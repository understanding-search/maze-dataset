<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.4"/>
    <title>maze_dataset.tokenization.modular.elements API documentation</title>
    <link rel="icon" href="../../../resources/favicon.png"/>
<link rel="stylesheet" href="../../../resources/css/bootstrap-reboot.min.css"><link rel="stylesheet" href="../../../resources/css/syntax-highlighting.css"><link rel="stylesheet" href="../../../resources/css/theme.css"><link rel="stylesheet" href="../../../resources/css/layout.css"><link rel="stylesheet" href="../../../resources/css/content.css"><link rel="stylesheet" href="../../../resources/css/custom.css"><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
        overflow-y: hidden;
    }
</style><style>
    .pdoc .mermaid-pre {
        border: none;
        background: none;
    }
</style>
<script type="module" defer>
    import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs";

    /* Re-invoke Mermaid when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => mermaid.run()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script></head>
<body>
<div class="package-version">
    docs for <a href="https://github.com/understanding-search/maze-dataset">maze-dataset</a> v1.4.0<br>
</div>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button">
            <img src="../../../resources/svg/navtoggle.svg" alt="Toggle navigation"> 
        </label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../modular.html">
                <img src="../../../resources/svg/box-arrow-in-left.svg" alt="Back to parent module"/>
                &nbsp;maze_dataset.tokenization.modular</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#CoordTokenizers">CoordTokenizers</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#CoordTokenizers.key">key</a>
                        </li>
                        <li>
                                <a class="class" href="#CoordTokenizers.UT">CoordTokenizers.UT</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#CoordTokenizers.UT.__init__">UT</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#CoordTokenizers.UT.to_tokens">to_tokens</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#CoordTokenizers.UT.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#CoordTokenizers.UT.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#CoordTokenizers.UT.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="class" href="#CoordTokenizers.CTT">CoordTokenizers.CTT</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#CoordTokenizers.CTT.__init__">CTT</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#CoordTokenizers.CTT.pre">pre</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#CoordTokenizers.CTT.intra">intra</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#CoordTokenizers.CTT.post">post</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#CoordTokenizers.CTT.to_tokens">to_tokens</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#CoordTokenizers.CTT.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#CoordTokenizers.CTT.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#CoordTokenizers.CTT.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#EdgeGroupings">EdgeGroupings</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#EdgeGroupings.key">key</a>
                        </li>
                        <li>
                                <a class="class" href="#EdgeGroupings.Ungrouped">EdgeGroupings.Ungrouped</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#EdgeGroupings.Ungrouped.__init__">Ungrouped</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#EdgeGroupings.Ungrouped.connection_token_ordinal">connection_token_ordinal</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgeGroupings.Ungrouped.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgeGroupings.Ungrouped.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgeGroupings.Ungrouped.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="class" href="#EdgeGroupings.ByLeadingCoord">EdgeGroupings.ByLeadingCoord</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#EdgeGroupings.ByLeadingCoord.__init__">ByLeadingCoord</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#EdgeGroupings.ByLeadingCoord.intra">intra</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#EdgeGroupings.ByLeadingCoord.shuffle_group">shuffle_group</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#EdgeGroupings.ByLeadingCoord.connection_token_ordinal">connection_token_ordinal</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgeGroupings.ByLeadingCoord.is_valid">is_valid</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgeGroupings.ByLeadingCoord.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgeGroupings.ByLeadingCoord.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgeGroupings.ByLeadingCoord.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#EdgePermuters">EdgePermuters</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#EdgePermuters.key">key</a>
                        </li>
                        <li>
                                <a class="class" href="#EdgePermuters.SortedCoords">EdgePermuters.SortedCoords</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#EdgePermuters.SortedCoords.__init__">SortedCoords</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgePermuters.SortedCoords.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgePermuters.SortedCoords.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgePermuters.SortedCoords.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="class" href="#EdgePermuters.RandomCoords">EdgePermuters.RandomCoords</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#EdgePermuters.RandomCoords.__init__">RandomCoords</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgePermuters.RandomCoords.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgePermuters.RandomCoords.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgePermuters.RandomCoords.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="class" href="#EdgePermuters.BothCoords">EdgePermuters.BothCoords</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#EdgePermuters.BothCoords.__init__">BothCoords</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgePermuters.BothCoords.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgePermuters.BothCoords.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgePermuters.BothCoords.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#EdgeSubsets">EdgeSubsets</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#EdgeSubsets.key">key</a>
                        </li>
                        <li>
                                <a class="class" href="#EdgeSubsets.AllLatticeEdges">EdgeSubsets.AllLatticeEdges</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#EdgeSubsets.AllLatticeEdges.__init__">AllLatticeEdges</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgeSubsets.AllLatticeEdges.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgeSubsets.AllLatticeEdges.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgeSubsets.AllLatticeEdges.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="class" href="#EdgeSubsets.ConnectionEdges">EdgeSubsets.ConnectionEdges</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#EdgeSubsets.ConnectionEdges.__init__">ConnectionEdges</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#EdgeSubsets.ConnectionEdges.walls">walls</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgeSubsets.ConnectionEdges.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgeSubsets.ConnectionEdges.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgeSubsets.ConnectionEdges.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#AdjListTokenizers">AdjListTokenizers</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#AdjListTokenizers.key">key</a>
                        </li>
                        <li>
                                <a class="class" href="#AdjListTokenizers.AdjListCoord">AdjListTokenizers.AdjListCoord</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#AdjListTokenizers.AdjListCoord.__init__">AdjListCoord</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#AdjListTokenizers.AdjListCoord.edge_permuter">edge_permuter</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#AdjListTokenizers.AdjListCoord.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#AdjListTokenizers.AdjListCoord.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#AdjListTokenizers.AdjListCoord.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="class" href="#AdjListTokenizers.AdjListCardinal">AdjListTokenizers.AdjListCardinal</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#AdjListTokenizers.AdjListCardinal.__init__">AdjListCardinal</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#AdjListTokenizers.AdjListCardinal.edge_permuter">edge_permuter</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#AdjListTokenizers.AdjListCardinal.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#AdjListTokenizers.AdjListCardinal.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#AdjListTokenizers.AdjListCardinal.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#TargetTokenizers">TargetTokenizers</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#TargetTokenizers.key">key</a>
                        </li>
                        <li>
                                <a class="class" href="#TargetTokenizers.Unlabeled">TargetTokenizers.Unlabeled</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#TargetTokenizers.Unlabeled.__init__">Unlabeled</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#TargetTokenizers.Unlabeled.post">post</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#TargetTokenizers.Unlabeled.to_tokens">to_tokens</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#TargetTokenizers.Unlabeled.is_valid">is_valid</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#TargetTokenizers.Unlabeled.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#TargetTokenizers.Unlabeled.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#TargetTokenizers.Unlabeled.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#StepSizes">StepSizes</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#StepSizes.key">key</a>
                        </li>
                        <li>
                                <a class="class" href="#StepSizes.Singles">StepSizes.Singles</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#StepSizes.Singles.__init__">Singles</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepSizes.Singles.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepSizes.Singles.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepSizes.Singles.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="class" href="#StepSizes.Straightaways">StepSizes.Straightaways</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#StepSizes.Straightaways.__init__">Straightaways</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepSizes.Straightaways.is_valid">is_valid</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepSizes.Straightaways.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepSizes.Straightaways.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepSizes.Straightaways.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="class" href="#StepSizes.Forks">StepSizes.Forks</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#StepSizes.Forks.__init__">Forks</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepSizes.Forks.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepSizes.Forks.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepSizes.Forks.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="class" href="#StepSizes.ForksAndStraightaways">StepSizes.ForksAndStraightaways</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#StepSizes.ForksAndStraightaways.__init__">ForksAndStraightaways</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepSizes.ForksAndStraightaways.is_valid">is_valid</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepSizes.ForksAndStraightaways.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepSizes.ForksAndStraightaways.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepSizes.ForksAndStraightaways.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#StepTokenizers">StepTokenizers</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#StepTokenizers.key">key</a>
                        </li>
                        <li>
                                <a class="class" href="#StepTokenizers.Coord">StepTokenizers.Coord</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#StepTokenizers.Coord.__init__">Coord</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepTokenizers.Coord.to_tokens">to_tokens</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepTokenizers.Coord.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepTokenizers.Coord.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepTokenizers.Coord.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="class" href="#StepTokenizers.Cardinal">StepTokenizers.Cardinal</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#StepTokenizers.Cardinal.__init__">Cardinal</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepTokenizers.Cardinal.to_tokens">to_tokens</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepTokenizers.Cardinal.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepTokenizers.Cardinal.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepTokenizers.Cardinal.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="class" href="#StepTokenizers.Relative">StepTokenizers.Relative</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#StepTokenizers.Relative.__init__">Relative</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepTokenizers.Relative.to_tokens">to_tokens</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepTokenizers.Relative.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepTokenizers.Relative.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepTokenizers.Relative.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="class" href="#StepTokenizers.Distance">StepTokenizers.Distance</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#StepTokenizers.Distance.__init__">Distance</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepTokenizers.Distance.to_tokens">to_tokens</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepTokenizers.Distance.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepTokenizers.Distance.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepTokenizers.Distance.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="variable" href="#StepTokenizers.StepTokenizerPermutation">StepTokenizerPermutation</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#PathTokenizers">PathTokenizers</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#PathTokenizers.key">key</a>
                        </li>
                        <li>
                                <a class="class" href="#PathTokenizers.StepSequence">PathTokenizers.StepSequence</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#PathTokenizers.StepSequence.__init__">StepSequence</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#PathTokenizers.StepSequence.step_size">step_size</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#PathTokenizers.StepSequence.step_tokenizers">step_tokenizers</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#PathTokenizers.StepSequence.pre">pre</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#PathTokenizers.StepSequence.intra">intra</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#PathTokenizers.StepSequence.post">post</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#PathTokenizers.StepSequence.to_tokens">to_tokens</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#PathTokenizers.StepSequence.is_valid">is_valid</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#PathTokenizers.StepSequence.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#PathTokenizers.StepSequence.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#PathTokenizers.StepSequence.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#PromptSequencers">PromptSequencers</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#PromptSequencers.key">key</a>
                        </li>
                        <li>
                                <a class="class" href="#PromptSequencers.AOTP">PromptSequencers.AOTP</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#PromptSequencers.AOTP.__init__">AOTP</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#PromptSequencers.AOTP.target_tokenizer">target_tokenizer</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#PromptSequencers.AOTP.path_tokenizer">path_tokenizer</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#PromptSequencers.AOTP.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#PromptSequencers.AOTP.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#PromptSequencers.AOTP.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="class" href="#PromptSequencers.AOP">PromptSequencers.AOP</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#PromptSequencers.AOP.__init__">AOP</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#PromptSequencers.AOP.path_tokenizer">path_tokenizer</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#PromptSequencers.AOP.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#PromptSequencers.AOP.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#PromptSequencers.AOP.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                </ul>

            </li>
    </ul>


    <hr/>
    
    <div>
        <a href="../../../coverage/html/index.html" class="pdoc-button" title="View test coverage report">
            Coverage
        </a>
        <a href="../../../other/todo-inline.html" class="pdoc-button" title="Table of TODOs scraped from source code, with links to create issues from them">
            TODOs
        </a>
        <a href="../../../other/lmcat.txt" class="pdoc-button" title="a view of the repo contents made for LLMs, using https://miv.name/lmcat">
            lmcat
        </a>
    </div>


        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span>
            <img src="../../../resources/svg/pdoc-logo.svg" alt="pdoc logo"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                        <a class="pdoc-button git-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py">View Source on GitHub</a>
                    <h1 class="modulename">
<a href="./../../../maze_dataset.html">maze_dataset</a><wbr>.<a href="./../../tokenization.html">tokenization</a><wbr>.<a href="./../modular.html">modular</a><wbr>.elements    </h1>

                        <div class="docstring"><p>implements subclasses of <code>_TokenizerElement</code> to be used in <code>MazeTokenizerModular</code></p>
</div>

                        <input id="mod-elements-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="mod-elements-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L0-L1293" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

                <br/>
                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="sd">&quot;&quot;&quot;implements subclasses of `_TokenizerElement` to be used in `MazeTokenizerModular`&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">abc</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a>	<span class="n">Callable</span><span class="p">,</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a>	<span class="n">Literal</span><span class="p">,</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a>	<span class="n">Sequence</span><span class="p">,</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a>	<span class="n">TypedDict</span><span class="p">,</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a><span class="p">)</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">jaxtyping</span><span class="w"> </span><span class="kn">import</span> <span class="n">Bool</span><span class="p">,</span> <span class="n">Int</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">muutils.json_serialize</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a>	<span class="n">serializable_dataclass</span><span class="p">,</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a>	<span class="n">serializable_field</span><span class="p">,</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a><span class="p">)</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">muutils.misc</span><span class="w"> </span><span class="kn">import</span> <span class="n">empty_sequence_if_attr_false</span><span class="p">,</span> <span class="n">flatten</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a><span class="c1"># from maze_dataset import SolvedMaze</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">maze_dataset.constants</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a>	<span class="n">VOCAB</span><span class="p">,</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a>	<span class="n">ConnectionArray</span><span class="p">,</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a>	<span class="n">ConnectionList</span><span class="p">,</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a>	<span class="n">Coord</span><span class="p">,</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a>	<span class="n">CoordTup</span><span class="p">,</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a><span class="p">)</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">maze_dataset.generation</span><span class="w"> </span><span class="kn">import</span> <span class="n">_NUMPY_RNG</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">maze_dataset.maze.lattice_maze</span><span class="w"> </span><span class="kn">import</span> <span class="n">LatticeMaze</span><span class="p">,</span> <span class="n">SolvedMaze</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">maze_dataset.token_utils</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a>	<span class="n">connection_list_to_adj_list</span><span class="p">,</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a>	<span class="n">get_cardinal_direction</span><span class="p">,</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a>	<span class="n">get_relative_direction</span><span class="p">,</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a>	<span class="n">is_connection</span><span class="p">,</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a>	<span class="n">tokens_between</span><span class="p">,</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a><span class="p">)</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">maze_dataset.tokenization.modular.element_base</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a>	<span class="n">__TokenizerElementNamespace</span><span class="p">,</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a>	<span class="n">_load_tokenizer_element</span><span class="p">,</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a>	<span class="n">_TokenizerElement</span><span class="p">,</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a>	<span class="n">_unsupported_is_invalid</span><span class="p">,</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a>	<span class="n">mark_as_unsupported</span><span class="p">,</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a><span class="p">)</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">maze_dataset.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">lattice_connection_array</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a><span class="k">class</span><span class="w"> </span><span class="nc">CoordTokenizers</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Namespace for `_CoordTokenizer` subclass hierarchy used by `MazeTokenizerModular`.&quot;&quot;&quot;</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a>	<span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;coord_tokenizer&quot;</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">_CoordTokenizer</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Superclass for classes which tokenize singular coords in a maze.&quot;&quot;&quot;</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a>		<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a>			<span class="k">pass</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a>		<span class="nd">@classmethod</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a>			<span class="k">return</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">key</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a>			<span class="c1"># No invalid instances possible within data member type hint bounds</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a>			<span class="k">return</span> <span class="kc">True</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">UT</span><span class="p">(</span><span class="n">_CoordTokenizer</span><span class="p">):</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Unique token coordinate tokenizer.&quot;&quot;&quot;</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a>		<span class="c1"># inherit docstring</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>  <span class="c1"># noqa: D102</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a>			<span class="k">return</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="s2">&quot;)&quot;</span><span class="p">])]</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">CTT</span><span class="p">(</span><span class="n">_CoordTokenizer</span><span class="p">):</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Coordinate tuple tokenizer</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a><span class="sd">		# Parameters</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a><span class="sd">		- `pre`: Whether all coords include an integral preceding delimiter token</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a><span class="sd">		- `intra`: Whether all coords include a delimiter token between coordinates</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a><span class="sd">		- `post`: Whether all coords include an integral following delimiter token</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a>
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a>		<span class="n">pre</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a>		<span class="n">intra</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a>		<span class="n">post</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a>		<span class="c1"># Implement methods</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a>		<span class="c1"># inherit docstring</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>  <span class="c1"># noqa: D102</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a>			<span class="k">return</span> <span class="p">[</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a>				<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">([</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">COORD_PRE</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;pre&quot;</span><span class="p">),</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a>				<span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a>				<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">([</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">COORD_INTRA</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;intra&quot;</span><span class="p">),</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a>				<span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a>				<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">([</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">COORD_POST</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;post&quot;</span><span class="p">),</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a>			<span class="p">]</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a><span class="k">class</span><span class="w"> </span><span class="nc">EdgeGroupings</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Namespace for `_EdgeGrouping` subclass hierarchy used by `_AdjListTokenizer`.&quot;&quot;&quot;</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a>	<span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;edge_grouping&quot;</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">_GroupingTokenParams</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;A uniform private hyperparameter interface used by `AdjListTokenizer`.&quot;&quot;&quot;</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a>		<span class="n">connection_token_ordinal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a>		<span class="n">intra</span><span class="p">:</span> <span class="nb">bool</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a>		<span class="n">grouped</span><span class="p">:</span> <span class="nb">bool</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">_EdgeGrouping</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Specifies if/how multiple coord-coord connections are grouped together in a token subsequence called a edge grouping.&quot;&quot;&quot;</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a>		<span class="nd">@classmethod</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a>			<span class="k">return</span> <span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">key</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a>			<span class="k">return</span> <span class="kc">True</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a>		<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_group_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ConnectionArray</span><span class="p">]:</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Divides a ConnectionArray into groups of edges.</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a><span class="sd">			Shuffles/sequences within each group if applicable.</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a>			<span class="k">pass</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a>		<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_token_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;EdgeGroupings._GroupingTokenParams&quot;</span><span class="p">:</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns the tok.nization hyperparameters necessary for an `AdjListTokenizer` to tokenize.</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a><span class="sd">			These hyperparameters are not used by `_EdgeGrouping` internally.</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a><span class="sd">			They are located in `_EdgeGrouping` rather than in `AdjListTokenizer`</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a><span class="sd">			since the hyperparameter space is a function of the `_EdgeGrouping` subclass.</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a><span class="sd">			This function resolves the `_EdgeGrouping` hyperparameter space which is non-uniform across subclasses</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a><span class="sd">			into a uniform private interface used by `AdjListTokenizer`.</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a>			<span class="k">pass</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">Ungrouped</span><span class="p">(</span><span class="n">_EdgeGrouping</span><span class="p">):</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;No grouping occurs, each edge is tokenized individually.</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a>
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a><span class="sd">		# Parameters</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a><span class="sd">		- `connection_token_ordinal`: At which index in the edge tokenization the connector (or wall) token appears.</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a><span class="sd">		Edge tokenizations contain 3 parts: a leading coord, a connector (or wall) token, and either a second coord or cardinal direction tokenization.</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a>		<span class="n">connection_token_ordinal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a>			<span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a>			<span class="n">assert_type</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a>		<span class="p">)</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_token_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;EdgeGroupings._GroupingTokenParams&quot;</span><span class="p">:</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a>			<span class="k">return</span> <span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">_GroupingTokenParams</span><span class="p">(</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a>				<span class="n">connection_token_ordinal</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">connection_token_ordinal</span><span class="p">,</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a>				<span class="n">intra</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a>				<span class="n">grouped</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a>			<span class="p">)</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_group_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionList</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ConnectionList</span><span class="p">]:</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a>			<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a>	<span class="nd">@mark_as_unsupported</span><span class="p">(</span><span class="n">_unsupported_is_invalid</span><span class="p">)</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">ByLeadingCoord</span><span class="p">(</span><span class="n">_EdgeGrouping</span><span class="p">):</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;All edges with the same leading coord are grouped together.</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a><span class="sd">		# Parameters</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a><span class="sd">		- `intra`: Whether all edge groupings include a delimiter token between individual edge representations.</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a><span class="sd">		Note that each edge representation will already always include a connector token (`VOCAB.CONNECTOR`, or possibly `)</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a><span class="sd">		- `shuffle_group`: Whether the sequence of edges within the group should be shuffled or appear in a fixed order.</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a><span class="sd">		If false, the fixed order is lexicographical by (row, col).</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a><span class="sd">		In effect, lexicographical sorting sorts edges by their cardinal direction in the sequence NORTH, WEST, EAST, SOUTH, where the directions indicate the position of the trailing coord relative to the leading coord.</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a><span class="sd">		- `connection_token_ordinal`: At which index in token sequence representing a single edge the connector (or wall) token appears.</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a><span class="sd">		Edge tokenizations contain 2 parts: a connector (or wall) token and a coord or cardinal tokenization.</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a>		<span class="n">intra</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a>		<span class="n">shuffle_group</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a>		<span class="n">connection_token_ordinal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a>			<span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a>			<span class="n">assert_type</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a>		<span class="p">)</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_token_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;EdgeGroupings._GroupingTokenParams&quot;</span><span class="p">:</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a>			<span class="k">return</span> <span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">_GroupingTokenParams</span><span class="p">(</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a>				<span class="n">connection_token_ordinal</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">connection_token_ordinal</span><span class="p">,</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a>				<span class="n">intra</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">intra</span><span class="p">,</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a>				<span class="n">grouped</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a>			<span class="p">)</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_group_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ConnectionArray</span><span class="p">]:</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a>			<span class="c1"># Adapted from: https://stackoverflow.com/questions/38013778/is-there-any-numpy-group-by-function</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a>			<span class="n">index_array</span><span class="p">:</span> <span class="n">Int</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;sort_indices=edges&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">lexsort</span><span class="p">(</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a>				<span class="p">(</span><span class="n">edges</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">edges</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a>			<span class="p">)</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a>			<span class="n">sorted_edges</span><span class="p">:</span> <span class="n">ConnectionArray</span> <span class="o">=</span> <span class="n">edges</span><span class="p">[</span><span class="n">index_array</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a>			<span class="n">groups</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ConnectionArray</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a>				<span class="n">sorted_edges</span><span class="p">,</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a>				<span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">sorted_edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a>			<span class="p">)</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a>			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shuffle_group</span><span class="p">:</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a>				<span class="p">[</span><span class="n">_NUMPY_RNG</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">]</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a>			<span class="k">return</span> <span class="n">groups</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a><span class="k">class</span><span class="w"> </span><span class="nc">EdgePermuters</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Namespace for `_EdgePermuter` subclass hierarchy used by `_AdjListTokenizer`.&quot;&quot;&quot;</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a>	<span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;edge_permuter&quot;</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">_EdgePermuter</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Specifies how to sequence the two coords that encode a lattice edge.&quot;&quot;&quot;</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a>		<span class="nd">@classmethod</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a>			<span class="k">return</span> <span class="n">EdgePermuters</span><span class="o">.</span><span class="n">key</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a>			<span class="c1"># No invalid instances possible within data member type hint bounds</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a>			<span class="k">return</span> <span class="kc">True</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a>		<span class="nd">@staticmethod</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a>		<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_permute</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Executes a permutation.</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a><span class="sd">			Warning: Caller should be aware that `lattice_edges` may be modified in-place depending on the subclass&#39;s implementation.</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a><span class="sd">			# Parameters</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a><span class="sd">			- `lattice_edges`: Array of lattice edges.</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a><span class="sd">			The two coords in shape[1] must be adjacent in the lattice.</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a><span class="sd">			# Returns</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a><span class="sd">			- Array of lattice edges with entries along shape[1] systematically permuted.</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a><span class="sd">			- shape[0] of the returned array is NOT guaranteed to match `lattice_edges.shape[1]`.</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a>			<span class="k">pass</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">SortedCoords</span><span class="p">(</span><span class="n">_EdgePermuter</span><span class="p">):</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;returns a sorted representation. useful for checking consistency&quot;&quot;&quot;</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a>		<span class="nd">@staticmethod</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_permute</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a>			<span class="k">return</span> <span class="n">lattice_edges</span><span class="p">[</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a>				<span class="n">np</span><span class="o">.</span><span class="n">lexsort</span><span class="p">(</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a>					<span class="p">(</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a>						<span class="n">lattice_edges</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a>						<span class="n">lattice_edges</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a>						<span class="n">lattice_edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a>						<span class="n">lattice_edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a>					<span class="p">),</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a>				<span class="p">),</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a>				<span class="o">...</span><span class="p">,</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a>			<span class="p">]</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">RandomCoords</span><span class="p">(</span><span class="n">_EdgePermuter</span><span class="p">):</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Permutes each edge randomly.&quot;&quot;&quot;</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a>		<span class="nd">@staticmethod</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_permute</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a>			<span class="n">_NUMPY_RNG</span><span class="o">.</span><span class="n">permuted</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">lattice_edges</span><span class="p">)</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a>			<span class="k">return</span> <span class="n">lattice_edges</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">BothCoords</span><span class="p">(</span><span class="n">_EdgePermuter</span><span class="p">):</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Includes both possible permutations of every edge in the output.</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a><span class="sd">		Since input ConnectionList has only 1 instance of each edge,</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a><span class="sd">		a call to `BothCoords._permute` will modify `lattice_edges` in-place, doubling `shape[0]`.</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a>		<span class="nd">@staticmethod</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_permute</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a>			<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a><span class="k">class</span><span class="w"> </span><span class="nc">EdgeSubsets</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Namespace for `_EdgeSubset` subclass hierarchy used by `_AdjListTokenizer`.&quot;&quot;&quot;</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a>	<span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;edge_subset&quot;</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">_EdgeSubset</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Component of an `AdjListTokenizers._AdjListTokenizer` which specifies the subset of lattice edges to be tokenized.&quot;&quot;&quot;</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a>		<span class="nd">@classmethod</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a>			<span class="k">return</span> <span class="n">EdgeSubsets</span><span class="o">.</span><span class="n">key</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a>			<span class="k">return</span> <span class="kc">True</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a>		<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_get_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns the set of lattice edges to be tokenized.&quot;&quot;&quot;</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a>			<span class="k">pass</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">AllLatticeEdges</span><span class="p">(</span><span class="n">_EdgeSubset</span><span class="p">):</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;All 2n**2-2n edges of the lattice are tokenized.</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a><span class="sd">		If a wall exists on that edge, the edge is tokenized in the same manner, using `VOCAB.ADJLIST_WALL` in place of `VOCAB.CONNECTOR`.</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_get_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a>			<span class="k">return</span> <span class="n">lattice_connection_array</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">grid_n</span><span class="p">)</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">ConnectionEdges</span><span class="p">(</span><span class="n">_EdgeSubset</span><span class="p">):</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Only edges which contain a connection are tokenized.</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a><span class="sd">		Alternatively, only edges which contain a wall are tokenized.</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a><span class="sd">		# Parameters</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a><span class="sd">		- `walls`: Whether wall edges or connection edges are tokenized.</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a><span class="sd">		If true, `VOCAB.ADJLIST_WALL` is used in place of `VOCAB.CONNECTOR`.</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a>		<span class="n">walls</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_get_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a>			<span class="n">conn_list</span><span class="p">:</span> <span class="n">ConnectionList</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">connection_list</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a>			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">walls</span><span class="p">:</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a>				<span class="n">conn_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">conn_list</span><span class="p">)</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a>				<span class="n">conn_list</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a>				<span class="n">conn_list</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a>			<span class="k">return</span> <span class="n">connection_list_to_adj_list</span><span class="p">(</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a>				<span class="n">conn_list</span><span class="p">,</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a>				<span class="n">shuffle_d0</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a>				<span class="n">shuffle_d1</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a>			<span class="p">)</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a><span class="k">def</span><span class="w"> </span><span class="nf">_adjlist_no_pre_unsupported</span><span class="p">(</span><span class="n">self_</span><span class="p">,</span> <span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># noqa: ANN001</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Returns False if `pre` is True, True otherwise.&quot;&quot;&quot;</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a>	<span class="n">output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">self_</span><span class="o">.</span><span class="n">pre</span> <span class="ow">is</span> <span class="kc">False</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a>	<span class="k">if</span> <span class="n">do_except</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">output</span><span class="p">:</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a>			<span class="s2">&quot;AdjListCoord does not support `pre == False`.&quot;</span><span class="p">,</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a>		<span class="p">)</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a>	<span class="k">return</span> <span class="n">output</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a><span class="k">class</span><span class="w"> </span><span class="nc">AdjListTokenizers</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Namespace for `_AdjListTokenizer` subclass hierarchy used by `MazeTokenizerModular`.&quot;&quot;&quot;</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a>
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a>	<span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;adj_list_tokenizer&quot;</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a>	<span class="nd">@mark_as_unsupported</span><span class="p">(</span><span class="n">_adjlist_no_pre_unsupported</span><span class="p">)</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">_AdjListTokenizer</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Specifies how the adjacency list is tokenized.</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a><span class="sd">		Tokenization behavior is decomposed into specification of edge subsets, groupings, and permutations.</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a><span class="sd">		See documentation of `EdgeSubset` and `EdgeGrouping` classes for more details.</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a><span class="sd">		# Parameters</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a><span class="sd">		- `pre`: Whether all edge groupings include a preceding delimiter token</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a><span class="sd">		- `post`: Whether all edge groupings include a following delimiter token</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a><span class="sd">		- `shuffle_d0`: Specifies how to sequence the edge groupings.</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a><span class="sd">			If true, groupings are shuffled randomly. If false, groupings are sorted by the leading coord of each group.</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a><span class="sd">		- `edge_grouping`: Specifies if/how multiple coord-coord connections are grouped together in a token subsequence called an edge grouping.</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a><span class="sd">		- `edge_subset`: Specifies the subset of lattice edges to be tokenized.</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a><span class="sd">		- `edge_permuter`: Specifies, in each edge tokenization, which coord either:</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a><span class="sd">			1. Appears first in the tokenization, for `AdjListCoord`.</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a><span class="sd">			2. Is tokenized directly as a coord, for `AdjListCardinal`.</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a><span class="sd">			- `shuffle`: For each edge, the leading coord is selected randomly.</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a><span class="sd">			- `all`: Each edge appears twice in the tokenization, appearing with both leading coords.</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a><span class="sd">			- `evens`, `odds`: The leading coord is the one belonging to that coord subset. See `EdgeSubsets.ChessboardSublattice` for details.</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a>		<span class="n">pre</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">assert_type</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a>		<span class="n">post</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a>		<span class="n">shuffle_d0</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a>		<span class="n">edge_grouping</span><span class="p">:</span> <span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">_EdgeGrouping</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a>			<span class="n">default</span><span class="o">=</span><span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">Ungrouped</span><span class="p">(),</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a>			<span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">EdgeGroupings</span><span class="p">),</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a>		<span class="p">)</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a>		<span class="n">edge_subset</span><span class="p">:</span> <span class="n">EdgeSubsets</span><span class="o">.</span><span class="n">_EdgeSubset</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a>			<span class="n">default</span><span class="o">=</span><span class="n">EdgeSubsets</span><span class="o">.</span><span class="n">ConnectionEdges</span><span class="p">(),</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a>			<span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">EdgeSubsets</span><span class="p">),</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a>		<span class="p">)</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a>		<span class="n">edge_permuter</span><span class="p">:</span> <span class="n">EdgePermuters</span><span class="o">.</span><span class="n">_EdgePermuter</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a>			<span class="n">default</span><span class="o">=</span><span class="n">EdgePermuters</span><span class="o">.</span><span class="n">RandomCoords</span><span class="p">(),</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a>			<span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">EdgePermuters</span><span class="p">),</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a>		<span class="p">)</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a>		<span class="nd">@classmethod</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a>			<span class="k">return</span> <span class="n">AdjListTokenizers</span><span class="o">.</span><span class="n">key</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a>			<span class="c1"># No invalid instances possible within data member type hint bounds</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a>			<span class="k">return</span> <span class="kc">True</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a>		<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_tokenization_callables</span><span class="p">(</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a>			<span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">,</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a>			<span class="n">is_conn</span><span class="p">:</span> <span class="n">Bool</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot; edges&quot;</span><span class="p">],</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a>			<span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a>			<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Callable</span><span class="p">]:</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns a sequence of callables which take an index in `edges` and return parts of that edge tokenization.</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a><span class="sd">			# Returns</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a><span class="sd">			- `[0]`: leading coord tokens</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a><span class="sd">			- `[1]`: connector tokens</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a><span class="sd">			- `[2]`: trailing coord tokens</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a>			<span class="k">pass</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_tokenize_edge_grouping</span><span class="p">(</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a>			<span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">,</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">,</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a>			<span class="n">group_params</span><span class="p">:</span> <span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">_GroupingTokenParams</span><span class="p">,</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Tokenizes a single edge grouping.&quot;&quot;&quot;</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a>			<span class="n">cxn_ord</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">group_params</span><span class="p">[</span><span class="s2">&quot;connection_token_ordinal&quot;</span><span class="p">]</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a>			<span class="n">is_conn</span><span class="p">:</span> <span class="n">Bool</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">edges</span><span class="p">]</span> <span class="o">=</span> <span class="n">is_connection</span><span class="p">(</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a>				<span class="n">edges</span><span class="p">,</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a>				<span class="n">maze</span><span class="o">.</span><span class="n">connection_list</span><span class="p">,</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a>			<span class="p">)</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a>			<span class="n">tokenize_callables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tokenization_callables</span><span class="p">(</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a>				<span class="n">edges</span><span class="p">,</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a>				<span class="n">is_conn</span><span class="p">,</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a>				<span class="n">coord_tokenizer</span><span class="p">,</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a>			<span class="p">)</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a>			<span class="k">if</span> <span class="n">group_params</span><span class="p">[</span><span class="s2">&quot;grouped&quot;</span><span class="p">]:</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a>				<span class="c1"># If grouped</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a>				<span class="n">callable_permutation</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="k">if</span> <span class="n">cxn_ord</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a>				<span class="n">repeated_callables</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a>					<span class="n">tokenize_callables</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">callable_permutation</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a>				<span class="p">]</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a>				<span class="k">return</span> <span class="n">flatten</span><span class="p">(</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a>					<span class="p">[</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a>						<span class="n">tokenize_callables</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="mi">0</span><span class="p">),</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a>						<span class="p">[</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a>							<span class="p">[</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a>								<span class="o">*</span><span class="p">[</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a>									<span class="n">tok_callable</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a>									<span class="k">for</span> <span class="n">tok_callable</span> <span class="ow">in</span> <span class="n">repeated_callables</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a>								<span class="p">],</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a>								<span class="o">*</span><span class="p">(</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a>									<span class="p">(</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_INTRA</span><span class="p">,)</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a>									<span class="k">if</span> <span class="n">group_params</span><span class="p">[</span><span class="s2">&quot;intra&quot;</span><span class="p">]</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a>									<span class="k">else</span> <span class="p">()</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a>								<span class="p">),</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a>							<span class="p">]</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a>							<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">edges</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a>						<span class="p">],</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a>					<span class="p">],</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a>				<span class="p">)</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a>			<span class="k">else</span><span class="p">:</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a>				<span class="c1"># If ungrouped</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a>				<span class="n">callable_permutation</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a>				<span class="n">callable_permutation</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">cxn_ord</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a>				<span class="n">tokenize_callables</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a>					<span class="n">tokenize_callables</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">callable_permutation</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a>				<span class="p">]</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a>				<span class="k">return</span> <span class="n">flatten</span><span class="p">(</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a>					<span class="p">[</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a>						<span class="p">[</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a>							<span class="p">[</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a>								<span class="o">*</span><span class="p">[</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a>									<span class="n">tok_callable</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a>									<span class="k">for</span> <span class="n">tok_callable</span> <span class="ow">in</span> <span class="n">tokenize_callables</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a>								<span class="p">],</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a>								<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">(</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a>									<span class="p">(</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_INTRA</span><span class="p">,),</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a>									<span class="n">group_params</span><span class="p">,</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a>									<span class="s2">&quot;intra&quot;</span><span class="p">,</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a>								<span class="p">),</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a>							<span class="p">]</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a>							<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">edges</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a>						<span class="p">],</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a>					<span class="p">],</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a>				<span class="p">)</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">,</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a>			<span class="c1"># Get the set of edges to be tokenized</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a>			<span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_subset</span><span class="o">.</span><span class="n">_get_edges</span><span class="p">(</span><span class="n">maze</span><span class="p">)</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a>			<span class="c1"># Systematically permute the leading coord of each edge</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a>			<span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_permuter</span><span class="o">.</span><span class="n">_permute</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a>			<span class="n">group_params</span><span class="p">:</span> <span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">_GroupingTokenParams</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a>				<span class="bp">self</span><span class="o">.</span><span class="n">edge_grouping</span><span class="o">.</span><span class="n">_token_params</span><span class="p">()</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a>			<span class="p">)</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a>			<span class="c1"># then, we need to group the edges</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a>			<span class="n">groups</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ConnectionArray</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_grouping</span><span class="o">.</span><span class="n">_group_edges</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a>			<span class="c1"># shuffle the groups if specified</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a>			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shuffle_d0</span><span class="p">:</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a>				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a>					<span class="n">_NUMPY_RNG</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a>				<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a>					<span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a>				<span class="k">else</span><span class="p">:</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a>					<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;`groups` is an unexpected type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span><span class="si">}</span><span class="s2">. Only types `list` and `np.ndarray` are currently supported.&quot;</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a>					<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a>			<span class="c1"># Tokenize each group with optional delimiters</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a>			<span class="n">tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a>				<span class="n">flatten</span><span class="p">(</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a>					<span class="p">[</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a>						<span class="p">[</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a>							<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">(</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a>								<span class="p">(</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_PRE</span><span class="p">,),</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a>								<span class="bp">self</span><span class="p">,</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a>								<span class="s2">&quot;pre&quot;</span><span class="p">,</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a>							<span class="p">),</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a>							<span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_tokenize_edge_grouping</span><span class="p">(</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a>								<span class="n">group</span><span class="p">,</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a>								<span class="n">maze</span><span class="p">,</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a>								<span class="n">coord_tokenizer</span><span class="p">,</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a>								<span class="n">group_params</span><span class="p">,</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a>							<span class="p">),</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a>							<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">(</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a>								<span class="p">(</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJACENCY_ENDLINE</span><span class="p">,),</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a>								<span class="bp">self</span><span class="p">,</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a>								<span class="s2">&quot;post&quot;</span><span class="p">,</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a>							<span class="p">),</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a>						<span class="p">]</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a>						<span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a>					<span class="p">],</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a>				<span class="p">),</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a>			<span class="p">)</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a>			<span class="k">return</span> <span class="n">tokens</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">AdjListCoord</span><span class="p">(</span><span class="n">_AdjListTokenizer</span><span class="p">):</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Represents an edge group as tokens for the leading coord followed by coord tokens for the other group members.&quot;&quot;&quot;</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a>
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a>		<span class="n">edge_permuter</span><span class="p">:</span> <span class="n">EdgePermuters</span><span class="o">.</span><span class="n">_EdgePermuter</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a>			<span class="n">default</span><span class="o">=</span><span class="n">EdgePermuters</span><span class="o">.</span><span class="n">RandomCoords</span><span class="p">(),</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a>			<span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">EdgePermuters</span><span class="p">),</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a>		<span class="p">)</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_tokenization_callables</span><span class="p">(</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a>			<span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">,</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a>			<span class="n">is_conn</span><span class="p">:</span> <span class="n">Bool</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot; edges&quot;</span><span class="p">],</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a>			<span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a>			<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Callable</span><span class="p">]:</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a>			<span class="c1"># Map from `is_conn` to the tokens which represent connections and walls</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a>			<span class="n">conn_token_map</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a>				<span class="kc">True</span><span class="p">:</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">CONNECTOR</span><span class="p">,</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a>				<span class="kc">False</span><span class="p">:</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_WALL</span><span class="p">,</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a>			<span class="p">}</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a>			<span class="k">return</span> <span class="p">[</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a>				<span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a>				<span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">conn_token_map</span><span class="p">[</span><span class="n">is_conn</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a>				<span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a>			<span class="p">]</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">AdjListCardinal</span><span class="p">(</span><span class="n">_AdjListTokenizer</span><span class="p">):</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Represents an edge group as coord tokens for the leading coord and cardinal tokens relative to the leading coord for the other group members.</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a><span class="sd">		# Parameters</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a><span class="sd">		- `coord_first`: Whether the leading coord token(s) should come before or after the sequence of cardinal tokens.</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a>		<span class="n">edge_permuter</span><span class="p">:</span> <span class="n">EdgePermuters</span><span class="o">.</span><span class="n">_EdgePermuter</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a>			<span class="n">default</span><span class="o">=</span><span class="n">EdgePermuters</span><span class="o">.</span><span class="n">BothCoords</span><span class="p">(),</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a>			<span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">EdgePermuters</span><span class="p">),</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a>		<span class="p">)</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_tokenization_callables</span><span class="p">(</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a>			<span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">,</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a>			<span class="n">is_conn</span><span class="p">:</span> <span class="n">Bool</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot; edges&quot;</span><span class="p">],</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a>			<span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a>			<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Callable</span><span class="p">]:</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a>			<span class="c1"># Map from `is_conn` to the tokens which represent connections and walls</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a>			<span class="n">conn_token_map</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a>				<span class="kc">True</span><span class="p">:</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">CONNECTOR</span><span class="p">,</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a>				<span class="kc">False</span><span class="p">:</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_WALL</span><span class="p">,</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a>			<span class="p">}</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a>			<span class="k">return</span> <span class="p">[</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a>				<span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a>				<span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">conn_token_map</span><span class="p">[</span><span class="n">is_conn</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a>				<span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">get_cardinal_direction</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a>			<span class="p">]</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a><span class="k">class</span><span class="w"> </span><span class="nc">TargetTokenizers</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Namespace for `_TargetTokenizer` subclass hierarchy used by `MazeTokenizerModular`.&quot;&quot;&quot;</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a>	<span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;target_tokenizer&quot;</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">_TargetTokenizer</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Superclass of tokenizers for maze targets.&quot;&quot;&quot;</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a>		<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a>			<span class="n">targets</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Coord</span><span class="p">],</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns tokens representing the target.&quot;&quot;&quot;</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a>			<span class="k">pass</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a>		<span class="nd">@classmethod</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a>			<span class="k">return</span> <span class="n">TargetTokenizers</span><span class="o">.</span><span class="n">key</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a>
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">Unlabeled</span><span class="p">(</span><span class="n">_TargetTokenizer</span><span class="p">):</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Targets are simply listed as coord tokens.</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a><span class="sd">		- `post`: Whether all coords include an integral following delimiter token</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a>		<span class="n">post</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a>		<span class="c1"># inherit docstring</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>  <span class="c1"># noqa: D102</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a>			<span class="n">targets</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Coord</span><span class="p">],</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a>			<span class="k">return</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a>				<span class="n">flatten</span><span class="p">(</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a>					<span class="p">[</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a>						<span class="p">[</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a>							<span class="o">*</span><span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a>							<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">(</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a>								<span class="p">[</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_POST</span><span class="p">],</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a>								<span class="bp">self</span><span class="p">,</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a>								<span class="s2">&quot;post&quot;</span><span class="p">,</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a>							<span class="p">),</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a>						<span class="p">]</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a>						<span class="k">for</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">targets</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a>					<span class="p">],</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a>				<span class="p">),</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a>			<span class="p">)</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a>		<span class="c1"># inherit docstring</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># noqa: D102</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a>			<span class="c1"># No invalid instances possible within data member type hint bounds</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a>			<span class="k">return</span> <span class="kc">True</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a><span class="k">class</span><span class="w"> </span><span class="nc">StepSizes</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Namespace for `_StepSize` subclass hierarchy used by `MazeTokenizerModular`.&quot;&quot;&quot;</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a>	<span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;step_size&quot;</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">_StepSize</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Specifies which coords in `maze.solution` are used to represent the path.&quot;&quot;&quot;</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a>		<span class="nd">@classmethod</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a>			<span class="k">return</span> <span class="n">StepSizes</span><span class="o">.</span><span class="n">key</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a>
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a>		<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>  <span class="c1"># TODO: make this a static/class method, allowing ForksAndStraightaways to skip object construction at every call</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_step_single_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns the indices of `maze.solution` corresponding to the steps to be tokenized.&quot;&quot;&quot;</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a>			<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a>				<span class="s2">&quot;Subclasses must implement `StepSize.step_indices.&quot;</span><span class="p">,</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a>			<span class="p">)</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">step_start_end_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns steps as tuples of starting and ending positions for each step.&quot;&quot;&quot;</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a>			<span class="n">indices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_step_single_indices</span><span class="p">(</span><span class="n">maze</span><span class="p">)</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a>			<span class="c1"># TODO: RUF007 Prefer `itertools.pairwise()` over `zip()` when iterating over successive pairs</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a>			<span class="k">return</span> <span class="p">[</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a>				<span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a>				<span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">indices</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">indices</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># noqa: RUF007</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a>			<span class="p">]</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a>			<span class="c1"># No invalid instances possible within data member type hint bounds</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a>			<span class="k">return</span> <span class="kc">True</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">Singles</span><span class="p">(</span><span class="n">_StepSize</span><span class="p">):</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Every coord in `maze.solution` is represented.</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a><span class="sd">		Legacy tokenizers all use this behavior.</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_step_single_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns the indices of `maze.solution` corresponding to the steps to be tokenized.&quot;&quot;&quot;</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a>			<span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a>	<span class="nd">@mark_as_unsupported</span><span class="p">(</span><span class="n">_unsupported_is_invalid</span><span class="p">)</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">Straightaways</span><span class="p">(</span><span class="n">_StepSize</span><span class="p">):</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Only coords where the path turns are represented in the path.</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a><span class="sd">		I.e., the path is represented as a sequence of straightaways,</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a><span class="sd">		specified by the coords at the turns.</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_step_single_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns the indices of `maze.solution` corresponding to the steps to be tokenized.&quot;&quot;&quot;</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a>			<span class="n">last_turn_coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a>			<span class="n">indices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a>			<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">coord</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">):</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a>				<span class="k">if</span> <span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">last_turn_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">last_turn_coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a>					<span class="n">indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a>					<span class="n">last_turn_coord</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a>			<span class="n">indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a>			<span class="k">return</span> <span class="n">indices</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">Forks</span><span class="p">(</span><span class="n">_StepSize</span><span class="p">):</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Only coords at forks, where the path has &gt;=2 options for the next step are included.</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a><span class="sd">		Excludes the option of backtracking.</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a><span class="sd">		The starting and ending coords are always included.</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_step_single_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns the indices of `maze.solution` corresponding to the steps to be tokenized.&quot;&quot;&quot;</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a>			<span class="k">return</span> <span class="n">maze</span><span class="o">.</span><span class="n">get_solution_forking_points</span><span class="p">(</span><span class="n">always_include_endpoints</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a>	<span class="nd">@mark_as_unsupported</span><span class="p">(</span><span class="n">_unsupported_is_invalid</span><span class="p">)</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">ForksAndStraightaways</span><span class="p">(</span><span class="n">_StepSize</span><span class="p">):</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Includes the union of the coords included by `Forks` and `Straightaways`.</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a><span class="sd">		See documentation for those classes for details.</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_step_single_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns the indices of `maze.solution` corresponding to the steps to be tokenized.&quot;&quot;&quot;</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a>			<span class="k">return</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a>				<span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a>					<span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a>						<span class="p">(</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a>							<span class="n">StepSizes</span><span class="o">.</span><span class="n">Straightaways</span><span class="p">()</span><span class="o">.</span><span class="n">_step_single_indices</span><span class="p">(</span><span class="n">maze</span><span class="p">),</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a>							<span class="n">StepSizes</span><span class="o">.</span><span class="n">Forks</span><span class="p">()</span><span class="o">.</span><span class="n">_step_single_indices</span><span class="p">(</span><span class="n">maze</span><span class="p">),</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a>						<span class="p">),</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a>					<span class="p">),</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a>				<span class="p">),</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a>			<span class="p">)</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a><span class="k">class</span><span class="w"> </span><span class="nc">StepTokenizers</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Namespace for `_StepTokenizer` subclass hierarchy used by `MazeTokenizerModular`.&quot;&quot;&quot;</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a>	<span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;step_tokenizers&quot;</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">_StepTokenizer</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Specifies how a single step (as specified by an instance of `_StepSize`) is tokenized.&quot;&quot;&quot;</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a>		<span class="nd">@classmethod</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a>			<span class="k">return</span> <span class="n">StepTokenizers</span><span class="o">.</span><span class="n">key</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a>		<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a>			<span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a>			<span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a>			<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Tokenizes a single step in the solution.</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a><span class="sd">			# Parameters</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a><span class="sd">			- `maze`: Maze to be tokenized</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a><span class="sd">			- `start_index`: The index of the Coord in `maze.solution` at which the current step starts</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a><span class="sd">			- `end_index`: The index of the Coord in `maze.solution` at which the current step ends</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a>			<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a>				<span class="s2">&quot;Subclasses must implement `StepTokenizer.to_tokens.&quot;</span><span class="p">,</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a>			<span class="p">)</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a>			<span class="c1"># No invalid instances possible within data member type hint bounds</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a>			<span class="k">return</span> <span class="kc">True</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">Coord</span><span class="p">(</span><span class="n">_StepTokenizer</span><span class="p">):</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;A direct tokenization of the end position coord represents the step.&quot;&quot;&quot;</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a>		<span class="c1"># inherit docstring</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>  <span class="c1"># noqa: D102</span>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a>			<span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a>			<span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a>			<span class="k">return</span> <span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">end_index</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">Cardinal</span><span class="p">(</span><span class="n">_StepTokenizer</span><span class="p">):</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;A step is tokenized with a cardinal direction token.</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a><span class="sd">		It is the direction of the step from the starting position along the solution.</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a>		<span class="c1"># inherit docstring</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>  <span class="c1"># noqa: D102</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a>			<span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a>			<span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a>			<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a>			<span class="k">return</span> <span class="p">[</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a>				<span class="n">get_cardinal_direction</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">start_index</span> <span class="p">:</span> <span class="n">start_index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]),</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a>			<span class="p">]</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">Relative</span><span class="p">(</span><span class="n">_StepTokenizer</span><span class="p">):</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Tokenizes a solution step using relative first-person directions (right, left, forward, etc.).</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a><span class="sd">		To simplify the indeterminacy, at the start of a solution the &quot;agent&quot; solving the maze is assumed to be facing NORTH.</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a><span class="sd">		Similarly to `Cardinal`, the direction is that of the step from the starting position.</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a>		<span class="c1"># inherit docstring</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>  <span class="c1"># noqa: D102</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a>			<span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a>			<span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a>			<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a>			<span class="k">if</span> <span class="n">start_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a>				<span class="n">start</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a>				<span class="n">previous</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a>				<span class="k">return</span> <span class="p">[</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a>					<span class="n">get_relative_direction</span><span class="p">(</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a>						<span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a>							<span class="p">(</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a>								<span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">previous</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a>								<span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">start_index</span> <span class="p">:</span> <span class="n">start_index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">],</span>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a>							<span class="p">),</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a>							<span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a>						<span class="p">),</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a>					<span class="p">),</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a>				<span class="p">]</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a>			<span class="k">return</span> <span class="p">[</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a>				<span class="n">get_relative_direction</span><span class="p">(</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a>					<span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">start_index</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">start_index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">],</span>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a>				<span class="p">),</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a>			<span class="p">]</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">Distance</span><span class="p">(</span><span class="n">_StepTokenizer</span><span class="p">):</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;A count of the number of individual steps from the starting point to the end point.</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a><span class="sd">		Contains no information about directionality, only the distance traveled in the step.</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a><span class="sd">		`Distance` must be combined with at least one other `_StepTokenizer` in a `StepTokenizerPermutation`.</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a><span class="sd">		This constraint is enforced in `_PathTokenizer.is_valid`.</span>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a>		<span class="c1"># inherit docstring</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>  <span class="c1"># noqa: D102</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a>			<span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a>			<span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a>			<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a>			<span class="n">d</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">end_index</span> <span class="o">-</span> <span class="n">start_index</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a>			<span class="k">return</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">VOCAB</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;I_</span><span class="si">{</span><span class="n">d</span><span class="si">:</span><span class="s2">03</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)]</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a><span class="sd">	`StepTokenizerPermutation`</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a><span class="sd">	A sequence of unique `_StepTokenizer`s.</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a><span class="sd">	This type exists mostly just for the clarity and convenience of `_PathTokenizer` code.</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a>	<span class="n">StepTokenizerPermutation</span><span class="p">:</span> <span class="nb">type</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a>		<span class="nb">tuple</span><span class="p">[</span><span class="n">_StepTokenizer</span><span class="p">]</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a>		<span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">_StepTokenizer</span><span class="p">]</span>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a>		<span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">_StepTokenizer</span><span class="p">]</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a>		<span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">_StepTokenizer</span><span class="p">]</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a>	<span class="p">)</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a><span class="k">class</span><span class="w"> </span><span class="nc">PathTokenizers</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Namespace for `_PathTokenizer` subclass hierarchy used by `MazeTokenizerModular`.&quot;&quot;&quot;</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a>	<span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;path_tokenizer&quot;</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">_PathTokenizer</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Superclass of tokenizers for maze solution paths.&quot;&quot;&quot;</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a>		<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns tokens representing the solution path.&quot;&quot;&quot;</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a>			<span class="k">pass</span>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a>		<span class="nd">@classmethod</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a>			<span class="k">return</span> <span class="n">PathTokenizers</span><span class="o">.</span><span class="n">key</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">StepSequence</span><span class="p">(</span><span class="n">_PathTokenizer</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Any `PathTokenizer` where the tokenization may be assembled from token subsequences, each of which represents a step along the path.</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a><span class="sd">		Allows for a sequence of leading and trailing tokens which don&#39;t fit the step pattern.</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a><span class="sd">		# Parameters</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a><span class="sd">		- `step_size`: Selects the size of a single step in the sequence</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a><span class="sd">		- `step_tokenizers`: Selects the combination and permutation of tokens</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a><span class="sd">		- `pre`: Whether all steps include an integral preceding delimiter token</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a><span class="sd">		- `intra`: Whether all steps include a delimiter token after each individual `_StepTokenizer` tokenization.</span>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a><span class="sd">		- `post`: Whether all steps include an integral following delimiter token</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a>		<span class="n">step_size</span><span class="p">:</span> <span class="n">StepSizes</span><span class="o">.</span><span class="n">_StepSize</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a>			<span class="n">default</span><span class="o">=</span><span class="n">StepSizes</span><span class="o">.</span><span class="n">Singles</span><span class="p">(),</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a>			<span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">StepSizes</span><span class="p">),</span>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a>		<span class="p">)</span>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a>		<span class="n">step_tokenizers</span><span class="p">:</span> <span class="n">StepTokenizers</span><span class="o">.</span><span class="n">StepTokenizerPermutation</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a>			<span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="n">StepTokenizers</span><span class="o">.</span><span class="n">Coord</span><span class="p">(),),</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a>			<span class="n">serialization_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">y</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="p">],</span>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a>			<span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">StepTokenizers</span><span class="o">.</span><span class="n">key</span><span class="p">]),</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a>		<span class="p">)</span>
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a>		<span class="n">pre</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a>		<span class="n">intra</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a>		<span class="n">post</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a>		<span class="c1"># inherit docstring</span>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>  <span class="c1"># noqa: D102</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a>			<span class="k">return</span> <span class="p">[</span>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a>				<span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_leading_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">),</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a>				<span class="o">*</span><span class="n">flatten</span><span class="p">(</span>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a>					<span class="p">[</span>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a>						<span class="bp">self</span><span class="o">.</span><span class="n">_single_step_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">)</span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a>						<span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_size</span><span class="o">.</span><span class="n">step_start_end_indices</span><span class="p">(</span><span class="n">maze</span><span class="p">)</span>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a>					<span class="p">],</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a>				<span class="p">),</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a>				<span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_trailing_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">),</span>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a>			<span class="p">]</span>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_single_step_tokens</span><span class="p">(</span>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a>			<span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a>			<span class="n">j</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns the token sequence representing a single step along the path.&quot;&quot;&quot;</span>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a>			<span class="n">step_rep_tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a>				<span class="n">step_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="o">=</span><span class="n">coord_tokenizer</span><span class="p">)</span>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a>				<span class="k">for</span> <span class="n">step_tokenizer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a>			<span class="p">]</span>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a>			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">intra</span><span class="p">:</span>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a>				<span class="n">step_rep_tokens_and_intra</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a>					<span class="nb">len</span><span class="p">(</span><span class="n">step_rep_tokens</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a>				<span class="p">)</span>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a>				<span class="n">step_rep_tokens_and_intra</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">step_rep_tokens</span>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a>				<span class="n">step_rep_tokens_and_intra</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_INTRA</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a>					<span class="n">step_rep_tokens</span><span class="p">,</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a>				<span class="p">)</span>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a>				<span class="n">step_rep_tokens</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="n">step_rep_tokens_and_intra</span><span class="p">))</span>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a>			<span class="n">all_tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a>				<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">((</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_PRE</span><span class="p">,),</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;pre&quot;</span><span class="p">),</span>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a>				<span class="o">*</span><span class="n">flatten</span><span class="p">(</span><span class="n">step_rep_tokens</span><span class="p">),</span>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a>				<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">((</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_POST</span><span class="p">,),</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;post&quot;</span><span class="p">),</span>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a>			<span class="p">]</span>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a>			<span class="k">return</span> <span class="n">all_tokens</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_leading_tokens</span><span class="p">(</span>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns tokens preceding those from the sequence from `_single_step_tokens`.</span>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a><span class="sd">			Since the for loop in `to_tokens` iterates `len(path)-1` times, a fencepost problem exists with `StepTokenizers.Coord`.</span>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a><span class="sd">			&lt;PATH_START&gt; should NOT be included.</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a>			<span class="k">if</span> <span class="n">StepTokenizers</span><span class="o">.</span><span class="n">Coord</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">:</span>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a>				<span class="k">return</span> <span class="p">[</span>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a>					<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">((</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_PRE</span><span class="p">,),</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;pre&quot;</span><span class="p">),</span>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a>					<span class="o">*</span><span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">...</span><span class="p">]),</span>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a>					<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">((</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_INTRA</span><span class="p">,),</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;intra&quot;</span><span class="p">),</span>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a>				<span class="p">]</span>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a>			<span class="k">return</span> <span class="p">[]</span>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_trailing_tokens</span><span class="p">(</span>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a>			<span class="n">c</span><span class="p">:</span> <span class="n">Coord</span><span class="p">,</span>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns tokens following those from the sequence from `_single_step_tokens`.</span>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a><span class="sd">			&lt;PATH_END&gt; should NOT be included.</span>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a>			<span class="k">return</span> <span class="p">[]</span>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a>		<span class="c1"># inherits docstring</span>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># noqa: D102</span>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a>			<span class="n">output</span><span class="p">:</span> <span class="nb">bool</span>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a>			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">):</span>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a>				<span class="c1"># Uninteresting: repeated elements are not useful</span>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a>				<span class="n">output</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a>			<span class="k">else</span><span class="p">:</span>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a>				<span class="c1"># we do noqa for the comment if false</span>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a>				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a>					<span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a>					<span class="n">StepTokenizers</span><span class="o">.</span><span class="n">Distance</span><span class="p">,</span>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a>				<span class="p">):</span>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a>					<span class="c1"># Untrainable: `Distance` alone cannot encode a path. &gt;=1 `StepTokenizer` which indicates direction/location is required.</span>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a>					<span class="n">output</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a>				<span class="k">else</span><span class="p">:</span>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a>					<span class="n">output</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a>			<span class="k">if</span> <span class="ow">not</span> <span class="n">output</span> <span class="ow">and</span> <span class="n">do_except</span><span class="p">:</span>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a>				<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a>					<span class="s2">&quot;PathTokenizer must contain at least one `StepTokenizer` which indicates direction/location, or it will be untrainable.&quot;</span><span class="p">,</span>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a>				<span class="p">)</span>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a>			<span class="k">return</span> <span class="n">output</span>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a><span class="k">class</span><span class="w"> </span><span class="nc">PromptSequencers</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Namespace for `_PromptSequencer` subclass hierarchy used by `MazeTokenizerModular`.&quot;&quot;&quot;</span>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a>	<span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;prompt_sequencer&quot;</span>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos">1058</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">_PromptSequencer</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos">1059</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Sequences token regions into a complete maze tokenization.</span>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos">1060</span></a>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos">1061</span></a><span class="sd">		# Parameters</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos">1062</span></a><span class="sd">		- `coord_tokenizer`: Tokenizer element which tokenizes a single `Coord` aka maze position.</span>
</span><span id="L-1063"><a href="#L-1063"><span class="linenos">1063</span></a><span class="sd">		- `adj_list_tokenizer`: Tokenizer element which tokenizes the adjacency list of a `LatticeMaze`.</span>
</span><span id="L-1064"><a href="#L-1064"><span class="linenos">1064</span></a><span class="sd">		Uses `coord_tokenizer` to tokenize coords if needed in other `TokenizerElement`s.</span>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos">1065</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos">1066</span></a>
</span><span id="L-1067"><a href="#L-1067"><span class="linenos">1067</span></a>		<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos">1068</span></a>			<span class="n">default</span><span class="o">=</span><span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">UT</span><span class="p">(),</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos">1069</span></a>			<span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">CoordTokenizers</span><span class="p">),</span>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos">1070</span></a>		<span class="p">)</span>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos">1071</span></a>		<span class="n">adj_list_tokenizer</span><span class="p">:</span> <span class="n">AdjListTokenizers</span><span class="o">.</span><span class="n">_AdjListTokenizer</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos">1072</span></a>			<span class="n">default</span><span class="o">=</span><span class="n">AdjListTokenizers</span><span class="o">.</span><span class="n">AdjListCoord</span><span class="p">(),</span>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos">1073</span></a>			<span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">AdjListTokenizers</span><span class="p">),</span>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos">1074</span></a>		<span class="p">)</span>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos">1075</span></a>
</span><span id="L-1076"><a href="#L-1076"><span class="linenos">1076</span></a>		<span class="nd">@classmethod</span>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos">1077</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos">1078</span></a>			<span class="k">return</span> <span class="n">PromptSequencers</span><span class="o">.</span><span class="n">key</span>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos">1079</span></a>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos">1080</span></a>		<span class="nd">@staticmethod</span>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos">1081</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_trim_if_unsolved_maze</span><span class="p">(</span>
</span><span id="L-1082"><a href="#L-1082"><span class="linenos">1082</span></a>			<span class="n">untrimmed</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos">1083</span></a>			<span class="n">is_untargeted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos">1084</span></a>			<span class="n">is_unsolved</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos">1085</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos">1086</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Trims a full `SolvedMaze` prompt if the maze data reflects an unsolved or untargeted maze.</span>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos">1087</span></a>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos">1088</span></a><span class="sd">			# Development</span>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos">1089</span></a><span class="sd">			This implementation should function for `AOTP`, `AOP`, and other concrete classes using any subsequence of AOTP.</span>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos">1090</span></a><span class="sd">			It is not located in `token_utils.py` because it may need to be overridden in more exotic `PromptSequencer` subclasses.</span>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos">1091</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="L-1092"><a href="#L-1092"><span class="linenos">1092</span></a>			<span class="k">if</span> <span class="n">is_untargeted</span><span class="p">:</span>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos">1093</span></a>				<span class="k">return</span> <span class="n">tokens_between</span><span class="p">(</span>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos">1094</span></a>					<span class="n">untrimmed</span><span class="p">,</span>
</span><span id="L-1095"><a href="#L-1095"><span class="linenos">1095</span></a>					<span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_START</span><span class="p">,</span>
</span><span id="L-1096"><a href="#L-1096"><span class="linenos">1096</span></a>					<span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_END</span><span class="p">,</span>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos">1097</span></a>					<span class="n">include_start</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos">1098</span></a>					<span class="n">include_end</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-1099"><a href="#L-1099"><span class="linenos">1099</span></a>				<span class="p">)</span>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos">1100</span></a>			<span class="k">if</span> <span class="n">is_unsolved</span><span class="p">:</span>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos">1101</span></a>				<span class="k">if</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_END</span> <span class="ow">in</span> <span class="n">untrimmed</span><span class="p">:</span>
</span><span id="L-1102"><a href="#L-1102"><span class="linenos">1102</span></a>					<span class="k">return</span> <span class="n">tokens_between</span><span class="p">(</span>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos">1103</span></a>						<span class="n">untrimmed</span><span class="p">,</span>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos">1104</span></a>						<span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_START</span><span class="p">,</span>
</span><span id="L-1105"><a href="#L-1105"><span class="linenos">1105</span></a>						<span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_END</span><span class="p">,</span>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos">1106</span></a>						<span class="n">include_start</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos">1107</span></a>						<span class="n">include_end</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-1108"><a href="#L-1108"><span class="linenos">1108</span></a>					<span class="p">)</span>
</span><span id="L-1109"><a href="#L-1109"><span class="linenos">1109</span></a>				<span class="k">else</span><span class="p">:</span>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos">1110</span></a>					<span class="k">return</span> <span class="n">tokens_between</span><span class="p">(</span>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos">1111</span></a>						<span class="n">untrimmed</span><span class="p">,</span>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos">1112</span></a>						<span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_START</span><span class="p">,</span>
</span><span id="L-1113"><a href="#L-1113"><span class="linenos">1113</span></a>						<span class="n">VOCAB</span><span class="o">.</span><span class="n">ORIGIN_END</span><span class="p">,</span>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos">1114</span></a>						<span class="n">include_start</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-1115"><a href="#L-1115"><span class="linenos">1115</span></a>						<span class="n">include_end</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-1116"><a href="#L-1116"><span class="linenos">1116</span></a>					<span class="p">)</span>
</span><span id="L-1117"><a href="#L-1117"><span class="linenos">1117</span></a>			<span class="k">return</span> <span class="n">untrimmed</span>
</span><span id="L-1118"><a href="#L-1118"><span class="linenos">1118</span></a>
</span><span id="L-1119"><a href="#L-1119"><span class="linenos">1119</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="L-1120"><a href="#L-1120"><span class="linenos">1120</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="L-1121"><a href="#L-1121"><span class="linenos">1121</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">,</span>
</span><span id="L-1122"><a href="#L-1122"><span class="linenos">1122</span></a>			<span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="L-1123"><a href="#L-1123"><span class="linenos">1123</span></a>			<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-1124"><a href="#L-1124"><span class="linenos">1124</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-1125"><a href="#L-1125"><span class="linenos">1125</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns a complete list of tokens for a given set of maze elements.&quot;&quot;&quot;</span>
</span><span id="L-1126"><a href="#L-1126"><span class="linenos">1126</span></a>			<span class="n">untrimmed</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sequence_tokens</span><span class="p">(</span>
</span><span id="L-1127"><a href="#L-1127"><span class="linenos">1127</span></a>				<span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_prompt_regions</span><span class="p">(</span><span class="n">maze</span><span class="p">),</span>
</span><span id="L-1128"><a href="#L-1128"><span class="linenos">1128</span></a>			<span class="p">)</span>
</span><span id="L-1129"><a href="#L-1129"><span class="linenos">1129</span></a>			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trim_if_unsolved_maze</span><span class="p">(</span>
</span><span id="L-1130"><a href="#L-1130"><span class="linenos">1130</span></a>				<span class="n">untrimmed</span><span class="p">,</span>
</span><span id="L-1131"><a href="#L-1131"><span class="linenos">1131</span></a>				<span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="s2">&quot;start_pos&quot;</span><span class="p">),</span>
</span><span id="L-1132"><a href="#L-1132"><span class="linenos">1132</span></a>				<span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="s2">&quot;solution&quot;</span><span class="p">),</span>
</span><span id="L-1133"><a href="#L-1133"><span class="linenos">1133</span></a>			<span class="p">)</span>
</span><span id="L-1134"><a href="#L-1134"><span class="linenos">1134</span></a>
</span><span id="L-1135"><a href="#L-1135"><span class="linenos">1135</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_get_prompt_regions</span><span class="p">(</span>
</span><span id="L-1136"><a href="#L-1136"><span class="linenos">1136</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="L-1137"><a href="#L-1137"><span class="linenos">1137</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">,</span>
</span><span id="L-1138"><a href="#L-1138"><span class="linenos">1138</span></a>			<span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="L-1139"><a href="#L-1139"><span class="linenos">1139</span></a>			<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-1140"><a href="#L-1140"><span class="linenos">1140</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="L-1141"><a href="#L-1141"><span class="linenos">1141</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Gets the prompt regions of a maze in a fixed sequence.</span>
</span><span id="L-1142"><a href="#L-1142"><span class="linenos">1142</span></a>
</span><span id="L-1143"><a href="#L-1143"><span class="linenos">1143</span></a><span class="sd">			This method is NOT responsible for including/excluding any prompt regions.</span>
</span><span id="L-1144"><a href="#L-1144"><span class="linenos">1144</span></a><span class="sd">			Always return according to the API described under Returns.</span>
</span><span id="L-1145"><a href="#L-1145"><span class="linenos">1145</span></a><span class="sd">			This implementation is expected to be suitable for most `PromptSequencer` subclasses.</span>
</span><span id="L-1146"><a href="#L-1146"><span class="linenos">1146</span></a><span class="sd">			Subclasses may override this method if needed for special behavior.</span>
</span><span id="L-1147"><a href="#L-1147"><span class="linenos">1147</span></a>
</span><span id="L-1148"><a href="#L-1148"><span class="linenos">1148</span></a><span class="sd">			# Returns</span>
</span><span id="L-1149"><a href="#L-1149"><span class="linenos">1149</span></a><span class="sd">			- [0]: list[str] Adjacency list tokens</span>
</span><span id="L-1150"><a href="#L-1150"><span class="linenos">1150</span></a><span class="sd">			- [1]: list[str] Origin tokens</span>
</span><span id="L-1151"><a href="#L-1151"><span class="linenos">1151</span></a><span class="sd">			- [2]: list[str] Target tokens</span>
</span><span id="L-1152"><a href="#L-1152"><span class="linenos">1152</span></a><span class="sd">			- [3]: list[str] Path tokens</span>
</span><span id="L-1153"><a href="#L-1153"><span class="linenos">1153</span></a>
</span><span id="L-1154"><a href="#L-1154"><span class="linenos">1154</span></a><span class="sd">			# `None`-valued Args</span>
</span><span id="L-1155"><a href="#L-1155"><span class="linenos">1155</span></a><span class="sd">			If one or more of `origin`, `target`, or `path` are `None`, that indicates that an unsolved or untargeted maze is being tokenized.</span>
</span><span id="L-1156"><a href="#L-1156"><span class="linenos">1156</span></a><span class="sd">			To ensure unpackability in `_sequence_tokens`, these `None` values are substituted for empty iterables.</span>
</span><span id="L-1157"><a href="#L-1157"><span class="linenos">1157</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="L-1158"><a href="#L-1158"><span class="linenos">1158</span></a>			<span class="n">origin</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="s2">&quot;start_pos&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-1159"><a href="#L-1159"><span class="linenos">1159</span></a>			<span class="n">target</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Coord</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-1160"><a href="#L-1160"><span class="linenos">1160</span></a>				<span class="nb">getattr</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="s2">&quot;end_pos&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="L-1161"><a href="#L-1161"><span class="linenos">1161</span></a>			<span class="p">]</span>  <span class="c1"># TargetTokenizer requires target: Sequence[Coord]</span>
</span><span id="L-1162"><a href="#L-1162"><span class="linenos">1162</span></a>
</span><span id="L-1163"><a href="#L-1163"><span class="linenos">1163</span></a>			<span class="k">return</span> <span class="p">[</span>
</span><span id="L-1164"><a href="#L-1164"><span class="linenos">1164</span></a>				<span class="p">(</span>
</span><span id="L-1165"><a href="#L-1165"><span class="linenos">1165</span></a>					<span class="bp">self</span><span class="o">.</span><span class="n">adj_list_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span>
</span><span id="L-1166"><a href="#L-1166"><span class="linenos">1166</span></a>						<span class="n">maze</span><span class="p">,</span>
</span><span id="L-1167"><a href="#L-1167"><span class="linenos">1167</span></a>						<span class="n">coord_tokenizer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">coord_tokenizer</span><span class="p">,</span>
</span><span id="L-1168"><a href="#L-1168"><span class="linenos">1168</span></a>					<span class="p">)</span>
</span><span id="L-1169"><a href="#L-1169"><span class="linenos">1169</span></a>					<span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;adj_list_tokenizer&quot;</span><span class="p">)</span>
</span><span id="L-1170"><a href="#L-1170"><span class="linenos">1170</span></a>					<span class="k">else</span> <span class="p">[]</span>
</span><span id="L-1171"><a href="#L-1171"><span class="linenos">1171</span></a>				<span class="p">),</span>
</span><span id="L-1172"><a href="#L-1172"><span class="linenos">1172</span></a>				<span class="bp">self</span><span class="o">.</span><span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">origin</span><span class="p">)</span> <span class="k">if</span> <span class="n">origin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[],</span>
</span><span id="L-1173"><a href="#L-1173"><span class="linenos">1173</span></a>				<span class="p">(</span>
</span><span id="L-1174"><a href="#L-1174"><span class="linenos">1174</span></a>					<span class="bp">self</span><span class="o">.</span><span class="n">target_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span>
</span><span id="L-1175"><a href="#L-1175"><span class="linenos">1175</span></a>						<span class="n">target</span><span class="p">,</span>
</span><span id="L-1176"><a href="#L-1176"><span class="linenos">1176</span></a>						<span class="n">coord_tokenizer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">coord_tokenizer</span><span class="p">,</span>
</span><span id="L-1177"><a href="#L-1177"><span class="linenos">1177</span></a>					<span class="p">)</span>
</span><span id="L-1178"><a href="#L-1178"><span class="linenos">1178</span></a>					<span class="k">if</span> <span class="n">target</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;target_tokenizer&quot;</span><span class="p">)</span>
</span><span id="L-1179"><a href="#L-1179"><span class="linenos">1179</span></a>					<span class="k">else</span> <span class="p">[]</span>
</span><span id="L-1180"><a href="#L-1180"><span class="linenos">1180</span></a>				<span class="p">),</span>
</span><span id="L-1181"><a href="#L-1181"><span class="linenos">1181</span></a>				<span class="p">(</span>
</span><span id="L-1182"><a href="#L-1182"><span class="linenos">1182</span></a>					<span class="bp">self</span><span class="o">.</span><span class="n">path_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span>
</span><span id="L-1183"><a href="#L-1183"><span class="linenos">1183</span></a>						<span class="n">maze</span><span class="p">,</span>
</span><span id="L-1184"><a href="#L-1184"><span class="linenos">1184</span></a>						<span class="n">coord_tokenizer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">coord_tokenizer</span><span class="p">,</span>
</span><span id="L-1185"><a href="#L-1185"><span class="linenos">1185</span></a>					<span class="p">)</span>
</span><span id="L-1186"><a href="#L-1186"><span class="linenos">1186</span></a>					<span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="s2">&quot;solution&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;path_tokenizer&quot;</span><span class="p">)</span>
</span><span id="L-1187"><a href="#L-1187"><span class="linenos">1187</span></a>					<span class="k">else</span> <span class="p">[]</span>
</span><span id="L-1188"><a href="#L-1188"><span class="linenos">1188</span></a>				<span class="p">),</span>
</span><span id="L-1189"><a href="#L-1189"><span class="linenos">1189</span></a>			<span class="p">]</span>
</span><span id="L-1190"><a href="#L-1190"><span class="linenos">1190</span></a>
</span><span id="L-1191"><a href="#L-1191"><span class="linenos">1191</span></a>		<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="L-1192"><a href="#L-1192"><span class="linenos">1192</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_sequence_tokens</span><span class="p">(</span>
</span><span id="L-1193"><a href="#L-1193"><span class="linenos">1193</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="L-1194"><a href="#L-1194"><span class="linenos">1194</span></a>			<span class="n">adj_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-1195"><a href="#L-1195"><span class="linenos">1195</span></a>			<span class="n">origin</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1196"><a href="#L-1196"><span class="linenos">1196</span></a>			<span class="n">target</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1197"><a href="#L-1197"><span class="linenos">1197</span></a>			<span class="n">path</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1198"><a href="#L-1198"><span class="linenos">1198</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-1199"><a href="#L-1199"><span class="linenos">1199</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Sequences token regions into a complete prompt.</span>
</span><span id="L-1200"><a href="#L-1200"><span class="linenos">1200</span></a>
</span><span id="L-1201"><a href="#L-1201"><span class="linenos">1201</span></a><span class="sd">			Includes any boundary tokens in `constants.SPECIAL_TOKENS` such as &lt;ADJLIST_START&gt;, &lt;ORIGIN_END&gt;, etc.</span>
</span><span id="L-1202"><a href="#L-1202"><span class="linenos">1202</span></a>
</span><span id="L-1203"><a href="#L-1203"><span class="linenos">1203</span></a><span class="sd">			# Parameters</span>
</span><span id="L-1204"><a href="#L-1204"><span class="linenos">1204</span></a><span class="sd">			- `adj_list`: Tokens representing the adjacency list</span>
</span><span id="L-1205"><a href="#L-1205"><span class="linenos">1205</span></a><span class="sd">			- `origin`: Tokens representing the origin</span>
</span><span id="L-1206"><a href="#L-1206"><span class="linenos">1206</span></a><span class="sd">			- `target`: Tokens representing the target</span>
</span><span id="L-1207"><a href="#L-1207"><span class="linenos">1207</span></a><span class="sd">			- `path`: Tokens representing the path</span>
</span><span id="L-1208"><a href="#L-1208"><span class="linenos">1208</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="L-1209"><a href="#L-1209"><span class="linenos">1209</span></a>			<span class="k">pass</span>
</span><span id="L-1210"><a href="#L-1210"><span class="linenos">1210</span></a>
</span><span id="L-1211"><a href="#L-1211"><span class="linenos">1211</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1212"><a href="#L-1212"><span class="linenos">1212</span></a>			<span class="c1"># No invalid instances possible within data member type hint bounds</span>
</span><span id="L-1213"><a href="#L-1213"><span class="linenos">1213</span></a>			<span class="k">return</span> <span class="kc">True</span>
</span><span id="L-1214"><a href="#L-1214"><span class="linenos">1214</span></a>
</span><span id="L-1215"><a href="#L-1215"><span class="linenos">1215</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1216"><a href="#L-1216"><span class="linenos">1216</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">AOTP</span><span class="p">(</span><span class="n">_PromptSequencer</span><span class="p">):</span>
</span><span id="L-1217"><a href="#L-1217"><span class="linenos">1217</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Sequences a prompt as [adjacency list, origin, target, path].</span>
</span><span id="L-1218"><a href="#L-1218"><span class="linenos">1218</span></a>
</span><span id="L-1219"><a href="#L-1219"><span class="linenos">1219</span></a><span class="sd">		# Parameters</span>
</span><span id="L-1220"><a href="#L-1220"><span class="linenos">1220</span></a><span class="sd">		- `target_tokenizer`: Tokenizer element which tokenizes the target(s) of a `TargetedLatticeMaze`.</span>
</span><span id="L-1221"><a href="#L-1221"><span class="linenos">1221</span></a><span class="sd">		Uses `coord_tokenizer` to tokenize coords if that is part of the design of that `TargetTokenizer`.</span>
</span><span id="L-1222"><a href="#L-1222"><span class="linenos">1222</span></a><span class="sd">		- `path_tokenizer`: Tokenizer element which tokenizes the solution path of a `SolvedMaze`.</span>
</span><span id="L-1223"><a href="#L-1223"><span class="linenos">1223</span></a><span class="sd">		Uses `coord_tokenizer` to tokenize coords if that is part of the design of that `PathTokenizer`.</span>
</span><span id="L-1224"><a href="#L-1224"><span class="linenos">1224</span></a>
</span><span id="L-1225"><a href="#L-1225"><span class="linenos">1225</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-1226"><a href="#L-1226"><span class="linenos">1226</span></a>
</span><span id="L-1227"><a href="#L-1227"><span class="linenos">1227</span></a>		<span class="n">target_tokenizer</span><span class="p">:</span> <span class="n">TargetTokenizers</span><span class="o">.</span><span class="n">_TargetTokenizer</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="L-1228"><a href="#L-1228"><span class="linenos">1228</span></a>			<span class="n">default</span><span class="o">=</span><span class="n">TargetTokenizers</span><span class="o">.</span><span class="n">Unlabeled</span><span class="p">(),</span>
</span><span id="L-1229"><a href="#L-1229"><span class="linenos">1229</span></a>			<span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">TargetTokenizers</span><span class="p">),</span>
</span><span id="L-1230"><a href="#L-1230"><span class="linenos">1230</span></a>		<span class="p">)</span>
</span><span id="L-1231"><a href="#L-1231"><span class="linenos">1231</span></a>		<span class="n">path_tokenizer</span><span class="p">:</span> <span class="n">PathTokenizers</span><span class="o">.</span><span class="n">_PathTokenizer</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="L-1232"><a href="#L-1232"><span class="linenos">1232</span></a>			<span class="n">default</span><span class="o">=</span><span class="n">PathTokenizers</span><span class="o">.</span><span class="n">StepSequence</span><span class="p">(),</span>
</span><span id="L-1233"><a href="#L-1233"><span class="linenos">1233</span></a>			<span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">PathTokenizers</span><span class="p">),</span>
</span><span id="L-1234"><a href="#L-1234"><span class="linenos">1234</span></a>		<span class="p">)</span>
</span><span id="L-1235"><a href="#L-1235"><span class="linenos">1235</span></a>
</span><span id="L-1236"><a href="#L-1236"><span class="linenos">1236</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_sequence_tokens</span><span class="p">(</span>
</span><span id="L-1237"><a href="#L-1237"><span class="linenos">1237</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="L-1238"><a href="#L-1238"><span class="linenos">1238</span></a>			<span class="n">adj_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-1239"><a href="#L-1239"><span class="linenos">1239</span></a>			<span class="n">origin</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-1240"><a href="#L-1240"><span class="linenos">1240</span></a>			<span class="n">target</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-1241"><a href="#L-1241"><span class="linenos">1241</span></a>			<span class="n">path</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-1242"><a href="#L-1242"><span class="linenos">1242</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-1243"><a href="#L-1243"><span class="linenos">1243</span></a>			<span class="k">return</span> <span class="p">[</span>
</span><span id="L-1244"><a href="#L-1244"><span class="linenos">1244</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_START</span><span class="p">,</span>
</span><span id="L-1245"><a href="#L-1245"><span class="linenos">1245</span></a>				<span class="o">*</span><span class="n">adj_list</span><span class="p">,</span>
</span><span id="L-1246"><a href="#L-1246"><span class="linenos">1246</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_END</span><span class="p">,</span>
</span><span id="L-1247"><a href="#L-1247"><span class="linenos">1247</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">ORIGIN_START</span><span class="p">,</span>
</span><span id="L-1248"><a href="#L-1248"><span class="linenos">1248</span></a>				<span class="o">*</span><span class="n">origin</span><span class="p">,</span>
</span><span id="L-1249"><a href="#L-1249"><span class="linenos">1249</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">ORIGIN_END</span><span class="p">,</span>
</span><span id="L-1250"><a href="#L-1250"><span class="linenos">1250</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_START</span><span class="p">,</span>
</span><span id="L-1251"><a href="#L-1251"><span class="linenos">1251</span></a>				<span class="o">*</span><span class="n">target</span><span class="p">,</span>
</span><span id="L-1252"><a href="#L-1252"><span class="linenos">1252</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_END</span><span class="p">,</span>
</span><span id="L-1253"><a href="#L-1253"><span class="linenos">1253</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_START</span><span class="p">,</span>
</span><span id="L-1254"><a href="#L-1254"><span class="linenos">1254</span></a>				<span class="o">*</span><span class="n">path</span><span class="p">,</span>
</span><span id="L-1255"><a href="#L-1255"><span class="linenos">1255</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_END</span><span class="p">,</span>
</span><span id="L-1256"><a href="#L-1256"><span class="linenos">1256</span></a>			<span class="p">]</span>
</span><span id="L-1257"><a href="#L-1257"><span class="linenos">1257</span></a>
</span><span id="L-1258"><a href="#L-1258"><span class="linenos">1258</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1259"><a href="#L-1259"><span class="linenos">1259</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">AOP</span><span class="p">(</span><span class="n">_PromptSequencer</span><span class="p">):</span>
</span><span id="L-1260"><a href="#L-1260"><span class="linenos">1260</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Sequences a prompt as [adjacency list, origin, path].</span>
</span><span id="L-1261"><a href="#L-1261"><span class="linenos">1261</span></a>
</span><span id="L-1262"><a href="#L-1262"><span class="linenos">1262</span></a><span class="sd">		Still includes &quot;&lt;TARGET_START&gt;&quot; and &quot;&lt;TARGET_END&gt;&quot; tokens, but no representation of the target itself.</span>
</span><span id="L-1263"><a href="#L-1263"><span class="linenos">1263</span></a>
</span><span id="L-1264"><a href="#L-1264"><span class="linenos">1264</span></a><span class="sd">		# Parameters</span>
</span><span id="L-1265"><a href="#L-1265"><span class="linenos">1265</span></a><span class="sd">		- `path_tokenizer`: Tokenizer element which tokenizes the solution path of a `SolvedMaze`.</span>
</span><span id="L-1266"><a href="#L-1266"><span class="linenos">1266</span></a><span class="sd">		Uses `coord_tokenizer` to tokenize coords if that is part of the design of that `PathTokenizer`.</span>
</span><span id="L-1267"><a href="#L-1267"><span class="linenos">1267</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-1268"><a href="#L-1268"><span class="linenos">1268</span></a>
</span><span id="L-1269"><a href="#L-1269"><span class="linenos">1269</span></a>		<span class="n">path_tokenizer</span><span class="p">:</span> <span class="n">PathTokenizers</span><span class="o">.</span><span class="n">_PathTokenizer</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="L-1270"><a href="#L-1270"><span class="linenos">1270</span></a>			<span class="n">default</span><span class="o">=</span><span class="n">PathTokenizers</span><span class="o">.</span><span class="n">StepSequence</span><span class="p">(),</span>
</span><span id="L-1271"><a href="#L-1271"><span class="linenos">1271</span></a>			<span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">PathTokenizers</span><span class="p">),</span>
</span><span id="L-1272"><a href="#L-1272"><span class="linenos">1272</span></a>		<span class="p">)</span>
</span><span id="L-1273"><a href="#L-1273"><span class="linenos">1273</span></a>
</span><span id="L-1274"><a href="#L-1274"><span class="linenos">1274</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_sequence_tokens</span><span class="p">(</span>
</span><span id="L-1275"><a href="#L-1275"><span class="linenos">1275</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="L-1276"><a href="#L-1276"><span class="linenos">1276</span></a>			<span class="n">adj_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-1277"><a href="#L-1277"><span class="linenos">1277</span></a>			<span class="n">origin</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-1278"><a href="#L-1278"><span class="linenos">1278</span></a>			<span class="c1"># explicitly no target in this tokenizer</span>
</span><span id="L-1279"><a href="#L-1279"><span class="linenos">1279</span></a>			<span class="n">target</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-1280"><a href="#L-1280"><span class="linenos">1280</span></a>			<span class="n">path</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-1281"><a href="#L-1281"><span class="linenos">1281</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-1282"><a href="#L-1282"><span class="linenos">1282</span></a>			<span class="k">return</span> <span class="p">[</span>
</span><span id="L-1283"><a href="#L-1283"><span class="linenos">1283</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_START</span><span class="p">,</span>
</span><span id="L-1284"><a href="#L-1284"><span class="linenos">1284</span></a>				<span class="o">*</span><span class="n">adj_list</span><span class="p">,</span>
</span><span id="L-1285"><a href="#L-1285"><span class="linenos">1285</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_END</span><span class="p">,</span>
</span><span id="L-1286"><a href="#L-1286"><span class="linenos">1286</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">ORIGIN_START</span><span class="p">,</span>
</span><span id="L-1287"><a href="#L-1287"><span class="linenos">1287</span></a>				<span class="o">*</span><span class="n">origin</span><span class="p">,</span>
</span><span id="L-1288"><a href="#L-1288"><span class="linenos">1288</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">ORIGIN_END</span><span class="p">,</span>
</span><span id="L-1289"><a href="#L-1289"><span class="linenos">1289</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_START</span><span class="p">,</span>
</span><span id="L-1290"><a href="#L-1290"><span class="linenos">1290</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_END</span><span class="p">,</span>
</span><span id="L-1291"><a href="#L-1291"><span class="linenos">1291</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_START</span><span class="p">,</span>
</span><span id="L-1292"><a href="#L-1292"><span class="linenos">1292</span></a>				<span class="o">*</span><span class="n">path</span><span class="p">,</span>
</span><span id="L-1293"><a href="#L-1293"><span class="linenos">1293</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_END</span><span class="p">,</span>
</span><span id="L-1294"><a href="#L-1294"><span class="linenos">1294</span></a>			<span class="p">]</span>
</span></pre></div>


                <br/>
            </section>
                <section id="CoordTokenizers">
                            <input id="CoordTokenizers-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">CoordTokenizers</span><wbr>(<span class="base"><a href="element_base.html#__TokenizerElementNamespace">maze_dataset.tokenization.modular.element_base.__TokenizerElementNamespace</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="CoordTokenizers-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L47-L99" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#CoordTokenizers"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoordTokenizers-48"><a href="#CoordTokenizers-48"><span class="linenos"> 48</span></a><span class="k">class</span><span class="w"> </span><span class="nc">CoordTokenizers</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="CoordTokenizers-49"><a href="#CoordTokenizers-49"><span class="linenos"> 49</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Namespace for `_CoordTokenizer` subclass hierarchy used by `MazeTokenizerModular`.&quot;&quot;&quot;</span>
</span><span id="CoordTokenizers-50"><a href="#CoordTokenizers-50"><span class="linenos"> 50</span></a>
</span><span id="CoordTokenizers-51"><a href="#CoordTokenizers-51"><span class="linenos"> 51</span></a>	<span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;coord_tokenizer&quot;</span>
</span><span id="CoordTokenizers-52"><a href="#CoordTokenizers-52"><span class="linenos"> 52</span></a>
</span><span id="CoordTokenizers-53"><a href="#CoordTokenizers-53"><span class="linenos"> 53</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="CoordTokenizers-54"><a href="#CoordTokenizers-54"><span class="linenos"> 54</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">_CoordTokenizer</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="CoordTokenizers-55"><a href="#CoordTokenizers-55"><span class="linenos"> 55</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Superclass for classes which tokenize singular coords in a maze.&quot;&quot;&quot;</span>
</span><span id="CoordTokenizers-56"><a href="#CoordTokenizers-56"><span class="linenos"> 56</span></a>
</span><span id="CoordTokenizers-57"><a href="#CoordTokenizers-57"><span class="linenos"> 57</span></a>		<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="CoordTokenizers-58"><a href="#CoordTokenizers-58"><span class="linenos"> 58</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="CoordTokenizers-59"><a href="#CoordTokenizers-59"><span class="linenos"> 59</span></a>			<span class="k">pass</span>
</span><span id="CoordTokenizers-60"><a href="#CoordTokenizers-60"><span class="linenos"> 60</span></a>
</span><span id="CoordTokenizers-61"><a href="#CoordTokenizers-61"><span class="linenos"> 61</span></a>		<span class="nd">@classmethod</span>
</span><span id="CoordTokenizers-62"><a href="#CoordTokenizers-62"><span class="linenos"> 62</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="CoordTokenizers-63"><a href="#CoordTokenizers-63"><span class="linenos"> 63</span></a>			<span class="k">return</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">key</span>
</span><span id="CoordTokenizers-64"><a href="#CoordTokenizers-64"><span class="linenos"> 64</span></a>
</span><span id="CoordTokenizers-65"><a href="#CoordTokenizers-65"><span class="linenos"> 65</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="CoordTokenizers-66"><a href="#CoordTokenizers-66"><span class="linenos"> 66</span></a>			<span class="c1"># No invalid instances possible within data member type hint bounds</span>
</span><span id="CoordTokenizers-67"><a href="#CoordTokenizers-67"><span class="linenos"> 67</span></a>			<span class="k">return</span> <span class="kc">True</span>
</span><span id="CoordTokenizers-68"><a href="#CoordTokenizers-68"><span class="linenos"> 68</span></a>
</span><span id="CoordTokenizers-69"><a href="#CoordTokenizers-69"><span class="linenos"> 69</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="CoordTokenizers-70"><a href="#CoordTokenizers-70"><span class="linenos"> 70</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">UT</span><span class="p">(</span><span class="n">_CoordTokenizer</span><span class="p">):</span>
</span><span id="CoordTokenizers-71"><a href="#CoordTokenizers-71"><span class="linenos"> 71</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Unique token coordinate tokenizer.&quot;&quot;&quot;</span>
</span><span id="CoordTokenizers-72"><a href="#CoordTokenizers-72"><span class="linenos"> 72</span></a>
</span><span id="CoordTokenizers-73"><a href="#CoordTokenizers-73"><span class="linenos"> 73</span></a>		<span class="c1"># inherit docstring</span>
</span><span id="CoordTokenizers-74"><a href="#CoordTokenizers-74"><span class="linenos"> 74</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>  <span class="c1"># noqa: D102</span>
</span><span id="CoordTokenizers-75"><a href="#CoordTokenizers-75"><span class="linenos"> 75</span></a>			<span class="k">return</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="s2">&quot;)&quot;</span><span class="p">])]</span>
</span><span id="CoordTokenizers-76"><a href="#CoordTokenizers-76"><span class="linenos"> 76</span></a>
</span><span id="CoordTokenizers-77"><a href="#CoordTokenizers-77"><span class="linenos"> 77</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="CoordTokenizers-78"><a href="#CoordTokenizers-78"><span class="linenos"> 78</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">CTT</span><span class="p">(</span><span class="n">_CoordTokenizer</span><span class="p">):</span>
</span><span id="CoordTokenizers-79"><a href="#CoordTokenizers-79"><span class="linenos"> 79</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Coordinate tuple tokenizer</span>
</span><span id="CoordTokenizers-80"><a href="#CoordTokenizers-80"><span class="linenos"> 80</span></a>
</span><span id="CoordTokenizers-81"><a href="#CoordTokenizers-81"><span class="linenos"> 81</span></a><span class="sd">		# Parameters</span>
</span><span id="CoordTokenizers-82"><a href="#CoordTokenizers-82"><span class="linenos"> 82</span></a><span class="sd">		- `pre`: Whether all coords include an integral preceding delimiter token</span>
</span><span id="CoordTokenizers-83"><a href="#CoordTokenizers-83"><span class="linenos"> 83</span></a><span class="sd">		- `intra`: Whether all coords include a delimiter token between coordinates</span>
</span><span id="CoordTokenizers-84"><a href="#CoordTokenizers-84"><span class="linenos"> 84</span></a><span class="sd">		- `post`: Whether all coords include an integral following delimiter token</span>
</span><span id="CoordTokenizers-85"><a href="#CoordTokenizers-85"><span class="linenos"> 85</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="CoordTokenizers-86"><a href="#CoordTokenizers-86"><span class="linenos"> 86</span></a>
</span><span id="CoordTokenizers-87"><a href="#CoordTokenizers-87"><span class="linenos"> 87</span></a>		<span class="n">pre</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="CoordTokenizers-88"><a href="#CoordTokenizers-88"><span class="linenos"> 88</span></a>		<span class="n">intra</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="CoordTokenizers-89"><a href="#CoordTokenizers-89"><span class="linenos"> 89</span></a>		<span class="n">post</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="CoordTokenizers-90"><a href="#CoordTokenizers-90"><span class="linenos"> 90</span></a>		<span class="c1"># Implement methods</span>
</span><span id="CoordTokenizers-91"><a href="#CoordTokenizers-91"><span class="linenos"> 91</span></a>
</span><span id="CoordTokenizers-92"><a href="#CoordTokenizers-92"><span class="linenos"> 92</span></a>		<span class="c1"># inherit docstring</span>
</span><span id="CoordTokenizers-93"><a href="#CoordTokenizers-93"><span class="linenos"> 93</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>  <span class="c1"># noqa: D102</span>
</span><span id="CoordTokenizers-94"><a href="#CoordTokenizers-94"><span class="linenos"> 94</span></a>			<span class="k">return</span> <span class="p">[</span>
</span><span id="CoordTokenizers-95"><a href="#CoordTokenizers-95"><span class="linenos"> 95</span></a>				<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">([</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">COORD_PRE</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;pre&quot;</span><span class="p">),</span>
</span><span id="CoordTokenizers-96"><a href="#CoordTokenizers-96"><span class="linenos"> 96</span></a>				<span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
</span><span id="CoordTokenizers-97"><a href="#CoordTokenizers-97"><span class="linenos"> 97</span></a>				<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">([</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">COORD_INTRA</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;intra&quot;</span><span class="p">),</span>
</span><span id="CoordTokenizers-98"><a href="#CoordTokenizers-98"><span class="linenos"> 98</span></a>				<span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
</span><span id="CoordTokenizers-99"><a href="#CoordTokenizers-99"><span class="linenos"> 99</span></a>				<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">([</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">COORD_POST</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;post&quot;</span><span class="p">),</span>
</span><span id="CoordTokenizers-100"><a href="#CoordTokenizers-100"><span class="linenos">100</span></a>			<span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Namespace for <code>_CoordTokenizer</code> subclass hierarchy used by <code>MazeTokenizerModular</code>.</p>
</div>


                            <div id="CoordTokenizers.key" class="classattr">
                                <div class="attr variable">
            <span class="name">key</span>        =
<span class="default_value">&#39;coord_tokenizer&#39;</span>

        
    </div>
    <a class="headerlink" href="#CoordTokenizers.key"></a>
    
    

                            </div>
                </section>
                <section id="CoordTokenizers.UT">
                            <input id="CoordTokenizers.UT-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">CoordTokenizers.UT</span><wbr>(<span class="base"><a href="#CoordTokenizers._CoordTokenizer">CoordTokenizers._CoordTokenizer</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="CoordTokenizers.UT-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L68-L74" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#CoordTokenizers.UT"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoordTokenizers.UT-69"><a href="#CoordTokenizers.UT-69"><span class="linenos">69</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="CoordTokenizers.UT-70"><a href="#CoordTokenizers.UT-70"><span class="linenos">70</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">UT</span><span class="p">(</span><span class="n">_CoordTokenizer</span><span class="p">):</span>
</span><span id="CoordTokenizers.UT-71"><a href="#CoordTokenizers.UT-71"><span class="linenos">71</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Unique token coordinate tokenizer.&quot;&quot;&quot;</span>
</span><span id="CoordTokenizers.UT-72"><a href="#CoordTokenizers.UT-72"><span class="linenos">72</span></a>
</span><span id="CoordTokenizers.UT-73"><a href="#CoordTokenizers.UT-73"><span class="linenos">73</span></a>		<span class="c1"># inherit docstring</span>
</span><span id="CoordTokenizers.UT-74"><a href="#CoordTokenizers.UT-74"><span class="linenos">74</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>  <span class="c1"># noqa: D102</span>
</span><span id="CoordTokenizers.UT-75"><a href="#CoordTokenizers.UT-75"><span class="linenos">75</span></a>			<span class="k">return</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="s2">&quot;)&quot;</span><span class="p">])]</span>
</span></pre></div>


            <div class="docstring"><p>Unique token coordinate tokenizer.</p>
</div>


                            <div id="CoordTokenizers.UT.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">CoordTokenizers.UT</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#CoordTokenizers.UT">CoordTokenizers.UT</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#CoordTokenizers.UT">CoordTokenizers.UT</a>&#39;&gt;&quot;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#CoordTokenizers.UT.__init__"></a>
    
    

                            </div>
                            <div id="CoordTokenizers.UT.to_tokens" class="classattr">
                                        <input id="CoordTokenizers.UT.to_tokens-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_tokens</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">coord</span><span class="p">:</span> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">Int8</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="s1">&#39;row_col=2&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="CoordTokenizers.UT.to_tokens-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L73-L74" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#CoordTokenizers.UT.to_tokens"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoordTokenizers.UT.to_tokens-74"><a href="#CoordTokenizers.UT.to_tokens-74"><span class="linenos">74</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>  <span class="c1"># noqa: D102</span>
</span><span id="CoordTokenizers.UT.to_tokens-75"><a href="#CoordTokenizers.UT.to_tokens-75"><span class="linenos">75</span></a>			<span class="k">return</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="s2">&quot;)&quot;</span><span class="p">])]</span>
</span></pre></div>


            <div class="docstring"><p>Converts a maze element into a list of tokens.</p>

<p>Not all <code>_TokenizerElement</code> subclasses produce tokens, so this is not an abstract method.
Those subclasses which do produce tokens should override this method.</p>
</div>


                            </div>
                            <div id="CoordTokenizers.UT.serialize" class="classattr">
                                        <input id="CoordTokenizers.UT.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="CoordTokenizers.UT.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L713-L769" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#CoordTokenizers.UT.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoordTokenizers.UT.serialize-714"><a href="#CoordTokenizers.UT.serialize-714"><span class="linenos">714</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="CoordTokenizers.UT.serialize-715"><a href="#CoordTokenizers.UT.serialize-715"><span class="linenos">715</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="CoordTokenizers.UT.serialize-716"><a href="#CoordTokenizers.UT.serialize-716"><span class="linenos">716</span></a>                <span class="n">_FORMAT_KEY</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="CoordTokenizers.UT.serialize-717"><a href="#CoordTokenizers.UT.serialize-717"><span class="linenos">717</span></a>            <span class="p">}</span>
</span><span id="CoordTokenizers.UT.serialize-718"><a href="#CoordTokenizers.UT.serialize-718"><span class="linenos">718</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="CoordTokenizers.UT.serialize-719"><a href="#CoordTokenizers.UT.serialize-719"><span class="linenos">719</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="CoordTokenizers.UT.serialize-720"><a href="#CoordTokenizers.UT.serialize-720"><span class="linenos">720</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="CoordTokenizers.UT.serialize-721"><a href="#CoordTokenizers.UT.serialize-721"><span class="linenos">721</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="CoordTokenizers.UT.serialize-722"><a href="#CoordTokenizers.UT.serialize-722"><span class="linenos">722</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="CoordTokenizers.UT.serialize-723"><a href="#CoordTokenizers.UT.serialize-723"><span class="linenos">723</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="CoordTokenizers.UT.serialize-724"><a href="#CoordTokenizers.UT.serialize-724"><span class="linenos">724</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="CoordTokenizers.UT.serialize-725"><a href="#CoordTokenizers.UT.serialize-725"><span class="linenos">725</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="CoordTokenizers.UT.serialize-726"><a href="#CoordTokenizers.UT.serialize-726"><span class="linenos">726</span></a>                    <span class="p">)</span>
</span><span id="CoordTokenizers.UT.serialize-727"><a href="#CoordTokenizers.UT.serialize-727"><span class="linenos">727</span></a>
</span><span id="CoordTokenizers.UT.serialize-728"><a href="#CoordTokenizers.UT.serialize-728"><span class="linenos">728</span></a>                <span class="c1"># try to save it</span>
</span><span id="CoordTokenizers.UT.serialize-729"><a href="#CoordTokenizers.UT.serialize-729"><span class="linenos">729</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="CoordTokenizers.UT.serialize-730"><a href="#CoordTokenizers.UT.serialize-730"><span class="linenos">730</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="CoordTokenizers.UT.serialize-731"><a href="#CoordTokenizers.UT.serialize-731"><span class="linenos">731</span></a>                        <span class="c1"># get the val</span>
</span><span id="CoordTokenizers.UT.serialize-732"><a href="#CoordTokenizers.UT.serialize-732"><span class="linenos">732</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="CoordTokenizers.UT.serialize-733"><a href="#CoordTokenizers.UT.serialize-733"><span class="linenos">733</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="CoordTokenizers.UT.serialize-734"><a href="#CoordTokenizers.UT.serialize-734"><span class="linenos">734</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="CoordTokenizers.UT.serialize-735"><a href="#CoordTokenizers.UT.serialize-735"><span class="linenos">735</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="CoordTokenizers.UT.serialize-736"><a href="#CoordTokenizers.UT.serialize-736"><span class="linenos">736</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="CoordTokenizers.UT.serialize-737"><a href="#CoordTokenizers.UT.serialize-737"><span class="linenos">737</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="CoordTokenizers.UT.serialize-738"><a href="#CoordTokenizers.UT.serialize-738"><span class="linenos">738</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="CoordTokenizers.UT.serialize-739"><a href="#CoordTokenizers.UT.serialize-739"><span class="linenos">739</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="CoordTokenizers.UT.serialize-740"><a href="#CoordTokenizers.UT.serialize-740"><span class="linenos">740</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="CoordTokenizers.UT.serialize-741"><a href="#CoordTokenizers.UT.serialize-741"><span class="linenos">741</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="CoordTokenizers.UT.serialize-742"><a href="#CoordTokenizers.UT.serialize-742"><span class="linenos">742</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="CoordTokenizers.UT.serialize-743"><a href="#CoordTokenizers.UT.serialize-743"><span class="linenos">743</span></a>
</span><span id="CoordTokenizers.UT.serialize-744"><a href="#CoordTokenizers.UT.serialize-744"><span class="linenos">744</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="CoordTokenizers.UT.serialize-745"><a href="#CoordTokenizers.UT.serialize-745"><span class="linenos">745</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="CoordTokenizers.UT.serialize-746"><a href="#CoordTokenizers.UT.serialize-746"><span class="linenos">746</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="CoordTokenizers.UT.serialize-747"><a href="#CoordTokenizers.UT.serialize-747"><span class="linenos">747</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="CoordTokenizers.UT.serialize-748"><a href="#CoordTokenizers.UT.serialize-748"><span class="linenos">748</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="CoordTokenizers.UT.serialize-749"><a href="#CoordTokenizers.UT.serialize-749"><span class="linenos">749</span></a>                                <span class="p">[</span>
</span><span id="CoordTokenizers.UT.serialize-750"><a href="#CoordTokenizers.UT.serialize-750"><span class="linenos">750</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CoordTokenizers.UT.serialize-751"><a href="#CoordTokenizers.UT.serialize-751"><span class="linenos">751</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CoordTokenizers.UT.serialize-752"><a href="#CoordTokenizers.UT.serialize-752"><span class="linenos">752</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CoordTokenizers.UT.serialize-753"><a href="#CoordTokenizers.UT.serialize-753"><span class="linenos">753</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CoordTokenizers.UT.serialize-754"><a href="#CoordTokenizers.UT.serialize-754"><span class="linenos">754</span></a>                                <span class="p">]</span>
</span><span id="CoordTokenizers.UT.serialize-755"><a href="#CoordTokenizers.UT.serialize-755"><span class="linenos">755</span></a>                            <span class="p">)</span>
</span><span id="CoordTokenizers.UT.serialize-756"><a href="#CoordTokenizers.UT.serialize-756"><span class="linenos">756</span></a>                        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</span><span id="CoordTokenizers.UT.serialize-757"><a href="#CoordTokenizers.UT.serialize-757"><span class="linenos">757</span></a>
</span><span id="CoordTokenizers.UT.serialize-758"><a href="#CoordTokenizers.UT.serialize-758"><span class="linenos">758</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="CoordTokenizers.UT.serialize-759"><a href="#CoordTokenizers.UT.serialize-759"><span class="linenos">759</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="CoordTokenizers.UT.serialize-760"><a href="#CoordTokenizers.UT.serialize-760"><span class="linenos">760</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="CoordTokenizers.UT.serialize-761"><a href="#CoordTokenizers.UT.serialize-761"><span class="linenos">761</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="CoordTokenizers.UT.serialize-762"><a href="#CoordTokenizers.UT.serialize-762"><span class="linenos">762</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="CoordTokenizers.UT.serialize-763"><a href="#CoordTokenizers.UT.serialize-763"><span class="linenos">763</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="CoordTokenizers.UT.serialize-764"><a href="#CoordTokenizers.UT.serialize-764"><span class="linenos">764</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="CoordTokenizers.UT.serialize-765"><a href="#CoordTokenizers.UT.serialize-765"><span class="linenos">765</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="CoordTokenizers.UT.serialize-766"><a href="#CoordTokenizers.UT.serialize-766"><span class="linenos">766</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="CoordTokenizers.UT.serialize-767"><a href="#CoordTokenizers.UT.serialize-767"><span class="linenos">767</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="CoordTokenizers.UT.serialize-768"><a href="#CoordTokenizers.UT.serialize-768"><span class="linenos">768</span></a>                    <span class="p">)</span>
</span><span id="CoordTokenizers.UT.serialize-769"><a href="#CoordTokenizers.UT.serialize-769"><span class="linenos">769</span></a>
</span><span id="CoordTokenizers.UT.serialize-770"><a href="#CoordTokenizers.UT.serialize-770"><span class="linenos">770</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="CoordTokenizers.UT.load" class="classattr">
                                        <input id="CoordTokenizers.UT.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="CoordTokenizers.UT.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L776-L862" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#CoordTokenizers.UT.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoordTokenizers.UT.load-777"><a href="#CoordTokenizers.UT.load-777"><span class="linenos">777</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="CoordTokenizers.UT.load-778"><a href="#CoordTokenizers.UT.load-778"><span class="linenos">778</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="CoordTokenizers.UT.load-779"><a href="#CoordTokenizers.UT.load-779"><span class="linenos">779</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="CoordTokenizers.UT.load-780"><a href="#CoordTokenizers.UT.load-780"><span class="linenos">780</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="CoordTokenizers.UT.load-781"><a href="#CoordTokenizers.UT.load-781"><span class="linenos">781</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="CoordTokenizers.UT.load-782"><a href="#CoordTokenizers.UT.load-782"><span class="linenos">782</span></a>
</span><span id="CoordTokenizers.UT.load-783"><a href="#CoordTokenizers.UT.load-783"><span class="linenos">783</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="CoordTokenizers.UT.load-784"><a href="#CoordTokenizers.UT.load-784"><span class="linenos">784</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="CoordTokenizers.UT.load-785"><a href="#CoordTokenizers.UT.load-785"><span class="linenos">785</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="CoordTokenizers.UT.load-786"><a href="#CoordTokenizers.UT.load-786"><span class="linenos">786</span></a>
</span><span id="CoordTokenizers.UT.load-787"><a href="#CoordTokenizers.UT.load-787"><span class="linenos">787</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="CoordTokenizers.UT.load-788"><a href="#CoordTokenizers.UT.load-788"><span class="linenos">788</span></a>
</span><span id="CoordTokenizers.UT.load-789"><a href="#CoordTokenizers.UT.load-789"><span class="linenos">789</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="CoordTokenizers.UT.load-790"><a href="#CoordTokenizers.UT.load-790"><span class="linenos">790</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="CoordTokenizers.UT.load-791"><a href="#CoordTokenizers.UT.load-791"><span class="linenos">791</span></a>
</span><span id="CoordTokenizers.UT.load-792"><a href="#CoordTokenizers.UT.load-792"><span class="linenos">792</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="CoordTokenizers.UT.load-793"><a href="#CoordTokenizers.UT.load-793"><span class="linenos">793</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="CoordTokenizers.UT.load-794"><a href="#CoordTokenizers.UT.load-794"><span class="linenos">794</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="CoordTokenizers.UT.load-795"><a href="#CoordTokenizers.UT.load-795"><span class="linenos">795</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="CoordTokenizers.UT.load-796"><a href="#CoordTokenizers.UT.load-796"><span class="linenos">796</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="CoordTokenizers.UT.load-797"><a href="#CoordTokenizers.UT.load-797"><span class="linenos">797</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="CoordTokenizers.UT.load-798"><a href="#CoordTokenizers.UT.load-798"><span class="linenos">798</span></a>
</span><span id="CoordTokenizers.UT.load-799"><a href="#CoordTokenizers.UT.load-799"><span class="linenos">799</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="CoordTokenizers.UT.load-800"><a href="#CoordTokenizers.UT.load-800"><span class="linenos">800</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="CoordTokenizers.UT.load-801"><a href="#CoordTokenizers.UT.load-801"><span class="linenos">801</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="CoordTokenizers.UT.load-802"><a href="#CoordTokenizers.UT.load-802"><span class="linenos">802</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="CoordTokenizers.UT.load-803"><a href="#CoordTokenizers.UT.load-803"><span class="linenos">803</span></a>
</span><span id="CoordTokenizers.UT.load-804"><a href="#CoordTokenizers.UT.load-804"><span class="linenos">804</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="CoordTokenizers.UT.load-805"><a href="#CoordTokenizers.UT.load-805"><span class="linenos">805</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="CoordTokenizers.UT.load-806"><a href="#CoordTokenizers.UT.load-806"><span class="linenos">806</span></a>
</span><span id="CoordTokenizers.UT.load-807"><a href="#CoordTokenizers.UT.load-807"><span class="linenos">807</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="CoordTokenizers.UT.load-808"><a href="#CoordTokenizers.UT.load-808"><span class="linenos">808</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="CoordTokenizers.UT.load-809"><a href="#CoordTokenizers.UT.load-809"><span class="linenos">809</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="CoordTokenizers.UT.load-810"><a href="#CoordTokenizers.UT.load-810"><span class="linenos">810</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="CoordTokenizers.UT.load-811"><a href="#CoordTokenizers.UT.load-811"><span class="linenos">811</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="CoordTokenizers.UT.load-812"><a href="#CoordTokenizers.UT.load-812"><span class="linenos">812</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="CoordTokenizers.UT.load-813"><a href="#CoordTokenizers.UT.load-813"><span class="linenos">813</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="CoordTokenizers.UT.load-814"><a href="#CoordTokenizers.UT.load-814"><span class="linenos">814</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="CoordTokenizers.UT.load-815"><a href="#CoordTokenizers.UT.load-815"><span class="linenos">815</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="CoordTokenizers.UT.load-816"><a href="#CoordTokenizers.UT.load-816"><span class="linenos">816</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="CoordTokenizers.UT.load-817"><a href="#CoordTokenizers.UT.load-817"><span class="linenos">817</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="CoordTokenizers.UT.load-818"><a href="#CoordTokenizers.UT.load-818"><span class="linenos">818</span></a>                    <span class="p">):</span>
</span><span id="CoordTokenizers.UT.load-819"><a href="#CoordTokenizers.UT.load-819"><span class="linenos">819</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="CoordTokenizers.UT.load-820"><a href="#CoordTokenizers.UT.load-820"><span class="linenos">820</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="CoordTokenizers.UT.load-821"><a href="#CoordTokenizers.UT.load-821"><span class="linenos">821</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="CoordTokenizers.UT.load-822"><a href="#CoordTokenizers.UT.load-822"><span class="linenos">822</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="CoordTokenizers.UT.load-823"><a href="#CoordTokenizers.UT.load-823"><span class="linenos">823</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="CoordTokenizers.UT.load-824"><a href="#CoordTokenizers.UT.load-824"><span class="linenos">824</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="CoordTokenizers.UT.load-825"><a href="#CoordTokenizers.UT.load-825"><span class="linenos">825</span></a>                            <span class="p">)</span>
</span><span id="CoordTokenizers.UT.load-826"><a href="#CoordTokenizers.UT.load-826"><span class="linenos">826</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="CoordTokenizers.UT.load-827"><a href="#CoordTokenizers.UT.load-827"><span class="linenos">827</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="CoordTokenizers.UT.load-828"><a href="#CoordTokenizers.UT.load-828"><span class="linenos">828</span></a>                        <span class="k">pass</span>
</span><span id="CoordTokenizers.UT.load-829"><a href="#CoordTokenizers.UT.load-829"><span class="linenos">829</span></a>
</span><span id="CoordTokenizers.UT.load-830"><a href="#CoordTokenizers.UT.load-830"><span class="linenos">830</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="CoordTokenizers.UT.load-831"><a href="#CoordTokenizers.UT.load-831"><span class="linenos">831</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="CoordTokenizers.UT.load-832"><a href="#CoordTokenizers.UT.load-832"><span class="linenos">832</span></a>
</span><span id="CoordTokenizers.UT.load-833"><a href="#CoordTokenizers.UT.load-833"><span class="linenos">833</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="CoordTokenizers.UT.load-834"><a href="#CoordTokenizers.UT.load-834"><span class="linenos">834</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="CoordTokenizers.UT.load-835"><a href="#CoordTokenizers.UT.load-835"><span class="linenos">835</span></a>
</span><span id="CoordTokenizers.UT.load-836"><a href="#CoordTokenizers.UT.load-836"><span class="linenos">836</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="CoordTokenizers.UT.load-837"><a href="#CoordTokenizers.UT.load-837"><span class="linenos">837</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="CoordTokenizers.UT.load-838"><a href="#CoordTokenizers.UT.load-838"><span class="linenos">838</span></a>                <span class="n">fields_valid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="CoordTokenizers.UT.load-839"><a href="#CoordTokenizers.UT.load-839"><span class="linenos">839</span></a>                    <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="CoordTokenizers.UT.load-840"><a href="#CoordTokenizers.UT.load-840"><span class="linenos">840</span></a>                        <span class="n">output</span><span class="p">,</span>
</span><span id="CoordTokenizers.UT.load-841"><a href="#CoordTokenizers.UT.load-841"><span class="linenos">841</span></a>                        <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">,</span>
</span><span id="CoordTokenizers.UT.load-842"><a href="#CoordTokenizers.UT.load-842"><span class="linenos">842</span></a>                    <span class="p">)</span>
</span><span id="CoordTokenizers.UT.load-843"><a href="#CoordTokenizers.UT.load-843"><span class="linenos">843</span></a>                <span class="p">)</span>
</span><span id="CoordTokenizers.UT.load-844"><a href="#CoordTokenizers.UT.load-844"><span class="linenos">844</span></a>
</span><span id="CoordTokenizers.UT.load-845"><a href="#CoordTokenizers.UT.load-845"><span class="linenos">845</span></a>                <span class="c1"># if there are any fields that are not valid, raise an error</span>
</span><span id="CoordTokenizers.UT.load-846"><a href="#CoordTokenizers.UT.load-846"><span class="linenos">846</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">fields_valid</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="CoordTokenizers.UT.load-847"><a href="#CoordTokenizers.UT.load-847"><span class="linenos">847</span></a>                    <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="CoordTokenizers.UT.load-848"><a href="#CoordTokenizers.UT.load-848"><span class="linenos">848</span></a>                        <span class="sa">f</span><span class="s2">&quot;Type mismatch in fields of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="CoordTokenizers.UT.load-849"><a href="#CoordTokenizers.UT.load-849"><span class="linenos">849</span></a>                        <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="CoordTokenizers.UT.load-850"><a href="#CoordTokenizers.UT.load-850"><span class="linenos">850</span></a>                            <span class="p">[</span>
</span><span id="CoordTokenizers.UT.load-851"><a href="#CoordTokenizers.UT.load-851"><span class="linenos">851</span></a>                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">:</span><span class="se">\t</span><span class="s2">expected </span><span class="si">{</span><span class="n">cls_type_hints</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="si">= }</span><span class="s2">, but got value </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="CoordTokenizers.UT.load-852"><a href="#CoordTokenizers.UT.load-852"><span class="linenos">852</span></a>                                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">fields_valid</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="CoordTokenizers.UT.load-853"><a href="#CoordTokenizers.UT.load-853"><span class="linenos">853</span></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span>
</span><span id="CoordTokenizers.UT.load-854"><a href="#CoordTokenizers.UT.load-854"><span class="linenos">854</span></a>                            <span class="p">]</span>
</span><span id="CoordTokenizers.UT.load-855"><a href="#CoordTokenizers.UT.load-855"><span class="linenos">855</span></a>                        <span class="p">)</span>
</span><span id="CoordTokenizers.UT.load-856"><a href="#CoordTokenizers.UT.load-856"><span class="linenos">856</span></a>                    <span class="p">)</span>
</span><span id="CoordTokenizers.UT.load-857"><a href="#CoordTokenizers.UT.load-857"><span class="linenos">857</span></a>
</span><span id="CoordTokenizers.UT.load-858"><a href="#CoordTokenizers.UT.load-858"><span class="linenos">858</span></a>                    <span class="n">on_typecheck_mismatch</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
</span><span id="CoordTokenizers.UT.load-859"><a href="#CoordTokenizers.UT.load-859"><span class="linenos">859</span></a>                        <span class="n">msg</span><span class="p">,</span> <span class="n">except_cls</span><span class="o">=</span><span class="n">FieldTypeMismatchError</span>
</span><span id="CoordTokenizers.UT.load-860"><a href="#CoordTokenizers.UT.load-860"><span class="linenos">860</span></a>                    <span class="p">)</span>
</span><span id="CoordTokenizers.UT.load-861"><a href="#CoordTokenizers.UT.load-861"><span class="linenos">861</span></a>
</span><span id="CoordTokenizers.UT.load-862"><a href="#CoordTokenizers.UT.load-862"><span class="linenos">862</span></a>            <span class="c1"># return the new instance</span>
</span><span id="CoordTokenizers.UT.load-863"><a href="#CoordTokenizers.UT.load-863"><span class="linenos">863</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="CoordTokenizers.UT.validate_fields_types" class="classattr">
                                        <input id="CoordTokenizers.UT.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="CoordTokenizers.UT.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L282-L291" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#CoordTokenizers.UT.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoordTokenizers.UT.validate_fields_types-283"><a href="#CoordTokenizers.UT.validate_fields_types-283"><span class="linenos">283</span></a><span class="k">def</span><span class="w"> </span><span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="CoordTokenizers.UT.validate_fields_types-284"><a href="#CoordTokenizers.UT.validate_fields_types-284"><span class="linenos">284</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="CoordTokenizers.UT.validate_fields_types-285"><a href="#CoordTokenizers.UT.validate_fields_types-285"><span class="linenos">285</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="CoordTokenizers.UT.validate_fields_types-286"><a href="#CoordTokenizers.UT.validate_fields_types-286"><span class="linenos">286</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="CoordTokenizers.UT.validate_fields_types-287"><a href="#CoordTokenizers.UT.validate_fields_types-287"><span class="linenos">287</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="CoordTokenizers.UT.validate_fields_types-288"><a href="#CoordTokenizers.UT.validate_fields_types-288"><span class="linenos">288</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="CoordTokenizers.UT.validate_fields_types-289"><a href="#CoordTokenizers.UT.validate_fields_types-289"><span class="linenos">289</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="CoordTokenizers.UT.validate_fields_types-290"><a href="#CoordTokenizers.UT.validate_fields_types-290"><span class="linenos">290</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="CoordTokenizers.UT.validate_fields_types-291"><a href="#CoordTokenizers.UT.validate_fields_types-291"><span class="linenos">291</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="CoordTokenizers.UT.validate_fields_types-292"><a href="#CoordTokenizers.UT.validate_fields_types-292"><span class="linenos">292</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#CoordTokenizers._CoordTokenizer">CoordTokenizers._CoordTokenizer</a></dt>
                                <dd id="CoordTokenizers.UT.attribute_key" class="function"><a href="#CoordTokenizers._CoordTokenizer.attribute_key">attribute_key</a></dd>
                <dd id="CoordTokenizers.UT.is_valid" class="function"><a href="#CoordTokenizers._CoordTokenizer.is_valid">is_valid</a></dd>

            </div>
            <div><dt><a href="element_base.html#_TokenizerElement">maze_dataset.tokenization.modular.element_base._TokenizerElement</a></dt>
                                <dd id="CoordTokenizers.UT.name" class="variable"><a href="element_base.html#_TokenizerElement.name">name</a></dd>
                <dd id="CoordTokenizers.UT.tokenizer_elements" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="CoordTokenizers.UT.tokenizer_element_tree" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="CoordTokenizers.UT.tokenizer_element_dict" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="CoordTokenizers.UT.validate_field_type" class="function">validate_field_type</dd>
                <dd id="CoordTokenizers.UT.diff" class="function">diff</dd>
                <dd id="CoordTokenizers.UT.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="CoordTokenizers.CTT">
                            <input id="CoordTokenizers.CTT-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">CoordTokenizers.CTT</span><wbr>(<span class="base"><a href="#CoordTokenizers._CoordTokenizer">CoordTokenizers._CoordTokenizer</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="CoordTokenizers.CTT-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L76-L99" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#CoordTokenizers.CTT"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoordTokenizers.CTT-77"><a href="#CoordTokenizers.CTT-77"><span class="linenos"> 77</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="CoordTokenizers.CTT-78"><a href="#CoordTokenizers.CTT-78"><span class="linenos"> 78</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">CTT</span><span class="p">(</span><span class="n">_CoordTokenizer</span><span class="p">):</span>
</span><span id="CoordTokenizers.CTT-79"><a href="#CoordTokenizers.CTT-79"><span class="linenos"> 79</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Coordinate tuple tokenizer</span>
</span><span id="CoordTokenizers.CTT-80"><a href="#CoordTokenizers.CTT-80"><span class="linenos"> 80</span></a>
</span><span id="CoordTokenizers.CTT-81"><a href="#CoordTokenizers.CTT-81"><span class="linenos"> 81</span></a><span class="sd">		# Parameters</span>
</span><span id="CoordTokenizers.CTT-82"><a href="#CoordTokenizers.CTT-82"><span class="linenos"> 82</span></a><span class="sd">		- `pre`: Whether all coords include an integral preceding delimiter token</span>
</span><span id="CoordTokenizers.CTT-83"><a href="#CoordTokenizers.CTT-83"><span class="linenos"> 83</span></a><span class="sd">		- `intra`: Whether all coords include a delimiter token between coordinates</span>
</span><span id="CoordTokenizers.CTT-84"><a href="#CoordTokenizers.CTT-84"><span class="linenos"> 84</span></a><span class="sd">		- `post`: Whether all coords include an integral following delimiter token</span>
</span><span id="CoordTokenizers.CTT-85"><a href="#CoordTokenizers.CTT-85"><span class="linenos"> 85</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="CoordTokenizers.CTT-86"><a href="#CoordTokenizers.CTT-86"><span class="linenos"> 86</span></a>
</span><span id="CoordTokenizers.CTT-87"><a href="#CoordTokenizers.CTT-87"><span class="linenos"> 87</span></a>		<span class="n">pre</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="CoordTokenizers.CTT-88"><a href="#CoordTokenizers.CTT-88"><span class="linenos"> 88</span></a>		<span class="n">intra</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="CoordTokenizers.CTT-89"><a href="#CoordTokenizers.CTT-89"><span class="linenos"> 89</span></a>		<span class="n">post</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="CoordTokenizers.CTT-90"><a href="#CoordTokenizers.CTT-90"><span class="linenos"> 90</span></a>		<span class="c1"># Implement methods</span>
</span><span id="CoordTokenizers.CTT-91"><a href="#CoordTokenizers.CTT-91"><span class="linenos"> 91</span></a>
</span><span id="CoordTokenizers.CTT-92"><a href="#CoordTokenizers.CTT-92"><span class="linenos"> 92</span></a>		<span class="c1"># inherit docstring</span>
</span><span id="CoordTokenizers.CTT-93"><a href="#CoordTokenizers.CTT-93"><span class="linenos"> 93</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>  <span class="c1"># noqa: D102</span>
</span><span id="CoordTokenizers.CTT-94"><a href="#CoordTokenizers.CTT-94"><span class="linenos"> 94</span></a>			<span class="k">return</span> <span class="p">[</span>
</span><span id="CoordTokenizers.CTT-95"><a href="#CoordTokenizers.CTT-95"><span class="linenos"> 95</span></a>				<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">([</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">COORD_PRE</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;pre&quot;</span><span class="p">),</span>
</span><span id="CoordTokenizers.CTT-96"><a href="#CoordTokenizers.CTT-96"><span class="linenos"> 96</span></a>				<span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
</span><span id="CoordTokenizers.CTT-97"><a href="#CoordTokenizers.CTT-97"><span class="linenos"> 97</span></a>				<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">([</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">COORD_INTRA</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;intra&quot;</span><span class="p">),</span>
</span><span id="CoordTokenizers.CTT-98"><a href="#CoordTokenizers.CTT-98"><span class="linenos"> 98</span></a>				<span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
</span><span id="CoordTokenizers.CTT-99"><a href="#CoordTokenizers.CTT-99"><span class="linenos"> 99</span></a>				<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">([</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">COORD_POST</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;post&quot;</span><span class="p">),</span>
</span><span id="CoordTokenizers.CTT-100"><a href="#CoordTokenizers.CTT-100"><span class="linenos">100</span></a>			<span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Coordinate tuple tokenizer</p>

<h1 id="parameters">Parameters</h1>

<ul>
<li><code><a href="#CoordTokenizers.CTT.pre">pre</a></code>: Whether all coords include an integral preceding delimiter token</li>
<li><code><a href="#CoordTokenizers.CTT.intra">intra</a></code>: Whether all coords include a delimiter token between coordinates</li>
<li><code><a href="#CoordTokenizers.CTT.post">post</a></code>: Whether all coords include an integral following delimiter token</li>
</ul>
</div>


                            <div id="CoordTokenizers.CTT.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">CoordTokenizers.CTT</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#CoordTokenizers.CTT">CoordTokenizers.CTT</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#CoordTokenizers.CTT">CoordTokenizers.CTT</a>&#39;&gt;&quot;</span>,</span><span class="param">	<span class="n">pre</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">intra</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">post</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#CoordTokenizers.CTT.__init__"></a>
    
    

                            </div>
                            <div id="CoordTokenizers.CTT.pre" class="classattr">
                                <div class="attr variable">
            <span class="name">pre</span><span class="annotation">: bool</span>        =
<span class="default_value">True</span>

        
    </div>
    <a class="headerlink" href="#CoordTokenizers.CTT.pre"></a>
    
    

                            </div>
                            <div id="CoordTokenizers.CTT.intra" class="classattr">
                                <div class="attr variable">
            <span class="name">intra</span><span class="annotation">: bool</span>        =
<span class="default_value">True</span>

        
    </div>
    <a class="headerlink" href="#CoordTokenizers.CTT.intra"></a>
    
    

                            </div>
                            <div id="CoordTokenizers.CTT.post" class="classattr">
                                <div class="attr variable">
            <span class="name">post</span><span class="annotation">: bool</span>        =
<span class="default_value">True</span>

        
    </div>
    <a class="headerlink" href="#CoordTokenizers.CTT.post"></a>
    
    

                            </div>
                            <div id="CoordTokenizers.CTT.to_tokens" class="classattr">
                                        <input id="CoordTokenizers.CTT.to_tokens-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_tokens</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">coord</span><span class="p">:</span> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">Int8</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="s1">&#39;row_col=2&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="CoordTokenizers.CTT.to_tokens-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L92-L99" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#CoordTokenizers.CTT.to_tokens"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoordTokenizers.CTT.to_tokens-93"><a href="#CoordTokenizers.CTT.to_tokens-93"><span class="linenos"> 93</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>  <span class="c1"># noqa: D102</span>
</span><span id="CoordTokenizers.CTT.to_tokens-94"><a href="#CoordTokenizers.CTT.to_tokens-94"><span class="linenos"> 94</span></a>			<span class="k">return</span> <span class="p">[</span>
</span><span id="CoordTokenizers.CTT.to_tokens-95"><a href="#CoordTokenizers.CTT.to_tokens-95"><span class="linenos"> 95</span></a>				<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">([</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">COORD_PRE</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;pre&quot;</span><span class="p">),</span>
</span><span id="CoordTokenizers.CTT.to_tokens-96"><a href="#CoordTokenizers.CTT.to_tokens-96"><span class="linenos"> 96</span></a>				<span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
</span><span id="CoordTokenizers.CTT.to_tokens-97"><a href="#CoordTokenizers.CTT.to_tokens-97"><span class="linenos"> 97</span></a>				<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">([</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">COORD_INTRA</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;intra&quot;</span><span class="p">),</span>
</span><span id="CoordTokenizers.CTT.to_tokens-98"><a href="#CoordTokenizers.CTT.to_tokens-98"><span class="linenos"> 98</span></a>				<span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
</span><span id="CoordTokenizers.CTT.to_tokens-99"><a href="#CoordTokenizers.CTT.to_tokens-99"><span class="linenos"> 99</span></a>				<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">([</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">COORD_POST</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;post&quot;</span><span class="p">),</span>
</span><span id="CoordTokenizers.CTT.to_tokens-100"><a href="#CoordTokenizers.CTT.to_tokens-100"><span class="linenos">100</span></a>			<span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Converts a maze element into a list of tokens.</p>

<p>Not all <code>_TokenizerElement</code> subclasses produce tokens, so this is not an abstract method.
Those subclasses which do produce tokens should override this method.</p>
</div>


                            </div>
                            <div id="CoordTokenizers.CTT.serialize" class="classattr">
                                        <input id="CoordTokenizers.CTT.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="CoordTokenizers.CTT.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L713-L769" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#CoordTokenizers.CTT.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoordTokenizers.CTT.serialize-714"><a href="#CoordTokenizers.CTT.serialize-714"><span class="linenos">714</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="CoordTokenizers.CTT.serialize-715"><a href="#CoordTokenizers.CTT.serialize-715"><span class="linenos">715</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="CoordTokenizers.CTT.serialize-716"><a href="#CoordTokenizers.CTT.serialize-716"><span class="linenos">716</span></a>                <span class="n">_FORMAT_KEY</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="CoordTokenizers.CTT.serialize-717"><a href="#CoordTokenizers.CTT.serialize-717"><span class="linenos">717</span></a>            <span class="p">}</span>
</span><span id="CoordTokenizers.CTT.serialize-718"><a href="#CoordTokenizers.CTT.serialize-718"><span class="linenos">718</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="CoordTokenizers.CTT.serialize-719"><a href="#CoordTokenizers.CTT.serialize-719"><span class="linenos">719</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="CoordTokenizers.CTT.serialize-720"><a href="#CoordTokenizers.CTT.serialize-720"><span class="linenos">720</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="CoordTokenizers.CTT.serialize-721"><a href="#CoordTokenizers.CTT.serialize-721"><span class="linenos">721</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="CoordTokenizers.CTT.serialize-722"><a href="#CoordTokenizers.CTT.serialize-722"><span class="linenos">722</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="CoordTokenizers.CTT.serialize-723"><a href="#CoordTokenizers.CTT.serialize-723"><span class="linenos">723</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="CoordTokenizers.CTT.serialize-724"><a href="#CoordTokenizers.CTT.serialize-724"><span class="linenos">724</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="CoordTokenizers.CTT.serialize-725"><a href="#CoordTokenizers.CTT.serialize-725"><span class="linenos">725</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="CoordTokenizers.CTT.serialize-726"><a href="#CoordTokenizers.CTT.serialize-726"><span class="linenos">726</span></a>                    <span class="p">)</span>
</span><span id="CoordTokenizers.CTT.serialize-727"><a href="#CoordTokenizers.CTT.serialize-727"><span class="linenos">727</span></a>
</span><span id="CoordTokenizers.CTT.serialize-728"><a href="#CoordTokenizers.CTT.serialize-728"><span class="linenos">728</span></a>                <span class="c1"># try to save it</span>
</span><span id="CoordTokenizers.CTT.serialize-729"><a href="#CoordTokenizers.CTT.serialize-729"><span class="linenos">729</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="CoordTokenizers.CTT.serialize-730"><a href="#CoordTokenizers.CTT.serialize-730"><span class="linenos">730</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="CoordTokenizers.CTT.serialize-731"><a href="#CoordTokenizers.CTT.serialize-731"><span class="linenos">731</span></a>                        <span class="c1"># get the val</span>
</span><span id="CoordTokenizers.CTT.serialize-732"><a href="#CoordTokenizers.CTT.serialize-732"><span class="linenos">732</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="CoordTokenizers.CTT.serialize-733"><a href="#CoordTokenizers.CTT.serialize-733"><span class="linenos">733</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="CoordTokenizers.CTT.serialize-734"><a href="#CoordTokenizers.CTT.serialize-734"><span class="linenos">734</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="CoordTokenizers.CTT.serialize-735"><a href="#CoordTokenizers.CTT.serialize-735"><span class="linenos">735</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="CoordTokenizers.CTT.serialize-736"><a href="#CoordTokenizers.CTT.serialize-736"><span class="linenos">736</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="CoordTokenizers.CTT.serialize-737"><a href="#CoordTokenizers.CTT.serialize-737"><span class="linenos">737</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="CoordTokenizers.CTT.serialize-738"><a href="#CoordTokenizers.CTT.serialize-738"><span class="linenos">738</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="CoordTokenizers.CTT.serialize-739"><a href="#CoordTokenizers.CTT.serialize-739"><span class="linenos">739</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="CoordTokenizers.CTT.serialize-740"><a href="#CoordTokenizers.CTT.serialize-740"><span class="linenos">740</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="CoordTokenizers.CTT.serialize-741"><a href="#CoordTokenizers.CTT.serialize-741"><span class="linenos">741</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="CoordTokenizers.CTT.serialize-742"><a href="#CoordTokenizers.CTT.serialize-742"><span class="linenos">742</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="CoordTokenizers.CTT.serialize-743"><a href="#CoordTokenizers.CTT.serialize-743"><span class="linenos">743</span></a>
</span><span id="CoordTokenizers.CTT.serialize-744"><a href="#CoordTokenizers.CTT.serialize-744"><span class="linenos">744</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="CoordTokenizers.CTT.serialize-745"><a href="#CoordTokenizers.CTT.serialize-745"><span class="linenos">745</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="CoordTokenizers.CTT.serialize-746"><a href="#CoordTokenizers.CTT.serialize-746"><span class="linenos">746</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="CoordTokenizers.CTT.serialize-747"><a href="#CoordTokenizers.CTT.serialize-747"><span class="linenos">747</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="CoordTokenizers.CTT.serialize-748"><a href="#CoordTokenizers.CTT.serialize-748"><span class="linenos">748</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="CoordTokenizers.CTT.serialize-749"><a href="#CoordTokenizers.CTT.serialize-749"><span class="linenos">749</span></a>                                <span class="p">[</span>
</span><span id="CoordTokenizers.CTT.serialize-750"><a href="#CoordTokenizers.CTT.serialize-750"><span class="linenos">750</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CoordTokenizers.CTT.serialize-751"><a href="#CoordTokenizers.CTT.serialize-751"><span class="linenos">751</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CoordTokenizers.CTT.serialize-752"><a href="#CoordTokenizers.CTT.serialize-752"><span class="linenos">752</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CoordTokenizers.CTT.serialize-753"><a href="#CoordTokenizers.CTT.serialize-753"><span class="linenos">753</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CoordTokenizers.CTT.serialize-754"><a href="#CoordTokenizers.CTT.serialize-754"><span class="linenos">754</span></a>                                <span class="p">]</span>
</span><span id="CoordTokenizers.CTT.serialize-755"><a href="#CoordTokenizers.CTT.serialize-755"><span class="linenos">755</span></a>                            <span class="p">)</span>
</span><span id="CoordTokenizers.CTT.serialize-756"><a href="#CoordTokenizers.CTT.serialize-756"><span class="linenos">756</span></a>                        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</span><span id="CoordTokenizers.CTT.serialize-757"><a href="#CoordTokenizers.CTT.serialize-757"><span class="linenos">757</span></a>
</span><span id="CoordTokenizers.CTT.serialize-758"><a href="#CoordTokenizers.CTT.serialize-758"><span class="linenos">758</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="CoordTokenizers.CTT.serialize-759"><a href="#CoordTokenizers.CTT.serialize-759"><span class="linenos">759</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="CoordTokenizers.CTT.serialize-760"><a href="#CoordTokenizers.CTT.serialize-760"><span class="linenos">760</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="CoordTokenizers.CTT.serialize-761"><a href="#CoordTokenizers.CTT.serialize-761"><span class="linenos">761</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="CoordTokenizers.CTT.serialize-762"><a href="#CoordTokenizers.CTT.serialize-762"><span class="linenos">762</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="CoordTokenizers.CTT.serialize-763"><a href="#CoordTokenizers.CTT.serialize-763"><span class="linenos">763</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="CoordTokenizers.CTT.serialize-764"><a href="#CoordTokenizers.CTT.serialize-764"><span class="linenos">764</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="CoordTokenizers.CTT.serialize-765"><a href="#CoordTokenizers.CTT.serialize-765"><span class="linenos">765</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="CoordTokenizers.CTT.serialize-766"><a href="#CoordTokenizers.CTT.serialize-766"><span class="linenos">766</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="CoordTokenizers.CTT.serialize-767"><a href="#CoordTokenizers.CTT.serialize-767"><span class="linenos">767</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="CoordTokenizers.CTT.serialize-768"><a href="#CoordTokenizers.CTT.serialize-768"><span class="linenos">768</span></a>                    <span class="p">)</span>
</span><span id="CoordTokenizers.CTT.serialize-769"><a href="#CoordTokenizers.CTT.serialize-769"><span class="linenos">769</span></a>
</span><span id="CoordTokenizers.CTT.serialize-770"><a href="#CoordTokenizers.CTT.serialize-770"><span class="linenos">770</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="CoordTokenizers.CTT.load" class="classattr">
                                        <input id="CoordTokenizers.CTT.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="CoordTokenizers.CTT.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L776-L862" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#CoordTokenizers.CTT.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoordTokenizers.CTT.load-777"><a href="#CoordTokenizers.CTT.load-777"><span class="linenos">777</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="CoordTokenizers.CTT.load-778"><a href="#CoordTokenizers.CTT.load-778"><span class="linenos">778</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="CoordTokenizers.CTT.load-779"><a href="#CoordTokenizers.CTT.load-779"><span class="linenos">779</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="CoordTokenizers.CTT.load-780"><a href="#CoordTokenizers.CTT.load-780"><span class="linenos">780</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="CoordTokenizers.CTT.load-781"><a href="#CoordTokenizers.CTT.load-781"><span class="linenos">781</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="CoordTokenizers.CTT.load-782"><a href="#CoordTokenizers.CTT.load-782"><span class="linenos">782</span></a>
</span><span id="CoordTokenizers.CTT.load-783"><a href="#CoordTokenizers.CTT.load-783"><span class="linenos">783</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="CoordTokenizers.CTT.load-784"><a href="#CoordTokenizers.CTT.load-784"><span class="linenos">784</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="CoordTokenizers.CTT.load-785"><a href="#CoordTokenizers.CTT.load-785"><span class="linenos">785</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="CoordTokenizers.CTT.load-786"><a href="#CoordTokenizers.CTT.load-786"><span class="linenos">786</span></a>
</span><span id="CoordTokenizers.CTT.load-787"><a href="#CoordTokenizers.CTT.load-787"><span class="linenos">787</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="CoordTokenizers.CTT.load-788"><a href="#CoordTokenizers.CTT.load-788"><span class="linenos">788</span></a>
</span><span id="CoordTokenizers.CTT.load-789"><a href="#CoordTokenizers.CTT.load-789"><span class="linenos">789</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="CoordTokenizers.CTT.load-790"><a href="#CoordTokenizers.CTT.load-790"><span class="linenos">790</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="CoordTokenizers.CTT.load-791"><a href="#CoordTokenizers.CTT.load-791"><span class="linenos">791</span></a>
</span><span id="CoordTokenizers.CTT.load-792"><a href="#CoordTokenizers.CTT.load-792"><span class="linenos">792</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="CoordTokenizers.CTT.load-793"><a href="#CoordTokenizers.CTT.load-793"><span class="linenos">793</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="CoordTokenizers.CTT.load-794"><a href="#CoordTokenizers.CTT.load-794"><span class="linenos">794</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="CoordTokenizers.CTT.load-795"><a href="#CoordTokenizers.CTT.load-795"><span class="linenos">795</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="CoordTokenizers.CTT.load-796"><a href="#CoordTokenizers.CTT.load-796"><span class="linenos">796</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="CoordTokenizers.CTT.load-797"><a href="#CoordTokenizers.CTT.load-797"><span class="linenos">797</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="CoordTokenizers.CTT.load-798"><a href="#CoordTokenizers.CTT.load-798"><span class="linenos">798</span></a>
</span><span id="CoordTokenizers.CTT.load-799"><a href="#CoordTokenizers.CTT.load-799"><span class="linenos">799</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="CoordTokenizers.CTT.load-800"><a href="#CoordTokenizers.CTT.load-800"><span class="linenos">800</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="CoordTokenizers.CTT.load-801"><a href="#CoordTokenizers.CTT.load-801"><span class="linenos">801</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="CoordTokenizers.CTT.load-802"><a href="#CoordTokenizers.CTT.load-802"><span class="linenos">802</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="CoordTokenizers.CTT.load-803"><a href="#CoordTokenizers.CTT.load-803"><span class="linenos">803</span></a>
</span><span id="CoordTokenizers.CTT.load-804"><a href="#CoordTokenizers.CTT.load-804"><span class="linenos">804</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="CoordTokenizers.CTT.load-805"><a href="#CoordTokenizers.CTT.load-805"><span class="linenos">805</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="CoordTokenizers.CTT.load-806"><a href="#CoordTokenizers.CTT.load-806"><span class="linenos">806</span></a>
</span><span id="CoordTokenizers.CTT.load-807"><a href="#CoordTokenizers.CTT.load-807"><span class="linenos">807</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="CoordTokenizers.CTT.load-808"><a href="#CoordTokenizers.CTT.load-808"><span class="linenos">808</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="CoordTokenizers.CTT.load-809"><a href="#CoordTokenizers.CTT.load-809"><span class="linenos">809</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="CoordTokenizers.CTT.load-810"><a href="#CoordTokenizers.CTT.load-810"><span class="linenos">810</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="CoordTokenizers.CTT.load-811"><a href="#CoordTokenizers.CTT.load-811"><span class="linenos">811</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="CoordTokenizers.CTT.load-812"><a href="#CoordTokenizers.CTT.load-812"><span class="linenos">812</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="CoordTokenizers.CTT.load-813"><a href="#CoordTokenizers.CTT.load-813"><span class="linenos">813</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="CoordTokenizers.CTT.load-814"><a href="#CoordTokenizers.CTT.load-814"><span class="linenos">814</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="CoordTokenizers.CTT.load-815"><a href="#CoordTokenizers.CTT.load-815"><span class="linenos">815</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="CoordTokenizers.CTT.load-816"><a href="#CoordTokenizers.CTT.load-816"><span class="linenos">816</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="CoordTokenizers.CTT.load-817"><a href="#CoordTokenizers.CTT.load-817"><span class="linenos">817</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="CoordTokenizers.CTT.load-818"><a href="#CoordTokenizers.CTT.load-818"><span class="linenos">818</span></a>                    <span class="p">):</span>
</span><span id="CoordTokenizers.CTT.load-819"><a href="#CoordTokenizers.CTT.load-819"><span class="linenos">819</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="CoordTokenizers.CTT.load-820"><a href="#CoordTokenizers.CTT.load-820"><span class="linenos">820</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="CoordTokenizers.CTT.load-821"><a href="#CoordTokenizers.CTT.load-821"><span class="linenos">821</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="CoordTokenizers.CTT.load-822"><a href="#CoordTokenizers.CTT.load-822"><span class="linenos">822</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="CoordTokenizers.CTT.load-823"><a href="#CoordTokenizers.CTT.load-823"><span class="linenos">823</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="CoordTokenizers.CTT.load-824"><a href="#CoordTokenizers.CTT.load-824"><span class="linenos">824</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="CoordTokenizers.CTT.load-825"><a href="#CoordTokenizers.CTT.load-825"><span class="linenos">825</span></a>                            <span class="p">)</span>
</span><span id="CoordTokenizers.CTT.load-826"><a href="#CoordTokenizers.CTT.load-826"><span class="linenos">826</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="CoordTokenizers.CTT.load-827"><a href="#CoordTokenizers.CTT.load-827"><span class="linenos">827</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="CoordTokenizers.CTT.load-828"><a href="#CoordTokenizers.CTT.load-828"><span class="linenos">828</span></a>                        <span class="k">pass</span>
</span><span id="CoordTokenizers.CTT.load-829"><a href="#CoordTokenizers.CTT.load-829"><span class="linenos">829</span></a>
</span><span id="CoordTokenizers.CTT.load-830"><a href="#CoordTokenizers.CTT.load-830"><span class="linenos">830</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="CoordTokenizers.CTT.load-831"><a href="#CoordTokenizers.CTT.load-831"><span class="linenos">831</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="CoordTokenizers.CTT.load-832"><a href="#CoordTokenizers.CTT.load-832"><span class="linenos">832</span></a>
</span><span id="CoordTokenizers.CTT.load-833"><a href="#CoordTokenizers.CTT.load-833"><span class="linenos">833</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="CoordTokenizers.CTT.load-834"><a href="#CoordTokenizers.CTT.load-834"><span class="linenos">834</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="CoordTokenizers.CTT.load-835"><a href="#CoordTokenizers.CTT.load-835"><span class="linenos">835</span></a>
</span><span id="CoordTokenizers.CTT.load-836"><a href="#CoordTokenizers.CTT.load-836"><span class="linenos">836</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="CoordTokenizers.CTT.load-837"><a href="#CoordTokenizers.CTT.load-837"><span class="linenos">837</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="CoordTokenizers.CTT.load-838"><a href="#CoordTokenizers.CTT.load-838"><span class="linenos">838</span></a>                <span class="n">fields_valid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="CoordTokenizers.CTT.load-839"><a href="#CoordTokenizers.CTT.load-839"><span class="linenos">839</span></a>                    <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="CoordTokenizers.CTT.load-840"><a href="#CoordTokenizers.CTT.load-840"><span class="linenos">840</span></a>                        <span class="n">output</span><span class="p">,</span>
</span><span id="CoordTokenizers.CTT.load-841"><a href="#CoordTokenizers.CTT.load-841"><span class="linenos">841</span></a>                        <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">,</span>
</span><span id="CoordTokenizers.CTT.load-842"><a href="#CoordTokenizers.CTT.load-842"><span class="linenos">842</span></a>                    <span class="p">)</span>
</span><span id="CoordTokenizers.CTT.load-843"><a href="#CoordTokenizers.CTT.load-843"><span class="linenos">843</span></a>                <span class="p">)</span>
</span><span id="CoordTokenizers.CTT.load-844"><a href="#CoordTokenizers.CTT.load-844"><span class="linenos">844</span></a>
</span><span id="CoordTokenizers.CTT.load-845"><a href="#CoordTokenizers.CTT.load-845"><span class="linenos">845</span></a>                <span class="c1"># if there are any fields that are not valid, raise an error</span>
</span><span id="CoordTokenizers.CTT.load-846"><a href="#CoordTokenizers.CTT.load-846"><span class="linenos">846</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">fields_valid</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="CoordTokenizers.CTT.load-847"><a href="#CoordTokenizers.CTT.load-847"><span class="linenos">847</span></a>                    <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="CoordTokenizers.CTT.load-848"><a href="#CoordTokenizers.CTT.load-848"><span class="linenos">848</span></a>                        <span class="sa">f</span><span class="s2">&quot;Type mismatch in fields of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="CoordTokenizers.CTT.load-849"><a href="#CoordTokenizers.CTT.load-849"><span class="linenos">849</span></a>                        <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="CoordTokenizers.CTT.load-850"><a href="#CoordTokenizers.CTT.load-850"><span class="linenos">850</span></a>                            <span class="p">[</span>
</span><span id="CoordTokenizers.CTT.load-851"><a href="#CoordTokenizers.CTT.load-851"><span class="linenos">851</span></a>                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">:</span><span class="se">\t</span><span class="s2">expected </span><span class="si">{</span><span class="n">cls_type_hints</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="si">= }</span><span class="s2">, but got value </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="CoordTokenizers.CTT.load-852"><a href="#CoordTokenizers.CTT.load-852"><span class="linenos">852</span></a>                                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">fields_valid</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="CoordTokenizers.CTT.load-853"><a href="#CoordTokenizers.CTT.load-853"><span class="linenos">853</span></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span>
</span><span id="CoordTokenizers.CTT.load-854"><a href="#CoordTokenizers.CTT.load-854"><span class="linenos">854</span></a>                            <span class="p">]</span>
</span><span id="CoordTokenizers.CTT.load-855"><a href="#CoordTokenizers.CTT.load-855"><span class="linenos">855</span></a>                        <span class="p">)</span>
</span><span id="CoordTokenizers.CTT.load-856"><a href="#CoordTokenizers.CTT.load-856"><span class="linenos">856</span></a>                    <span class="p">)</span>
</span><span id="CoordTokenizers.CTT.load-857"><a href="#CoordTokenizers.CTT.load-857"><span class="linenos">857</span></a>
</span><span id="CoordTokenizers.CTT.load-858"><a href="#CoordTokenizers.CTT.load-858"><span class="linenos">858</span></a>                    <span class="n">on_typecheck_mismatch</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
</span><span id="CoordTokenizers.CTT.load-859"><a href="#CoordTokenizers.CTT.load-859"><span class="linenos">859</span></a>                        <span class="n">msg</span><span class="p">,</span> <span class="n">except_cls</span><span class="o">=</span><span class="n">FieldTypeMismatchError</span>
</span><span id="CoordTokenizers.CTT.load-860"><a href="#CoordTokenizers.CTT.load-860"><span class="linenos">860</span></a>                    <span class="p">)</span>
</span><span id="CoordTokenizers.CTT.load-861"><a href="#CoordTokenizers.CTT.load-861"><span class="linenos">861</span></a>
</span><span id="CoordTokenizers.CTT.load-862"><a href="#CoordTokenizers.CTT.load-862"><span class="linenos">862</span></a>            <span class="c1"># return the new instance</span>
</span><span id="CoordTokenizers.CTT.load-863"><a href="#CoordTokenizers.CTT.load-863"><span class="linenos">863</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="CoordTokenizers.CTT.validate_fields_types" class="classattr">
                                        <input id="CoordTokenizers.CTT.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="CoordTokenizers.CTT.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L282-L291" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#CoordTokenizers.CTT.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoordTokenizers.CTT.validate_fields_types-283"><a href="#CoordTokenizers.CTT.validate_fields_types-283"><span class="linenos">283</span></a><span class="k">def</span><span class="w"> </span><span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="CoordTokenizers.CTT.validate_fields_types-284"><a href="#CoordTokenizers.CTT.validate_fields_types-284"><span class="linenos">284</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="CoordTokenizers.CTT.validate_fields_types-285"><a href="#CoordTokenizers.CTT.validate_fields_types-285"><span class="linenos">285</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="CoordTokenizers.CTT.validate_fields_types-286"><a href="#CoordTokenizers.CTT.validate_fields_types-286"><span class="linenos">286</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="CoordTokenizers.CTT.validate_fields_types-287"><a href="#CoordTokenizers.CTT.validate_fields_types-287"><span class="linenos">287</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="CoordTokenizers.CTT.validate_fields_types-288"><a href="#CoordTokenizers.CTT.validate_fields_types-288"><span class="linenos">288</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="CoordTokenizers.CTT.validate_fields_types-289"><a href="#CoordTokenizers.CTT.validate_fields_types-289"><span class="linenos">289</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="CoordTokenizers.CTT.validate_fields_types-290"><a href="#CoordTokenizers.CTT.validate_fields_types-290"><span class="linenos">290</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="CoordTokenizers.CTT.validate_fields_types-291"><a href="#CoordTokenizers.CTT.validate_fields_types-291"><span class="linenos">291</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="CoordTokenizers.CTT.validate_fields_types-292"><a href="#CoordTokenizers.CTT.validate_fields_types-292"><span class="linenos">292</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#CoordTokenizers._CoordTokenizer">CoordTokenizers._CoordTokenizer</a></dt>
                                <dd id="CoordTokenizers.CTT.attribute_key" class="function"><a href="#CoordTokenizers._CoordTokenizer.attribute_key">attribute_key</a></dd>
                <dd id="CoordTokenizers.CTT.is_valid" class="function"><a href="#CoordTokenizers._CoordTokenizer.is_valid">is_valid</a></dd>

            </div>
            <div><dt><a href="element_base.html#_TokenizerElement">maze_dataset.tokenization.modular.element_base._TokenizerElement</a></dt>
                                <dd id="CoordTokenizers.CTT.name" class="variable"><a href="element_base.html#_TokenizerElement.name">name</a></dd>
                <dd id="CoordTokenizers.CTT.tokenizer_elements" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="CoordTokenizers.CTT.tokenizer_element_tree" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="CoordTokenizers.CTT.tokenizer_element_dict" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="CoordTokenizers.CTT.validate_field_type" class="function">validate_field_type</dd>
                <dd id="CoordTokenizers.CTT.diff" class="function">diff</dd>
                <dd id="CoordTokenizers.CTT.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="EdgeGroupings">
                            <input id="EdgeGroupings-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">EdgeGroupings</span><wbr>(<span class="base"><a href="element_base.html#__TokenizerElementNamespace">maze_dataset.tokenization.modular.element_base.__TokenizerElementNamespace</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeGroupings-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L102-L210" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeGroupings"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeGroupings-103"><a href="#EdgeGroupings-103"><span class="linenos">103</span></a><span class="k">class</span><span class="w"> </span><span class="nc">EdgeGroupings</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="EdgeGroupings-104"><a href="#EdgeGroupings-104"><span class="linenos">104</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Namespace for `_EdgeGrouping` subclass hierarchy used by `_AdjListTokenizer`.&quot;&quot;&quot;</span>
</span><span id="EdgeGroupings-105"><a href="#EdgeGroupings-105"><span class="linenos">105</span></a>
</span><span id="EdgeGroupings-106"><a href="#EdgeGroupings-106"><span class="linenos">106</span></a>	<span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;edge_grouping&quot;</span>
</span><span id="EdgeGroupings-107"><a href="#EdgeGroupings-107"><span class="linenos">107</span></a>
</span><span id="EdgeGroupings-108"><a href="#EdgeGroupings-108"><span class="linenos">108</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">_GroupingTokenParams</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
</span><span id="EdgeGroupings-109"><a href="#EdgeGroupings-109"><span class="linenos">109</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;A uniform private hyperparameter interface used by `AdjListTokenizer`.&quot;&quot;&quot;</span>
</span><span id="EdgeGroupings-110"><a href="#EdgeGroupings-110"><span class="linenos">110</span></a>
</span><span id="EdgeGroupings-111"><a href="#EdgeGroupings-111"><span class="linenos">111</span></a>		<span class="n">connection_token_ordinal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</span><span id="EdgeGroupings-112"><a href="#EdgeGroupings-112"><span class="linenos">112</span></a>		<span class="n">intra</span><span class="p">:</span> <span class="nb">bool</span>
</span><span id="EdgeGroupings-113"><a href="#EdgeGroupings-113"><span class="linenos">113</span></a>		<span class="n">grouped</span><span class="p">:</span> <span class="nb">bool</span>
</span><span id="EdgeGroupings-114"><a href="#EdgeGroupings-114"><span class="linenos">114</span></a>
</span><span id="EdgeGroupings-115"><a href="#EdgeGroupings-115"><span class="linenos">115</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgeGroupings-116"><a href="#EdgeGroupings-116"><span class="linenos">116</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">_EdgeGrouping</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="EdgeGroupings-117"><a href="#EdgeGroupings-117"><span class="linenos">117</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Specifies if/how multiple coord-coord connections are grouped together in a token subsequence called a edge grouping.&quot;&quot;&quot;</span>
</span><span id="EdgeGroupings-118"><a href="#EdgeGroupings-118"><span class="linenos">118</span></a>
</span><span id="EdgeGroupings-119"><a href="#EdgeGroupings-119"><span class="linenos">119</span></a>		<span class="nd">@classmethod</span>
</span><span id="EdgeGroupings-120"><a href="#EdgeGroupings-120"><span class="linenos">120</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="EdgeGroupings-121"><a href="#EdgeGroupings-121"><span class="linenos">121</span></a>			<span class="k">return</span> <span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">key</span>
</span><span id="EdgeGroupings-122"><a href="#EdgeGroupings-122"><span class="linenos">122</span></a>
</span><span id="EdgeGroupings-123"><a href="#EdgeGroupings-123"><span class="linenos">123</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="EdgeGroupings-124"><a href="#EdgeGroupings-124"><span class="linenos">124</span></a>			<span class="k">return</span> <span class="kc">True</span>
</span><span id="EdgeGroupings-125"><a href="#EdgeGroupings-125"><span class="linenos">125</span></a>
</span><span id="EdgeGroupings-126"><a href="#EdgeGroupings-126"><span class="linenos">126</span></a>		<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="EdgeGroupings-127"><a href="#EdgeGroupings-127"><span class="linenos">127</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_group_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ConnectionArray</span><span class="p">]:</span>
</span><span id="EdgeGroupings-128"><a href="#EdgeGroupings-128"><span class="linenos">128</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Divides a ConnectionArray into groups of edges.</span>
</span><span id="EdgeGroupings-129"><a href="#EdgeGroupings-129"><span class="linenos">129</span></a>
</span><span id="EdgeGroupings-130"><a href="#EdgeGroupings-130"><span class="linenos">130</span></a><span class="sd">			Shuffles/sequences within each group if applicable.</span>
</span><span id="EdgeGroupings-131"><a href="#EdgeGroupings-131"><span class="linenos">131</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="EdgeGroupings-132"><a href="#EdgeGroupings-132"><span class="linenos">132</span></a>			<span class="k">pass</span>
</span><span id="EdgeGroupings-133"><a href="#EdgeGroupings-133"><span class="linenos">133</span></a>
</span><span id="EdgeGroupings-134"><a href="#EdgeGroupings-134"><span class="linenos">134</span></a>		<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="EdgeGroupings-135"><a href="#EdgeGroupings-135"><span class="linenos">135</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_token_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;EdgeGroupings._GroupingTokenParams&quot;</span><span class="p">:</span>
</span><span id="EdgeGroupings-136"><a href="#EdgeGroupings-136"><span class="linenos">136</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns the tok.nization hyperparameters necessary for an `AdjListTokenizer` to tokenize.</span>
</span><span id="EdgeGroupings-137"><a href="#EdgeGroupings-137"><span class="linenos">137</span></a>
</span><span id="EdgeGroupings-138"><a href="#EdgeGroupings-138"><span class="linenos">138</span></a><span class="sd">			These hyperparameters are not used by `_EdgeGrouping` internally.</span>
</span><span id="EdgeGroupings-139"><a href="#EdgeGroupings-139"><span class="linenos">139</span></a><span class="sd">			They are located in `_EdgeGrouping` rather than in `AdjListTokenizer`</span>
</span><span id="EdgeGroupings-140"><a href="#EdgeGroupings-140"><span class="linenos">140</span></a><span class="sd">			since the hyperparameter space is a function of the `_EdgeGrouping` subclass.</span>
</span><span id="EdgeGroupings-141"><a href="#EdgeGroupings-141"><span class="linenos">141</span></a><span class="sd">			This function resolves the `_EdgeGrouping` hyperparameter space which is non-uniform across subclasses</span>
</span><span id="EdgeGroupings-142"><a href="#EdgeGroupings-142"><span class="linenos">142</span></a><span class="sd">			into a uniform private interface used by `AdjListTokenizer`.</span>
</span><span id="EdgeGroupings-143"><a href="#EdgeGroupings-143"><span class="linenos">143</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="EdgeGroupings-144"><a href="#EdgeGroupings-144"><span class="linenos">144</span></a>			<span class="k">pass</span>
</span><span id="EdgeGroupings-145"><a href="#EdgeGroupings-145"><span class="linenos">145</span></a>
</span><span id="EdgeGroupings-146"><a href="#EdgeGroupings-146"><span class="linenos">146</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgeGroupings-147"><a href="#EdgeGroupings-147"><span class="linenos">147</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">Ungrouped</span><span class="p">(</span><span class="n">_EdgeGrouping</span><span class="p">):</span>
</span><span id="EdgeGroupings-148"><a href="#EdgeGroupings-148"><span class="linenos">148</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;No grouping occurs, each edge is tokenized individually.</span>
</span><span id="EdgeGroupings-149"><a href="#EdgeGroupings-149"><span class="linenos">149</span></a>
</span><span id="EdgeGroupings-150"><a href="#EdgeGroupings-150"><span class="linenos">150</span></a><span class="sd">		# Parameters</span>
</span><span id="EdgeGroupings-151"><a href="#EdgeGroupings-151"><span class="linenos">151</span></a><span class="sd">		- `connection_token_ordinal`: At which index in the edge tokenization the connector (or wall) token appears.</span>
</span><span id="EdgeGroupings-152"><a href="#EdgeGroupings-152"><span class="linenos">152</span></a><span class="sd">		Edge tokenizations contain 3 parts: a leading coord, a connector (or wall) token, and either a second coord or cardinal direction tokenization.</span>
</span><span id="EdgeGroupings-153"><a href="#EdgeGroupings-153"><span class="linenos">153</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="EdgeGroupings-154"><a href="#EdgeGroupings-154"><span class="linenos">154</span></a>
</span><span id="EdgeGroupings-155"><a href="#EdgeGroupings-155"><span class="linenos">155</span></a>		<span class="n">connection_token_ordinal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="EdgeGroupings-156"><a href="#EdgeGroupings-156"><span class="linenos">156</span></a>			<span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="EdgeGroupings-157"><a href="#EdgeGroupings-157"><span class="linenos">157</span></a>			<span class="n">assert_type</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="EdgeGroupings-158"><a href="#EdgeGroupings-158"><span class="linenos">158</span></a>		<span class="p">)</span>
</span><span id="EdgeGroupings-159"><a href="#EdgeGroupings-159"><span class="linenos">159</span></a>
</span><span id="EdgeGroupings-160"><a href="#EdgeGroupings-160"><span class="linenos">160</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_token_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;EdgeGroupings._GroupingTokenParams&quot;</span><span class="p">:</span>
</span><span id="EdgeGroupings-161"><a href="#EdgeGroupings-161"><span class="linenos">161</span></a>			<span class="k">return</span> <span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">_GroupingTokenParams</span><span class="p">(</span>
</span><span id="EdgeGroupings-162"><a href="#EdgeGroupings-162"><span class="linenos">162</span></a>				<span class="n">connection_token_ordinal</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">connection_token_ordinal</span><span class="p">,</span>
</span><span id="EdgeGroupings-163"><a href="#EdgeGroupings-163"><span class="linenos">163</span></a>				<span class="n">intra</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="EdgeGroupings-164"><a href="#EdgeGroupings-164"><span class="linenos">164</span></a>				<span class="n">grouped</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="EdgeGroupings-165"><a href="#EdgeGroupings-165"><span class="linenos">165</span></a>			<span class="p">)</span>
</span><span id="EdgeGroupings-166"><a href="#EdgeGroupings-166"><span class="linenos">166</span></a>
</span><span id="EdgeGroupings-167"><a href="#EdgeGroupings-167"><span class="linenos">167</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_group_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionList</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ConnectionList</span><span class="p">]:</span>
</span><span id="EdgeGroupings-168"><a href="#EdgeGroupings-168"><span class="linenos">168</span></a>			<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="EdgeGroupings-169"><a href="#EdgeGroupings-169"><span class="linenos">169</span></a>
</span><span id="EdgeGroupings-170"><a href="#EdgeGroupings-170"><span class="linenos">170</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgeGroupings-171"><a href="#EdgeGroupings-171"><span class="linenos">171</span></a>	<span class="nd">@mark_as_unsupported</span><span class="p">(</span><span class="n">_unsupported_is_invalid</span><span class="p">)</span>
</span><span id="EdgeGroupings-172"><a href="#EdgeGroupings-172"><span class="linenos">172</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">ByLeadingCoord</span><span class="p">(</span><span class="n">_EdgeGrouping</span><span class="p">):</span>
</span><span id="EdgeGroupings-173"><a href="#EdgeGroupings-173"><span class="linenos">173</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;All edges with the same leading coord are grouped together.</span>
</span><span id="EdgeGroupings-174"><a href="#EdgeGroupings-174"><span class="linenos">174</span></a>
</span><span id="EdgeGroupings-175"><a href="#EdgeGroupings-175"><span class="linenos">175</span></a><span class="sd">		# Parameters</span>
</span><span id="EdgeGroupings-176"><a href="#EdgeGroupings-176"><span class="linenos">176</span></a><span class="sd">		- `intra`: Whether all edge groupings include a delimiter token between individual edge representations.</span>
</span><span id="EdgeGroupings-177"><a href="#EdgeGroupings-177"><span class="linenos">177</span></a><span class="sd">		Note that each edge representation will already always include a connector token (`VOCAB.CONNECTOR`, or possibly `)</span>
</span><span id="EdgeGroupings-178"><a href="#EdgeGroupings-178"><span class="linenos">178</span></a><span class="sd">		- `shuffle_group`: Whether the sequence of edges within the group should be shuffled or appear in a fixed order.</span>
</span><span id="EdgeGroupings-179"><a href="#EdgeGroupings-179"><span class="linenos">179</span></a><span class="sd">		If false, the fixed order is lexicographical by (row, col).</span>
</span><span id="EdgeGroupings-180"><a href="#EdgeGroupings-180"><span class="linenos">180</span></a><span class="sd">		In effect, lexicographical sorting sorts edges by their cardinal direction in the sequence NORTH, WEST, EAST, SOUTH, where the directions indicate the position of the trailing coord relative to the leading coord.</span>
</span><span id="EdgeGroupings-181"><a href="#EdgeGroupings-181"><span class="linenos">181</span></a><span class="sd">		- `connection_token_ordinal`: At which index in token sequence representing a single edge the connector (or wall) token appears.</span>
</span><span id="EdgeGroupings-182"><a href="#EdgeGroupings-182"><span class="linenos">182</span></a><span class="sd">		Edge tokenizations contain 2 parts: a connector (or wall) token and a coord or cardinal tokenization.</span>
</span><span id="EdgeGroupings-183"><a href="#EdgeGroupings-183"><span class="linenos">183</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="EdgeGroupings-184"><a href="#EdgeGroupings-184"><span class="linenos">184</span></a>
</span><span id="EdgeGroupings-185"><a href="#EdgeGroupings-185"><span class="linenos">185</span></a>		<span class="n">intra</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgeGroupings-186"><a href="#EdgeGroupings-186"><span class="linenos">186</span></a>		<span class="n">shuffle_group</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgeGroupings-187"><a href="#EdgeGroupings-187"><span class="linenos">187</span></a>		<span class="n">connection_token_ordinal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="EdgeGroupings-188"><a href="#EdgeGroupings-188"><span class="linenos">188</span></a>			<span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="EdgeGroupings-189"><a href="#EdgeGroupings-189"><span class="linenos">189</span></a>			<span class="n">assert_type</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="EdgeGroupings-190"><a href="#EdgeGroupings-190"><span class="linenos">190</span></a>		<span class="p">)</span>
</span><span id="EdgeGroupings-191"><a href="#EdgeGroupings-191"><span class="linenos">191</span></a>
</span><span id="EdgeGroupings-192"><a href="#EdgeGroupings-192"><span class="linenos">192</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_token_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;EdgeGroupings._GroupingTokenParams&quot;</span><span class="p">:</span>
</span><span id="EdgeGroupings-193"><a href="#EdgeGroupings-193"><span class="linenos">193</span></a>			<span class="k">return</span> <span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">_GroupingTokenParams</span><span class="p">(</span>
</span><span id="EdgeGroupings-194"><a href="#EdgeGroupings-194"><span class="linenos">194</span></a>				<span class="n">connection_token_ordinal</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">connection_token_ordinal</span><span class="p">,</span>
</span><span id="EdgeGroupings-195"><a href="#EdgeGroupings-195"><span class="linenos">195</span></a>				<span class="n">intra</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">intra</span><span class="p">,</span>
</span><span id="EdgeGroupings-196"><a href="#EdgeGroupings-196"><span class="linenos">196</span></a>				<span class="n">grouped</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="EdgeGroupings-197"><a href="#EdgeGroupings-197"><span class="linenos">197</span></a>			<span class="p">)</span>
</span><span id="EdgeGroupings-198"><a href="#EdgeGroupings-198"><span class="linenos">198</span></a>
</span><span id="EdgeGroupings-199"><a href="#EdgeGroupings-199"><span class="linenos">199</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_group_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ConnectionArray</span><span class="p">]:</span>
</span><span id="EdgeGroupings-200"><a href="#EdgeGroupings-200"><span class="linenos">200</span></a>			<span class="c1"># Adapted from: https://stackoverflow.com/questions/38013778/is-there-any-numpy-group-by-function</span>
</span><span id="EdgeGroupings-201"><a href="#EdgeGroupings-201"><span class="linenos">201</span></a>			<span class="n">index_array</span><span class="p">:</span> <span class="n">Int</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;sort_indices=edges&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">lexsort</span><span class="p">(</span>
</span><span id="EdgeGroupings-202"><a href="#EdgeGroupings-202"><span class="linenos">202</span></a>				<span class="p">(</span><span class="n">edges</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">edges</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
</span><span id="EdgeGroupings-203"><a href="#EdgeGroupings-203"><span class="linenos">203</span></a>			<span class="p">)</span>
</span><span id="EdgeGroupings-204"><a href="#EdgeGroupings-204"><span class="linenos">204</span></a>			<span class="n">sorted_edges</span><span class="p">:</span> <span class="n">ConnectionArray</span> <span class="o">=</span> <span class="n">edges</span><span class="p">[</span><span class="n">index_array</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span><span id="EdgeGroupings-205"><a href="#EdgeGroupings-205"><span class="linenos">205</span></a>			<span class="n">groups</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ConnectionArray</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span>
</span><span id="EdgeGroupings-206"><a href="#EdgeGroupings-206"><span class="linenos">206</span></a>				<span class="n">sorted_edges</span><span class="p">,</span>
</span><span id="EdgeGroupings-207"><a href="#EdgeGroupings-207"><span class="linenos">207</span></a>				<span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">sorted_edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span>
</span><span id="EdgeGroupings-208"><a href="#EdgeGroupings-208"><span class="linenos">208</span></a>			<span class="p">)</span>
</span><span id="EdgeGroupings-209"><a href="#EdgeGroupings-209"><span class="linenos">209</span></a>			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shuffle_group</span><span class="p">:</span>
</span><span id="EdgeGroupings-210"><a href="#EdgeGroupings-210"><span class="linenos">210</span></a>				<span class="p">[</span><span class="n">_NUMPY_RNG</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">]</span>
</span><span id="EdgeGroupings-211"><a href="#EdgeGroupings-211"><span class="linenos">211</span></a>			<span class="k">return</span> <span class="n">groups</span>
</span></pre></div>


            <div class="docstring"><p>Namespace for <code>_EdgeGrouping</code> subclass hierarchy used by <code>_AdjListTokenizer</code>.</p>
</div>


                            <div id="EdgeGroupings.key" class="classattr">
                                <div class="attr variable">
            <span class="name">key</span>        =
<span class="default_value">&#39;edge_grouping&#39;</span>

        
    </div>
    <a class="headerlink" href="#EdgeGroupings.key"></a>
    
    

                            </div>
                </section>
                <section id="EdgeGroupings.Ungrouped">
                            <input id="EdgeGroupings.Ungrouped-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">EdgeGroupings.Ungrouped</span><wbr>(<span class="base"><a href="#EdgeGroupings._EdgeGrouping">EdgeGroupings._EdgeGrouping</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeGroupings.Ungrouped-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L145-L167" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeGroupings.Ungrouped"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeGroupings.Ungrouped-146"><a href="#EdgeGroupings.Ungrouped-146"><span class="linenos">146</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped-147"><a href="#EdgeGroupings.Ungrouped-147"><span class="linenos">147</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">Ungrouped</span><span class="p">(</span><span class="n">_EdgeGrouping</span><span class="p">):</span>
</span><span id="EdgeGroupings.Ungrouped-148"><a href="#EdgeGroupings.Ungrouped-148"><span class="linenos">148</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;No grouping occurs, each edge is tokenized individually.</span>
</span><span id="EdgeGroupings.Ungrouped-149"><a href="#EdgeGroupings.Ungrouped-149"><span class="linenos">149</span></a>
</span><span id="EdgeGroupings.Ungrouped-150"><a href="#EdgeGroupings.Ungrouped-150"><span class="linenos">150</span></a><span class="sd">		# Parameters</span>
</span><span id="EdgeGroupings.Ungrouped-151"><a href="#EdgeGroupings.Ungrouped-151"><span class="linenos">151</span></a><span class="sd">		- `connection_token_ordinal`: At which index in the edge tokenization the connector (or wall) token appears.</span>
</span><span id="EdgeGroupings.Ungrouped-152"><a href="#EdgeGroupings.Ungrouped-152"><span class="linenos">152</span></a><span class="sd">		Edge tokenizations contain 3 parts: a leading coord, a connector (or wall) token, and either a second coord or cardinal direction tokenization.</span>
</span><span id="EdgeGroupings.Ungrouped-153"><a href="#EdgeGroupings.Ungrouped-153"><span class="linenos">153</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="EdgeGroupings.Ungrouped-154"><a href="#EdgeGroupings.Ungrouped-154"><span class="linenos">154</span></a>
</span><span id="EdgeGroupings.Ungrouped-155"><a href="#EdgeGroupings.Ungrouped-155"><span class="linenos">155</span></a>		<span class="n">connection_token_ordinal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="EdgeGroupings.Ungrouped-156"><a href="#EdgeGroupings.Ungrouped-156"><span class="linenos">156</span></a>			<span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="EdgeGroupings.Ungrouped-157"><a href="#EdgeGroupings.Ungrouped-157"><span class="linenos">157</span></a>			<span class="n">assert_type</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="EdgeGroupings.Ungrouped-158"><a href="#EdgeGroupings.Ungrouped-158"><span class="linenos">158</span></a>		<span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped-159"><a href="#EdgeGroupings.Ungrouped-159"><span class="linenos">159</span></a>
</span><span id="EdgeGroupings.Ungrouped-160"><a href="#EdgeGroupings.Ungrouped-160"><span class="linenos">160</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_token_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;EdgeGroupings._GroupingTokenParams&quot;</span><span class="p">:</span>
</span><span id="EdgeGroupings.Ungrouped-161"><a href="#EdgeGroupings.Ungrouped-161"><span class="linenos">161</span></a>			<span class="k">return</span> <span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">_GroupingTokenParams</span><span class="p">(</span>
</span><span id="EdgeGroupings.Ungrouped-162"><a href="#EdgeGroupings.Ungrouped-162"><span class="linenos">162</span></a>				<span class="n">connection_token_ordinal</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">connection_token_ordinal</span><span class="p">,</span>
</span><span id="EdgeGroupings.Ungrouped-163"><a href="#EdgeGroupings.Ungrouped-163"><span class="linenos">163</span></a>				<span class="n">intra</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="EdgeGroupings.Ungrouped-164"><a href="#EdgeGroupings.Ungrouped-164"><span class="linenos">164</span></a>				<span class="n">grouped</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="EdgeGroupings.Ungrouped-165"><a href="#EdgeGroupings.Ungrouped-165"><span class="linenos">165</span></a>			<span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped-166"><a href="#EdgeGroupings.Ungrouped-166"><span class="linenos">166</span></a>
</span><span id="EdgeGroupings.Ungrouped-167"><a href="#EdgeGroupings.Ungrouped-167"><span class="linenos">167</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_group_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionList</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ConnectionList</span><span class="p">]:</span>
</span><span id="EdgeGroupings.Ungrouped-168"><a href="#EdgeGroupings.Ungrouped-168"><span class="linenos">168</span></a>			<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>No grouping occurs, each edge is tokenized individually.</p>

<h1 id="parameters">Parameters</h1>

<ul>
<li><code><a href="#EdgeGroupings.Ungrouped.connection_token_ordinal">connection_token_ordinal</a></code>: At which index in the edge tokenization the connector (or wall) token appears.
Edge tokenizations contain 3 parts: a leading coord, a connector (or wall) token, and either a second coord or cardinal direction tokenization.</li>
</ul>
</div>


                            <div id="EdgeGroupings.Ungrouped.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">EdgeGroupings.Ungrouped</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#EdgeGroupings.Ungrouped">EdgeGroupings.Ungrouped</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#EdgeGroupings.Ungrouped">EdgeGroupings.Ungrouped</a>&#39;&gt;&quot;</span>,</span><span class="param">	<span class="n">connection_token_ordinal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#EdgeGroupings.Ungrouped.__init__"></a>
    
    

                            </div>
                            <div id="EdgeGroupings.Ungrouped.connection_token_ordinal" class="classattr">
                                <div class="attr variable">
            <span class="name">connection_token_ordinal</span><span class="annotation">: Literal[0, 1, 2]</span>        =
<span class="default_value">1</span>

        
    </div>
    <a class="headerlink" href="#EdgeGroupings.Ungrouped.connection_token_ordinal"></a>
    
    

                            </div>
                            <div id="EdgeGroupings.Ungrouped.serialize" class="classattr">
                                        <input id="EdgeGroupings.Ungrouped.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeGroupings.Ungrouped.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L713-L769" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeGroupings.Ungrouped.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeGroupings.Ungrouped.serialize-714"><a href="#EdgeGroupings.Ungrouped.serialize-714"><span class="linenos">714</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-715"><a href="#EdgeGroupings.Ungrouped.serialize-715"><span class="linenos">715</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-716"><a href="#EdgeGroupings.Ungrouped.serialize-716"><span class="linenos">716</span></a>                <span class="n">_FORMAT_KEY</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-717"><a href="#EdgeGroupings.Ungrouped.serialize-717"><span class="linenos">717</span></a>            <span class="p">}</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-718"><a href="#EdgeGroupings.Ungrouped.serialize-718"><span class="linenos">718</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-719"><a href="#EdgeGroupings.Ungrouped.serialize-719"><span class="linenos">719</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-720"><a href="#EdgeGroupings.Ungrouped.serialize-720"><span class="linenos">720</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-721"><a href="#EdgeGroupings.Ungrouped.serialize-721"><span class="linenos">721</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-722"><a href="#EdgeGroupings.Ungrouped.serialize-722"><span class="linenos">722</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-723"><a href="#EdgeGroupings.Ungrouped.serialize-723"><span class="linenos">723</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-724"><a href="#EdgeGroupings.Ungrouped.serialize-724"><span class="linenos">724</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-725"><a href="#EdgeGroupings.Ungrouped.serialize-725"><span class="linenos">725</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-726"><a href="#EdgeGroupings.Ungrouped.serialize-726"><span class="linenos">726</span></a>                    <span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-727"><a href="#EdgeGroupings.Ungrouped.serialize-727"><span class="linenos">727</span></a>
</span><span id="EdgeGroupings.Ungrouped.serialize-728"><a href="#EdgeGroupings.Ungrouped.serialize-728"><span class="linenos">728</span></a>                <span class="c1"># try to save it</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-729"><a href="#EdgeGroupings.Ungrouped.serialize-729"><span class="linenos">729</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-730"><a href="#EdgeGroupings.Ungrouped.serialize-730"><span class="linenos">730</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-731"><a href="#EdgeGroupings.Ungrouped.serialize-731"><span class="linenos">731</span></a>                        <span class="c1"># get the val</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-732"><a href="#EdgeGroupings.Ungrouped.serialize-732"><span class="linenos">732</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-733"><a href="#EdgeGroupings.Ungrouped.serialize-733"><span class="linenos">733</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-734"><a href="#EdgeGroupings.Ungrouped.serialize-734"><span class="linenos">734</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-735"><a href="#EdgeGroupings.Ungrouped.serialize-735"><span class="linenos">735</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-736"><a href="#EdgeGroupings.Ungrouped.serialize-736"><span class="linenos">736</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-737"><a href="#EdgeGroupings.Ungrouped.serialize-737"><span class="linenos">737</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-738"><a href="#EdgeGroupings.Ungrouped.serialize-738"><span class="linenos">738</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-739"><a href="#EdgeGroupings.Ungrouped.serialize-739"><span class="linenos">739</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-740"><a href="#EdgeGroupings.Ungrouped.serialize-740"><span class="linenos">740</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-741"><a href="#EdgeGroupings.Ungrouped.serialize-741"><span class="linenos">741</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-742"><a href="#EdgeGroupings.Ungrouped.serialize-742"><span class="linenos">742</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-743"><a href="#EdgeGroupings.Ungrouped.serialize-743"><span class="linenos">743</span></a>
</span><span id="EdgeGroupings.Ungrouped.serialize-744"><a href="#EdgeGroupings.Ungrouped.serialize-744"><span class="linenos">744</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-745"><a href="#EdgeGroupings.Ungrouped.serialize-745"><span class="linenos">745</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-746"><a href="#EdgeGroupings.Ungrouped.serialize-746"><span class="linenos">746</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-747"><a href="#EdgeGroupings.Ungrouped.serialize-747"><span class="linenos">747</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-748"><a href="#EdgeGroupings.Ungrouped.serialize-748"><span class="linenos">748</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-749"><a href="#EdgeGroupings.Ungrouped.serialize-749"><span class="linenos">749</span></a>                                <span class="p">[</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-750"><a href="#EdgeGroupings.Ungrouped.serialize-750"><span class="linenos">750</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-751"><a href="#EdgeGroupings.Ungrouped.serialize-751"><span class="linenos">751</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-752"><a href="#EdgeGroupings.Ungrouped.serialize-752"><span class="linenos">752</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-753"><a href="#EdgeGroupings.Ungrouped.serialize-753"><span class="linenos">753</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-754"><a href="#EdgeGroupings.Ungrouped.serialize-754"><span class="linenos">754</span></a>                                <span class="p">]</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-755"><a href="#EdgeGroupings.Ungrouped.serialize-755"><span class="linenos">755</span></a>                            <span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-756"><a href="#EdgeGroupings.Ungrouped.serialize-756"><span class="linenos">756</span></a>                        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-757"><a href="#EdgeGroupings.Ungrouped.serialize-757"><span class="linenos">757</span></a>
</span><span id="EdgeGroupings.Ungrouped.serialize-758"><a href="#EdgeGroupings.Ungrouped.serialize-758"><span class="linenos">758</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-759"><a href="#EdgeGroupings.Ungrouped.serialize-759"><span class="linenos">759</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-760"><a href="#EdgeGroupings.Ungrouped.serialize-760"><span class="linenos">760</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-761"><a href="#EdgeGroupings.Ungrouped.serialize-761"><span class="linenos">761</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-762"><a href="#EdgeGroupings.Ungrouped.serialize-762"><span class="linenos">762</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-763"><a href="#EdgeGroupings.Ungrouped.serialize-763"><span class="linenos">763</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-764"><a href="#EdgeGroupings.Ungrouped.serialize-764"><span class="linenos">764</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-765"><a href="#EdgeGroupings.Ungrouped.serialize-765"><span class="linenos">765</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-766"><a href="#EdgeGroupings.Ungrouped.serialize-766"><span class="linenos">766</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-767"><a href="#EdgeGroupings.Ungrouped.serialize-767"><span class="linenos">767</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-768"><a href="#EdgeGroupings.Ungrouped.serialize-768"><span class="linenos">768</span></a>                    <span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-769"><a href="#EdgeGroupings.Ungrouped.serialize-769"><span class="linenos">769</span></a>
</span><span id="EdgeGroupings.Ungrouped.serialize-770"><a href="#EdgeGroupings.Ungrouped.serialize-770"><span class="linenos">770</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="EdgeGroupings.Ungrouped.load" class="classattr">
                                        <input id="EdgeGroupings.Ungrouped.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeGroupings.Ungrouped.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L776-L862" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeGroupings.Ungrouped.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeGroupings.Ungrouped.load-777"><a href="#EdgeGroupings.Ungrouped.load-777"><span class="linenos">777</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="EdgeGroupings.Ungrouped.load-778"><a href="#EdgeGroupings.Ungrouped.load-778"><span class="linenos">778</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="EdgeGroupings.Ungrouped.load-779"><a href="#EdgeGroupings.Ungrouped.load-779"><span class="linenos">779</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="EdgeGroupings.Ungrouped.load-780"><a href="#EdgeGroupings.Ungrouped.load-780"><span class="linenos">780</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="EdgeGroupings.Ungrouped.load-781"><a href="#EdgeGroupings.Ungrouped.load-781"><span class="linenos">781</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="EdgeGroupings.Ungrouped.load-782"><a href="#EdgeGroupings.Ungrouped.load-782"><span class="linenos">782</span></a>
</span><span id="EdgeGroupings.Ungrouped.load-783"><a href="#EdgeGroupings.Ungrouped.load-783"><span class="linenos">783</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="EdgeGroupings.Ungrouped.load-784"><a href="#EdgeGroupings.Ungrouped.load-784"><span class="linenos">784</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="EdgeGroupings.Ungrouped.load-785"><a href="#EdgeGroupings.Ungrouped.load-785"><span class="linenos">785</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeGroupings.Ungrouped.load-786"><a href="#EdgeGroupings.Ungrouped.load-786"><span class="linenos">786</span></a>
</span><span id="EdgeGroupings.Ungrouped.load-787"><a href="#EdgeGroupings.Ungrouped.load-787"><span class="linenos">787</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.load-788"><a href="#EdgeGroupings.Ungrouped.load-788"><span class="linenos">788</span></a>
</span><span id="EdgeGroupings.Ungrouped.load-789"><a href="#EdgeGroupings.Ungrouped.load-789"><span class="linenos">789</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="EdgeGroupings.Ungrouped.load-790"><a href="#EdgeGroupings.Ungrouped.load-790"><span class="linenos">790</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="EdgeGroupings.Ungrouped.load-791"><a href="#EdgeGroupings.Ungrouped.load-791"><span class="linenos">791</span></a>
</span><span id="EdgeGroupings.Ungrouped.load-792"><a href="#EdgeGroupings.Ungrouped.load-792"><span class="linenos">792</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="EdgeGroupings.Ungrouped.load-793"><a href="#EdgeGroupings.Ungrouped.load-793"><span class="linenos">793</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="EdgeGroupings.Ungrouped.load-794"><a href="#EdgeGroupings.Ungrouped.load-794"><span class="linenos">794</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="EdgeGroupings.Ungrouped.load-795"><a href="#EdgeGroupings.Ungrouped.load-795"><span class="linenos">795</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="EdgeGroupings.Ungrouped.load-796"><a href="#EdgeGroupings.Ungrouped.load-796"><span class="linenos">796</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="EdgeGroupings.Ungrouped.load-797"><a href="#EdgeGroupings.Ungrouped.load-797"><span class="linenos">797</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="EdgeGroupings.Ungrouped.load-798"><a href="#EdgeGroupings.Ungrouped.load-798"><span class="linenos">798</span></a>
</span><span id="EdgeGroupings.Ungrouped.load-799"><a href="#EdgeGroupings.Ungrouped.load-799"><span class="linenos">799</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="EdgeGroupings.Ungrouped.load-800"><a href="#EdgeGroupings.Ungrouped.load-800"><span class="linenos">800</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="EdgeGroupings.Ungrouped.load-801"><a href="#EdgeGroupings.Ungrouped.load-801"><span class="linenos">801</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="EdgeGroupings.Ungrouped.load-802"><a href="#EdgeGroupings.Ungrouped.load-802"><span class="linenos">802</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="EdgeGroupings.Ungrouped.load-803"><a href="#EdgeGroupings.Ungrouped.load-803"><span class="linenos">803</span></a>
</span><span id="EdgeGroupings.Ungrouped.load-804"><a href="#EdgeGroupings.Ungrouped.load-804"><span class="linenos">804</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="EdgeGroupings.Ungrouped.load-805"><a href="#EdgeGroupings.Ungrouped.load-805"><span class="linenos">805</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.load-806"><a href="#EdgeGroupings.Ungrouped.load-806"><span class="linenos">806</span></a>
</span><span id="EdgeGroupings.Ungrouped.load-807"><a href="#EdgeGroupings.Ungrouped.load-807"><span class="linenos">807</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="EdgeGroupings.Ungrouped.load-808"><a href="#EdgeGroupings.Ungrouped.load-808"><span class="linenos">808</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="EdgeGroupings.Ungrouped.load-809"><a href="#EdgeGroupings.Ungrouped.load-809"><span class="linenos">809</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="EdgeGroupings.Ungrouped.load-810"><a href="#EdgeGroupings.Ungrouped.load-810"><span class="linenos">810</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.load-811"><a href="#EdgeGroupings.Ungrouped.load-811"><span class="linenos">811</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="EdgeGroupings.Ungrouped.load-812"><a href="#EdgeGroupings.Ungrouped.load-812"><span class="linenos">812</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="EdgeGroupings.Ungrouped.load-813"><a href="#EdgeGroupings.Ungrouped.load-813"><span class="linenos">813</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.load-814"><a href="#EdgeGroupings.Ungrouped.load-814"><span class="linenos">814</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="EdgeGroupings.Ungrouped.load-815"><a href="#EdgeGroupings.Ungrouped.load-815"><span class="linenos">815</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="EdgeGroupings.Ungrouped.load-816"><a href="#EdgeGroupings.Ungrouped.load-816"><span class="linenos">816</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.load-817"><a href="#EdgeGroupings.Ungrouped.load-817"><span class="linenos">817</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.load-818"><a href="#EdgeGroupings.Ungrouped.load-818"><span class="linenos">818</span></a>                    <span class="p">):</span>
</span><span id="EdgeGroupings.Ungrouped.load-819"><a href="#EdgeGroupings.Ungrouped.load-819"><span class="linenos">819</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="EdgeGroupings.Ungrouped.load-820"><a href="#EdgeGroupings.Ungrouped.load-820"><span class="linenos">820</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="EdgeGroupings.Ungrouped.load-821"><a href="#EdgeGroupings.Ungrouped.load-821"><span class="linenos">821</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.load-822"><a href="#EdgeGroupings.Ungrouped.load-822"><span class="linenos">822</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="EdgeGroupings.Ungrouped.load-823"><a href="#EdgeGroupings.Ungrouped.load-823"><span class="linenos">823</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="EdgeGroupings.Ungrouped.load-824"><a href="#EdgeGroupings.Ungrouped.load-824"><span class="linenos">824</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeGroupings.Ungrouped.load-825"><a href="#EdgeGroupings.Ungrouped.load-825"><span class="linenos">825</span></a>                            <span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.load-826"><a href="#EdgeGroupings.Ungrouped.load-826"><span class="linenos">826</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="EdgeGroupings.Ungrouped.load-827"><a href="#EdgeGroupings.Ungrouped.load-827"><span class="linenos">827</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="EdgeGroupings.Ungrouped.load-828"><a href="#EdgeGroupings.Ungrouped.load-828"><span class="linenos">828</span></a>                        <span class="k">pass</span>
</span><span id="EdgeGroupings.Ungrouped.load-829"><a href="#EdgeGroupings.Ungrouped.load-829"><span class="linenos">829</span></a>
</span><span id="EdgeGroupings.Ungrouped.load-830"><a href="#EdgeGroupings.Ungrouped.load-830"><span class="linenos">830</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="EdgeGroupings.Ungrouped.load-831"><a href="#EdgeGroupings.Ungrouped.load-831"><span class="linenos">831</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgeGroupings.Ungrouped.load-832"><a href="#EdgeGroupings.Ungrouped.load-832"><span class="linenos">832</span></a>
</span><span id="EdgeGroupings.Ungrouped.load-833"><a href="#EdgeGroupings.Ungrouped.load-833"><span class="linenos">833</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="EdgeGroupings.Ungrouped.load-834"><a href="#EdgeGroupings.Ungrouped.load-834"><span class="linenos">834</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.load-835"><a href="#EdgeGroupings.Ungrouped.load-835"><span class="linenos">835</span></a>
</span><span id="EdgeGroupings.Ungrouped.load-836"><a href="#EdgeGroupings.Ungrouped.load-836"><span class="linenos">836</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="EdgeGroupings.Ungrouped.load-837"><a href="#EdgeGroupings.Ungrouped.load-837"><span class="linenos">837</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="EdgeGroupings.Ungrouped.load-838"><a href="#EdgeGroupings.Ungrouped.load-838"><span class="linenos">838</span></a>                <span class="n">fields_valid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="EdgeGroupings.Ungrouped.load-839"><a href="#EdgeGroupings.Ungrouped.load-839"><span class="linenos">839</span></a>                    <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="EdgeGroupings.Ungrouped.load-840"><a href="#EdgeGroupings.Ungrouped.load-840"><span class="linenos">840</span></a>                        <span class="n">output</span><span class="p">,</span>
</span><span id="EdgeGroupings.Ungrouped.load-841"><a href="#EdgeGroupings.Ungrouped.load-841"><span class="linenos">841</span></a>                        <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">,</span>
</span><span id="EdgeGroupings.Ungrouped.load-842"><a href="#EdgeGroupings.Ungrouped.load-842"><span class="linenos">842</span></a>                    <span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.load-843"><a href="#EdgeGroupings.Ungrouped.load-843"><span class="linenos">843</span></a>                <span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.load-844"><a href="#EdgeGroupings.Ungrouped.load-844"><span class="linenos">844</span></a>
</span><span id="EdgeGroupings.Ungrouped.load-845"><a href="#EdgeGroupings.Ungrouped.load-845"><span class="linenos">845</span></a>                <span class="c1"># if there are any fields that are not valid, raise an error</span>
</span><span id="EdgeGroupings.Ungrouped.load-846"><a href="#EdgeGroupings.Ungrouped.load-846"><span class="linenos">846</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">fields_valid</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="EdgeGroupings.Ungrouped.load-847"><a href="#EdgeGroupings.Ungrouped.load-847"><span class="linenos">847</span></a>                    <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="EdgeGroupings.Ungrouped.load-848"><a href="#EdgeGroupings.Ungrouped.load-848"><span class="linenos">848</span></a>                        <span class="sa">f</span><span class="s2">&quot;Type mismatch in fields of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="EdgeGroupings.Ungrouped.load-849"><a href="#EdgeGroupings.Ungrouped.load-849"><span class="linenos">849</span></a>                        <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="EdgeGroupings.Ungrouped.load-850"><a href="#EdgeGroupings.Ungrouped.load-850"><span class="linenos">850</span></a>                            <span class="p">[</span>
</span><span id="EdgeGroupings.Ungrouped.load-851"><a href="#EdgeGroupings.Ungrouped.load-851"><span class="linenos">851</span></a>                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">:</span><span class="se">\t</span><span class="s2">expected </span><span class="si">{</span><span class="n">cls_type_hints</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="si">= }</span><span class="s2">, but got value </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeGroupings.Ungrouped.load-852"><a href="#EdgeGroupings.Ungrouped.load-852"><span class="linenos">852</span></a>                                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">fields_valid</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="EdgeGroupings.Ungrouped.load-853"><a href="#EdgeGroupings.Ungrouped.load-853"><span class="linenos">853</span></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span>
</span><span id="EdgeGroupings.Ungrouped.load-854"><a href="#EdgeGroupings.Ungrouped.load-854"><span class="linenos">854</span></a>                            <span class="p">]</span>
</span><span id="EdgeGroupings.Ungrouped.load-855"><a href="#EdgeGroupings.Ungrouped.load-855"><span class="linenos">855</span></a>                        <span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.load-856"><a href="#EdgeGroupings.Ungrouped.load-856"><span class="linenos">856</span></a>                    <span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.load-857"><a href="#EdgeGroupings.Ungrouped.load-857"><span class="linenos">857</span></a>
</span><span id="EdgeGroupings.Ungrouped.load-858"><a href="#EdgeGroupings.Ungrouped.load-858"><span class="linenos">858</span></a>                    <span class="n">on_typecheck_mismatch</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
</span><span id="EdgeGroupings.Ungrouped.load-859"><a href="#EdgeGroupings.Ungrouped.load-859"><span class="linenos">859</span></a>                        <span class="n">msg</span><span class="p">,</span> <span class="n">except_cls</span><span class="o">=</span><span class="n">FieldTypeMismatchError</span>
</span><span id="EdgeGroupings.Ungrouped.load-860"><a href="#EdgeGroupings.Ungrouped.load-860"><span class="linenos">860</span></a>                    <span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.load-861"><a href="#EdgeGroupings.Ungrouped.load-861"><span class="linenos">861</span></a>
</span><span id="EdgeGroupings.Ungrouped.load-862"><a href="#EdgeGroupings.Ungrouped.load-862"><span class="linenos">862</span></a>            <span class="c1"># return the new instance</span>
</span><span id="EdgeGroupings.Ungrouped.load-863"><a href="#EdgeGroupings.Ungrouped.load-863"><span class="linenos">863</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="EdgeGroupings.Ungrouped.validate_fields_types" class="classattr">
                                        <input id="EdgeGroupings.Ungrouped.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeGroupings.Ungrouped.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L282-L291" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeGroupings.Ungrouped.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeGroupings.Ungrouped.validate_fields_types-283"><a href="#EdgeGroupings.Ungrouped.validate_fields_types-283"><span class="linenos">283</span></a><span class="k">def</span><span class="w"> </span><span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="EdgeGroupings.Ungrouped.validate_fields_types-284"><a href="#EdgeGroupings.Ungrouped.validate_fields_types-284"><span class="linenos">284</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="EdgeGroupings.Ungrouped.validate_fields_types-285"><a href="#EdgeGroupings.Ungrouped.validate_fields_types-285"><span class="linenos">285</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="EdgeGroupings.Ungrouped.validate_fields_types-286"><a href="#EdgeGroupings.Ungrouped.validate_fields_types-286"><span class="linenos">286</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="EdgeGroupings.Ungrouped.validate_fields_types-287"><a href="#EdgeGroupings.Ungrouped.validate_fields_types-287"><span class="linenos">287</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="EdgeGroupings.Ungrouped.validate_fields_types-288"><a href="#EdgeGroupings.Ungrouped.validate_fields_types-288"><span class="linenos">288</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="EdgeGroupings.Ungrouped.validate_fields_types-289"><a href="#EdgeGroupings.Ungrouped.validate_fields_types-289"><span class="linenos">289</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="EdgeGroupings.Ungrouped.validate_fields_types-290"><a href="#EdgeGroupings.Ungrouped.validate_fields_types-290"><span class="linenos">290</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="EdgeGroupings.Ungrouped.validate_fields_types-291"><a href="#EdgeGroupings.Ungrouped.validate_fields_types-291"><span class="linenos">291</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="EdgeGroupings.Ungrouped.validate_fields_types-292"><a href="#EdgeGroupings.Ungrouped.validate_fields_types-292"><span class="linenos">292</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#EdgeGroupings._EdgeGrouping">EdgeGroupings._EdgeGrouping</a></dt>
                                <dd id="EdgeGroupings.Ungrouped.attribute_key" class="function"><a href="#EdgeGroupings._EdgeGrouping.attribute_key">attribute_key</a></dd>
                <dd id="EdgeGroupings.Ungrouped.is_valid" class="function"><a href="#EdgeGroupings._EdgeGrouping.is_valid">is_valid</a></dd>

            </div>
            <div><dt><a href="element_base.html#_TokenizerElement">maze_dataset.tokenization.modular.element_base._TokenizerElement</a></dt>
                                <dd id="EdgeGroupings.Ungrouped.name" class="variable"><a href="element_base.html#_TokenizerElement.name">name</a></dd>
                <dd id="EdgeGroupings.Ungrouped.tokenizer_elements" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="EdgeGroupings.Ungrouped.tokenizer_element_tree" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="EdgeGroupings.Ungrouped.tokenizer_element_dict" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>
                <dd id="EdgeGroupings.Ungrouped.to_tokens" class="function"><a href="element_base.html#_TokenizerElement.to_tokens">to_tokens</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="EdgeGroupings.Ungrouped.validate_field_type" class="function">validate_field_type</dd>
                <dd id="EdgeGroupings.Ungrouped.diff" class="function">diff</dd>
                <dd id="EdgeGroupings.Ungrouped.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="EdgeGroupings.ByLeadingCoord">
                            <input id="EdgeGroupings.ByLeadingCoord-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>
        <div class="decorator">@mark_as_unsupported(_unsupported_is_invalid)</div>

    <span class="def">class</span>
    <span class="name">EdgeGroupings.ByLeadingCoord</span><wbr>(<span class="base"><a href="#EdgeGroupings._EdgeGrouping">EdgeGroupings._EdgeGrouping</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeGroupings.ByLeadingCoord-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L169-L210" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeGroupings.ByLeadingCoord"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeGroupings.ByLeadingCoord-170"><a href="#EdgeGroupings.ByLeadingCoord-170"><span class="linenos">170</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord-171"><a href="#EdgeGroupings.ByLeadingCoord-171"><span class="linenos">171</span></a>	<span class="nd">@mark_as_unsupported</span><span class="p">(</span><span class="n">_unsupported_is_invalid</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord-172"><a href="#EdgeGroupings.ByLeadingCoord-172"><span class="linenos">172</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">ByLeadingCoord</span><span class="p">(</span><span class="n">_EdgeGrouping</span><span class="p">):</span>
</span><span id="EdgeGroupings.ByLeadingCoord-173"><a href="#EdgeGroupings.ByLeadingCoord-173"><span class="linenos">173</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;All edges with the same leading coord are grouped together.</span>
</span><span id="EdgeGroupings.ByLeadingCoord-174"><a href="#EdgeGroupings.ByLeadingCoord-174"><span class="linenos">174</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord-175"><a href="#EdgeGroupings.ByLeadingCoord-175"><span class="linenos">175</span></a><span class="sd">		# Parameters</span>
</span><span id="EdgeGroupings.ByLeadingCoord-176"><a href="#EdgeGroupings.ByLeadingCoord-176"><span class="linenos">176</span></a><span class="sd">		- `intra`: Whether all edge groupings include a delimiter token between individual edge representations.</span>
</span><span id="EdgeGroupings.ByLeadingCoord-177"><a href="#EdgeGroupings.ByLeadingCoord-177"><span class="linenos">177</span></a><span class="sd">		Note that each edge representation will already always include a connector token (`VOCAB.CONNECTOR`, or possibly `)</span>
</span><span id="EdgeGroupings.ByLeadingCoord-178"><a href="#EdgeGroupings.ByLeadingCoord-178"><span class="linenos">178</span></a><span class="sd">		- `shuffle_group`: Whether the sequence of edges within the group should be shuffled or appear in a fixed order.</span>
</span><span id="EdgeGroupings.ByLeadingCoord-179"><a href="#EdgeGroupings.ByLeadingCoord-179"><span class="linenos">179</span></a><span class="sd">		If false, the fixed order is lexicographical by (row, col).</span>
</span><span id="EdgeGroupings.ByLeadingCoord-180"><a href="#EdgeGroupings.ByLeadingCoord-180"><span class="linenos">180</span></a><span class="sd">		In effect, lexicographical sorting sorts edges by their cardinal direction in the sequence NORTH, WEST, EAST, SOUTH, where the directions indicate the position of the trailing coord relative to the leading coord.</span>
</span><span id="EdgeGroupings.ByLeadingCoord-181"><a href="#EdgeGroupings.ByLeadingCoord-181"><span class="linenos">181</span></a><span class="sd">		- `connection_token_ordinal`: At which index in token sequence representing a single edge the connector (or wall) token appears.</span>
</span><span id="EdgeGroupings.ByLeadingCoord-182"><a href="#EdgeGroupings.ByLeadingCoord-182"><span class="linenos">182</span></a><span class="sd">		Edge tokenizations contain 2 parts: a connector (or wall) token and a coord or cardinal tokenization.</span>
</span><span id="EdgeGroupings.ByLeadingCoord-183"><a href="#EdgeGroupings.ByLeadingCoord-183"><span class="linenos">183</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="EdgeGroupings.ByLeadingCoord-184"><a href="#EdgeGroupings.ByLeadingCoord-184"><span class="linenos">184</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord-185"><a href="#EdgeGroupings.ByLeadingCoord-185"><span class="linenos">185</span></a>		<span class="n">intra</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord-186"><a href="#EdgeGroupings.ByLeadingCoord-186"><span class="linenos">186</span></a>		<span class="n">shuffle_group</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord-187"><a href="#EdgeGroupings.ByLeadingCoord-187"><span class="linenos">187</span></a>		<span class="n">connection_token_ordinal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord-188"><a href="#EdgeGroupings.ByLeadingCoord-188"><span class="linenos">188</span></a>			<span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="EdgeGroupings.ByLeadingCoord-189"><a href="#EdgeGroupings.ByLeadingCoord-189"><span class="linenos">189</span></a>			<span class="n">assert_type</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="EdgeGroupings.ByLeadingCoord-190"><a href="#EdgeGroupings.ByLeadingCoord-190"><span class="linenos">190</span></a>		<span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord-191"><a href="#EdgeGroupings.ByLeadingCoord-191"><span class="linenos">191</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord-192"><a href="#EdgeGroupings.ByLeadingCoord-192"><span class="linenos">192</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_token_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;EdgeGroupings._GroupingTokenParams&quot;</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord-193"><a href="#EdgeGroupings.ByLeadingCoord-193"><span class="linenos">193</span></a>			<span class="k">return</span> <span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">_GroupingTokenParams</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord-194"><a href="#EdgeGroupings.ByLeadingCoord-194"><span class="linenos">194</span></a>				<span class="n">connection_token_ordinal</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">connection_token_ordinal</span><span class="p">,</span>
</span><span id="EdgeGroupings.ByLeadingCoord-195"><a href="#EdgeGroupings.ByLeadingCoord-195"><span class="linenos">195</span></a>				<span class="n">intra</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">intra</span><span class="p">,</span>
</span><span id="EdgeGroupings.ByLeadingCoord-196"><a href="#EdgeGroupings.ByLeadingCoord-196"><span class="linenos">196</span></a>				<span class="n">grouped</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="EdgeGroupings.ByLeadingCoord-197"><a href="#EdgeGroupings.ByLeadingCoord-197"><span class="linenos">197</span></a>			<span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord-198"><a href="#EdgeGroupings.ByLeadingCoord-198"><span class="linenos">198</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord-199"><a href="#EdgeGroupings.ByLeadingCoord-199"><span class="linenos">199</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_group_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ConnectionArray</span><span class="p">]:</span>
</span><span id="EdgeGroupings.ByLeadingCoord-200"><a href="#EdgeGroupings.ByLeadingCoord-200"><span class="linenos">200</span></a>			<span class="c1"># Adapted from: https://stackoverflow.com/questions/38013778/is-there-any-numpy-group-by-function</span>
</span><span id="EdgeGroupings.ByLeadingCoord-201"><a href="#EdgeGroupings.ByLeadingCoord-201"><span class="linenos">201</span></a>			<span class="n">index_array</span><span class="p">:</span> <span class="n">Int</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;sort_indices=edges&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">lexsort</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord-202"><a href="#EdgeGroupings.ByLeadingCoord-202"><span class="linenos">202</span></a>				<span class="p">(</span><span class="n">edges</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">edges</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
</span><span id="EdgeGroupings.ByLeadingCoord-203"><a href="#EdgeGroupings.ByLeadingCoord-203"><span class="linenos">203</span></a>			<span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord-204"><a href="#EdgeGroupings.ByLeadingCoord-204"><span class="linenos">204</span></a>			<span class="n">sorted_edges</span><span class="p">:</span> <span class="n">ConnectionArray</span> <span class="o">=</span> <span class="n">edges</span><span class="p">[</span><span class="n">index_array</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span><span id="EdgeGroupings.ByLeadingCoord-205"><a href="#EdgeGroupings.ByLeadingCoord-205"><span class="linenos">205</span></a>			<span class="n">groups</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ConnectionArray</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord-206"><a href="#EdgeGroupings.ByLeadingCoord-206"><span class="linenos">206</span></a>				<span class="n">sorted_edges</span><span class="p">,</span>
</span><span id="EdgeGroupings.ByLeadingCoord-207"><a href="#EdgeGroupings.ByLeadingCoord-207"><span class="linenos">207</span></a>				<span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">sorted_edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span>
</span><span id="EdgeGroupings.ByLeadingCoord-208"><a href="#EdgeGroupings.ByLeadingCoord-208"><span class="linenos">208</span></a>			<span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord-209"><a href="#EdgeGroupings.ByLeadingCoord-209"><span class="linenos">209</span></a>			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shuffle_group</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord-210"><a href="#EdgeGroupings.ByLeadingCoord-210"><span class="linenos">210</span></a>				<span class="p">[</span><span class="n">_NUMPY_RNG</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">]</span>
</span><span id="EdgeGroupings.ByLeadingCoord-211"><a href="#EdgeGroupings.ByLeadingCoord-211"><span class="linenos">211</span></a>			<span class="k">return</span> <span class="n">groups</span>
</span></pre></div>


            <div class="docstring"><p>All edges with the same leading coord are grouped together.</p>

<h1 id="parameters">Parameters</h1>

<ul>
<li><code><a href="#EdgeGroupings.ByLeadingCoord.intra">intra</a></code>: Whether all edge groupings include a delimiter token between individual edge representations.
Note that each edge representation will already always include a connector token (<code>VOCAB.CONNECTOR</code>, or possibly `)</li>
<li><code><a href="#EdgeGroupings.ByLeadingCoord.shuffle_group">shuffle_group</a></code>: Whether the sequence of edges within the group should be shuffled or appear in a fixed order.
If false, the fixed order is lexicographical by (row, col).
In effect, lexicographical sorting sorts edges by their cardinal direction in the sequence NORTH, WEST, EAST, SOUTH, where the directions indicate the position of the trailing coord relative to the leading coord.</li>
<li><code><a href="#EdgeGroupings.ByLeadingCoord.connection_token_ordinal">connection_token_ordinal</a></code>: At which index in token sequence representing a single edge the connector (or wall) token appears.
Edge tokenizations contain 2 parts: a connector (or wall) token and a coord or cardinal tokenization.</li>
</ul>
</div>


                            <div id="EdgeGroupings.ByLeadingCoord.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">EdgeGroupings.ByLeadingCoord</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#EdgeGroupings.ByLeadingCoord">EdgeGroupings.ByLeadingCoord</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#EdgeGroupings.ByLeadingCoord">EdgeGroupings.ByLeadingCoord</a>&#39;&gt;&quot;</span>,</span><span class="param">	<span class="n">intra</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">shuffle_group</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">connection_token_ordinal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#EdgeGroupings.ByLeadingCoord.__init__"></a>
    
    

                            </div>
                            <div id="EdgeGroupings.ByLeadingCoord.intra" class="classattr">
                                <div class="attr variable">
            <span class="name">intra</span><span class="annotation">: bool</span>        =
<span class="default_value">True</span>

        
    </div>
    <a class="headerlink" href="#EdgeGroupings.ByLeadingCoord.intra"></a>
    
    

                            </div>
                            <div id="EdgeGroupings.ByLeadingCoord.shuffle_group" class="classattr">
                                <div class="attr variable">
            <span class="name">shuffle_group</span><span class="annotation">: bool</span>        =
<span class="default_value">True</span>

        
    </div>
    <a class="headerlink" href="#EdgeGroupings.ByLeadingCoord.shuffle_group"></a>
    
    

                            </div>
                            <div id="EdgeGroupings.ByLeadingCoord.connection_token_ordinal" class="classattr">
                                <div class="attr variable">
            <span class="name">connection_token_ordinal</span><span class="annotation">: Literal[0, 1]</span>        =
<span class="default_value">0</span>

        
    </div>
    <a class="headerlink" href="#EdgeGroupings.ByLeadingCoord.connection_token_ordinal"></a>
    
    

                            </div>
                            <div id="EdgeGroupings.ByLeadingCoord.is_valid" class="classattr">
                                        <input id="EdgeGroupings.ByLeadingCoord.is_valid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_valid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeGroupings.ByLeadingCoord.is_valid-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L256-L265" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeGroupings.ByLeadingCoord.is_valid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeGroupings.ByLeadingCoord.is_valid-257"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-257"><span class="linenos">257</span></a><span class="k">def</span><span class="w"> </span><span class="nf">_unsupported_is_invalid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># noqa: ANN001</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-258"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-258"><span class="linenos">258</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Default implementation of `is_valid` for `mark_as_unsupported`-decorated classes&quot;&quot;&quot;</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-259"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-259"><span class="linenos">259</span></a>	<span class="k">if</span> <span class="n">do_except</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-260"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-260"><span class="linenos">260</span></a>		<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-261"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-261"><span class="linenos">261</span></a>			<span class="sa">f</span><span class="s2">&quot;Class `</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2">, marked as unsupported, is not valid.&quot;</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-262"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-262"><span class="linenos">262</span></a>			<span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-263"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-263"><span class="linenos">263</span></a>		<span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-264"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-264"><span class="linenos">264</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-265"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-265"><span class="linenos">265</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-266"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-266"><span class="linenos">266</span></a>	<span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Default implementation of <code><a href="#EdgeGroupings.ByLeadingCoord.is_valid">is_valid</a></code> for <code>mark_as_unsupported</code>-decorated classes</p>
</div>


                            </div>
                            <div id="EdgeGroupings.ByLeadingCoord.serialize" class="classattr">
                                        <input id="EdgeGroupings.ByLeadingCoord.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeGroupings.ByLeadingCoord.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L713-L769" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeGroupings.ByLeadingCoord.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeGroupings.ByLeadingCoord.serialize-714"><a href="#EdgeGroupings.ByLeadingCoord.serialize-714"><span class="linenos">714</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-715"><a href="#EdgeGroupings.ByLeadingCoord.serialize-715"><span class="linenos">715</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-716"><a href="#EdgeGroupings.ByLeadingCoord.serialize-716"><span class="linenos">716</span></a>                <span class="n">_FORMAT_KEY</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-717"><a href="#EdgeGroupings.ByLeadingCoord.serialize-717"><span class="linenos">717</span></a>            <span class="p">}</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-718"><a href="#EdgeGroupings.ByLeadingCoord.serialize-718"><span class="linenos">718</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-719"><a href="#EdgeGroupings.ByLeadingCoord.serialize-719"><span class="linenos">719</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-720"><a href="#EdgeGroupings.ByLeadingCoord.serialize-720"><span class="linenos">720</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-721"><a href="#EdgeGroupings.ByLeadingCoord.serialize-721"><span class="linenos">721</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-722"><a href="#EdgeGroupings.ByLeadingCoord.serialize-722"><span class="linenos">722</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-723"><a href="#EdgeGroupings.ByLeadingCoord.serialize-723"><span class="linenos">723</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-724"><a href="#EdgeGroupings.ByLeadingCoord.serialize-724"><span class="linenos">724</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-725"><a href="#EdgeGroupings.ByLeadingCoord.serialize-725"><span class="linenos">725</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-726"><a href="#EdgeGroupings.ByLeadingCoord.serialize-726"><span class="linenos">726</span></a>                    <span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-727"><a href="#EdgeGroupings.ByLeadingCoord.serialize-727"><span class="linenos">727</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-728"><a href="#EdgeGroupings.ByLeadingCoord.serialize-728"><span class="linenos">728</span></a>                <span class="c1"># try to save it</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-729"><a href="#EdgeGroupings.ByLeadingCoord.serialize-729"><span class="linenos">729</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-730"><a href="#EdgeGroupings.ByLeadingCoord.serialize-730"><span class="linenos">730</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-731"><a href="#EdgeGroupings.ByLeadingCoord.serialize-731"><span class="linenos">731</span></a>                        <span class="c1"># get the val</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-732"><a href="#EdgeGroupings.ByLeadingCoord.serialize-732"><span class="linenos">732</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-733"><a href="#EdgeGroupings.ByLeadingCoord.serialize-733"><span class="linenos">733</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-734"><a href="#EdgeGroupings.ByLeadingCoord.serialize-734"><span class="linenos">734</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-735"><a href="#EdgeGroupings.ByLeadingCoord.serialize-735"><span class="linenos">735</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-736"><a href="#EdgeGroupings.ByLeadingCoord.serialize-736"><span class="linenos">736</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-737"><a href="#EdgeGroupings.ByLeadingCoord.serialize-737"><span class="linenos">737</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-738"><a href="#EdgeGroupings.ByLeadingCoord.serialize-738"><span class="linenos">738</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-739"><a href="#EdgeGroupings.ByLeadingCoord.serialize-739"><span class="linenos">739</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-740"><a href="#EdgeGroupings.ByLeadingCoord.serialize-740"><span class="linenos">740</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-741"><a href="#EdgeGroupings.ByLeadingCoord.serialize-741"><span class="linenos">741</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-742"><a href="#EdgeGroupings.ByLeadingCoord.serialize-742"><span class="linenos">742</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-743"><a href="#EdgeGroupings.ByLeadingCoord.serialize-743"><span class="linenos">743</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-744"><a href="#EdgeGroupings.ByLeadingCoord.serialize-744"><span class="linenos">744</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-745"><a href="#EdgeGroupings.ByLeadingCoord.serialize-745"><span class="linenos">745</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-746"><a href="#EdgeGroupings.ByLeadingCoord.serialize-746"><span class="linenos">746</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-747"><a href="#EdgeGroupings.ByLeadingCoord.serialize-747"><span class="linenos">747</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-748"><a href="#EdgeGroupings.ByLeadingCoord.serialize-748"><span class="linenos">748</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-749"><a href="#EdgeGroupings.ByLeadingCoord.serialize-749"><span class="linenos">749</span></a>                                <span class="p">[</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-750"><a href="#EdgeGroupings.ByLeadingCoord.serialize-750"><span class="linenos">750</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-751"><a href="#EdgeGroupings.ByLeadingCoord.serialize-751"><span class="linenos">751</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-752"><a href="#EdgeGroupings.ByLeadingCoord.serialize-752"><span class="linenos">752</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-753"><a href="#EdgeGroupings.ByLeadingCoord.serialize-753"><span class="linenos">753</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-754"><a href="#EdgeGroupings.ByLeadingCoord.serialize-754"><span class="linenos">754</span></a>                                <span class="p">]</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-755"><a href="#EdgeGroupings.ByLeadingCoord.serialize-755"><span class="linenos">755</span></a>                            <span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-756"><a href="#EdgeGroupings.ByLeadingCoord.serialize-756"><span class="linenos">756</span></a>                        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-757"><a href="#EdgeGroupings.ByLeadingCoord.serialize-757"><span class="linenos">757</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-758"><a href="#EdgeGroupings.ByLeadingCoord.serialize-758"><span class="linenos">758</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-759"><a href="#EdgeGroupings.ByLeadingCoord.serialize-759"><span class="linenos">759</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-760"><a href="#EdgeGroupings.ByLeadingCoord.serialize-760"><span class="linenos">760</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-761"><a href="#EdgeGroupings.ByLeadingCoord.serialize-761"><span class="linenos">761</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-762"><a href="#EdgeGroupings.ByLeadingCoord.serialize-762"><span class="linenos">762</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-763"><a href="#EdgeGroupings.ByLeadingCoord.serialize-763"><span class="linenos">763</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-764"><a href="#EdgeGroupings.ByLeadingCoord.serialize-764"><span class="linenos">764</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-765"><a href="#EdgeGroupings.ByLeadingCoord.serialize-765"><span class="linenos">765</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-766"><a href="#EdgeGroupings.ByLeadingCoord.serialize-766"><span class="linenos">766</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-767"><a href="#EdgeGroupings.ByLeadingCoord.serialize-767"><span class="linenos">767</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-768"><a href="#EdgeGroupings.ByLeadingCoord.serialize-768"><span class="linenos">768</span></a>                    <span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-769"><a href="#EdgeGroupings.ByLeadingCoord.serialize-769"><span class="linenos">769</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-770"><a href="#EdgeGroupings.ByLeadingCoord.serialize-770"><span class="linenos">770</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="EdgeGroupings.ByLeadingCoord.load" class="classattr">
                                        <input id="EdgeGroupings.ByLeadingCoord.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeGroupings.ByLeadingCoord.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L776-L862" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeGroupings.ByLeadingCoord.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeGroupings.ByLeadingCoord.load-777"><a href="#EdgeGroupings.ByLeadingCoord.load-777"><span class="linenos">777</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-778"><a href="#EdgeGroupings.ByLeadingCoord.load-778"><span class="linenos">778</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-779"><a href="#EdgeGroupings.ByLeadingCoord.load-779"><span class="linenos">779</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-780"><a href="#EdgeGroupings.ByLeadingCoord.load-780"><span class="linenos">780</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-781"><a href="#EdgeGroupings.ByLeadingCoord.load-781"><span class="linenos">781</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-782"><a href="#EdgeGroupings.ByLeadingCoord.load-782"><span class="linenos">782</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.load-783"><a href="#EdgeGroupings.ByLeadingCoord.load-783"><span class="linenos">783</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-784"><a href="#EdgeGroupings.ByLeadingCoord.load-784"><span class="linenos">784</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-785"><a href="#EdgeGroupings.ByLeadingCoord.load-785"><span class="linenos">785</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-786"><a href="#EdgeGroupings.ByLeadingCoord.load-786"><span class="linenos">786</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.load-787"><a href="#EdgeGroupings.ByLeadingCoord.load-787"><span class="linenos">787</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-788"><a href="#EdgeGroupings.ByLeadingCoord.load-788"><span class="linenos">788</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.load-789"><a href="#EdgeGroupings.ByLeadingCoord.load-789"><span class="linenos">789</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-790"><a href="#EdgeGroupings.ByLeadingCoord.load-790"><span class="linenos">790</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-791"><a href="#EdgeGroupings.ByLeadingCoord.load-791"><span class="linenos">791</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.load-792"><a href="#EdgeGroupings.ByLeadingCoord.load-792"><span class="linenos">792</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-793"><a href="#EdgeGroupings.ByLeadingCoord.load-793"><span class="linenos">793</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-794"><a href="#EdgeGroupings.ByLeadingCoord.load-794"><span class="linenos">794</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-795"><a href="#EdgeGroupings.ByLeadingCoord.load-795"><span class="linenos">795</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-796"><a href="#EdgeGroupings.ByLeadingCoord.load-796"><span class="linenos">796</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-797"><a href="#EdgeGroupings.ByLeadingCoord.load-797"><span class="linenos">797</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-798"><a href="#EdgeGroupings.ByLeadingCoord.load-798"><span class="linenos">798</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.load-799"><a href="#EdgeGroupings.ByLeadingCoord.load-799"><span class="linenos">799</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-800"><a href="#EdgeGroupings.ByLeadingCoord.load-800"><span class="linenos">800</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-801"><a href="#EdgeGroupings.ByLeadingCoord.load-801"><span class="linenos">801</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-802"><a href="#EdgeGroupings.ByLeadingCoord.load-802"><span class="linenos">802</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-803"><a href="#EdgeGroupings.ByLeadingCoord.load-803"><span class="linenos">803</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.load-804"><a href="#EdgeGroupings.ByLeadingCoord.load-804"><span class="linenos">804</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-805"><a href="#EdgeGroupings.ByLeadingCoord.load-805"><span class="linenos">805</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-806"><a href="#EdgeGroupings.ByLeadingCoord.load-806"><span class="linenos">806</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.load-807"><a href="#EdgeGroupings.ByLeadingCoord.load-807"><span class="linenos">807</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-808"><a href="#EdgeGroupings.ByLeadingCoord.load-808"><span class="linenos">808</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-809"><a href="#EdgeGroupings.ByLeadingCoord.load-809"><span class="linenos">809</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-810"><a href="#EdgeGroupings.ByLeadingCoord.load-810"><span class="linenos">810</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-811"><a href="#EdgeGroupings.ByLeadingCoord.load-811"><span class="linenos">811</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-812"><a href="#EdgeGroupings.ByLeadingCoord.load-812"><span class="linenos">812</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-813"><a href="#EdgeGroupings.ByLeadingCoord.load-813"><span class="linenos">813</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-814"><a href="#EdgeGroupings.ByLeadingCoord.load-814"><span class="linenos">814</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-815"><a href="#EdgeGroupings.ByLeadingCoord.load-815"><span class="linenos">815</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-816"><a href="#EdgeGroupings.ByLeadingCoord.load-816"><span class="linenos">816</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-817"><a href="#EdgeGroupings.ByLeadingCoord.load-817"><span class="linenos">817</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-818"><a href="#EdgeGroupings.ByLeadingCoord.load-818"><span class="linenos">818</span></a>                    <span class="p">):</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-819"><a href="#EdgeGroupings.ByLeadingCoord.load-819"><span class="linenos">819</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-820"><a href="#EdgeGroupings.ByLeadingCoord.load-820"><span class="linenos">820</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-821"><a href="#EdgeGroupings.ByLeadingCoord.load-821"><span class="linenos">821</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-822"><a href="#EdgeGroupings.ByLeadingCoord.load-822"><span class="linenos">822</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-823"><a href="#EdgeGroupings.ByLeadingCoord.load-823"><span class="linenos">823</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-824"><a href="#EdgeGroupings.ByLeadingCoord.load-824"><span class="linenos">824</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-825"><a href="#EdgeGroupings.ByLeadingCoord.load-825"><span class="linenos">825</span></a>                            <span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-826"><a href="#EdgeGroupings.ByLeadingCoord.load-826"><span class="linenos">826</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-827"><a href="#EdgeGroupings.ByLeadingCoord.load-827"><span class="linenos">827</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-828"><a href="#EdgeGroupings.ByLeadingCoord.load-828"><span class="linenos">828</span></a>                        <span class="k">pass</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-829"><a href="#EdgeGroupings.ByLeadingCoord.load-829"><span class="linenos">829</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.load-830"><a href="#EdgeGroupings.ByLeadingCoord.load-830"><span class="linenos">830</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-831"><a href="#EdgeGroupings.ByLeadingCoord.load-831"><span class="linenos">831</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-832"><a href="#EdgeGroupings.ByLeadingCoord.load-832"><span class="linenos">832</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.load-833"><a href="#EdgeGroupings.ByLeadingCoord.load-833"><span class="linenos">833</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-834"><a href="#EdgeGroupings.ByLeadingCoord.load-834"><span class="linenos">834</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-835"><a href="#EdgeGroupings.ByLeadingCoord.load-835"><span class="linenos">835</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.load-836"><a href="#EdgeGroupings.ByLeadingCoord.load-836"><span class="linenos">836</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-837"><a href="#EdgeGroupings.ByLeadingCoord.load-837"><span class="linenos">837</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-838"><a href="#EdgeGroupings.ByLeadingCoord.load-838"><span class="linenos">838</span></a>                <span class="n">fields_valid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-839"><a href="#EdgeGroupings.ByLeadingCoord.load-839"><span class="linenos">839</span></a>                    <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-840"><a href="#EdgeGroupings.ByLeadingCoord.load-840"><span class="linenos">840</span></a>                        <span class="n">output</span><span class="p">,</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-841"><a href="#EdgeGroupings.ByLeadingCoord.load-841"><span class="linenos">841</span></a>                        <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">,</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-842"><a href="#EdgeGroupings.ByLeadingCoord.load-842"><span class="linenos">842</span></a>                    <span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-843"><a href="#EdgeGroupings.ByLeadingCoord.load-843"><span class="linenos">843</span></a>                <span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-844"><a href="#EdgeGroupings.ByLeadingCoord.load-844"><span class="linenos">844</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.load-845"><a href="#EdgeGroupings.ByLeadingCoord.load-845"><span class="linenos">845</span></a>                <span class="c1"># if there are any fields that are not valid, raise an error</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-846"><a href="#EdgeGroupings.ByLeadingCoord.load-846"><span class="linenos">846</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">fields_valid</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-847"><a href="#EdgeGroupings.ByLeadingCoord.load-847"><span class="linenos">847</span></a>                    <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-848"><a href="#EdgeGroupings.ByLeadingCoord.load-848"><span class="linenos">848</span></a>                        <span class="sa">f</span><span class="s2">&quot;Type mismatch in fields of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-849"><a href="#EdgeGroupings.ByLeadingCoord.load-849"><span class="linenos">849</span></a>                        <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-850"><a href="#EdgeGroupings.ByLeadingCoord.load-850"><span class="linenos">850</span></a>                            <span class="p">[</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-851"><a href="#EdgeGroupings.ByLeadingCoord.load-851"><span class="linenos">851</span></a>                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">:</span><span class="se">\t</span><span class="s2">expected </span><span class="si">{</span><span class="n">cls_type_hints</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="si">= }</span><span class="s2">, but got value </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-852"><a href="#EdgeGroupings.ByLeadingCoord.load-852"><span class="linenos">852</span></a>                                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">fields_valid</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-853"><a href="#EdgeGroupings.ByLeadingCoord.load-853"><span class="linenos">853</span></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-854"><a href="#EdgeGroupings.ByLeadingCoord.load-854"><span class="linenos">854</span></a>                            <span class="p">]</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-855"><a href="#EdgeGroupings.ByLeadingCoord.load-855"><span class="linenos">855</span></a>                        <span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-856"><a href="#EdgeGroupings.ByLeadingCoord.load-856"><span class="linenos">856</span></a>                    <span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-857"><a href="#EdgeGroupings.ByLeadingCoord.load-857"><span class="linenos">857</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.load-858"><a href="#EdgeGroupings.ByLeadingCoord.load-858"><span class="linenos">858</span></a>                    <span class="n">on_typecheck_mismatch</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-859"><a href="#EdgeGroupings.ByLeadingCoord.load-859"><span class="linenos">859</span></a>                        <span class="n">msg</span><span class="p">,</span> <span class="n">except_cls</span><span class="o">=</span><span class="n">FieldTypeMismatchError</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-860"><a href="#EdgeGroupings.ByLeadingCoord.load-860"><span class="linenos">860</span></a>                    <span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-861"><a href="#EdgeGroupings.ByLeadingCoord.load-861"><span class="linenos">861</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.load-862"><a href="#EdgeGroupings.ByLeadingCoord.load-862"><span class="linenos">862</span></a>            <span class="c1"># return the new instance</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-863"><a href="#EdgeGroupings.ByLeadingCoord.load-863"><span class="linenos">863</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="EdgeGroupings.ByLeadingCoord.validate_fields_types" class="classattr">
                                        <input id="EdgeGroupings.ByLeadingCoord.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeGroupings.ByLeadingCoord.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L282-L291" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeGroupings.ByLeadingCoord.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeGroupings.ByLeadingCoord.validate_fields_types-283"><a href="#EdgeGroupings.ByLeadingCoord.validate_fields_types-283"><span class="linenos">283</span></a><span class="k">def</span><span class="w"> </span><span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord.validate_fields_types-284"><a href="#EdgeGroupings.ByLeadingCoord.validate_fields_types-284"><span class="linenos">284</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="EdgeGroupings.ByLeadingCoord.validate_fields_types-285"><a href="#EdgeGroupings.ByLeadingCoord.validate_fields_types-285"><span class="linenos">285</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="EdgeGroupings.ByLeadingCoord.validate_fields_types-286"><a href="#EdgeGroupings.ByLeadingCoord.validate_fields_types-286"><span class="linenos">286</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.validate_fields_types-287"><a href="#EdgeGroupings.ByLeadingCoord.validate_fields_types-287"><span class="linenos">287</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="EdgeGroupings.ByLeadingCoord.validate_fields_types-288"><a href="#EdgeGroupings.ByLeadingCoord.validate_fields_types-288"><span class="linenos">288</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord.validate_fields_types-289"><a href="#EdgeGroupings.ByLeadingCoord.validate_fields_types-289"><span class="linenos">289</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord.validate_fields_types-290"><a href="#EdgeGroupings.ByLeadingCoord.validate_fields_types-290"><span class="linenos">290</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="EdgeGroupings.ByLeadingCoord.validate_fields_types-291"><a href="#EdgeGroupings.ByLeadingCoord.validate_fields_types-291"><span class="linenos">291</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="EdgeGroupings.ByLeadingCoord.validate_fields_types-292"><a href="#EdgeGroupings.ByLeadingCoord.validate_fields_types-292"><span class="linenos">292</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#EdgeGroupings._EdgeGrouping">EdgeGroupings._EdgeGrouping</a></dt>
                                <dd id="EdgeGroupings.ByLeadingCoord.attribute_key" class="function"><a href="#EdgeGroupings._EdgeGrouping.attribute_key">attribute_key</a></dd>

            </div>
            <div><dt><a href="element_base.html#_TokenizerElement">maze_dataset.tokenization.modular.element_base._TokenizerElement</a></dt>
                                <dd id="EdgeGroupings.ByLeadingCoord.name" class="variable"><a href="element_base.html#_TokenizerElement.name">name</a></dd>
                <dd id="EdgeGroupings.ByLeadingCoord.tokenizer_elements" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="EdgeGroupings.ByLeadingCoord.tokenizer_element_tree" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="EdgeGroupings.ByLeadingCoord.tokenizer_element_dict" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>
                <dd id="EdgeGroupings.ByLeadingCoord.to_tokens" class="function"><a href="element_base.html#_TokenizerElement.to_tokens">to_tokens</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="EdgeGroupings.ByLeadingCoord.validate_field_type" class="function">validate_field_type</dd>
                <dd id="EdgeGroupings.ByLeadingCoord.diff" class="function">diff</dd>
                <dd id="EdgeGroupings.ByLeadingCoord.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="EdgePermuters">
                            <input id="EdgePermuters-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">EdgePermuters</span><wbr>(<span class="base"><a href="element_base.html#__TokenizerElementNamespace">maze_dataset.tokenization.modular.element_base.__TokenizerElementNamespace</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgePermuters-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L213-L284" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgePermuters"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgePermuters-214"><a href="#EdgePermuters-214"><span class="linenos">214</span></a><span class="k">class</span><span class="w"> </span><span class="nc">EdgePermuters</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="EdgePermuters-215"><a href="#EdgePermuters-215"><span class="linenos">215</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Namespace for `_EdgePermuter` subclass hierarchy used by `_AdjListTokenizer`.&quot;&quot;&quot;</span>
</span><span id="EdgePermuters-216"><a href="#EdgePermuters-216"><span class="linenos">216</span></a>
</span><span id="EdgePermuters-217"><a href="#EdgePermuters-217"><span class="linenos">217</span></a>	<span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;edge_permuter&quot;</span>
</span><span id="EdgePermuters-218"><a href="#EdgePermuters-218"><span class="linenos">218</span></a>
</span><span id="EdgePermuters-219"><a href="#EdgePermuters-219"><span class="linenos">219</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgePermuters-220"><a href="#EdgePermuters-220"><span class="linenos">220</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">_EdgePermuter</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="EdgePermuters-221"><a href="#EdgePermuters-221"><span class="linenos">221</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Specifies how to sequence the two coords that encode a lattice edge.&quot;&quot;&quot;</span>
</span><span id="EdgePermuters-222"><a href="#EdgePermuters-222"><span class="linenos">222</span></a>
</span><span id="EdgePermuters-223"><a href="#EdgePermuters-223"><span class="linenos">223</span></a>		<span class="nd">@classmethod</span>
</span><span id="EdgePermuters-224"><a href="#EdgePermuters-224"><span class="linenos">224</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="EdgePermuters-225"><a href="#EdgePermuters-225"><span class="linenos">225</span></a>			<span class="k">return</span> <span class="n">EdgePermuters</span><span class="o">.</span><span class="n">key</span>
</span><span id="EdgePermuters-226"><a href="#EdgePermuters-226"><span class="linenos">226</span></a>
</span><span id="EdgePermuters-227"><a href="#EdgePermuters-227"><span class="linenos">227</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="EdgePermuters-228"><a href="#EdgePermuters-228"><span class="linenos">228</span></a>			<span class="c1"># No invalid instances possible within data member type hint bounds</span>
</span><span id="EdgePermuters-229"><a href="#EdgePermuters-229"><span class="linenos">229</span></a>			<span class="k">return</span> <span class="kc">True</span>
</span><span id="EdgePermuters-230"><a href="#EdgePermuters-230"><span class="linenos">230</span></a>
</span><span id="EdgePermuters-231"><a href="#EdgePermuters-231"><span class="linenos">231</span></a>		<span class="nd">@staticmethod</span>
</span><span id="EdgePermuters-232"><a href="#EdgePermuters-232"><span class="linenos">232</span></a>		<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="EdgePermuters-233"><a href="#EdgePermuters-233"><span class="linenos">233</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_permute</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="EdgePermuters-234"><a href="#EdgePermuters-234"><span class="linenos">234</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Executes a permutation.</span>
</span><span id="EdgePermuters-235"><a href="#EdgePermuters-235"><span class="linenos">235</span></a>
</span><span id="EdgePermuters-236"><a href="#EdgePermuters-236"><span class="linenos">236</span></a><span class="sd">			Warning: Caller should be aware that `lattice_edges` may be modified in-place depending on the subclass&#39;s implementation.</span>
</span><span id="EdgePermuters-237"><a href="#EdgePermuters-237"><span class="linenos">237</span></a>
</span><span id="EdgePermuters-238"><a href="#EdgePermuters-238"><span class="linenos">238</span></a><span class="sd">			# Parameters</span>
</span><span id="EdgePermuters-239"><a href="#EdgePermuters-239"><span class="linenos">239</span></a><span class="sd">			- `lattice_edges`: Array of lattice edges.</span>
</span><span id="EdgePermuters-240"><a href="#EdgePermuters-240"><span class="linenos">240</span></a><span class="sd">			The two coords in shape[1] must be adjacent in the lattice.</span>
</span><span id="EdgePermuters-241"><a href="#EdgePermuters-241"><span class="linenos">241</span></a>
</span><span id="EdgePermuters-242"><a href="#EdgePermuters-242"><span class="linenos">242</span></a><span class="sd">			# Returns</span>
</span><span id="EdgePermuters-243"><a href="#EdgePermuters-243"><span class="linenos">243</span></a><span class="sd">			- Array of lattice edges with entries along shape[1] systematically permuted.</span>
</span><span id="EdgePermuters-244"><a href="#EdgePermuters-244"><span class="linenos">244</span></a><span class="sd">			- shape[0] of the returned array is NOT guaranteed to match `lattice_edges.shape[1]`.</span>
</span><span id="EdgePermuters-245"><a href="#EdgePermuters-245"><span class="linenos">245</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="EdgePermuters-246"><a href="#EdgePermuters-246"><span class="linenos">246</span></a>			<span class="k">pass</span>
</span><span id="EdgePermuters-247"><a href="#EdgePermuters-247"><span class="linenos">247</span></a>
</span><span id="EdgePermuters-248"><a href="#EdgePermuters-248"><span class="linenos">248</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgePermuters-249"><a href="#EdgePermuters-249"><span class="linenos">249</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">SortedCoords</span><span class="p">(</span><span class="n">_EdgePermuter</span><span class="p">):</span>
</span><span id="EdgePermuters-250"><a href="#EdgePermuters-250"><span class="linenos">250</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;returns a sorted representation. useful for checking consistency&quot;&quot;&quot;</span>
</span><span id="EdgePermuters-251"><a href="#EdgePermuters-251"><span class="linenos">251</span></a>
</span><span id="EdgePermuters-252"><a href="#EdgePermuters-252"><span class="linenos">252</span></a>		<span class="nd">@staticmethod</span>
</span><span id="EdgePermuters-253"><a href="#EdgePermuters-253"><span class="linenos">253</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_permute</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="EdgePermuters-254"><a href="#EdgePermuters-254"><span class="linenos">254</span></a>			<span class="k">return</span> <span class="n">lattice_edges</span><span class="p">[</span>
</span><span id="EdgePermuters-255"><a href="#EdgePermuters-255"><span class="linenos">255</span></a>				<span class="n">np</span><span class="o">.</span><span class="n">lexsort</span><span class="p">(</span>
</span><span id="EdgePermuters-256"><a href="#EdgePermuters-256"><span class="linenos">256</span></a>					<span class="p">(</span>
</span><span id="EdgePermuters-257"><a href="#EdgePermuters-257"><span class="linenos">257</span></a>						<span class="n">lattice_edges</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
</span><span id="EdgePermuters-258"><a href="#EdgePermuters-258"><span class="linenos">258</span></a>						<span class="n">lattice_edges</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
</span><span id="EdgePermuters-259"><a href="#EdgePermuters-259"><span class="linenos">259</span></a>						<span class="n">lattice_edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
</span><span id="EdgePermuters-260"><a href="#EdgePermuters-260"><span class="linenos">260</span></a>						<span class="n">lattice_edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
</span><span id="EdgePermuters-261"><a href="#EdgePermuters-261"><span class="linenos">261</span></a>					<span class="p">),</span>
</span><span id="EdgePermuters-262"><a href="#EdgePermuters-262"><span class="linenos">262</span></a>				<span class="p">),</span>
</span><span id="EdgePermuters-263"><a href="#EdgePermuters-263"><span class="linenos">263</span></a>				<span class="o">...</span><span class="p">,</span>
</span><span id="EdgePermuters-264"><a href="#EdgePermuters-264"><span class="linenos">264</span></a>			<span class="p">]</span>
</span><span id="EdgePermuters-265"><a href="#EdgePermuters-265"><span class="linenos">265</span></a>
</span><span id="EdgePermuters-266"><a href="#EdgePermuters-266"><span class="linenos">266</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgePermuters-267"><a href="#EdgePermuters-267"><span class="linenos">267</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">RandomCoords</span><span class="p">(</span><span class="n">_EdgePermuter</span><span class="p">):</span>
</span><span id="EdgePermuters-268"><a href="#EdgePermuters-268"><span class="linenos">268</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Permutes each edge randomly.&quot;&quot;&quot;</span>
</span><span id="EdgePermuters-269"><a href="#EdgePermuters-269"><span class="linenos">269</span></a>
</span><span id="EdgePermuters-270"><a href="#EdgePermuters-270"><span class="linenos">270</span></a>		<span class="nd">@staticmethod</span>
</span><span id="EdgePermuters-271"><a href="#EdgePermuters-271"><span class="linenos">271</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_permute</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="EdgePermuters-272"><a href="#EdgePermuters-272"><span class="linenos">272</span></a>			<span class="n">_NUMPY_RNG</span><span class="o">.</span><span class="n">permuted</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">lattice_edges</span><span class="p">)</span>
</span><span id="EdgePermuters-273"><a href="#EdgePermuters-273"><span class="linenos">273</span></a>			<span class="k">return</span> <span class="n">lattice_edges</span>
</span><span id="EdgePermuters-274"><a href="#EdgePermuters-274"><span class="linenos">274</span></a>
</span><span id="EdgePermuters-275"><a href="#EdgePermuters-275"><span class="linenos">275</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgePermuters-276"><a href="#EdgePermuters-276"><span class="linenos">276</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">BothCoords</span><span class="p">(</span><span class="n">_EdgePermuter</span><span class="p">):</span>
</span><span id="EdgePermuters-277"><a href="#EdgePermuters-277"><span class="linenos">277</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Includes both possible permutations of every edge in the output.</span>
</span><span id="EdgePermuters-278"><a href="#EdgePermuters-278"><span class="linenos">278</span></a>
</span><span id="EdgePermuters-279"><a href="#EdgePermuters-279"><span class="linenos">279</span></a><span class="sd">		Since input ConnectionList has only 1 instance of each edge,</span>
</span><span id="EdgePermuters-280"><a href="#EdgePermuters-280"><span class="linenos">280</span></a><span class="sd">		a call to `BothCoords._permute` will modify `lattice_edges` in-place, doubling `shape[0]`.</span>
</span><span id="EdgePermuters-281"><a href="#EdgePermuters-281"><span class="linenos">281</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="EdgePermuters-282"><a href="#EdgePermuters-282"><span class="linenos">282</span></a>
</span><span id="EdgePermuters-283"><a href="#EdgePermuters-283"><span class="linenos">283</span></a>		<span class="nd">@staticmethod</span>
</span><span id="EdgePermuters-284"><a href="#EdgePermuters-284"><span class="linenos">284</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_permute</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="EdgePermuters-285"><a href="#EdgePermuters-285"><span class="linenos">285</span></a>			<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Namespace for <code>_EdgePermuter</code> subclass hierarchy used by <code>_AdjListTokenizer</code>.</p>
</div>


                            <div id="EdgePermuters.key" class="classattr">
                                <div class="attr variable">
            <span class="name">key</span>        =
<span class="default_value">&#39;edge_permuter&#39;</span>

        
    </div>
    <a class="headerlink" href="#EdgePermuters.key"></a>
    
    

                            </div>
                </section>
                <section id="EdgePermuters.SortedCoords">
                            <input id="EdgePermuters.SortedCoords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">EdgePermuters.SortedCoords</span><wbr>(<span class="base"><a href="#EdgePermuters._EdgePermuter">EdgePermuters._EdgePermuter</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgePermuters.SortedCoords-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L247-L263" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgePermuters.SortedCoords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgePermuters.SortedCoords-248"><a href="#EdgePermuters.SortedCoords-248"><span class="linenos">248</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords-249"><a href="#EdgePermuters.SortedCoords-249"><span class="linenos">249</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">SortedCoords</span><span class="p">(</span><span class="n">_EdgePermuter</span><span class="p">):</span>
</span><span id="EdgePermuters.SortedCoords-250"><a href="#EdgePermuters.SortedCoords-250"><span class="linenos">250</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;returns a sorted representation. useful for checking consistency&quot;&quot;&quot;</span>
</span><span id="EdgePermuters.SortedCoords-251"><a href="#EdgePermuters.SortedCoords-251"><span class="linenos">251</span></a>
</span><span id="EdgePermuters.SortedCoords-252"><a href="#EdgePermuters.SortedCoords-252"><span class="linenos">252</span></a>		<span class="nd">@staticmethod</span>
</span><span id="EdgePermuters.SortedCoords-253"><a href="#EdgePermuters.SortedCoords-253"><span class="linenos">253</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_permute</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="EdgePermuters.SortedCoords-254"><a href="#EdgePermuters.SortedCoords-254"><span class="linenos">254</span></a>			<span class="k">return</span> <span class="n">lattice_edges</span><span class="p">[</span>
</span><span id="EdgePermuters.SortedCoords-255"><a href="#EdgePermuters.SortedCoords-255"><span class="linenos">255</span></a>				<span class="n">np</span><span class="o">.</span><span class="n">lexsort</span><span class="p">(</span>
</span><span id="EdgePermuters.SortedCoords-256"><a href="#EdgePermuters.SortedCoords-256"><span class="linenos">256</span></a>					<span class="p">(</span>
</span><span id="EdgePermuters.SortedCoords-257"><a href="#EdgePermuters.SortedCoords-257"><span class="linenos">257</span></a>						<span class="n">lattice_edges</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
</span><span id="EdgePermuters.SortedCoords-258"><a href="#EdgePermuters.SortedCoords-258"><span class="linenos">258</span></a>						<span class="n">lattice_edges</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
</span><span id="EdgePermuters.SortedCoords-259"><a href="#EdgePermuters.SortedCoords-259"><span class="linenos">259</span></a>						<span class="n">lattice_edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
</span><span id="EdgePermuters.SortedCoords-260"><a href="#EdgePermuters.SortedCoords-260"><span class="linenos">260</span></a>						<span class="n">lattice_edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
</span><span id="EdgePermuters.SortedCoords-261"><a href="#EdgePermuters.SortedCoords-261"><span class="linenos">261</span></a>					<span class="p">),</span>
</span><span id="EdgePermuters.SortedCoords-262"><a href="#EdgePermuters.SortedCoords-262"><span class="linenos">262</span></a>				<span class="p">),</span>
</span><span id="EdgePermuters.SortedCoords-263"><a href="#EdgePermuters.SortedCoords-263"><span class="linenos">263</span></a>				<span class="o">...</span><span class="p">,</span>
</span><span id="EdgePermuters.SortedCoords-264"><a href="#EdgePermuters.SortedCoords-264"><span class="linenos">264</span></a>			<span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>returns a sorted representation. useful for checking consistency</p>
</div>


                            <div id="EdgePermuters.SortedCoords.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">EdgePermuters.SortedCoords</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#EdgePermuters.SortedCoords">EdgePermuters.SortedCoords</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#EdgePermuters.SortedCoords">EdgePermuters.SortedCoords</a>&#39;&gt;&quot;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#EdgePermuters.SortedCoords.__init__"></a>
    
    

                            </div>
                            <div id="EdgePermuters.SortedCoords.serialize" class="classattr">
                                        <input id="EdgePermuters.SortedCoords.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgePermuters.SortedCoords.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L713-L769" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgePermuters.SortedCoords.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgePermuters.SortedCoords.serialize-714"><a href="#EdgePermuters.SortedCoords.serialize-714"><span class="linenos">714</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="EdgePermuters.SortedCoords.serialize-715"><a href="#EdgePermuters.SortedCoords.serialize-715"><span class="linenos">715</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="EdgePermuters.SortedCoords.serialize-716"><a href="#EdgePermuters.SortedCoords.serialize-716"><span class="linenos">716</span></a>                <span class="n">_FORMAT_KEY</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="EdgePermuters.SortedCoords.serialize-717"><a href="#EdgePermuters.SortedCoords.serialize-717"><span class="linenos">717</span></a>            <span class="p">}</span>
</span><span id="EdgePermuters.SortedCoords.serialize-718"><a href="#EdgePermuters.SortedCoords.serialize-718"><span class="linenos">718</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="EdgePermuters.SortedCoords.serialize-719"><a href="#EdgePermuters.SortedCoords.serialize-719"><span class="linenos">719</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="EdgePermuters.SortedCoords.serialize-720"><a href="#EdgePermuters.SortedCoords.serialize-720"><span class="linenos">720</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="EdgePermuters.SortedCoords.serialize-721"><a href="#EdgePermuters.SortedCoords.serialize-721"><span class="linenos">721</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="EdgePermuters.SortedCoords.serialize-722"><a href="#EdgePermuters.SortedCoords.serialize-722"><span class="linenos">722</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="EdgePermuters.SortedCoords.serialize-723"><a href="#EdgePermuters.SortedCoords.serialize-723"><span class="linenos">723</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="EdgePermuters.SortedCoords.serialize-724"><a href="#EdgePermuters.SortedCoords.serialize-724"><span class="linenos">724</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="EdgePermuters.SortedCoords.serialize-725"><a href="#EdgePermuters.SortedCoords.serialize-725"><span class="linenos">725</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="EdgePermuters.SortedCoords.serialize-726"><a href="#EdgePermuters.SortedCoords.serialize-726"><span class="linenos">726</span></a>                    <span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.serialize-727"><a href="#EdgePermuters.SortedCoords.serialize-727"><span class="linenos">727</span></a>
</span><span id="EdgePermuters.SortedCoords.serialize-728"><a href="#EdgePermuters.SortedCoords.serialize-728"><span class="linenos">728</span></a>                <span class="c1"># try to save it</span>
</span><span id="EdgePermuters.SortedCoords.serialize-729"><a href="#EdgePermuters.SortedCoords.serialize-729"><span class="linenos">729</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="EdgePermuters.SortedCoords.serialize-730"><a href="#EdgePermuters.SortedCoords.serialize-730"><span class="linenos">730</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="EdgePermuters.SortedCoords.serialize-731"><a href="#EdgePermuters.SortedCoords.serialize-731"><span class="linenos">731</span></a>                        <span class="c1"># get the val</span>
</span><span id="EdgePermuters.SortedCoords.serialize-732"><a href="#EdgePermuters.SortedCoords.serialize-732"><span class="linenos">732</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.serialize-733"><a href="#EdgePermuters.SortedCoords.serialize-733"><span class="linenos">733</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="EdgePermuters.SortedCoords.serialize-734"><a href="#EdgePermuters.SortedCoords.serialize-734"><span class="linenos">734</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="EdgePermuters.SortedCoords.serialize-735"><a href="#EdgePermuters.SortedCoords.serialize-735"><span class="linenos">735</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="EdgePermuters.SortedCoords.serialize-736"><a href="#EdgePermuters.SortedCoords.serialize-736"><span class="linenos">736</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="EdgePermuters.SortedCoords.serialize-737"><a href="#EdgePermuters.SortedCoords.serialize-737"><span class="linenos">737</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="EdgePermuters.SortedCoords.serialize-738"><a href="#EdgePermuters.SortedCoords.serialize-738"><span class="linenos">738</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="EdgePermuters.SortedCoords.serialize-739"><a href="#EdgePermuters.SortedCoords.serialize-739"><span class="linenos">739</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="EdgePermuters.SortedCoords.serialize-740"><a href="#EdgePermuters.SortedCoords.serialize-740"><span class="linenos">740</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="EdgePermuters.SortedCoords.serialize-741"><a href="#EdgePermuters.SortedCoords.serialize-741"><span class="linenos">741</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="EdgePermuters.SortedCoords.serialize-742"><a href="#EdgePermuters.SortedCoords.serialize-742"><span class="linenos">742</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.serialize-743"><a href="#EdgePermuters.SortedCoords.serialize-743"><span class="linenos">743</span></a>
</span><span id="EdgePermuters.SortedCoords.serialize-744"><a href="#EdgePermuters.SortedCoords.serialize-744"><span class="linenos">744</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="EdgePermuters.SortedCoords.serialize-745"><a href="#EdgePermuters.SortedCoords.serialize-745"><span class="linenos">745</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgePermuters.SortedCoords.serialize-746"><a href="#EdgePermuters.SortedCoords.serialize-746"><span class="linenos">746</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="EdgePermuters.SortedCoords.serialize-747"><a href="#EdgePermuters.SortedCoords.serialize-747"><span class="linenos">747</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="EdgePermuters.SortedCoords.serialize-748"><a href="#EdgePermuters.SortedCoords.serialize-748"><span class="linenos">748</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="EdgePermuters.SortedCoords.serialize-749"><a href="#EdgePermuters.SortedCoords.serialize-749"><span class="linenos">749</span></a>                                <span class="p">[</span>
</span><span id="EdgePermuters.SortedCoords.serialize-750"><a href="#EdgePermuters.SortedCoords.serialize-750"><span class="linenos">750</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgePermuters.SortedCoords.serialize-751"><a href="#EdgePermuters.SortedCoords.serialize-751"><span class="linenos">751</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgePermuters.SortedCoords.serialize-752"><a href="#EdgePermuters.SortedCoords.serialize-752"><span class="linenos">752</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgePermuters.SortedCoords.serialize-753"><a href="#EdgePermuters.SortedCoords.serialize-753"><span class="linenos">753</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgePermuters.SortedCoords.serialize-754"><a href="#EdgePermuters.SortedCoords.serialize-754"><span class="linenos">754</span></a>                                <span class="p">]</span>
</span><span id="EdgePermuters.SortedCoords.serialize-755"><a href="#EdgePermuters.SortedCoords.serialize-755"><span class="linenos">755</span></a>                            <span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.serialize-756"><a href="#EdgePermuters.SortedCoords.serialize-756"><span class="linenos">756</span></a>                        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</span><span id="EdgePermuters.SortedCoords.serialize-757"><a href="#EdgePermuters.SortedCoords.serialize-757"><span class="linenos">757</span></a>
</span><span id="EdgePermuters.SortedCoords.serialize-758"><a href="#EdgePermuters.SortedCoords.serialize-758"><span class="linenos">758</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="EdgePermuters.SortedCoords.serialize-759"><a href="#EdgePermuters.SortedCoords.serialize-759"><span class="linenos">759</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="EdgePermuters.SortedCoords.serialize-760"><a href="#EdgePermuters.SortedCoords.serialize-760"><span class="linenos">760</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="EdgePermuters.SortedCoords.serialize-761"><a href="#EdgePermuters.SortedCoords.serialize-761"><span class="linenos">761</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.serialize-762"><a href="#EdgePermuters.SortedCoords.serialize-762"><span class="linenos">762</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgePermuters.SortedCoords.serialize-763"><a href="#EdgePermuters.SortedCoords.serialize-763"><span class="linenos">763</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="EdgePermuters.SortedCoords.serialize-764"><a href="#EdgePermuters.SortedCoords.serialize-764"><span class="linenos">764</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="EdgePermuters.SortedCoords.serialize-765"><a href="#EdgePermuters.SortedCoords.serialize-765"><span class="linenos">765</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.SortedCoords.serialize-766"><a href="#EdgePermuters.SortedCoords.serialize-766"><span class="linenos">766</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.SortedCoords.serialize-767"><a href="#EdgePermuters.SortedCoords.serialize-767"><span class="linenos">767</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.SortedCoords.serialize-768"><a href="#EdgePermuters.SortedCoords.serialize-768"><span class="linenos">768</span></a>                    <span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.serialize-769"><a href="#EdgePermuters.SortedCoords.serialize-769"><span class="linenos">769</span></a>
</span><span id="EdgePermuters.SortedCoords.serialize-770"><a href="#EdgePermuters.SortedCoords.serialize-770"><span class="linenos">770</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="EdgePermuters.SortedCoords.load" class="classattr">
                                        <input id="EdgePermuters.SortedCoords.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgePermuters.SortedCoords.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L776-L862" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgePermuters.SortedCoords.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgePermuters.SortedCoords.load-777"><a href="#EdgePermuters.SortedCoords.load-777"><span class="linenos">777</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="EdgePermuters.SortedCoords.load-778"><a href="#EdgePermuters.SortedCoords.load-778"><span class="linenos">778</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="EdgePermuters.SortedCoords.load-779"><a href="#EdgePermuters.SortedCoords.load-779"><span class="linenos">779</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="EdgePermuters.SortedCoords.load-780"><a href="#EdgePermuters.SortedCoords.load-780"><span class="linenos">780</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="EdgePermuters.SortedCoords.load-781"><a href="#EdgePermuters.SortedCoords.load-781"><span class="linenos">781</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="EdgePermuters.SortedCoords.load-782"><a href="#EdgePermuters.SortedCoords.load-782"><span class="linenos">782</span></a>
</span><span id="EdgePermuters.SortedCoords.load-783"><a href="#EdgePermuters.SortedCoords.load-783"><span class="linenos">783</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="EdgePermuters.SortedCoords.load-784"><a href="#EdgePermuters.SortedCoords.load-784"><span class="linenos">784</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="EdgePermuters.SortedCoords.load-785"><a href="#EdgePermuters.SortedCoords.load-785"><span class="linenos">785</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.SortedCoords.load-786"><a href="#EdgePermuters.SortedCoords.load-786"><span class="linenos">786</span></a>
</span><span id="EdgePermuters.SortedCoords.load-787"><a href="#EdgePermuters.SortedCoords.load-787"><span class="linenos">787</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.load-788"><a href="#EdgePermuters.SortedCoords.load-788"><span class="linenos">788</span></a>
</span><span id="EdgePermuters.SortedCoords.load-789"><a href="#EdgePermuters.SortedCoords.load-789"><span class="linenos">789</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="EdgePermuters.SortedCoords.load-790"><a href="#EdgePermuters.SortedCoords.load-790"><span class="linenos">790</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="EdgePermuters.SortedCoords.load-791"><a href="#EdgePermuters.SortedCoords.load-791"><span class="linenos">791</span></a>
</span><span id="EdgePermuters.SortedCoords.load-792"><a href="#EdgePermuters.SortedCoords.load-792"><span class="linenos">792</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="EdgePermuters.SortedCoords.load-793"><a href="#EdgePermuters.SortedCoords.load-793"><span class="linenos">793</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="EdgePermuters.SortedCoords.load-794"><a href="#EdgePermuters.SortedCoords.load-794"><span class="linenos">794</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="EdgePermuters.SortedCoords.load-795"><a href="#EdgePermuters.SortedCoords.load-795"><span class="linenos">795</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="EdgePermuters.SortedCoords.load-796"><a href="#EdgePermuters.SortedCoords.load-796"><span class="linenos">796</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="EdgePermuters.SortedCoords.load-797"><a href="#EdgePermuters.SortedCoords.load-797"><span class="linenos">797</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="EdgePermuters.SortedCoords.load-798"><a href="#EdgePermuters.SortedCoords.load-798"><span class="linenos">798</span></a>
</span><span id="EdgePermuters.SortedCoords.load-799"><a href="#EdgePermuters.SortedCoords.load-799"><span class="linenos">799</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="EdgePermuters.SortedCoords.load-800"><a href="#EdgePermuters.SortedCoords.load-800"><span class="linenos">800</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="EdgePermuters.SortedCoords.load-801"><a href="#EdgePermuters.SortedCoords.load-801"><span class="linenos">801</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="EdgePermuters.SortedCoords.load-802"><a href="#EdgePermuters.SortedCoords.load-802"><span class="linenos">802</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="EdgePermuters.SortedCoords.load-803"><a href="#EdgePermuters.SortedCoords.load-803"><span class="linenos">803</span></a>
</span><span id="EdgePermuters.SortedCoords.load-804"><a href="#EdgePermuters.SortedCoords.load-804"><span class="linenos">804</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="EdgePermuters.SortedCoords.load-805"><a href="#EdgePermuters.SortedCoords.load-805"><span class="linenos">805</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.load-806"><a href="#EdgePermuters.SortedCoords.load-806"><span class="linenos">806</span></a>
</span><span id="EdgePermuters.SortedCoords.load-807"><a href="#EdgePermuters.SortedCoords.load-807"><span class="linenos">807</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="EdgePermuters.SortedCoords.load-808"><a href="#EdgePermuters.SortedCoords.load-808"><span class="linenos">808</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="EdgePermuters.SortedCoords.load-809"><a href="#EdgePermuters.SortedCoords.load-809"><span class="linenos">809</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="EdgePermuters.SortedCoords.load-810"><a href="#EdgePermuters.SortedCoords.load-810"><span class="linenos">810</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.load-811"><a href="#EdgePermuters.SortedCoords.load-811"><span class="linenos">811</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="EdgePermuters.SortedCoords.load-812"><a href="#EdgePermuters.SortedCoords.load-812"><span class="linenos">812</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="EdgePermuters.SortedCoords.load-813"><a href="#EdgePermuters.SortedCoords.load-813"><span class="linenos">813</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.load-814"><a href="#EdgePermuters.SortedCoords.load-814"><span class="linenos">814</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="EdgePermuters.SortedCoords.load-815"><a href="#EdgePermuters.SortedCoords.load-815"><span class="linenos">815</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="EdgePermuters.SortedCoords.load-816"><a href="#EdgePermuters.SortedCoords.load-816"><span class="linenos">816</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.load-817"><a href="#EdgePermuters.SortedCoords.load-817"><span class="linenos">817</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.load-818"><a href="#EdgePermuters.SortedCoords.load-818"><span class="linenos">818</span></a>                    <span class="p">):</span>
</span><span id="EdgePermuters.SortedCoords.load-819"><a href="#EdgePermuters.SortedCoords.load-819"><span class="linenos">819</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="EdgePermuters.SortedCoords.load-820"><a href="#EdgePermuters.SortedCoords.load-820"><span class="linenos">820</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="EdgePermuters.SortedCoords.load-821"><a href="#EdgePermuters.SortedCoords.load-821"><span class="linenos">821</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.load-822"><a href="#EdgePermuters.SortedCoords.load-822"><span class="linenos">822</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="EdgePermuters.SortedCoords.load-823"><a href="#EdgePermuters.SortedCoords.load-823"><span class="linenos">823</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="EdgePermuters.SortedCoords.load-824"><a href="#EdgePermuters.SortedCoords.load-824"><span class="linenos">824</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.SortedCoords.load-825"><a href="#EdgePermuters.SortedCoords.load-825"><span class="linenos">825</span></a>                            <span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.load-826"><a href="#EdgePermuters.SortedCoords.load-826"><span class="linenos">826</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="EdgePermuters.SortedCoords.load-827"><a href="#EdgePermuters.SortedCoords.load-827"><span class="linenos">827</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="EdgePermuters.SortedCoords.load-828"><a href="#EdgePermuters.SortedCoords.load-828"><span class="linenos">828</span></a>                        <span class="k">pass</span>
</span><span id="EdgePermuters.SortedCoords.load-829"><a href="#EdgePermuters.SortedCoords.load-829"><span class="linenos">829</span></a>
</span><span id="EdgePermuters.SortedCoords.load-830"><a href="#EdgePermuters.SortedCoords.load-830"><span class="linenos">830</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="EdgePermuters.SortedCoords.load-831"><a href="#EdgePermuters.SortedCoords.load-831"><span class="linenos">831</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgePermuters.SortedCoords.load-832"><a href="#EdgePermuters.SortedCoords.load-832"><span class="linenos">832</span></a>
</span><span id="EdgePermuters.SortedCoords.load-833"><a href="#EdgePermuters.SortedCoords.load-833"><span class="linenos">833</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="EdgePermuters.SortedCoords.load-834"><a href="#EdgePermuters.SortedCoords.load-834"><span class="linenos">834</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.load-835"><a href="#EdgePermuters.SortedCoords.load-835"><span class="linenos">835</span></a>
</span><span id="EdgePermuters.SortedCoords.load-836"><a href="#EdgePermuters.SortedCoords.load-836"><span class="linenos">836</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="EdgePermuters.SortedCoords.load-837"><a href="#EdgePermuters.SortedCoords.load-837"><span class="linenos">837</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="EdgePermuters.SortedCoords.load-838"><a href="#EdgePermuters.SortedCoords.load-838"><span class="linenos">838</span></a>                <span class="n">fields_valid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="EdgePermuters.SortedCoords.load-839"><a href="#EdgePermuters.SortedCoords.load-839"><span class="linenos">839</span></a>                    <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="EdgePermuters.SortedCoords.load-840"><a href="#EdgePermuters.SortedCoords.load-840"><span class="linenos">840</span></a>                        <span class="n">output</span><span class="p">,</span>
</span><span id="EdgePermuters.SortedCoords.load-841"><a href="#EdgePermuters.SortedCoords.load-841"><span class="linenos">841</span></a>                        <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">,</span>
</span><span id="EdgePermuters.SortedCoords.load-842"><a href="#EdgePermuters.SortedCoords.load-842"><span class="linenos">842</span></a>                    <span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.load-843"><a href="#EdgePermuters.SortedCoords.load-843"><span class="linenos">843</span></a>                <span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.load-844"><a href="#EdgePermuters.SortedCoords.load-844"><span class="linenos">844</span></a>
</span><span id="EdgePermuters.SortedCoords.load-845"><a href="#EdgePermuters.SortedCoords.load-845"><span class="linenos">845</span></a>                <span class="c1"># if there are any fields that are not valid, raise an error</span>
</span><span id="EdgePermuters.SortedCoords.load-846"><a href="#EdgePermuters.SortedCoords.load-846"><span class="linenos">846</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">fields_valid</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="EdgePermuters.SortedCoords.load-847"><a href="#EdgePermuters.SortedCoords.load-847"><span class="linenos">847</span></a>                    <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="EdgePermuters.SortedCoords.load-848"><a href="#EdgePermuters.SortedCoords.load-848"><span class="linenos">848</span></a>                        <span class="sa">f</span><span class="s2">&quot;Type mismatch in fields of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.SortedCoords.load-849"><a href="#EdgePermuters.SortedCoords.load-849"><span class="linenos">849</span></a>                        <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="EdgePermuters.SortedCoords.load-850"><a href="#EdgePermuters.SortedCoords.load-850"><span class="linenos">850</span></a>                            <span class="p">[</span>
</span><span id="EdgePermuters.SortedCoords.load-851"><a href="#EdgePermuters.SortedCoords.load-851"><span class="linenos">851</span></a>                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">:</span><span class="se">\t</span><span class="s2">expected </span><span class="si">{</span><span class="n">cls_type_hints</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="si">= }</span><span class="s2">, but got value </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.SortedCoords.load-852"><a href="#EdgePermuters.SortedCoords.load-852"><span class="linenos">852</span></a>                                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">fields_valid</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="EdgePermuters.SortedCoords.load-853"><a href="#EdgePermuters.SortedCoords.load-853"><span class="linenos">853</span></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span>
</span><span id="EdgePermuters.SortedCoords.load-854"><a href="#EdgePermuters.SortedCoords.load-854"><span class="linenos">854</span></a>                            <span class="p">]</span>
</span><span id="EdgePermuters.SortedCoords.load-855"><a href="#EdgePermuters.SortedCoords.load-855"><span class="linenos">855</span></a>                        <span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.load-856"><a href="#EdgePermuters.SortedCoords.load-856"><span class="linenos">856</span></a>                    <span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.load-857"><a href="#EdgePermuters.SortedCoords.load-857"><span class="linenos">857</span></a>
</span><span id="EdgePermuters.SortedCoords.load-858"><a href="#EdgePermuters.SortedCoords.load-858"><span class="linenos">858</span></a>                    <span class="n">on_typecheck_mismatch</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
</span><span id="EdgePermuters.SortedCoords.load-859"><a href="#EdgePermuters.SortedCoords.load-859"><span class="linenos">859</span></a>                        <span class="n">msg</span><span class="p">,</span> <span class="n">except_cls</span><span class="o">=</span><span class="n">FieldTypeMismatchError</span>
</span><span id="EdgePermuters.SortedCoords.load-860"><a href="#EdgePermuters.SortedCoords.load-860"><span class="linenos">860</span></a>                    <span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.load-861"><a href="#EdgePermuters.SortedCoords.load-861"><span class="linenos">861</span></a>
</span><span id="EdgePermuters.SortedCoords.load-862"><a href="#EdgePermuters.SortedCoords.load-862"><span class="linenos">862</span></a>            <span class="c1"># return the new instance</span>
</span><span id="EdgePermuters.SortedCoords.load-863"><a href="#EdgePermuters.SortedCoords.load-863"><span class="linenos">863</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="EdgePermuters.SortedCoords.validate_fields_types" class="classattr">
                                        <input id="EdgePermuters.SortedCoords.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgePermuters.SortedCoords.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L282-L291" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgePermuters.SortedCoords.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgePermuters.SortedCoords.validate_fields_types-283"><a href="#EdgePermuters.SortedCoords.validate_fields_types-283"><span class="linenos">283</span></a><span class="k">def</span><span class="w"> </span><span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="EdgePermuters.SortedCoords.validate_fields_types-284"><a href="#EdgePermuters.SortedCoords.validate_fields_types-284"><span class="linenos">284</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="EdgePermuters.SortedCoords.validate_fields_types-285"><a href="#EdgePermuters.SortedCoords.validate_fields_types-285"><span class="linenos">285</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="EdgePermuters.SortedCoords.validate_fields_types-286"><a href="#EdgePermuters.SortedCoords.validate_fields_types-286"><span class="linenos">286</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="EdgePermuters.SortedCoords.validate_fields_types-287"><a href="#EdgePermuters.SortedCoords.validate_fields_types-287"><span class="linenos">287</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="EdgePermuters.SortedCoords.validate_fields_types-288"><a href="#EdgePermuters.SortedCoords.validate_fields_types-288"><span class="linenos">288</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="EdgePermuters.SortedCoords.validate_fields_types-289"><a href="#EdgePermuters.SortedCoords.validate_fields_types-289"><span class="linenos">289</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="EdgePermuters.SortedCoords.validate_fields_types-290"><a href="#EdgePermuters.SortedCoords.validate_fields_types-290"><span class="linenos">290</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="EdgePermuters.SortedCoords.validate_fields_types-291"><a href="#EdgePermuters.SortedCoords.validate_fields_types-291"><span class="linenos">291</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="EdgePermuters.SortedCoords.validate_fields_types-292"><a href="#EdgePermuters.SortedCoords.validate_fields_types-292"><span class="linenos">292</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#EdgePermuters._EdgePermuter">EdgePermuters._EdgePermuter</a></dt>
                                <dd id="EdgePermuters.SortedCoords.attribute_key" class="function"><a href="#EdgePermuters._EdgePermuter.attribute_key">attribute_key</a></dd>
                <dd id="EdgePermuters.SortedCoords.is_valid" class="function"><a href="#EdgePermuters._EdgePermuter.is_valid">is_valid</a></dd>

            </div>
            <div><dt><a href="element_base.html#_TokenizerElement">maze_dataset.tokenization.modular.element_base._TokenizerElement</a></dt>
                                <dd id="EdgePermuters.SortedCoords.name" class="variable"><a href="element_base.html#_TokenizerElement.name">name</a></dd>
                <dd id="EdgePermuters.SortedCoords.tokenizer_elements" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="EdgePermuters.SortedCoords.tokenizer_element_tree" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="EdgePermuters.SortedCoords.tokenizer_element_dict" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>
                <dd id="EdgePermuters.SortedCoords.to_tokens" class="function"><a href="element_base.html#_TokenizerElement.to_tokens">to_tokens</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="EdgePermuters.SortedCoords.validate_field_type" class="function">validate_field_type</dd>
                <dd id="EdgePermuters.SortedCoords.diff" class="function">diff</dd>
                <dd id="EdgePermuters.SortedCoords.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="EdgePermuters.RandomCoords">
                            <input id="EdgePermuters.RandomCoords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">EdgePermuters.RandomCoords</span><wbr>(<span class="base"><a href="#EdgePermuters._EdgePermuter">EdgePermuters._EdgePermuter</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgePermuters.RandomCoords-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L265-L272" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgePermuters.RandomCoords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgePermuters.RandomCoords-266"><a href="#EdgePermuters.RandomCoords-266"><span class="linenos">266</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords-267"><a href="#EdgePermuters.RandomCoords-267"><span class="linenos">267</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">RandomCoords</span><span class="p">(</span><span class="n">_EdgePermuter</span><span class="p">):</span>
</span><span id="EdgePermuters.RandomCoords-268"><a href="#EdgePermuters.RandomCoords-268"><span class="linenos">268</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Permutes each edge randomly.&quot;&quot;&quot;</span>
</span><span id="EdgePermuters.RandomCoords-269"><a href="#EdgePermuters.RandomCoords-269"><span class="linenos">269</span></a>
</span><span id="EdgePermuters.RandomCoords-270"><a href="#EdgePermuters.RandomCoords-270"><span class="linenos">270</span></a>		<span class="nd">@staticmethod</span>
</span><span id="EdgePermuters.RandomCoords-271"><a href="#EdgePermuters.RandomCoords-271"><span class="linenos">271</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_permute</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="EdgePermuters.RandomCoords-272"><a href="#EdgePermuters.RandomCoords-272"><span class="linenos">272</span></a>			<span class="n">_NUMPY_RNG</span><span class="o">.</span><span class="n">permuted</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">lattice_edges</span><span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords-273"><a href="#EdgePermuters.RandomCoords-273"><span class="linenos">273</span></a>			<span class="k">return</span> <span class="n">lattice_edges</span>
</span></pre></div>


            <div class="docstring"><p>Permutes each edge randomly.</p>
</div>


                            <div id="EdgePermuters.RandomCoords.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">EdgePermuters.RandomCoords</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#EdgePermuters.RandomCoords">EdgePermuters.RandomCoords</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#EdgePermuters.RandomCoords">EdgePermuters.RandomCoords</a>&#39;&gt;&quot;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#EdgePermuters.RandomCoords.__init__"></a>
    
    

                            </div>
                            <div id="EdgePermuters.RandomCoords.serialize" class="classattr">
                                        <input id="EdgePermuters.RandomCoords.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgePermuters.RandomCoords.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L713-L769" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgePermuters.RandomCoords.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgePermuters.RandomCoords.serialize-714"><a href="#EdgePermuters.RandomCoords.serialize-714"><span class="linenos">714</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="EdgePermuters.RandomCoords.serialize-715"><a href="#EdgePermuters.RandomCoords.serialize-715"><span class="linenos">715</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="EdgePermuters.RandomCoords.serialize-716"><a href="#EdgePermuters.RandomCoords.serialize-716"><span class="linenos">716</span></a>                <span class="n">_FORMAT_KEY</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="EdgePermuters.RandomCoords.serialize-717"><a href="#EdgePermuters.RandomCoords.serialize-717"><span class="linenos">717</span></a>            <span class="p">}</span>
</span><span id="EdgePermuters.RandomCoords.serialize-718"><a href="#EdgePermuters.RandomCoords.serialize-718"><span class="linenos">718</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="EdgePermuters.RandomCoords.serialize-719"><a href="#EdgePermuters.RandomCoords.serialize-719"><span class="linenos">719</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="EdgePermuters.RandomCoords.serialize-720"><a href="#EdgePermuters.RandomCoords.serialize-720"><span class="linenos">720</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="EdgePermuters.RandomCoords.serialize-721"><a href="#EdgePermuters.RandomCoords.serialize-721"><span class="linenos">721</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="EdgePermuters.RandomCoords.serialize-722"><a href="#EdgePermuters.RandomCoords.serialize-722"><span class="linenos">722</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="EdgePermuters.RandomCoords.serialize-723"><a href="#EdgePermuters.RandomCoords.serialize-723"><span class="linenos">723</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="EdgePermuters.RandomCoords.serialize-724"><a href="#EdgePermuters.RandomCoords.serialize-724"><span class="linenos">724</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="EdgePermuters.RandomCoords.serialize-725"><a href="#EdgePermuters.RandomCoords.serialize-725"><span class="linenos">725</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="EdgePermuters.RandomCoords.serialize-726"><a href="#EdgePermuters.RandomCoords.serialize-726"><span class="linenos">726</span></a>                    <span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.serialize-727"><a href="#EdgePermuters.RandomCoords.serialize-727"><span class="linenos">727</span></a>
</span><span id="EdgePermuters.RandomCoords.serialize-728"><a href="#EdgePermuters.RandomCoords.serialize-728"><span class="linenos">728</span></a>                <span class="c1"># try to save it</span>
</span><span id="EdgePermuters.RandomCoords.serialize-729"><a href="#EdgePermuters.RandomCoords.serialize-729"><span class="linenos">729</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="EdgePermuters.RandomCoords.serialize-730"><a href="#EdgePermuters.RandomCoords.serialize-730"><span class="linenos">730</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="EdgePermuters.RandomCoords.serialize-731"><a href="#EdgePermuters.RandomCoords.serialize-731"><span class="linenos">731</span></a>                        <span class="c1"># get the val</span>
</span><span id="EdgePermuters.RandomCoords.serialize-732"><a href="#EdgePermuters.RandomCoords.serialize-732"><span class="linenos">732</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.serialize-733"><a href="#EdgePermuters.RandomCoords.serialize-733"><span class="linenos">733</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="EdgePermuters.RandomCoords.serialize-734"><a href="#EdgePermuters.RandomCoords.serialize-734"><span class="linenos">734</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="EdgePermuters.RandomCoords.serialize-735"><a href="#EdgePermuters.RandomCoords.serialize-735"><span class="linenos">735</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="EdgePermuters.RandomCoords.serialize-736"><a href="#EdgePermuters.RandomCoords.serialize-736"><span class="linenos">736</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="EdgePermuters.RandomCoords.serialize-737"><a href="#EdgePermuters.RandomCoords.serialize-737"><span class="linenos">737</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="EdgePermuters.RandomCoords.serialize-738"><a href="#EdgePermuters.RandomCoords.serialize-738"><span class="linenos">738</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="EdgePermuters.RandomCoords.serialize-739"><a href="#EdgePermuters.RandomCoords.serialize-739"><span class="linenos">739</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="EdgePermuters.RandomCoords.serialize-740"><a href="#EdgePermuters.RandomCoords.serialize-740"><span class="linenos">740</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="EdgePermuters.RandomCoords.serialize-741"><a href="#EdgePermuters.RandomCoords.serialize-741"><span class="linenos">741</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="EdgePermuters.RandomCoords.serialize-742"><a href="#EdgePermuters.RandomCoords.serialize-742"><span class="linenos">742</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.serialize-743"><a href="#EdgePermuters.RandomCoords.serialize-743"><span class="linenos">743</span></a>
</span><span id="EdgePermuters.RandomCoords.serialize-744"><a href="#EdgePermuters.RandomCoords.serialize-744"><span class="linenos">744</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="EdgePermuters.RandomCoords.serialize-745"><a href="#EdgePermuters.RandomCoords.serialize-745"><span class="linenos">745</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgePermuters.RandomCoords.serialize-746"><a href="#EdgePermuters.RandomCoords.serialize-746"><span class="linenos">746</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="EdgePermuters.RandomCoords.serialize-747"><a href="#EdgePermuters.RandomCoords.serialize-747"><span class="linenos">747</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="EdgePermuters.RandomCoords.serialize-748"><a href="#EdgePermuters.RandomCoords.serialize-748"><span class="linenos">748</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="EdgePermuters.RandomCoords.serialize-749"><a href="#EdgePermuters.RandomCoords.serialize-749"><span class="linenos">749</span></a>                                <span class="p">[</span>
</span><span id="EdgePermuters.RandomCoords.serialize-750"><a href="#EdgePermuters.RandomCoords.serialize-750"><span class="linenos">750</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgePermuters.RandomCoords.serialize-751"><a href="#EdgePermuters.RandomCoords.serialize-751"><span class="linenos">751</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgePermuters.RandomCoords.serialize-752"><a href="#EdgePermuters.RandomCoords.serialize-752"><span class="linenos">752</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgePermuters.RandomCoords.serialize-753"><a href="#EdgePermuters.RandomCoords.serialize-753"><span class="linenos">753</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgePermuters.RandomCoords.serialize-754"><a href="#EdgePermuters.RandomCoords.serialize-754"><span class="linenos">754</span></a>                                <span class="p">]</span>
</span><span id="EdgePermuters.RandomCoords.serialize-755"><a href="#EdgePermuters.RandomCoords.serialize-755"><span class="linenos">755</span></a>                            <span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.serialize-756"><a href="#EdgePermuters.RandomCoords.serialize-756"><span class="linenos">756</span></a>                        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</span><span id="EdgePermuters.RandomCoords.serialize-757"><a href="#EdgePermuters.RandomCoords.serialize-757"><span class="linenos">757</span></a>
</span><span id="EdgePermuters.RandomCoords.serialize-758"><a href="#EdgePermuters.RandomCoords.serialize-758"><span class="linenos">758</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="EdgePermuters.RandomCoords.serialize-759"><a href="#EdgePermuters.RandomCoords.serialize-759"><span class="linenos">759</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="EdgePermuters.RandomCoords.serialize-760"><a href="#EdgePermuters.RandomCoords.serialize-760"><span class="linenos">760</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="EdgePermuters.RandomCoords.serialize-761"><a href="#EdgePermuters.RandomCoords.serialize-761"><span class="linenos">761</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.serialize-762"><a href="#EdgePermuters.RandomCoords.serialize-762"><span class="linenos">762</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgePermuters.RandomCoords.serialize-763"><a href="#EdgePermuters.RandomCoords.serialize-763"><span class="linenos">763</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="EdgePermuters.RandomCoords.serialize-764"><a href="#EdgePermuters.RandomCoords.serialize-764"><span class="linenos">764</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="EdgePermuters.RandomCoords.serialize-765"><a href="#EdgePermuters.RandomCoords.serialize-765"><span class="linenos">765</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.RandomCoords.serialize-766"><a href="#EdgePermuters.RandomCoords.serialize-766"><span class="linenos">766</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.RandomCoords.serialize-767"><a href="#EdgePermuters.RandomCoords.serialize-767"><span class="linenos">767</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.RandomCoords.serialize-768"><a href="#EdgePermuters.RandomCoords.serialize-768"><span class="linenos">768</span></a>                    <span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.serialize-769"><a href="#EdgePermuters.RandomCoords.serialize-769"><span class="linenos">769</span></a>
</span><span id="EdgePermuters.RandomCoords.serialize-770"><a href="#EdgePermuters.RandomCoords.serialize-770"><span class="linenos">770</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="EdgePermuters.RandomCoords.load" class="classattr">
                                        <input id="EdgePermuters.RandomCoords.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgePermuters.RandomCoords.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L776-L862" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgePermuters.RandomCoords.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgePermuters.RandomCoords.load-777"><a href="#EdgePermuters.RandomCoords.load-777"><span class="linenos">777</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="EdgePermuters.RandomCoords.load-778"><a href="#EdgePermuters.RandomCoords.load-778"><span class="linenos">778</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="EdgePermuters.RandomCoords.load-779"><a href="#EdgePermuters.RandomCoords.load-779"><span class="linenos">779</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="EdgePermuters.RandomCoords.load-780"><a href="#EdgePermuters.RandomCoords.load-780"><span class="linenos">780</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="EdgePermuters.RandomCoords.load-781"><a href="#EdgePermuters.RandomCoords.load-781"><span class="linenos">781</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="EdgePermuters.RandomCoords.load-782"><a href="#EdgePermuters.RandomCoords.load-782"><span class="linenos">782</span></a>
</span><span id="EdgePermuters.RandomCoords.load-783"><a href="#EdgePermuters.RandomCoords.load-783"><span class="linenos">783</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="EdgePermuters.RandomCoords.load-784"><a href="#EdgePermuters.RandomCoords.load-784"><span class="linenos">784</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="EdgePermuters.RandomCoords.load-785"><a href="#EdgePermuters.RandomCoords.load-785"><span class="linenos">785</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.RandomCoords.load-786"><a href="#EdgePermuters.RandomCoords.load-786"><span class="linenos">786</span></a>
</span><span id="EdgePermuters.RandomCoords.load-787"><a href="#EdgePermuters.RandomCoords.load-787"><span class="linenos">787</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.load-788"><a href="#EdgePermuters.RandomCoords.load-788"><span class="linenos">788</span></a>
</span><span id="EdgePermuters.RandomCoords.load-789"><a href="#EdgePermuters.RandomCoords.load-789"><span class="linenos">789</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="EdgePermuters.RandomCoords.load-790"><a href="#EdgePermuters.RandomCoords.load-790"><span class="linenos">790</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="EdgePermuters.RandomCoords.load-791"><a href="#EdgePermuters.RandomCoords.load-791"><span class="linenos">791</span></a>
</span><span id="EdgePermuters.RandomCoords.load-792"><a href="#EdgePermuters.RandomCoords.load-792"><span class="linenos">792</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="EdgePermuters.RandomCoords.load-793"><a href="#EdgePermuters.RandomCoords.load-793"><span class="linenos">793</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="EdgePermuters.RandomCoords.load-794"><a href="#EdgePermuters.RandomCoords.load-794"><span class="linenos">794</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="EdgePermuters.RandomCoords.load-795"><a href="#EdgePermuters.RandomCoords.load-795"><span class="linenos">795</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="EdgePermuters.RandomCoords.load-796"><a href="#EdgePermuters.RandomCoords.load-796"><span class="linenos">796</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="EdgePermuters.RandomCoords.load-797"><a href="#EdgePermuters.RandomCoords.load-797"><span class="linenos">797</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="EdgePermuters.RandomCoords.load-798"><a href="#EdgePermuters.RandomCoords.load-798"><span class="linenos">798</span></a>
</span><span id="EdgePermuters.RandomCoords.load-799"><a href="#EdgePermuters.RandomCoords.load-799"><span class="linenos">799</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="EdgePermuters.RandomCoords.load-800"><a href="#EdgePermuters.RandomCoords.load-800"><span class="linenos">800</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="EdgePermuters.RandomCoords.load-801"><a href="#EdgePermuters.RandomCoords.load-801"><span class="linenos">801</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="EdgePermuters.RandomCoords.load-802"><a href="#EdgePermuters.RandomCoords.load-802"><span class="linenos">802</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="EdgePermuters.RandomCoords.load-803"><a href="#EdgePermuters.RandomCoords.load-803"><span class="linenos">803</span></a>
</span><span id="EdgePermuters.RandomCoords.load-804"><a href="#EdgePermuters.RandomCoords.load-804"><span class="linenos">804</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="EdgePermuters.RandomCoords.load-805"><a href="#EdgePermuters.RandomCoords.load-805"><span class="linenos">805</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.load-806"><a href="#EdgePermuters.RandomCoords.load-806"><span class="linenos">806</span></a>
</span><span id="EdgePermuters.RandomCoords.load-807"><a href="#EdgePermuters.RandomCoords.load-807"><span class="linenos">807</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="EdgePermuters.RandomCoords.load-808"><a href="#EdgePermuters.RandomCoords.load-808"><span class="linenos">808</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="EdgePermuters.RandomCoords.load-809"><a href="#EdgePermuters.RandomCoords.load-809"><span class="linenos">809</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="EdgePermuters.RandomCoords.load-810"><a href="#EdgePermuters.RandomCoords.load-810"><span class="linenos">810</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.load-811"><a href="#EdgePermuters.RandomCoords.load-811"><span class="linenos">811</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="EdgePermuters.RandomCoords.load-812"><a href="#EdgePermuters.RandomCoords.load-812"><span class="linenos">812</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="EdgePermuters.RandomCoords.load-813"><a href="#EdgePermuters.RandomCoords.load-813"><span class="linenos">813</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.load-814"><a href="#EdgePermuters.RandomCoords.load-814"><span class="linenos">814</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="EdgePermuters.RandomCoords.load-815"><a href="#EdgePermuters.RandomCoords.load-815"><span class="linenos">815</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="EdgePermuters.RandomCoords.load-816"><a href="#EdgePermuters.RandomCoords.load-816"><span class="linenos">816</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.load-817"><a href="#EdgePermuters.RandomCoords.load-817"><span class="linenos">817</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.load-818"><a href="#EdgePermuters.RandomCoords.load-818"><span class="linenos">818</span></a>                    <span class="p">):</span>
</span><span id="EdgePermuters.RandomCoords.load-819"><a href="#EdgePermuters.RandomCoords.load-819"><span class="linenos">819</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="EdgePermuters.RandomCoords.load-820"><a href="#EdgePermuters.RandomCoords.load-820"><span class="linenos">820</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="EdgePermuters.RandomCoords.load-821"><a href="#EdgePermuters.RandomCoords.load-821"><span class="linenos">821</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.load-822"><a href="#EdgePermuters.RandomCoords.load-822"><span class="linenos">822</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="EdgePermuters.RandomCoords.load-823"><a href="#EdgePermuters.RandomCoords.load-823"><span class="linenos">823</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="EdgePermuters.RandomCoords.load-824"><a href="#EdgePermuters.RandomCoords.load-824"><span class="linenos">824</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.RandomCoords.load-825"><a href="#EdgePermuters.RandomCoords.load-825"><span class="linenos">825</span></a>                            <span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.load-826"><a href="#EdgePermuters.RandomCoords.load-826"><span class="linenos">826</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="EdgePermuters.RandomCoords.load-827"><a href="#EdgePermuters.RandomCoords.load-827"><span class="linenos">827</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="EdgePermuters.RandomCoords.load-828"><a href="#EdgePermuters.RandomCoords.load-828"><span class="linenos">828</span></a>                        <span class="k">pass</span>
</span><span id="EdgePermuters.RandomCoords.load-829"><a href="#EdgePermuters.RandomCoords.load-829"><span class="linenos">829</span></a>
</span><span id="EdgePermuters.RandomCoords.load-830"><a href="#EdgePermuters.RandomCoords.load-830"><span class="linenos">830</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="EdgePermuters.RandomCoords.load-831"><a href="#EdgePermuters.RandomCoords.load-831"><span class="linenos">831</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgePermuters.RandomCoords.load-832"><a href="#EdgePermuters.RandomCoords.load-832"><span class="linenos">832</span></a>
</span><span id="EdgePermuters.RandomCoords.load-833"><a href="#EdgePermuters.RandomCoords.load-833"><span class="linenos">833</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="EdgePermuters.RandomCoords.load-834"><a href="#EdgePermuters.RandomCoords.load-834"><span class="linenos">834</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.load-835"><a href="#EdgePermuters.RandomCoords.load-835"><span class="linenos">835</span></a>
</span><span id="EdgePermuters.RandomCoords.load-836"><a href="#EdgePermuters.RandomCoords.load-836"><span class="linenos">836</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="EdgePermuters.RandomCoords.load-837"><a href="#EdgePermuters.RandomCoords.load-837"><span class="linenos">837</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="EdgePermuters.RandomCoords.load-838"><a href="#EdgePermuters.RandomCoords.load-838"><span class="linenos">838</span></a>                <span class="n">fields_valid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="EdgePermuters.RandomCoords.load-839"><a href="#EdgePermuters.RandomCoords.load-839"><span class="linenos">839</span></a>                    <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="EdgePermuters.RandomCoords.load-840"><a href="#EdgePermuters.RandomCoords.load-840"><span class="linenos">840</span></a>                        <span class="n">output</span><span class="p">,</span>
</span><span id="EdgePermuters.RandomCoords.load-841"><a href="#EdgePermuters.RandomCoords.load-841"><span class="linenos">841</span></a>                        <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">,</span>
</span><span id="EdgePermuters.RandomCoords.load-842"><a href="#EdgePermuters.RandomCoords.load-842"><span class="linenos">842</span></a>                    <span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.load-843"><a href="#EdgePermuters.RandomCoords.load-843"><span class="linenos">843</span></a>                <span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.load-844"><a href="#EdgePermuters.RandomCoords.load-844"><span class="linenos">844</span></a>
</span><span id="EdgePermuters.RandomCoords.load-845"><a href="#EdgePermuters.RandomCoords.load-845"><span class="linenos">845</span></a>                <span class="c1"># if there are any fields that are not valid, raise an error</span>
</span><span id="EdgePermuters.RandomCoords.load-846"><a href="#EdgePermuters.RandomCoords.load-846"><span class="linenos">846</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">fields_valid</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="EdgePermuters.RandomCoords.load-847"><a href="#EdgePermuters.RandomCoords.load-847"><span class="linenos">847</span></a>                    <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="EdgePermuters.RandomCoords.load-848"><a href="#EdgePermuters.RandomCoords.load-848"><span class="linenos">848</span></a>                        <span class="sa">f</span><span class="s2">&quot;Type mismatch in fields of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.RandomCoords.load-849"><a href="#EdgePermuters.RandomCoords.load-849"><span class="linenos">849</span></a>                        <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="EdgePermuters.RandomCoords.load-850"><a href="#EdgePermuters.RandomCoords.load-850"><span class="linenos">850</span></a>                            <span class="p">[</span>
</span><span id="EdgePermuters.RandomCoords.load-851"><a href="#EdgePermuters.RandomCoords.load-851"><span class="linenos">851</span></a>                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">:</span><span class="se">\t</span><span class="s2">expected </span><span class="si">{</span><span class="n">cls_type_hints</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="si">= }</span><span class="s2">, but got value </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.RandomCoords.load-852"><a href="#EdgePermuters.RandomCoords.load-852"><span class="linenos">852</span></a>                                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">fields_valid</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="EdgePermuters.RandomCoords.load-853"><a href="#EdgePermuters.RandomCoords.load-853"><span class="linenos">853</span></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span>
</span><span id="EdgePermuters.RandomCoords.load-854"><a href="#EdgePermuters.RandomCoords.load-854"><span class="linenos">854</span></a>                            <span class="p">]</span>
</span><span id="EdgePermuters.RandomCoords.load-855"><a href="#EdgePermuters.RandomCoords.load-855"><span class="linenos">855</span></a>                        <span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.load-856"><a href="#EdgePermuters.RandomCoords.load-856"><span class="linenos">856</span></a>                    <span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.load-857"><a href="#EdgePermuters.RandomCoords.load-857"><span class="linenos">857</span></a>
</span><span id="EdgePermuters.RandomCoords.load-858"><a href="#EdgePermuters.RandomCoords.load-858"><span class="linenos">858</span></a>                    <span class="n">on_typecheck_mismatch</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
</span><span id="EdgePermuters.RandomCoords.load-859"><a href="#EdgePermuters.RandomCoords.load-859"><span class="linenos">859</span></a>                        <span class="n">msg</span><span class="p">,</span> <span class="n">except_cls</span><span class="o">=</span><span class="n">FieldTypeMismatchError</span>
</span><span id="EdgePermuters.RandomCoords.load-860"><a href="#EdgePermuters.RandomCoords.load-860"><span class="linenos">860</span></a>                    <span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.load-861"><a href="#EdgePermuters.RandomCoords.load-861"><span class="linenos">861</span></a>
</span><span id="EdgePermuters.RandomCoords.load-862"><a href="#EdgePermuters.RandomCoords.load-862"><span class="linenos">862</span></a>            <span class="c1"># return the new instance</span>
</span><span id="EdgePermuters.RandomCoords.load-863"><a href="#EdgePermuters.RandomCoords.load-863"><span class="linenos">863</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="EdgePermuters.RandomCoords.validate_fields_types" class="classattr">
                                        <input id="EdgePermuters.RandomCoords.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgePermuters.RandomCoords.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L282-L291" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgePermuters.RandomCoords.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgePermuters.RandomCoords.validate_fields_types-283"><a href="#EdgePermuters.RandomCoords.validate_fields_types-283"><span class="linenos">283</span></a><span class="k">def</span><span class="w"> </span><span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="EdgePermuters.RandomCoords.validate_fields_types-284"><a href="#EdgePermuters.RandomCoords.validate_fields_types-284"><span class="linenos">284</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="EdgePermuters.RandomCoords.validate_fields_types-285"><a href="#EdgePermuters.RandomCoords.validate_fields_types-285"><span class="linenos">285</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="EdgePermuters.RandomCoords.validate_fields_types-286"><a href="#EdgePermuters.RandomCoords.validate_fields_types-286"><span class="linenos">286</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="EdgePermuters.RandomCoords.validate_fields_types-287"><a href="#EdgePermuters.RandomCoords.validate_fields_types-287"><span class="linenos">287</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="EdgePermuters.RandomCoords.validate_fields_types-288"><a href="#EdgePermuters.RandomCoords.validate_fields_types-288"><span class="linenos">288</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="EdgePermuters.RandomCoords.validate_fields_types-289"><a href="#EdgePermuters.RandomCoords.validate_fields_types-289"><span class="linenos">289</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="EdgePermuters.RandomCoords.validate_fields_types-290"><a href="#EdgePermuters.RandomCoords.validate_fields_types-290"><span class="linenos">290</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="EdgePermuters.RandomCoords.validate_fields_types-291"><a href="#EdgePermuters.RandomCoords.validate_fields_types-291"><span class="linenos">291</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="EdgePermuters.RandomCoords.validate_fields_types-292"><a href="#EdgePermuters.RandomCoords.validate_fields_types-292"><span class="linenos">292</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#EdgePermuters._EdgePermuter">EdgePermuters._EdgePermuter</a></dt>
                                <dd id="EdgePermuters.RandomCoords.attribute_key" class="function"><a href="#EdgePermuters._EdgePermuter.attribute_key">attribute_key</a></dd>
                <dd id="EdgePermuters.RandomCoords.is_valid" class="function"><a href="#EdgePermuters._EdgePermuter.is_valid">is_valid</a></dd>

            </div>
            <div><dt><a href="element_base.html#_TokenizerElement">maze_dataset.tokenization.modular.element_base._TokenizerElement</a></dt>
                                <dd id="EdgePermuters.RandomCoords.name" class="variable"><a href="element_base.html#_TokenizerElement.name">name</a></dd>
                <dd id="EdgePermuters.RandomCoords.tokenizer_elements" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="EdgePermuters.RandomCoords.tokenizer_element_tree" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="EdgePermuters.RandomCoords.tokenizer_element_dict" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>
                <dd id="EdgePermuters.RandomCoords.to_tokens" class="function"><a href="element_base.html#_TokenizerElement.to_tokens">to_tokens</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="EdgePermuters.RandomCoords.validate_field_type" class="function">validate_field_type</dd>
                <dd id="EdgePermuters.RandomCoords.diff" class="function">diff</dd>
                <dd id="EdgePermuters.RandomCoords.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="EdgePermuters.BothCoords">
                            <input id="EdgePermuters.BothCoords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">EdgePermuters.BothCoords</span><wbr>(<span class="base"><a href="#EdgePermuters._EdgePermuter">EdgePermuters._EdgePermuter</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgePermuters.BothCoords-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L274-L284" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgePermuters.BothCoords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgePermuters.BothCoords-275"><a href="#EdgePermuters.BothCoords-275"><span class="linenos">275</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgePermuters.BothCoords-276"><a href="#EdgePermuters.BothCoords-276"><span class="linenos">276</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">BothCoords</span><span class="p">(</span><span class="n">_EdgePermuter</span><span class="p">):</span>
</span><span id="EdgePermuters.BothCoords-277"><a href="#EdgePermuters.BothCoords-277"><span class="linenos">277</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Includes both possible permutations of every edge in the output.</span>
</span><span id="EdgePermuters.BothCoords-278"><a href="#EdgePermuters.BothCoords-278"><span class="linenos">278</span></a>
</span><span id="EdgePermuters.BothCoords-279"><a href="#EdgePermuters.BothCoords-279"><span class="linenos">279</span></a><span class="sd">		Since input ConnectionList has only 1 instance of each edge,</span>
</span><span id="EdgePermuters.BothCoords-280"><a href="#EdgePermuters.BothCoords-280"><span class="linenos">280</span></a><span class="sd">		a call to `BothCoords._permute` will modify `lattice_edges` in-place, doubling `shape[0]`.</span>
</span><span id="EdgePermuters.BothCoords-281"><a href="#EdgePermuters.BothCoords-281"><span class="linenos">281</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="EdgePermuters.BothCoords-282"><a href="#EdgePermuters.BothCoords-282"><span class="linenos">282</span></a>
</span><span id="EdgePermuters.BothCoords-283"><a href="#EdgePermuters.BothCoords-283"><span class="linenos">283</span></a>		<span class="nd">@staticmethod</span>
</span><span id="EdgePermuters.BothCoords-284"><a href="#EdgePermuters.BothCoords-284"><span class="linenos">284</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_permute</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="EdgePermuters.BothCoords-285"><a href="#EdgePermuters.BothCoords-285"><span class="linenos">285</span></a>			<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Includes both possible permutations of every edge in the output.</p>

<p>Since input ConnectionList has only 1 instance of each edge,
a call to <code>BothCoords._permute</code> will modify <code>lattice_edges</code> in-place, doubling <code>shape[0]</code>.</p>
</div>


                            <div id="EdgePermuters.BothCoords.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">EdgePermuters.BothCoords</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#EdgePermuters.BothCoords">EdgePermuters.BothCoords</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#EdgePermuters.BothCoords">EdgePermuters.BothCoords</a>&#39;&gt;&quot;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#EdgePermuters.BothCoords.__init__"></a>
    
    

                            </div>
                            <div id="EdgePermuters.BothCoords.serialize" class="classattr">
                                        <input id="EdgePermuters.BothCoords.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgePermuters.BothCoords.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L713-L769" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgePermuters.BothCoords.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgePermuters.BothCoords.serialize-714"><a href="#EdgePermuters.BothCoords.serialize-714"><span class="linenos">714</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="EdgePermuters.BothCoords.serialize-715"><a href="#EdgePermuters.BothCoords.serialize-715"><span class="linenos">715</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="EdgePermuters.BothCoords.serialize-716"><a href="#EdgePermuters.BothCoords.serialize-716"><span class="linenos">716</span></a>                <span class="n">_FORMAT_KEY</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="EdgePermuters.BothCoords.serialize-717"><a href="#EdgePermuters.BothCoords.serialize-717"><span class="linenos">717</span></a>            <span class="p">}</span>
</span><span id="EdgePermuters.BothCoords.serialize-718"><a href="#EdgePermuters.BothCoords.serialize-718"><span class="linenos">718</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="EdgePermuters.BothCoords.serialize-719"><a href="#EdgePermuters.BothCoords.serialize-719"><span class="linenos">719</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="EdgePermuters.BothCoords.serialize-720"><a href="#EdgePermuters.BothCoords.serialize-720"><span class="linenos">720</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="EdgePermuters.BothCoords.serialize-721"><a href="#EdgePermuters.BothCoords.serialize-721"><span class="linenos">721</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="EdgePermuters.BothCoords.serialize-722"><a href="#EdgePermuters.BothCoords.serialize-722"><span class="linenos">722</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="EdgePermuters.BothCoords.serialize-723"><a href="#EdgePermuters.BothCoords.serialize-723"><span class="linenos">723</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="EdgePermuters.BothCoords.serialize-724"><a href="#EdgePermuters.BothCoords.serialize-724"><span class="linenos">724</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="EdgePermuters.BothCoords.serialize-725"><a href="#EdgePermuters.BothCoords.serialize-725"><span class="linenos">725</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="EdgePermuters.BothCoords.serialize-726"><a href="#EdgePermuters.BothCoords.serialize-726"><span class="linenos">726</span></a>                    <span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.serialize-727"><a href="#EdgePermuters.BothCoords.serialize-727"><span class="linenos">727</span></a>
</span><span id="EdgePermuters.BothCoords.serialize-728"><a href="#EdgePermuters.BothCoords.serialize-728"><span class="linenos">728</span></a>                <span class="c1"># try to save it</span>
</span><span id="EdgePermuters.BothCoords.serialize-729"><a href="#EdgePermuters.BothCoords.serialize-729"><span class="linenos">729</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="EdgePermuters.BothCoords.serialize-730"><a href="#EdgePermuters.BothCoords.serialize-730"><span class="linenos">730</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="EdgePermuters.BothCoords.serialize-731"><a href="#EdgePermuters.BothCoords.serialize-731"><span class="linenos">731</span></a>                        <span class="c1"># get the val</span>
</span><span id="EdgePermuters.BothCoords.serialize-732"><a href="#EdgePermuters.BothCoords.serialize-732"><span class="linenos">732</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.serialize-733"><a href="#EdgePermuters.BothCoords.serialize-733"><span class="linenos">733</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="EdgePermuters.BothCoords.serialize-734"><a href="#EdgePermuters.BothCoords.serialize-734"><span class="linenos">734</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="EdgePermuters.BothCoords.serialize-735"><a href="#EdgePermuters.BothCoords.serialize-735"><span class="linenos">735</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="EdgePermuters.BothCoords.serialize-736"><a href="#EdgePermuters.BothCoords.serialize-736"><span class="linenos">736</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="EdgePermuters.BothCoords.serialize-737"><a href="#EdgePermuters.BothCoords.serialize-737"><span class="linenos">737</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="EdgePermuters.BothCoords.serialize-738"><a href="#EdgePermuters.BothCoords.serialize-738"><span class="linenos">738</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="EdgePermuters.BothCoords.serialize-739"><a href="#EdgePermuters.BothCoords.serialize-739"><span class="linenos">739</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="EdgePermuters.BothCoords.serialize-740"><a href="#EdgePermuters.BothCoords.serialize-740"><span class="linenos">740</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="EdgePermuters.BothCoords.serialize-741"><a href="#EdgePermuters.BothCoords.serialize-741"><span class="linenos">741</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="EdgePermuters.BothCoords.serialize-742"><a href="#EdgePermuters.BothCoords.serialize-742"><span class="linenos">742</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.serialize-743"><a href="#EdgePermuters.BothCoords.serialize-743"><span class="linenos">743</span></a>
</span><span id="EdgePermuters.BothCoords.serialize-744"><a href="#EdgePermuters.BothCoords.serialize-744"><span class="linenos">744</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="EdgePermuters.BothCoords.serialize-745"><a href="#EdgePermuters.BothCoords.serialize-745"><span class="linenos">745</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgePermuters.BothCoords.serialize-746"><a href="#EdgePermuters.BothCoords.serialize-746"><span class="linenos">746</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="EdgePermuters.BothCoords.serialize-747"><a href="#EdgePermuters.BothCoords.serialize-747"><span class="linenos">747</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="EdgePermuters.BothCoords.serialize-748"><a href="#EdgePermuters.BothCoords.serialize-748"><span class="linenos">748</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="EdgePermuters.BothCoords.serialize-749"><a href="#EdgePermuters.BothCoords.serialize-749"><span class="linenos">749</span></a>                                <span class="p">[</span>
</span><span id="EdgePermuters.BothCoords.serialize-750"><a href="#EdgePermuters.BothCoords.serialize-750"><span class="linenos">750</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgePermuters.BothCoords.serialize-751"><a href="#EdgePermuters.BothCoords.serialize-751"><span class="linenos">751</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgePermuters.BothCoords.serialize-752"><a href="#EdgePermuters.BothCoords.serialize-752"><span class="linenos">752</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgePermuters.BothCoords.serialize-753"><a href="#EdgePermuters.BothCoords.serialize-753"><span class="linenos">753</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgePermuters.BothCoords.serialize-754"><a href="#EdgePermuters.BothCoords.serialize-754"><span class="linenos">754</span></a>                                <span class="p">]</span>
</span><span id="EdgePermuters.BothCoords.serialize-755"><a href="#EdgePermuters.BothCoords.serialize-755"><span class="linenos">755</span></a>                            <span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.serialize-756"><a href="#EdgePermuters.BothCoords.serialize-756"><span class="linenos">756</span></a>                        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</span><span id="EdgePermuters.BothCoords.serialize-757"><a href="#EdgePermuters.BothCoords.serialize-757"><span class="linenos">757</span></a>
</span><span id="EdgePermuters.BothCoords.serialize-758"><a href="#EdgePermuters.BothCoords.serialize-758"><span class="linenos">758</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="EdgePermuters.BothCoords.serialize-759"><a href="#EdgePermuters.BothCoords.serialize-759"><span class="linenos">759</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="EdgePermuters.BothCoords.serialize-760"><a href="#EdgePermuters.BothCoords.serialize-760"><span class="linenos">760</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="EdgePermuters.BothCoords.serialize-761"><a href="#EdgePermuters.BothCoords.serialize-761"><span class="linenos">761</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.serialize-762"><a href="#EdgePermuters.BothCoords.serialize-762"><span class="linenos">762</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgePermuters.BothCoords.serialize-763"><a href="#EdgePermuters.BothCoords.serialize-763"><span class="linenos">763</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="EdgePermuters.BothCoords.serialize-764"><a href="#EdgePermuters.BothCoords.serialize-764"><span class="linenos">764</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="EdgePermuters.BothCoords.serialize-765"><a href="#EdgePermuters.BothCoords.serialize-765"><span class="linenos">765</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.BothCoords.serialize-766"><a href="#EdgePermuters.BothCoords.serialize-766"><span class="linenos">766</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.BothCoords.serialize-767"><a href="#EdgePermuters.BothCoords.serialize-767"><span class="linenos">767</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.BothCoords.serialize-768"><a href="#EdgePermuters.BothCoords.serialize-768"><span class="linenos">768</span></a>                    <span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.serialize-769"><a href="#EdgePermuters.BothCoords.serialize-769"><span class="linenos">769</span></a>
</span><span id="EdgePermuters.BothCoords.serialize-770"><a href="#EdgePermuters.BothCoords.serialize-770"><span class="linenos">770</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="EdgePermuters.BothCoords.load" class="classattr">
                                        <input id="EdgePermuters.BothCoords.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgePermuters.BothCoords.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L776-L862" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgePermuters.BothCoords.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgePermuters.BothCoords.load-777"><a href="#EdgePermuters.BothCoords.load-777"><span class="linenos">777</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="EdgePermuters.BothCoords.load-778"><a href="#EdgePermuters.BothCoords.load-778"><span class="linenos">778</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="EdgePermuters.BothCoords.load-779"><a href="#EdgePermuters.BothCoords.load-779"><span class="linenos">779</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="EdgePermuters.BothCoords.load-780"><a href="#EdgePermuters.BothCoords.load-780"><span class="linenos">780</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="EdgePermuters.BothCoords.load-781"><a href="#EdgePermuters.BothCoords.load-781"><span class="linenos">781</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="EdgePermuters.BothCoords.load-782"><a href="#EdgePermuters.BothCoords.load-782"><span class="linenos">782</span></a>
</span><span id="EdgePermuters.BothCoords.load-783"><a href="#EdgePermuters.BothCoords.load-783"><span class="linenos">783</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="EdgePermuters.BothCoords.load-784"><a href="#EdgePermuters.BothCoords.load-784"><span class="linenos">784</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="EdgePermuters.BothCoords.load-785"><a href="#EdgePermuters.BothCoords.load-785"><span class="linenos">785</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.BothCoords.load-786"><a href="#EdgePermuters.BothCoords.load-786"><span class="linenos">786</span></a>
</span><span id="EdgePermuters.BothCoords.load-787"><a href="#EdgePermuters.BothCoords.load-787"><span class="linenos">787</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.load-788"><a href="#EdgePermuters.BothCoords.load-788"><span class="linenos">788</span></a>
</span><span id="EdgePermuters.BothCoords.load-789"><a href="#EdgePermuters.BothCoords.load-789"><span class="linenos">789</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="EdgePermuters.BothCoords.load-790"><a href="#EdgePermuters.BothCoords.load-790"><span class="linenos">790</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="EdgePermuters.BothCoords.load-791"><a href="#EdgePermuters.BothCoords.load-791"><span class="linenos">791</span></a>
</span><span id="EdgePermuters.BothCoords.load-792"><a href="#EdgePermuters.BothCoords.load-792"><span class="linenos">792</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="EdgePermuters.BothCoords.load-793"><a href="#EdgePermuters.BothCoords.load-793"><span class="linenos">793</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="EdgePermuters.BothCoords.load-794"><a href="#EdgePermuters.BothCoords.load-794"><span class="linenos">794</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="EdgePermuters.BothCoords.load-795"><a href="#EdgePermuters.BothCoords.load-795"><span class="linenos">795</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="EdgePermuters.BothCoords.load-796"><a href="#EdgePermuters.BothCoords.load-796"><span class="linenos">796</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="EdgePermuters.BothCoords.load-797"><a href="#EdgePermuters.BothCoords.load-797"><span class="linenos">797</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="EdgePermuters.BothCoords.load-798"><a href="#EdgePermuters.BothCoords.load-798"><span class="linenos">798</span></a>
</span><span id="EdgePermuters.BothCoords.load-799"><a href="#EdgePermuters.BothCoords.load-799"><span class="linenos">799</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="EdgePermuters.BothCoords.load-800"><a href="#EdgePermuters.BothCoords.load-800"><span class="linenos">800</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="EdgePermuters.BothCoords.load-801"><a href="#EdgePermuters.BothCoords.load-801"><span class="linenos">801</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="EdgePermuters.BothCoords.load-802"><a href="#EdgePermuters.BothCoords.load-802"><span class="linenos">802</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="EdgePermuters.BothCoords.load-803"><a href="#EdgePermuters.BothCoords.load-803"><span class="linenos">803</span></a>
</span><span id="EdgePermuters.BothCoords.load-804"><a href="#EdgePermuters.BothCoords.load-804"><span class="linenos">804</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="EdgePermuters.BothCoords.load-805"><a href="#EdgePermuters.BothCoords.load-805"><span class="linenos">805</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.load-806"><a href="#EdgePermuters.BothCoords.load-806"><span class="linenos">806</span></a>
</span><span id="EdgePermuters.BothCoords.load-807"><a href="#EdgePermuters.BothCoords.load-807"><span class="linenos">807</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="EdgePermuters.BothCoords.load-808"><a href="#EdgePermuters.BothCoords.load-808"><span class="linenos">808</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="EdgePermuters.BothCoords.load-809"><a href="#EdgePermuters.BothCoords.load-809"><span class="linenos">809</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="EdgePermuters.BothCoords.load-810"><a href="#EdgePermuters.BothCoords.load-810"><span class="linenos">810</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.load-811"><a href="#EdgePermuters.BothCoords.load-811"><span class="linenos">811</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="EdgePermuters.BothCoords.load-812"><a href="#EdgePermuters.BothCoords.load-812"><span class="linenos">812</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="EdgePermuters.BothCoords.load-813"><a href="#EdgePermuters.BothCoords.load-813"><span class="linenos">813</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.load-814"><a href="#EdgePermuters.BothCoords.load-814"><span class="linenos">814</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="EdgePermuters.BothCoords.load-815"><a href="#EdgePermuters.BothCoords.load-815"><span class="linenos">815</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="EdgePermuters.BothCoords.load-816"><a href="#EdgePermuters.BothCoords.load-816"><span class="linenos">816</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.load-817"><a href="#EdgePermuters.BothCoords.load-817"><span class="linenos">817</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.load-818"><a href="#EdgePermuters.BothCoords.load-818"><span class="linenos">818</span></a>                    <span class="p">):</span>
</span><span id="EdgePermuters.BothCoords.load-819"><a href="#EdgePermuters.BothCoords.load-819"><span class="linenos">819</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="EdgePermuters.BothCoords.load-820"><a href="#EdgePermuters.BothCoords.load-820"><span class="linenos">820</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="EdgePermuters.BothCoords.load-821"><a href="#EdgePermuters.BothCoords.load-821"><span class="linenos">821</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.load-822"><a href="#EdgePermuters.BothCoords.load-822"><span class="linenos">822</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="EdgePermuters.BothCoords.load-823"><a href="#EdgePermuters.BothCoords.load-823"><span class="linenos">823</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="EdgePermuters.BothCoords.load-824"><a href="#EdgePermuters.BothCoords.load-824"><span class="linenos">824</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.BothCoords.load-825"><a href="#EdgePermuters.BothCoords.load-825"><span class="linenos">825</span></a>                            <span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.load-826"><a href="#EdgePermuters.BothCoords.load-826"><span class="linenos">826</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="EdgePermuters.BothCoords.load-827"><a href="#EdgePermuters.BothCoords.load-827"><span class="linenos">827</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="EdgePermuters.BothCoords.load-828"><a href="#EdgePermuters.BothCoords.load-828"><span class="linenos">828</span></a>                        <span class="k">pass</span>
</span><span id="EdgePermuters.BothCoords.load-829"><a href="#EdgePermuters.BothCoords.load-829"><span class="linenos">829</span></a>
</span><span id="EdgePermuters.BothCoords.load-830"><a href="#EdgePermuters.BothCoords.load-830"><span class="linenos">830</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="EdgePermuters.BothCoords.load-831"><a href="#EdgePermuters.BothCoords.load-831"><span class="linenos">831</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgePermuters.BothCoords.load-832"><a href="#EdgePermuters.BothCoords.load-832"><span class="linenos">832</span></a>
</span><span id="EdgePermuters.BothCoords.load-833"><a href="#EdgePermuters.BothCoords.load-833"><span class="linenos">833</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="EdgePermuters.BothCoords.load-834"><a href="#EdgePermuters.BothCoords.load-834"><span class="linenos">834</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.load-835"><a href="#EdgePermuters.BothCoords.load-835"><span class="linenos">835</span></a>
</span><span id="EdgePermuters.BothCoords.load-836"><a href="#EdgePermuters.BothCoords.load-836"><span class="linenos">836</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="EdgePermuters.BothCoords.load-837"><a href="#EdgePermuters.BothCoords.load-837"><span class="linenos">837</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="EdgePermuters.BothCoords.load-838"><a href="#EdgePermuters.BothCoords.load-838"><span class="linenos">838</span></a>                <span class="n">fields_valid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="EdgePermuters.BothCoords.load-839"><a href="#EdgePermuters.BothCoords.load-839"><span class="linenos">839</span></a>                    <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="EdgePermuters.BothCoords.load-840"><a href="#EdgePermuters.BothCoords.load-840"><span class="linenos">840</span></a>                        <span class="n">output</span><span class="p">,</span>
</span><span id="EdgePermuters.BothCoords.load-841"><a href="#EdgePermuters.BothCoords.load-841"><span class="linenos">841</span></a>                        <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">,</span>
</span><span id="EdgePermuters.BothCoords.load-842"><a href="#EdgePermuters.BothCoords.load-842"><span class="linenos">842</span></a>                    <span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.load-843"><a href="#EdgePermuters.BothCoords.load-843"><span class="linenos">843</span></a>                <span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.load-844"><a href="#EdgePermuters.BothCoords.load-844"><span class="linenos">844</span></a>
</span><span id="EdgePermuters.BothCoords.load-845"><a href="#EdgePermuters.BothCoords.load-845"><span class="linenos">845</span></a>                <span class="c1"># if there are any fields that are not valid, raise an error</span>
</span><span id="EdgePermuters.BothCoords.load-846"><a href="#EdgePermuters.BothCoords.load-846"><span class="linenos">846</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">fields_valid</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="EdgePermuters.BothCoords.load-847"><a href="#EdgePermuters.BothCoords.load-847"><span class="linenos">847</span></a>                    <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="EdgePermuters.BothCoords.load-848"><a href="#EdgePermuters.BothCoords.load-848"><span class="linenos">848</span></a>                        <span class="sa">f</span><span class="s2">&quot;Type mismatch in fields of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.BothCoords.load-849"><a href="#EdgePermuters.BothCoords.load-849"><span class="linenos">849</span></a>                        <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="EdgePermuters.BothCoords.load-850"><a href="#EdgePermuters.BothCoords.load-850"><span class="linenos">850</span></a>                            <span class="p">[</span>
</span><span id="EdgePermuters.BothCoords.load-851"><a href="#EdgePermuters.BothCoords.load-851"><span class="linenos">851</span></a>                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">:</span><span class="se">\t</span><span class="s2">expected </span><span class="si">{</span><span class="n">cls_type_hints</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="si">= }</span><span class="s2">, but got value </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.BothCoords.load-852"><a href="#EdgePermuters.BothCoords.load-852"><span class="linenos">852</span></a>                                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">fields_valid</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="EdgePermuters.BothCoords.load-853"><a href="#EdgePermuters.BothCoords.load-853"><span class="linenos">853</span></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span>
</span><span id="EdgePermuters.BothCoords.load-854"><a href="#EdgePermuters.BothCoords.load-854"><span class="linenos">854</span></a>                            <span class="p">]</span>
</span><span id="EdgePermuters.BothCoords.load-855"><a href="#EdgePermuters.BothCoords.load-855"><span class="linenos">855</span></a>                        <span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.load-856"><a href="#EdgePermuters.BothCoords.load-856"><span class="linenos">856</span></a>                    <span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.load-857"><a href="#EdgePermuters.BothCoords.load-857"><span class="linenos">857</span></a>
</span><span id="EdgePermuters.BothCoords.load-858"><a href="#EdgePermuters.BothCoords.load-858"><span class="linenos">858</span></a>                    <span class="n">on_typecheck_mismatch</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
</span><span id="EdgePermuters.BothCoords.load-859"><a href="#EdgePermuters.BothCoords.load-859"><span class="linenos">859</span></a>                        <span class="n">msg</span><span class="p">,</span> <span class="n">except_cls</span><span class="o">=</span><span class="n">FieldTypeMismatchError</span>
</span><span id="EdgePermuters.BothCoords.load-860"><a href="#EdgePermuters.BothCoords.load-860"><span class="linenos">860</span></a>                    <span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.load-861"><a href="#EdgePermuters.BothCoords.load-861"><span class="linenos">861</span></a>
</span><span id="EdgePermuters.BothCoords.load-862"><a href="#EdgePermuters.BothCoords.load-862"><span class="linenos">862</span></a>            <span class="c1"># return the new instance</span>
</span><span id="EdgePermuters.BothCoords.load-863"><a href="#EdgePermuters.BothCoords.load-863"><span class="linenos">863</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="EdgePermuters.BothCoords.validate_fields_types" class="classattr">
                                        <input id="EdgePermuters.BothCoords.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgePermuters.BothCoords.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L282-L291" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgePermuters.BothCoords.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgePermuters.BothCoords.validate_fields_types-283"><a href="#EdgePermuters.BothCoords.validate_fields_types-283"><span class="linenos">283</span></a><span class="k">def</span><span class="w"> </span><span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="EdgePermuters.BothCoords.validate_fields_types-284"><a href="#EdgePermuters.BothCoords.validate_fields_types-284"><span class="linenos">284</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="EdgePermuters.BothCoords.validate_fields_types-285"><a href="#EdgePermuters.BothCoords.validate_fields_types-285"><span class="linenos">285</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="EdgePermuters.BothCoords.validate_fields_types-286"><a href="#EdgePermuters.BothCoords.validate_fields_types-286"><span class="linenos">286</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="EdgePermuters.BothCoords.validate_fields_types-287"><a href="#EdgePermuters.BothCoords.validate_fields_types-287"><span class="linenos">287</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="EdgePermuters.BothCoords.validate_fields_types-288"><a href="#EdgePermuters.BothCoords.validate_fields_types-288"><span class="linenos">288</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="EdgePermuters.BothCoords.validate_fields_types-289"><a href="#EdgePermuters.BothCoords.validate_fields_types-289"><span class="linenos">289</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="EdgePermuters.BothCoords.validate_fields_types-290"><a href="#EdgePermuters.BothCoords.validate_fields_types-290"><span class="linenos">290</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="EdgePermuters.BothCoords.validate_fields_types-291"><a href="#EdgePermuters.BothCoords.validate_fields_types-291"><span class="linenos">291</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="EdgePermuters.BothCoords.validate_fields_types-292"><a href="#EdgePermuters.BothCoords.validate_fields_types-292"><span class="linenos">292</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#EdgePermuters._EdgePermuter">EdgePermuters._EdgePermuter</a></dt>
                                <dd id="EdgePermuters.BothCoords.attribute_key" class="function"><a href="#EdgePermuters._EdgePermuter.attribute_key">attribute_key</a></dd>
                <dd id="EdgePermuters.BothCoords.is_valid" class="function"><a href="#EdgePermuters._EdgePermuter.is_valid">is_valid</a></dd>

            </div>
            <div><dt><a href="element_base.html#_TokenizerElement">maze_dataset.tokenization.modular.element_base._TokenizerElement</a></dt>
                                <dd id="EdgePermuters.BothCoords.name" class="variable"><a href="element_base.html#_TokenizerElement.name">name</a></dd>
                <dd id="EdgePermuters.BothCoords.tokenizer_elements" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="EdgePermuters.BothCoords.tokenizer_element_tree" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="EdgePermuters.BothCoords.tokenizer_element_dict" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>
                <dd id="EdgePermuters.BothCoords.to_tokens" class="function"><a href="element_base.html#_TokenizerElement.to_tokens">to_tokens</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="EdgePermuters.BothCoords.validate_field_type" class="function">validate_field_type</dd>
                <dd id="EdgePermuters.BothCoords.diff" class="function">diff</dd>
                <dd id="EdgePermuters.BothCoords.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="EdgeSubsets">
                            <input id="EdgeSubsets-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">EdgeSubsets</span><wbr>(<span class="base"><a href="element_base.html#__TokenizerElementNamespace">maze_dataset.tokenization.modular.element_base.__TokenizerElementNamespace</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeSubsets-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L287-L341" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeSubsets"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeSubsets-288"><a href="#EdgeSubsets-288"><span class="linenos">288</span></a><span class="k">class</span><span class="w"> </span><span class="nc">EdgeSubsets</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="EdgeSubsets-289"><a href="#EdgeSubsets-289"><span class="linenos">289</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Namespace for `_EdgeSubset` subclass hierarchy used by `_AdjListTokenizer`.&quot;&quot;&quot;</span>
</span><span id="EdgeSubsets-290"><a href="#EdgeSubsets-290"><span class="linenos">290</span></a>
</span><span id="EdgeSubsets-291"><a href="#EdgeSubsets-291"><span class="linenos">291</span></a>	<span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;edge_subset&quot;</span>
</span><span id="EdgeSubsets-292"><a href="#EdgeSubsets-292"><span class="linenos">292</span></a>
</span><span id="EdgeSubsets-293"><a href="#EdgeSubsets-293"><span class="linenos">293</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgeSubsets-294"><a href="#EdgeSubsets-294"><span class="linenos">294</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">_EdgeSubset</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="EdgeSubsets-295"><a href="#EdgeSubsets-295"><span class="linenos">295</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Component of an `AdjListTokenizers._AdjListTokenizer` which specifies the subset of lattice edges to be tokenized.&quot;&quot;&quot;</span>
</span><span id="EdgeSubsets-296"><a href="#EdgeSubsets-296"><span class="linenos">296</span></a>
</span><span id="EdgeSubsets-297"><a href="#EdgeSubsets-297"><span class="linenos">297</span></a>		<span class="nd">@classmethod</span>
</span><span id="EdgeSubsets-298"><a href="#EdgeSubsets-298"><span class="linenos">298</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="EdgeSubsets-299"><a href="#EdgeSubsets-299"><span class="linenos">299</span></a>			<span class="k">return</span> <span class="n">EdgeSubsets</span><span class="o">.</span><span class="n">key</span>
</span><span id="EdgeSubsets-300"><a href="#EdgeSubsets-300"><span class="linenos">300</span></a>
</span><span id="EdgeSubsets-301"><a href="#EdgeSubsets-301"><span class="linenos">301</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="EdgeSubsets-302"><a href="#EdgeSubsets-302"><span class="linenos">302</span></a>			<span class="k">return</span> <span class="kc">True</span>
</span><span id="EdgeSubsets-303"><a href="#EdgeSubsets-303"><span class="linenos">303</span></a>
</span><span id="EdgeSubsets-304"><a href="#EdgeSubsets-304"><span class="linenos">304</span></a>		<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="EdgeSubsets-305"><a href="#EdgeSubsets-305"><span class="linenos">305</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_get_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="EdgeSubsets-306"><a href="#EdgeSubsets-306"><span class="linenos">306</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns the set of lattice edges to be tokenized.&quot;&quot;&quot;</span>
</span><span id="EdgeSubsets-307"><a href="#EdgeSubsets-307"><span class="linenos">307</span></a>			<span class="k">pass</span>
</span><span id="EdgeSubsets-308"><a href="#EdgeSubsets-308"><span class="linenos">308</span></a>
</span><span id="EdgeSubsets-309"><a href="#EdgeSubsets-309"><span class="linenos">309</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgeSubsets-310"><a href="#EdgeSubsets-310"><span class="linenos">310</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">AllLatticeEdges</span><span class="p">(</span><span class="n">_EdgeSubset</span><span class="p">):</span>
</span><span id="EdgeSubsets-311"><a href="#EdgeSubsets-311"><span class="linenos">311</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;All 2n**2-2n edges of the lattice are tokenized.</span>
</span><span id="EdgeSubsets-312"><a href="#EdgeSubsets-312"><span class="linenos">312</span></a>
</span><span id="EdgeSubsets-313"><a href="#EdgeSubsets-313"><span class="linenos">313</span></a><span class="sd">		If a wall exists on that edge, the edge is tokenized in the same manner, using `VOCAB.ADJLIST_WALL` in place of `VOCAB.CONNECTOR`.</span>
</span><span id="EdgeSubsets-314"><a href="#EdgeSubsets-314"><span class="linenos">314</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="EdgeSubsets-315"><a href="#EdgeSubsets-315"><span class="linenos">315</span></a>
</span><span id="EdgeSubsets-316"><a href="#EdgeSubsets-316"><span class="linenos">316</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_get_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="EdgeSubsets-317"><a href="#EdgeSubsets-317"><span class="linenos">317</span></a>			<span class="k">return</span> <span class="n">lattice_connection_array</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">grid_n</span><span class="p">)</span>
</span><span id="EdgeSubsets-318"><a href="#EdgeSubsets-318"><span class="linenos">318</span></a>
</span><span id="EdgeSubsets-319"><a href="#EdgeSubsets-319"><span class="linenos">319</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgeSubsets-320"><a href="#EdgeSubsets-320"><span class="linenos">320</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">ConnectionEdges</span><span class="p">(</span><span class="n">_EdgeSubset</span><span class="p">):</span>
</span><span id="EdgeSubsets-321"><a href="#EdgeSubsets-321"><span class="linenos">321</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Only edges which contain a connection are tokenized.</span>
</span><span id="EdgeSubsets-322"><a href="#EdgeSubsets-322"><span class="linenos">322</span></a>
</span><span id="EdgeSubsets-323"><a href="#EdgeSubsets-323"><span class="linenos">323</span></a><span class="sd">		Alternatively, only edges which contain a wall are tokenized.</span>
</span><span id="EdgeSubsets-324"><a href="#EdgeSubsets-324"><span class="linenos">324</span></a>
</span><span id="EdgeSubsets-325"><a href="#EdgeSubsets-325"><span class="linenos">325</span></a><span class="sd">		# Parameters</span>
</span><span id="EdgeSubsets-326"><a href="#EdgeSubsets-326"><span class="linenos">326</span></a><span class="sd">		- `walls`: Whether wall edges or connection edges are tokenized.</span>
</span><span id="EdgeSubsets-327"><a href="#EdgeSubsets-327"><span class="linenos">327</span></a><span class="sd">		If true, `VOCAB.ADJLIST_WALL` is used in place of `VOCAB.CONNECTOR`.</span>
</span><span id="EdgeSubsets-328"><a href="#EdgeSubsets-328"><span class="linenos">328</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="EdgeSubsets-329"><a href="#EdgeSubsets-329"><span class="linenos">329</span></a>
</span><span id="EdgeSubsets-330"><a href="#EdgeSubsets-330"><span class="linenos">330</span></a>		<span class="n">walls</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="EdgeSubsets-331"><a href="#EdgeSubsets-331"><span class="linenos">331</span></a>
</span><span id="EdgeSubsets-332"><a href="#EdgeSubsets-332"><span class="linenos">332</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_get_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="EdgeSubsets-333"><a href="#EdgeSubsets-333"><span class="linenos">333</span></a>			<span class="n">conn_list</span><span class="p">:</span> <span class="n">ConnectionList</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">connection_list</span>
</span><span id="EdgeSubsets-334"><a href="#EdgeSubsets-334"><span class="linenos">334</span></a>			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">walls</span><span class="p">:</span>
</span><span id="EdgeSubsets-335"><a href="#EdgeSubsets-335"><span class="linenos">335</span></a>				<span class="n">conn_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">conn_list</span><span class="p">)</span>
</span><span id="EdgeSubsets-336"><a href="#EdgeSubsets-336"><span class="linenos">336</span></a>				<span class="n">conn_list</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="EdgeSubsets-337"><a href="#EdgeSubsets-337"><span class="linenos">337</span></a>				<span class="n">conn_list</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="EdgeSubsets-338"><a href="#EdgeSubsets-338"><span class="linenos">338</span></a>			<span class="k">return</span> <span class="n">connection_list_to_adj_list</span><span class="p">(</span>
</span><span id="EdgeSubsets-339"><a href="#EdgeSubsets-339"><span class="linenos">339</span></a>				<span class="n">conn_list</span><span class="p">,</span>
</span><span id="EdgeSubsets-340"><a href="#EdgeSubsets-340"><span class="linenos">340</span></a>				<span class="n">shuffle_d0</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="EdgeSubsets-341"><a href="#EdgeSubsets-341"><span class="linenos">341</span></a>				<span class="n">shuffle_d1</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="EdgeSubsets-342"><a href="#EdgeSubsets-342"><span class="linenos">342</span></a>			<span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Namespace for <code>_EdgeSubset</code> subclass hierarchy used by <code>_AdjListTokenizer</code>.</p>
</div>


                            <div id="EdgeSubsets.key" class="classattr">
                                <div class="attr variable">
            <span class="name">key</span>        =
<span class="default_value">&#39;edge_subset&#39;</span>

        
    </div>
    <a class="headerlink" href="#EdgeSubsets.key"></a>
    
    

                            </div>
                </section>
                <section id="EdgeSubsets.AllLatticeEdges">
                            <input id="EdgeSubsets.AllLatticeEdges-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">EdgeSubsets.AllLatticeEdges</span><wbr>(<span class="base"><a href="#EdgeSubsets._EdgeSubset">EdgeSubsets._EdgeSubset</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeSubsets.AllLatticeEdges-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L308-L316" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeSubsets.AllLatticeEdges"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeSubsets.AllLatticeEdges-309"><a href="#EdgeSubsets.AllLatticeEdges-309"><span class="linenos">309</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges-310"><a href="#EdgeSubsets.AllLatticeEdges-310"><span class="linenos">310</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">AllLatticeEdges</span><span class="p">(</span><span class="n">_EdgeSubset</span><span class="p">):</span>
</span><span id="EdgeSubsets.AllLatticeEdges-311"><a href="#EdgeSubsets.AllLatticeEdges-311"><span class="linenos">311</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;All 2n**2-2n edges of the lattice are tokenized.</span>
</span><span id="EdgeSubsets.AllLatticeEdges-312"><a href="#EdgeSubsets.AllLatticeEdges-312"><span class="linenos">312</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges-313"><a href="#EdgeSubsets.AllLatticeEdges-313"><span class="linenos">313</span></a><span class="sd">		If a wall exists on that edge, the edge is tokenized in the same manner, using `VOCAB.ADJLIST_WALL` in place of `VOCAB.CONNECTOR`.</span>
</span><span id="EdgeSubsets.AllLatticeEdges-314"><a href="#EdgeSubsets.AllLatticeEdges-314"><span class="linenos">314</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="EdgeSubsets.AllLatticeEdges-315"><a href="#EdgeSubsets.AllLatticeEdges-315"><span class="linenos">315</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges-316"><a href="#EdgeSubsets.AllLatticeEdges-316"><span class="linenos">316</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_get_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="EdgeSubsets.AllLatticeEdges-317"><a href="#EdgeSubsets.AllLatticeEdges-317"><span class="linenos">317</span></a>			<span class="k">return</span> <span class="n">lattice_connection_array</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">grid_n</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>All 2n**2-2n edges of the lattice are tokenized.</p>

<p>If a wall exists on that edge, the edge is tokenized in the same manner, using <code>VOCAB.ADJLIST_WALL</code> in place of <code>VOCAB.CONNECTOR</code>.</p>
</div>


                            <div id="EdgeSubsets.AllLatticeEdges.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">EdgeSubsets.AllLatticeEdges</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#EdgeSubsets.AllLatticeEdges">EdgeSubsets.AllLatticeEdges</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#EdgeSubsets.AllLatticeEdges">EdgeSubsets.AllLatticeEdges</a>&#39;&gt;&quot;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#EdgeSubsets.AllLatticeEdges.__init__"></a>
    
    

                            </div>
                            <div id="EdgeSubsets.AllLatticeEdges.serialize" class="classattr">
                                        <input id="EdgeSubsets.AllLatticeEdges.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeSubsets.AllLatticeEdges.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L713-L769" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeSubsets.AllLatticeEdges.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeSubsets.AllLatticeEdges.serialize-714"><a href="#EdgeSubsets.AllLatticeEdges.serialize-714"><span class="linenos">714</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-715"><a href="#EdgeSubsets.AllLatticeEdges.serialize-715"><span class="linenos">715</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-716"><a href="#EdgeSubsets.AllLatticeEdges.serialize-716"><span class="linenos">716</span></a>                <span class="n">_FORMAT_KEY</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-717"><a href="#EdgeSubsets.AllLatticeEdges.serialize-717"><span class="linenos">717</span></a>            <span class="p">}</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-718"><a href="#EdgeSubsets.AllLatticeEdges.serialize-718"><span class="linenos">718</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-719"><a href="#EdgeSubsets.AllLatticeEdges.serialize-719"><span class="linenos">719</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-720"><a href="#EdgeSubsets.AllLatticeEdges.serialize-720"><span class="linenos">720</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-721"><a href="#EdgeSubsets.AllLatticeEdges.serialize-721"><span class="linenos">721</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-722"><a href="#EdgeSubsets.AllLatticeEdges.serialize-722"><span class="linenos">722</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-723"><a href="#EdgeSubsets.AllLatticeEdges.serialize-723"><span class="linenos">723</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-724"><a href="#EdgeSubsets.AllLatticeEdges.serialize-724"><span class="linenos">724</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-725"><a href="#EdgeSubsets.AllLatticeEdges.serialize-725"><span class="linenos">725</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-726"><a href="#EdgeSubsets.AllLatticeEdges.serialize-726"><span class="linenos">726</span></a>                    <span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-727"><a href="#EdgeSubsets.AllLatticeEdges.serialize-727"><span class="linenos">727</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-728"><a href="#EdgeSubsets.AllLatticeEdges.serialize-728"><span class="linenos">728</span></a>                <span class="c1"># try to save it</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-729"><a href="#EdgeSubsets.AllLatticeEdges.serialize-729"><span class="linenos">729</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-730"><a href="#EdgeSubsets.AllLatticeEdges.serialize-730"><span class="linenos">730</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-731"><a href="#EdgeSubsets.AllLatticeEdges.serialize-731"><span class="linenos">731</span></a>                        <span class="c1"># get the val</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-732"><a href="#EdgeSubsets.AllLatticeEdges.serialize-732"><span class="linenos">732</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-733"><a href="#EdgeSubsets.AllLatticeEdges.serialize-733"><span class="linenos">733</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-734"><a href="#EdgeSubsets.AllLatticeEdges.serialize-734"><span class="linenos">734</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-735"><a href="#EdgeSubsets.AllLatticeEdges.serialize-735"><span class="linenos">735</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-736"><a href="#EdgeSubsets.AllLatticeEdges.serialize-736"><span class="linenos">736</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-737"><a href="#EdgeSubsets.AllLatticeEdges.serialize-737"><span class="linenos">737</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-738"><a href="#EdgeSubsets.AllLatticeEdges.serialize-738"><span class="linenos">738</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-739"><a href="#EdgeSubsets.AllLatticeEdges.serialize-739"><span class="linenos">739</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-740"><a href="#EdgeSubsets.AllLatticeEdges.serialize-740"><span class="linenos">740</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-741"><a href="#EdgeSubsets.AllLatticeEdges.serialize-741"><span class="linenos">741</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-742"><a href="#EdgeSubsets.AllLatticeEdges.serialize-742"><span class="linenos">742</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-743"><a href="#EdgeSubsets.AllLatticeEdges.serialize-743"><span class="linenos">743</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-744"><a href="#EdgeSubsets.AllLatticeEdges.serialize-744"><span class="linenos">744</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-745"><a href="#EdgeSubsets.AllLatticeEdges.serialize-745"><span class="linenos">745</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-746"><a href="#EdgeSubsets.AllLatticeEdges.serialize-746"><span class="linenos">746</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-747"><a href="#EdgeSubsets.AllLatticeEdges.serialize-747"><span class="linenos">747</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-748"><a href="#EdgeSubsets.AllLatticeEdges.serialize-748"><span class="linenos">748</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-749"><a href="#EdgeSubsets.AllLatticeEdges.serialize-749"><span class="linenos">749</span></a>                                <span class="p">[</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-750"><a href="#EdgeSubsets.AllLatticeEdges.serialize-750"><span class="linenos">750</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-751"><a href="#EdgeSubsets.AllLatticeEdges.serialize-751"><span class="linenos">751</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-752"><a href="#EdgeSubsets.AllLatticeEdges.serialize-752"><span class="linenos">752</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-753"><a href="#EdgeSubsets.AllLatticeEdges.serialize-753"><span class="linenos">753</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-754"><a href="#EdgeSubsets.AllLatticeEdges.serialize-754"><span class="linenos">754</span></a>                                <span class="p">]</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-755"><a href="#EdgeSubsets.AllLatticeEdges.serialize-755"><span class="linenos">755</span></a>                            <span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-756"><a href="#EdgeSubsets.AllLatticeEdges.serialize-756"><span class="linenos">756</span></a>                        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-757"><a href="#EdgeSubsets.AllLatticeEdges.serialize-757"><span class="linenos">757</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-758"><a href="#EdgeSubsets.AllLatticeEdges.serialize-758"><span class="linenos">758</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-759"><a href="#EdgeSubsets.AllLatticeEdges.serialize-759"><span class="linenos">759</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-760"><a href="#EdgeSubsets.AllLatticeEdges.serialize-760"><span class="linenos">760</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-761"><a href="#EdgeSubsets.AllLatticeEdges.serialize-761"><span class="linenos">761</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-762"><a href="#EdgeSubsets.AllLatticeEdges.serialize-762"><span class="linenos">762</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-763"><a href="#EdgeSubsets.AllLatticeEdges.serialize-763"><span class="linenos">763</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-764"><a href="#EdgeSubsets.AllLatticeEdges.serialize-764"><span class="linenos">764</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-765"><a href="#EdgeSubsets.AllLatticeEdges.serialize-765"><span class="linenos">765</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-766"><a href="#EdgeSubsets.AllLatticeEdges.serialize-766"><span class="linenos">766</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-767"><a href="#EdgeSubsets.AllLatticeEdges.serialize-767"><span class="linenos">767</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-768"><a href="#EdgeSubsets.AllLatticeEdges.serialize-768"><span class="linenos">768</span></a>                    <span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-769"><a href="#EdgeSubsets.AllLatticeEdges.serialize-769"><span class="linenos">769</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-770"><a href="#EdgeSubsets.AllLatticeEdges.serialize-770"><span class="linenos">770</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="EdgeSubsets.AllLatticeEdges.load" class="classattr">
                                        <input id="EdgeSubsets.AllLatticeEdges.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeSubsets.AllLatticeEdges.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L776-L862" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeSubsets.AllLatticeEdges.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeSubsets.AllLatticeEdges.load-777"><a href="#EdgeSubsets.AllLatticeEdges.load-777"><span class="linenos">777</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-778"><a href="#EdgeSubsets.AllLatticeEdges.load-778"><span class="linenos">778</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-779"><a href="#EdgeSubsets.AllLatticeEdges.load-779"><span class="linenos">779</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-780"><a href="#EdgeSubsets.AllLatticeEdges.load-780"><span class="linenos">780</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-781"><a href="#EdgeSubsets.AllLatticeEdges.load-781"><span class="linenos">781</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-782"><a href="#EdgeSubsets.AllLatticeEdges.load-782"><span class="linenos">782</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges.load-783"><a href="#EdgeSubsets.AllLatticeEdges.load-783"><span class="linenos">783</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-784"><a href="#EdgeSubsets.AllLatticeEdges.load-784"><span class="linenos">784</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-785"><a href="#EdgeSubsets.AllLatticeEdges.load-785"><span class="linenos">785</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-786"><a href="#EdgeSubsets.AllLatticeEdges.load-786"><span class="linenos">786</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges.load-787"><a href="#EdgeSubsets.AllLatticeEdges.load-787"><span class="linenos">787</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-788"><a href="#EdgeSubsets.AllLatticeEdges.load-788"><span class="linenos">788</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges.load-789"><a href="#EdgeSubsets.AllLatticeEdges.load-789"><span class="linenos">789</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-790"><a href="#EdgeSubsets.AllLatticeEdges.load-790"><span class="linenos">790</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-791"><a href="#EdgeSubsets.AllLatticeEdges.load-791"><span class="linenos">791</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges.load-792"><a href="#EdgeSubsets.AllLatticeEdges.load-792"><span class="linenos">792</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-793"><a href="#EdgeSubsets.AllLatticeEdges.load-793"><span class="linenos">793</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-794"><a href="#EdgeSubsets.AllLatticeEdges.load-794"><span class="linenos">794</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-795"><a href="#EdgeSubsets.AllLatticeEdges.load-795"><span class="linenos">795</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-796"><a href="#EdgeSubsets.AllLatticeEdges.load-796"><span class="linenos">796</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-797"><a href="#EdgeSubsets.AllLatticeEdges.load-797"><span class="linenos">797</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-798"><a href="#EdgeSubsets.AllLatticeEdges.load-798"><span class="linenos">798</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges.load-799"><a href="#EdgeSubsets.AllLatticeEdges.load-799"><span class="linenos">799</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-800"><a href="#EdgeSubsets.AllLatticeEdges.load-800"><span class="linenos">800</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-801"><a href="#EdgeSubsets.AllLatticeEdges.load-801"><span class="linenos">801</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-802"><a href="#EdgeSubsets.AllLatticeEdges.load-802"><span class="linenos">802</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-803"><a href="#EdgeSubsets.AllLatticeEdges.load-803"><span class="linenos">803</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges.load-804"><a href="#EdgeSubsets.AllLatticeEdges.load-804"><span class="linenos">804</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-805"><a href="#EdgeSubsets.AllLatticeEdges.load-805"><span class="linenos">805</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-806"><a href="#EdgeSubsets.AllLatticeEdges.load-806"><span class="linenos">806</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges.load-807"><a href="#EdgeSubsets.AllLatticeEdges.load-807"><span class="linenos">807</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-808"><a href="#EdgeSubsets.AllLatticeEdges.load-808"><span class="linenos">808</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-809"><a href="#EdgeSubsets.AllLatticeEdges.load-809"><span class="linenos">809</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-810"><a href="#EdgeSubsets.AllLatticeEdges.load-810"><span class="linenos">810</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-811"><a href="#EdgeSubsets.AllLatticeEdges.load-811"><span class="linenos">811</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-812"><a href="#EdgeSubsets.AllLatticeEdges.load-812"><span class="linenos">812</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-813"><a href="#EdgeSubsets.AllLatticeEdges.load-813"><span class="linenos">813</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-814"><a href="#EdgeSubsets.AllLatticeEdges.load-814"><span class="linenos">814</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-815"><a href="#EdgeSubsets.AllLatticeEdges.load-815"><span class="linenos">815</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-816"><a href="#EdgeSubsets.AllLatticeEdges.load-816"><span class="linenos">816</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-817"><a href="#EdgeSubsets.AllLatticeEdges.load-817"><span class="linenos">817</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-818"><a href="#EdgeSubsets.AllLatticeEdges.load-818"><span class="linenos">818</span></a>                    <span class="p">):</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-819"><a href="#EdgeSubsets.AllLatticeEdges.load-819"><span class="linenos">819</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-820"><a href="#EdgeSubsets.AllLatticeEdges.load-820"><span class="linenos">820</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-821"><a href="#EdgeSubsets.AllLatticeEdges.load-821"><span class="linenos">821</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-822"><a href="#EdgeSubsets.AllLatticeEdges.load-822"><span class="linenos">822</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-823"><a href="#EdgeSubsets.AllLatticeEdges.load-823"><span class="linenos">823</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-824"><a href="#EdgeSubsets.AllLatticeEdges.load-824"><span class="linenos">824</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-825"><a href="#EdgeSubsets.AllLatticeEdges.load-825"><span class="linenos">825</span></a>                            <span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-826"><a href="#EdgeSubsets.AllLatticeEdges.load-826"><span class="linenos">826</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-827"><a href="#EdgeSubsets.AllLatticeEdges.load-827"><span class="linenos">827</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-828"><a href="#EdgeSubsets.AllLatticeEdges.load-828"><span class="linenos">828</span></a>                        <span class="k">pass</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-829"><a href="#EdgeSubsets.AllLatticeEdges.load-829"><span class="linenos">829</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges.load-830"><a href="#EdgeSubsets.AllLatticeEdges.load-830"><span class="linenos">830</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-831"><a href="#EdgeSubsets.AllLatticeEdges.load-831"><span class="linenos">831</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-832"><a href="#EdgeSubsets.AllLatticeEdges.load-832"><span class="linenos">832</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges.load-833"><a href="#EdgeSubsets.AllLatticeEdges.load-833"><span class="linenos">833</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-834"><a href="#EdgeSubsets.AllLatticeEdges.load-834"><span class="linenos">834</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-835"><a href="#EdgeSubsets.AllLatticeEdges.load-835"><span class="linenos">835</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges.load-836"><a href="#EdgeSubsets.AllLatticeEdges.load-836"><span class="linenos">836</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-837"><a href="#EdgeSubsets.AllLatticeEdges.load-837"><span class="linenos">837</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-838"><a href="#EdgeSubsets.AllLatticeEdges.load-838"><span class="linenos">838</span></a>                <span class="n">fields_valid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-839"><a href="#EdgeSubsets.AllLatticeEdges.load-839"><span class="linenos">839</span></a>                    <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-840"><a href="#EdgeSubsets.AllLatticeEdges.load-840"><span class="linenos">840</span></a>                        <span class="n">output</span><span class="p">,</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-841"><a href="#EdgeSubsets.AllLatticeEdges.load-841"><span class="linenos">841</span></a>                        <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">,</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-842"><a href="#EdgeSubsets.AllLatticeEdges.load-842"><span class="linenos">842</span></a>                    <span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-843"><a href="#EdgeSubsets.AllLatticeEdges.load-843"><span class="linenos">843</span></a>                <span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-844"><a href="#EdgeSubsets.AllLatticeEdges.load-844"><span class="linenos">844</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges.load-845"><a href="#EdgeSubsets.AllLatticeEdges.load-845"><span class="linenos">845</span></a>                <span class="c1"># if there are any fields that are not valid, raise an error</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-846"><a href="#EdgeSubsets.AllLatticeEdges.load-846"><span class="linenos">846</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">fields_valid</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-847"><a href="#EdgeSubsets.AllLatticeEdges.load-847"><span class="linenos">847</span></a>                    <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-848"><a href="#EdgeSubsets.AllLatticeEdges.load-848"><span class="linenos">848</span></a>                        <span class="sa">f</span><span class="s2">&quot;Type mismatch in fields of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-849"><a href="#EdgeSubsets.AllLatticeEdges.load-849"><span class="linenos">849</span></a>                        <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-850"><a href="#EdgeSubsets.AllLatticeEdges.load-850"><span class="linenos">850</span></a>                            <span class="p">[</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-851"><a href="#EdgeSubsets.AllLatticeEdges.load-851"><span class="linenos">851</span></a>                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">:</span><span class="se">\t</span><span class="s2">expected </span><span class="si">{</span><span class="n">cls_type_hints</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="si">= }</span><span class="s2">, but got value </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-852"><a href="#EdgeSubsets.AllLatticeEdges.load-852"><span class="linenos">852</span></a>                                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">fields_valid</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-853"><a href="#EdgeSubsets.AllLatticeEdges.load-853"><span class="linenos">853</span></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-854"><a href="#EdgeSubsets.AllLatticeEdges.load-854"><span class="linenos">854</span></a>                            <span class="p">]</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-855"><a href="#EdgeSubsets.AllLatticeEdges.load-855"><span class="linenos">855</span></a>                        <span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-856"><a href="#EdgeSubsets.AllLatticeEdges.load-856"><span class="linenos">856</span></a>                    <span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-857"><a href="#EdgeSubsets.AllLatticeEdges.load-857"><span class="linenos">857</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges.load-858"><a href="#EdgeSubsets.AllLatticeEdges.load-858"><span class="linenos">858</span></a>                    <span class="n">on_typecheck_mismatch</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-859"><a href="#EdgeSubsets.AllLatticeEdges.load-859"><span class="linenos">859</span></a>                        <span class="n">msg</span><span class="p">,</span> <span class="n">except_cls</span><span class="o">=</span><span class="n">FieldTypeMismatchError</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-860"><a href="#EdgeSubsets.AllLatticeEdges.load-860"><span class="linenos">860</span></a>                    <span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-861"><a href="#EdgeSubsets.AllLatticeEdges.load-861"><span class="linenos">861</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges.load-862"><a href="#EdgeSubsets.AllLatticeEdges.load-862"><span class="linenos">862</span></a>            <span class="c1"># return the new instance</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-863"><a href="#EdgeSubsets.AllLatticeEdges.load-863"><span class="linenos">863</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="EdgeSubsets.AllLatticeEdges.validate_fields_types" class="classattr">
                                        <input id="EdgeSubsets.AllLatticeEdges.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeSubsets.AllLatticeEdges.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L282-L291" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeSubsets.AllLatticeEdges.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeSubsets.AllLatticeEdges.validate_fields_types-283"><a href="#EdgeSubsets.AllLatticeEdges.validate_fields_types-283"><span class="linenos">283</span></a><span class="k">def</span><span class="w"> </span><span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="EdgeSubsets.AllLatticeEdges.validate_fields_types-284"><a href="#EdgeSubsets.AllLatticeEdges.validate_fields_types-284"><span class="linenos">284</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="EdgeSubsets.AllLatticeEdges.validate_fields_types-285"><a href="#EdgeSubsets.AllLatticeEdges.validate_fields_types-285"><span class="linenos">285</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="EdgeSubsets.AllLatticeEdges.validate_fields_types-286"><a href="#EdgeSubsets.AllLatticeEdges.validate_fields_types-286"><span class="linenos">286</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="EdgeSubsets.AllLatticeEdges.validate_fields_types-287"><a href="#EdgeSubsets.AllLatticeEdges.validate_fields_types-287"><span class="linenos">287</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="EdgeSubsets.AllLatticeEdges.validate_fields_types-288"><a href="#EdgeSubsets.AllLatticeEdges.validate_fields_types-288"><span class="linenos">288</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="EdgeSubsets.AllLatticeEdges.validate_fields_types-289"><a href="#EdgeSubsets.AllLatticeEdges.validate_fields_types-289"><span class="linenos">289</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="EdgeSubsets.AllLatticeEdges.validate_fields_types-290"><a href="#EdgeSubsets.AllLatticeEdges.validate_fields_types-290"><span class="linenos">290</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="EdgeSubsets.AllLatticeEdges.validate_fields_types-291"><a href="#EdgeSubsets.AllLatticeEdges.validate_fields_types-291"><span class="linenos">291</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="EdgeSubsets.AllLatticeEdges.validate_fields_types-292"><a href="#EdgeSubsets.AllLatticeEdges.validate_fields_types-292"><span class="linenos">292</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#EdgeSubsets._EdgeSubset">EdgeSubsets._EdgeSubset</a></dt>
                                <dd id="EdgeSubsets.AllLatticeEdges.attribute_key" class="function"><a href="#EdgeSubsets._EdgeSubset.attribute_key">attribute_key</a></dd>
                <dd id="EdgeSubsets.AllLatticeEdges.is_valid" class="function"><a href="#EdgeSubsets._EdgeSubset.is_valid">is_valid</a></dd>

            </div>
            <div><dt><a href="element_base.html#_TokenizerElement">maze_dataset.tokenization.modular.element_base._TokenizerElement</a></dt>
                                <dd id="EdgeSubsets.AllLatticeEdges.name" class="variable"><a href="element_base.html#_TokenizerElement.name">name</a></dd>
                <dd id="EdgeSubsets.AllLatticeEdges.tokenizer_elements" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="EdgeSubsets.AllLatticeEdges.tokenizer_element_tree" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="EdgeSubsets.AllLatticeEdges.tokenizer_element_dict" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>
                <dd id="EdgeSubsets.AllLatticeEdges.to_tokens" class="function"><a href="element_base.html#_TokenizerElement.to_tokens">to_tokens</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="EdgeSubsets.AllLatticeEdges.validate_field_type" class="function">validate_field_type</dd>
                <dd id="EdgeSubsets.AllLatticeEdges.diff" class="function">diff</dd>
                <dd id="EdgeSubsets.AllLatticeEdges.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="EdgeSubsets.ConnectionEdges">
                            <input id="EdgeSubsets.ConnectionEdges-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">EdgeSubsets.ConnectionEdges</span><wbr>(<span class="base"><a href="#EdgeSubsets._EdgeSubset">EdgeSubsets._EdgeSubset</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeSubsets.ConnectionEdges-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L318-L341" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeSubsets.ConnectionEdges"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeSubsets.ConnectionEdges-319"><a href="#EdgeSubsets.ConnectionEdges-319"><span class="linenos">319</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges-320"><a href="#EdgeSubsets.ConnectionEdges-320"><span class="linenos">320</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">ConnectionEdges</span><span class="p">(</span><span class="n">_EdgeSubset</span><span class="p">):</span>
</span><span id="EdgeSubsets.ConnectionEdges-321"><a href="#EdgeSubsets.ConnectionEdges-321"><span class="linenos">321</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Only edges which contain a connection are tokenized.</span>
</span><span id="EdgeSubsets.ConnectionEdges-322"><a href="#EdgeSubsets.ConnectionEdges-322"><span class="linenos">322</span></a>
</span><span id="EdgeSubsets.ConnectionEdges-323"><a href="#EdgeSubsets.ConnectionEdges-323"><span class="linenos">323</span></a><span class="sd">		Alternatively, only edges which contain a wall are tokenized.</span>
</span><span id="EdgeSubsets.ConnectionEdges-324"><a href="#EdgeSubsets.ConnectionEdges-324"><span class="linenos">324</span></a>
</span><span id="EdgeSubsets.ConnectionEdges-325"><a href="#EdgeSubsets.ConnectionEdges-325"><span class="linenos">325</span></a><span class="sd">		# Parameters</span>
</span><span id="EdgeSubsets.ConnectionEdges-326"><a href="#EdgeSubsets.ConnectionEdges-326"><span class="linenos">326</span></a><span class="sd">		- `walls`: Whether wall edges or connection edges are tokenized.</span>
</span><span id="EdgeSubsets.ConnectionEdges-327"><a href="#EdgeSubsets.ConnectionEdges-327"><span class="linenos">327</span></a><span class="sd">		If true, `VOCAB.ADJLIST_WALL` is used in place of `VOCAB.CONNECTOR`.</span>
</span><span id="EdgeSubsets.ConnectionEdges-328"><a href="#EdgeSubsets.ConnectionEdges-328"><span class="linenos">328</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="EdgeSubsets.ConnectionEdges-329"><a href="#EdgeSubsets.ConnectionEdges-329"><span class="linenos">329</span></a>
</span><span id="EdgeSubsets.ConnectionEdges-330"><a href="#EdgeSubsets.ConnectionEdges-330"><span class="linenos">330</span></a>		<span class="n">walls</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges-331"><a href="#EdgeSubsets.ConnectionEdges-331"><span class="linenos">331</span></a>
</span><span id="EdgeSubsets.ConnectionEdges-332"><a href="#EdgeSubsets.ConnectionEdges-332"><span class="linenos">332</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_get_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="EdgeSubsets.ConnectionEdges-333"><a href="#EdgeSubsets.ConnectionEdges-333"><span class="linenos">333</span></a>			<span class="n">conn_list</span><span class="p">:</span> <span class="n">ConnectionList</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">connection_list</span>
</span><span id="EdgeSubsets.ConnectionEdges-334"><a href="#EdgeSubsets.ConnectionEdges-334"><span class="linenos">334</span></a>			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">walls</span><span class="p">:</span>
</span><span id="EdgeSubsets.ConnectionEdges-335"><a href="#EdgeSubsets.ConnectionEdges-335"><span class="linenos">335</span></a>				<span class="n">conn_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">conn_list</span><span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges-336"><a href="#EdgeSubsets.ConnectionEdges-336"><span class="linenos">336</span></a>				<span class="n">conn_list</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="EdgeSubsets.ConnectionEdges-337"><a href="#EdgeSubsets.ConnectionEdges-337"><span class="linenos">337</span></a>				<span class="n">conn_list</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="EdgeSubsets.ConnectionEdges-338"><a href="#EdgeSubsets.ConnectionEdges-338"><span class="linenos">338</span></a>			<span class="k">return</span> <span class="n">connection_list_to_adj_list</span><span class="p">(</span>
</span><span id="EdgeSubsets.ConnectionEdges-339"><a href="#EdgeSubsets.ConnectionEdges-339"><span class="linenos">339</span></a>				<span class="n">conn_list</span><span class="p">,</span>
</span><span id="EdgeSubsets.ConnectionEdges-340"><a href="#EdgeSubsets.ConnectionEdges-340"><span class="linenos">340</span></a>				<span class="n">shuffle_d0</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="EdgeSubsets.ConnectionEdges-341"><a href="#EdgeSubsets.ConnectionEdges-341"><span class="linenos">341</span></a>				<span class="n">shuffle_d1</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="EdgeSubsets.ConnectionEdges-342"><a href="#EdgeSubsets.ConnectionEdges-342"><span class="linenos">342</span></a>			<span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Only edges which contain a connection are tokenized.</p>

<p>Alternatively, only edges which contain a wall are tokenized.</p>

<h1 id="parameters">Parameters</h1>

<ul>
<li><code><a href="#EdgeSubsets.ConnectionEdges.walls">walls</a></code>: Whether wall edges or connection edges are tokenized.
If true, <code>VOCAB.ADJLIST_WALL</code> is used in place of <code>VOCAB.CONNECTOR</code>.</li>
</ul>
</div>


                            <div id="EdgeSubsets.ConnectionEdges.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">EdgeSubsets.ConnectionEdges</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#EdgeSubsets.ConnectionEdges">EdgeSubsets.ConnectionEdges</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#EdgeSubsets.ConnectionEdges">EdgeSubsets.ConnectionEdges</a>&#39;&gt;&quot;</span>,</span><span class="param">	<span class="n">walls</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#EdgeSubsets.ConnectionEdges.__init__"></a>
    
    

                            </div>
                            <div id="EdgeSubsets.ConnectionEdges.walls" class="classattr">
                                <div class="attr variable">
            <span class="name">walls</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#EdgeSubsets.ConnectionEdges.walls"></a>
    
    

                            </div>
                            <div id="EdgeSubsets.ConnectionEdges.serialize" class="classattr">
                                        <input id="EdgeSubsets.ConnectionEdges.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeSubsets.ConnectionEdges.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L713-L769" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeSubsets.ConnectionEdges.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeSubsets.ConnectionEdges.serialize-714"><a href="#EdgeSubsets.ConnectionEdges.serialize-714"><span class="linenos">714</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-715"><a href="#EdgeSubsets.ConnectionEdges.serialize-715"><span class="linenos">715</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-716"><a href="#EdgeSubsets.ConnectionEdges.serialize-716"><span class="linenos">716</span></a>                <span class="n">_FORMAT_KEY</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-717"><a href="#EdgeSubsets.ConnectionEdges.serialize-717"><span class="linenos">717</span></a>            <span class="p">}</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-718"><a href="#EdgeSubsets.ConnectionEdges.serialize-718"><span class="linenos">718</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-719"><a href="#EdgeSubsets.ConnectionEdges.serialize-719"><span class="linenos">719</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-720"><a href="#EdgeSubsets.ConnectionEdges.serialize-720"><span class="linenos">720</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-721"><a href="#EdgeSubsets.ConnectionEdges.serialize-721"><span class="linenos">721</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-722"><a href="#EdgeSubsets.ConnectionEdges.serialize-722"><span class="linenos">722</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-723"><a href="#EdgeSubsets.ConnectionEdges.serialize-723"><span class="linenos">723</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-724"><a href="#EdgeSubsets.ConnectionEdges.serialize-724"><span class="linenos">724</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-725"><a href="#EdgeSubsets.ConnectionEdges.serialize-725"><span class="linenos">725</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-726"><a href="#EdgeSubsets.ConnectionEdges.serialize-726"><span class="linenos">726</span></a>                    <span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-727"><a href="#EdgeSubsets.ConnectionEdges.serialize-727"><span class="linenos">727</span></a>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-728"><a href="#EdgeSubsets.ConnectionEdges.serialize-728"><span class="linenos">728</span></a>                <span class="c1"># try to save it</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-729"><a href="#EdgeSubsets.ConnectionEdges.serialize-729"><span class="linenos">729</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-730"><a href="#EdgeSubsets.ConnectionEdges.serialize-730"><span class="linenos">730</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-731"><a href="#EdgeSubsets.ConnectionEdges.serialize-731"><span class="linenos">731</span></a>                        <span class="c1"># get the val</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-732"><a href="#EdgeSubsets.ConnectionEdges.serialize-732"><span class="linenos">732</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-733"><a href="#EdgeSubsets.ConnectionEdges.serialize-733"><span class="linenos">733</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-734"><a href="#EdgeSubsets.ConnectionEdges.serialize-734"><span class="linenos">734</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-735"><a href="#EdgeSubsets.ConnectionEdges.serialize-735"><span class="linenos">735</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-736"><a href="#EdgeSubsets.ConnectionEdges.serialize-736"><span class="linenos">736</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-737"><a href="#EdgeSubsets.ConnectionEdges.serialize-737"><span class="linenos">737</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-738"><a href="#EdgeSubsets.ConnectionEdges.serialize-738"><span class="linenos">738</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-739"><a href="#EdgeSubsets.ConnectionEdges.serialize-739"><span class="linenos">739</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-740"><a href="#EdgeSubsets.ConnectionEdges.serialize-740"><span class="linenos">740</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-741"><a href="#EdgeSubsets.ConnectionEdges.serialize-741"><span class="linenos">741</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-742"><a href="#EdgeSubsets.ConnectionEdges.serialize-742"><span class="linenos">742</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-743"><a href="#EdgeSubsets.ConnectionEdges.serialize-743"><span class="linenos">743</span></a>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-744"><a href="#EdgeSubsets.ConnectionEdges.serialize-744"><span class="linenos">744</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-745"><a href="#EdgeSubsets.ConnectionEdges.serialize-745"><span class="linenos">745</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-746"><a href="#EdgeSubsets.ConnectionEdges.serialize-746"><span class="linenos">746</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-747"><a href="#EdgeSubsets.ConnectionEdges.serialize-747"><span class="linenos">747</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-748"><a href="#EdgeSubsets.ConnectionEdges.serialize-748"><span class="linenos">748</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-749"><a href="#EdgeSubsets.ConnectionEdges.serialize-749"><span class="linenos">749</span></a>                                <span class="p">[</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-750"><a href="#EdgeSubsets.ConnectionEdges.serialize-750"><span class="linenos">750</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-751"><a href="#EdgeSubsets.ConnectionEdges.serialize-751"><span class="linenos">751</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-752"><a href="#EdgeSubsets.ConnectionEdges.serialize-752"><span class="linenos">752</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-753"><a href="#EdgeSubsets.ConnectionEdges.serialize-753"><span class="linenos">753</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-754"><a href="#EdgeSubsets.ConnectionEdges.serialize-754"><span class="linenos">754</span></a>                                <span class="p">]</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-755"><a href="#EdgeSubsets.ConnectionEdges.serialize-755"><span class="linenos">755</span></a>                            <span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-756"><a href="#EdgeSubsets.ConnectionEdges.serialize-756"><span class="linenos">756</span></a>                        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-757"><a href="#EdgeSubsets.ConnectionEdges.serialize-757"><span class="linenos">757</span></a>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-758"><a href="#EdgeSubsets.ConnectionEdges.serialize-758"><span class="linenos">758</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-759"><a href="#EdgeSubsets.ConnectionEdges.serialize-759"><span class="linenos">759</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-760"><a href="#EdgeSubsets.ConnectionEdges.serialize-760"><span class="linenos">760</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-761"><a href="#EdgeSubsets.ConnectionEdges.serialize-761"><span class="linenos">761</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-762"><a href="#EdgeSubsets.ConnectionEdges.serialize-762"><span class="linenos">762</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-763"><a href="#EdgeSubsets.ConnectionEdges.serialize-763"><span class="linenos">763</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-764"><a href="#EdgeSubsets.ConnectionEdges.serialize-764"><span class="linenos">764</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-765"><a href="#EdgeSubsets.ConnectionEdges.serialize-765"><span class="linenos">765</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-766"><a href="#EdgeSubsets.ConnectionEdges.serialize-766"><span class="linenos">766</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-767"><a href="#EdgeSubsets.ConnectionEdges.serialize-767"><span class="linenos">767</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-768"><a href="#EdgeSubsets.ConnectionEdges.serialize-768"><span class="linenos">768</span></a>                    <span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-769"><a href="#EdgeSubsets.ConnectionEdges.serialize-769"><span class="linenos">769</span></a>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-770"><a href="#EdgeSubsets.ConnectionEdges.serialize-770"><span class="linenos">770</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="EdgeSubsets.ConnectionEdges.load" class="classattr">
                                        <input id="EdgeSubsets.ConnectionEdges.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeSubsets.ConnectionEdges.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L776-L862" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeSubsets.ConnectionEdges.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeSubsets.ConnectionEdges.load-777"><a href="#EdgeSubsets.ConnectionEdges.load-777"><span class="linenos">777</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-778"><a href="#EdgeSubsets.ConnectionEdges.load-778"><span class="linenos">778</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-779"><a href="#EdgeSubsets.ConnectionEdges.load-779"><span class="linenos">779</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-780"><a href="#EdgeSubsets.ConnectionEdges.load-780"><span class="linenos">780</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-781"><a href="#EdgeSubsets.ConnectionEdges.load-781"><span class="linenos">781</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-782"><a href="#EdgeSubsets.ConnectionEdges.load-782"><span class="linenos">782</span></a>
</span><span id="EdgeSubsets.ConnectionEdges.load-783"><a href="#EdgeSubsets.ConnectionEdges.load-783"><span class="linenos">783</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-784"><a href="#EdgeSubsets.ConnectionEdges.load-784"><span class="linenos">784</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-785"><a href="#EdgeSubsets.ConnectionEdges.load-785"><span class="linenos">785</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-786"><a href="#EdgeSubsets.ConnectionEdges.load-786"><span class="linenos">786</span></a>
</span><span id="EdgeSubsets.ConnectionEdges.load-787"><a href="#EdgeSubsets.ConnectionEdges.load-787"><span class="linenos">787</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-788"><a href="#EdgeSubsets.ConnectionEdges.load-788"><span class="linenos">788</span></a>
</span><span id="EdgeSubsets.ConnectionEdges.load-789"><a href="#EdgeSubsets.ConnectionEdges.load-789"><span class="linenos">789</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-790"><a href="#EdgeSubsets.ConnectionEdges.load-790"><span class="linenos">790</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-791"><a href="#EdgeSubsets.ConnectionEdges.load-791"><span class="linenos">791</span></a>
</span><span id="EdgeSubsets.ConnectionEdges.load-792"><a href="#EdgeSubsets.ConnectionEdges.load-792"><span class="linenos">792</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-793"><a href="#EdgeSubsets.ConnectionEdges.load-793"><span class="linenos">793</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-794"><a href="#EdgeSubsets.ConnectionEdges.load-794"><span class="linenos">794</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-795"><a href="#EdgeSubsets.ConnectionEdges.load-795"><span class="linenos">795</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-796"><a href="#EdgeSubsets.ConnectionEdges.load-796"><span class="linenos">796</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-797"><a href="#EdgeSubsets.ConnectionEdges.load-797"><span class="linenos">797</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-798"><a href="#EdgeSubsets.ConnectionEdges.load-798"><span class="linenos">798</span></a>
</span><span id="EdgeSubsets.ConnectionEdges.load-799"><a href="#EdgeSubsets.ConnectionEdges.load-799"><span class="linenos">799</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-800"><a href="#EdgeSubsets.ConnectionEdges.load-800"><span class="linenos">800</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-801"><a href="#EdgeSubsets.ConnectionEdges.load-801"><span class="linenos">801</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-802"><a href="#EdgeSubsets.ConnectionEdges.load-802"><span class="linenos">802</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-803"><a href="#EdgeSubsets.ConnectionEdges.load-803"><span class="linenos">803</span></a>
</span><span id="EdgeSubsets.ConnectionEdges.load-804"><a href="#EdgeSubsets.ConnectionEdges.load-804"><span class="linenos">804</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-805"><a href="#EdgeSubsets.ConnectionEdges.load-805"><span class="linenos">805</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-806"><a href="#EdgeSubsets.ConnectionEdges.load-806"><span class="linenos">806</span></a>
</span><span id="EdgeSubsets.ConnectionEdges.load-807"><a href="#EdgeSubsets.ConnectionEdges.load-807"><span class="linenos">807</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-808"><a href="#EdgeSubsets.ConnectionEdges.load-808"><span class="linenos">808</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-809"><a href="#EdgeSubsets.ConnectionEdges.load-809"><span class="linenos">809</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-810"><a href="#EdgeSubsets.ConnectionEdges.load-810"><span class="linenos">810</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-811"><a href="#EdgeSubsets.ConnectionEdges.load-811"><span class="linenos">811</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-812"><a href="#EdgeSubsets.ConnectionEdges.load-812"><span class="linenos">812</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-813"><a href="#EdgeSubsets.ConnectionEdges.load-813"><span class="linenos">813</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-814"><a href="#EdgeSubsets.ConnectionEdges.load-814"><span class="linenos">814</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-815"><a href="#EdgeSubsets.ConnectionEdges.load-815"><span class="linenos">815</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-816"><a href="#EdgeSubsets.ConnectionEdges.load-816"><span class="linenos">816</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-817"><a href="#EdgeSubsets.ConnectionEdges.load-817"><span class="linenos">817</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-818"><a href="#EdgeSubsets.ConnectionEdges.load-818"><span class="linenos">818</span></a>                    <span class="p">):</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-819"><a href="#EdgeSubsets.ConnectionEdges.load-819"><span class="linenos">819</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-820"><a href="#EdgeSubsets.ConnectionEdges.load-820"><span class="linenos">820</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-821"><a href="#EdgeSubsets.ConnectionEdges.load-821"><span class="linenos">821</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-822"><a href="#EdgeSubsets.ConnectionEdges.load-822"><span class="linenos">822</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-823"><a href="#EdgeSubsets.ConnectionEdges.load-823"><span class="linenos">823</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-824"><a href="#EdgeSubsets.ConnectionEdges.load-824"><span class="linenos">824</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-825"><a href="#EdgeSubsets.ConnectionEdges.load-825"><span class="linenos">825</span></a>                            <span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-826"><a href="#EdgeSubsets.ConnectionEdges.load-826"><span class="linenos">826</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-827"><a href="#EdgeSubsets.ConnectionEdges.load-827"><span class="linenos">827</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-828"><a href="#EdgeSubsets.ConnectionEdges.load-828"><span class="linenos">828</span></a>                        <span class="k">pass</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-829"><a href="#EdgeSubsets.ConnectionEdges.load-829"><span class="linenos">829</span></a>
</span><span id="EdgeSubsets.ConnectionEdges.load-830"><a href="#EdgeSubsets.ConnectionEdges.load-830"><span class="linenos">830</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-831"><a href="#EdgeSubsets.ConnectionEdges.load-831"><span class="linenos">831</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-832"><a href="#EdgeSubsets.ConnectionEdges.load-832"><span class="linenos">832</span></a>
</span><span id="EdgeSubsets.ConnectionEdges.load-833"><a href="#EdgeSubsets.ConnectionEdges.load-833"><span class="linenos">833</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-834"><a href="#EdgeSubsets.ConnectionEdges.load-834"><span class="linenos">834</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-835"><a href="#EdgeSubsets.ConnectionEdges.load-835"><span class="linenos">835</span></a>
</span><span id="EdgeSubsets.ConnectionEdges.load-836"><a href="#EdgeSubsets.ConnectionEdges.load-836"><span class="linenos">836</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-837"><a href="#EdgeSubsets.ConnectionEdges.load-837"><span class="linenos">837</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-838"><a href="#EdgeSubsets.ConnectionEdges.load-838"><span class="linenos">838</span></a>                <span class="n">fields_valid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-839"><a href="#EdgeSubsets.ConnectionEdges.load-839"><span class="linenos">839</span></a>                    <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-840"><a href="#EdgeSubsets.ConnectionEdges.load-840"><span class="linenos">840</span></a>                        <span class="n">output</span><span class="p">,</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-841"><a href="#EdgeSubsets.ConnectionEdges.load-841"><span class="linenos">841</span></a>                        <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">,</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-842"><a href="#EdgeSubsets.ConnectionEdges.load-842"><span class="linenos">842</span></a>                    <span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-843"><a href="#EdgeSubsets.ConnectionEdges.load-843"><span class="linenos">843</span></a>                <span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-844"><a href="#EdgeSubsets.ConnectionEdges.load-844"><span class="linenos">844</span></a>
</span><span id="EdgeSubsets.ConnectionEdges.load-845"><a href="#EdgeSubsets.ConnectionEdges.load-845"><span class="linenos">845</span></a>                <span class="c1"># if there are any fields that are not valid, raise an error</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-846"><a href="#EdgeSubsets.ConnectionEdges.load-846"><span class="linenos">846</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">fields_valid</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-847"><a href="#EdgeSubsets.ConnectionEdges.load-847"><span class="linenos">847</span></a>                    <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-848"><a href="#EdgeSubsets.ConnectionEdges.load-848"><span class="linenos">848</span></a>                        <span class="sa">f</span><span class="s2">&quot;Type mismatch in fields of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-849"><a href="#EdgeSubsets.ConnectionEdges.load-849"><span class="linenos">849</span></a>                        <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-850"><a href="#EdgeSubsets.ConnectionEdges.load-850"><span class="linenos">850</span></a>                            <span class="p">[</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-851"><a href="#EdgeSubsets.ConnectionEdges.load-851"><span class="linenos">851</span></a>                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">:</span><span class="se">\t</span><span class="s2">expected </span><span class="si">{</span><span class="n">cls_type_hints</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="si">= }</span><span class="s2">, but got value </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-852"><a href="#EdgeSubsets.ConnectionEdges.load-852"><span class="linenos">852</span></a>                                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">fields_valid</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-853"><a href="#EdgeSubsets.ConnectionEdges.load-853"><span class="linenos">853</span></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-854"><a href="#EdgeSubsets.ConnectionEdges.load-854"><span class="linenos">854</span></a>                            <span class="p">]</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-855"><a href="#EdgeSubsets.ConnectionEdges.load-855"><span class="linenos">855</span></a>                        <span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-856"><a href="#EdgeSubsets.ConnectionEdges.load-856"><span class="linenos">856</span></a>                    <span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-857"><a href="#EdgeSubsets.ConnectionEdges.load-857"><span class="linenos">857</span></a>
</span><span id="EdgeSubsets.ConnectionEdges.load-858"><a href="#EdgeSubsets.ConnectionEdges.load-858"><span class="linenos">858</span></a>                    <span class="n">on_typecheck_mismatch</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-859"><a href="#EdgeSubsets.ConnectionEdges.load-859"><span class="linenos">859</span></a>                        <span class="n">msg</span><span class="p">,</span> <span class="n">except_cls</span><span class="o">=</span><span class="n">FieldTypeMismatchError</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-860"><a href="#EdgeSubsets.ConnectionEdges.load-860"><span class="linenos">860</span></a>                    <span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-861"><a href="#EdgeSubsets.ConnectionEdges.load-861"><span class="linenos">861</span></a>
</span><span id="EdgeSubsets.ConnectionEdges.load-862"><a href="#EdgeSubsets.ConnectionEdges.load-862"><span class="linenos">862</span></a>            <span class="c1"># return the new instance</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-863"><a href="#EdgeSubsets.ConnectionEdges.load-863"><span class="linenos">863</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="EdgeSubsets.ConnectionEdges.validate_fields_types" class="classattr">
                                        <input id="EdgeSubsets.ConnectionEdges.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeSubsets.ConnectionEdges.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L282-L291" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeSubsets.ConnectionEdges.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeSubsets.ConnectionEdges.validate_fields_types-283"><a href="#EdgeSubsets.ConnectionEdges.validate_fields_types-283"><span class="linenos">283</span></a><span class="k">def</span><span class="w"> </span><span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="EdgeSubsets.ConnectionEdges.validate_fields_types-284"><a href="#EdgeSubsets.ConnectionEdges.validate_fields_types-284"><span class="linenos">284</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="EdgeSubsets.ConnectionEdges.validate_fields_types-285"><a href="#EdgeSubsets.ConnectionEdges.validate_fields_types-285"><span class="linenos">285</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="EdgeSubsets.ConnectionEdges.validate_fields_types-286"><a href="#EdgeSubsets.ConnectionEdges.validate_fields_types-286"><span class="linenos">286</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="EdgeSubsets.ConnectionEdges.validate_fields_types-287"><a href="#EdgeSubsets.ConnectionEdges.validate_fields_types-287"><span class="linenos">287</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="EdgeSubsets.ConnectionEdges.validate_fields_types-288"><a href="#EdgeSubsets.ConnectionEdges.validate_fields_types-288"><span class="linenos">288</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="EdgeSubsets.ConnectionEdges.validate_fields_types-289"><a href="#EdgeSubsets.ConnectionEdges.validate_fields_types-289"><span class="linenos">289</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="EdgeSubsets.ConnectionEdges.validate_fields_types-290"><a href="#EdgeSubsets.ConnectionEdges.validate_fields_types-290"><span class="linenos">290</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="EdgeSubsets.ConnectionEdges.validate_fields_types-291"><a href="#EdgeSubsets.ConnectionEdges.validate_fields_types-291"><span class="linenos">291</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="EdgeSubsets.ConnectionEdges.validate_fields_types-292"><a href="#EdgeSubsets.ConnectionEdges.validate_fields_types-292"><span class="linenos">292</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#EdgeSubsets._EdgeSubset">EdgeSubsets._EdgeSubset</a></dt>
                                <dd id="EdgeSubsets.ConnectionEdges.attribute_key" class="function"><a href="#EdgeSubsets._EdgeSubset.attribute_key">attribute_key</a></dd>
                <dd id="EdgeSubsets.ConnectionEdges.is_valid" class="function"><a href="#EdgeSubsets._EdgeSubset.is_valid">is_valid</a></dd>

            </div>
            <div><dt><a href="element_base.html#_TokenizerElement">maze_dataset.tokenization.modular.element_base._TokenizerElement</a></dt>
                                <dd id="EdgeSubsets.ConnectionEdges.name" class="variable"><a href="element_base.html#_TokenizerElement.name">name</a></dd>
                <dd id="EdgeSubsets.ConnectionEdges.tokenizer_elements" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="EdgeSubsets.ConnectionEdges.tokenizer_element_tree" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="EdgeSubsets.ConnectionEdges.tokenizer_element_dict" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>
                <dd id="EdgeSubsets.ConnectionEdges.to_tokens" class="function"><a href="element_base.html#_TokenizerElement.to_tokens">to_tokens</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="EdgeSubsets.ConnectionEdges.validate_field_type" class="function">validate_field_type</dd>
                <dd id="EdgeSubsets.ConnectionEdges.diff" class="function">diff</dd>
                <dd id="EdgeSubsets.ConnectionEdges.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="AdjListTokenizers">
                            <input id="AdjListTokenizers-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">AdjListTokenizers</span><wbr>(<span class="base"><a href="element_base.html#__TokenizerElementNamespace">maze_dataset.tokenization.modular.element_base.__TokenizerElementNamespace</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="AdjListTokenizers-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L355-L605" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#AdjListTokenizers"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdjListTokenizers-356"><a href="#AdjListTokenizers-356"><span class="linenos">356</span></a><span class="k">class</span><span class="w"> </span><span class="nc">AdjListTokenizers</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="AdjListTokenizers-357"><a href="#AdjListTokenizers-357"><span class="linenos">357</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Namespace for `_AdjListTokenizer` subclass hierarchy used by `MazeTokenizerModular`.&quot;&quot;&quot;</span>
</span><span id="AdjListTokenizers-358"><a href="#AdjListTokenizers-358"><span class="linenos">358</span></a>
</span><span id="AdjListTokenizers-359"><a href="#AdjListTokenizers-359"><span class="linenos">359</span></a>	<span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;adj_list_tokenizer&quot;</span>
</span><span id="AdjListTokenizers-360"><a href="#AdjListTokenizers-360"><span class="linenos">360</span></a>
</span><span id="AdjListTokenizers-361"><a href="#AdjListTokenizers-361"><span class="linenos">361</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="AdjListTokenizers-362"><a href="#AdjListTokenizers-362"><span class="linenos">362</span></a>	<span class="nd">@mark_as_unsupported</span><span class="p">(</span><span class="n">_adjlist_no_pre_unsupported</span><span class="p">)</span>
</span><span id="AdjListTokenizers-363"><a href="#AdjListTokenizers-363"><span class="linenos">363</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">_AdjListTokenizer</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="AdjListTokenizers-364"><a href="#AdjListTokenizers-364"><span class="linenos">364</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Specifies how the adjacency list is tokenized.</span>
</span><span id="AdjListTokenizers-365"><a href="#AdjListTokenizers-365"><span class="linenos">365</span></a>
</span><span id="AdjListTokenizers-366"><a href="#AdjListTokenizers-366"><span class="linenos">366</span></a><span class="sd">		Tokenization behavior is decomposed into specification of edge subsets, groupings, and permutations.</span>
</span><span id="AdjListTokenizers-367"><a href="#AdjListTokenizers-367"><span class="linenos">367</span></a><span class="sd">		See documentation of `EdgeSubset` and `EdgeGrouping` classes for more details.</span>
</span><span id="AdjListTokenizers-368"><a href="#AdjListTokenizers-368"><span class="linenos">368</span></a>
</span><span id="AdjListTokenizers-369"><a href="#AdjListTokenizers-369"><span class="linenos">369</span></a><span class="sd">		# Parameters</span>
</span><span id="AdjListTokenizers-370"><a href="#AdjListTokenizers-370"><span class="linenos">370</span></a><span class="sd">		- `pre`: Whether all edge groupings include a preceding delimiter token</span>
</span><span id="AdjListTokenizers-371"><a href="#AdjListTokenizers-371"><span class="linenos">371</span></a><span class="sd">		- `post`: Whether all edge groupings include a following delimiter token</span>
</span><span id="AdjListTokenizers-372"><a href="#AdjListTokenizers-372"><span class="linenos">372</span></a><span class="sd">		- `shuffle_d0`: Specifies how to sequence the edge groupings.</span>
</span><span id="AdjListTokenizers-373"><a href="#AdjListTokenizers-373"><span class="linenos">373</span></a><span class="sd">			If true, groupings are shuffled randomly. If false, groupings are sorted by the leading coord of each group.</span>
</span><span id="AdjListTokenizers-374"><a href="#AdjListTokenizers-374"><span class="linenos">374</span></a><span class="sd">		- `edge_grouping`: Specifies if/how multiple coord-coord connections are grouped together in a token subsequence called an edge grouping.</span>
</span><span id="AdjListTokenizers-375"><a href="#AdjListTokenizers-375"><span class="linenos">375</span></a><span class="sd">		- `edge_subset`: Specifies the subset of lattice edges to be tokenized.</span>
</span><span id="AdjListTokenizers-376"><a href="#AdjListTokenizers-376"><span class="linenos">376</span></a><span class="sd">		- `edge_permuter`: Specifies, in each edge tokenization, which coord either:</span>
</span><span id="AdjListTokenizers-377"><a href="#AdjListTokenizers-377"><span class="linenos">377</span></a><span class="sd">			1. Appears first in the tokenization, for `AdjListCoord`.</span>
</span><span id="AdjListTokenizers-378"><a href="#AdjListTokenizers-378"><span class="linenos">378</span></a><span class="sd">			2. Is tokenized directly as a coord, for `AdjListCardinal`.</span>
</span><span id="AdjListTokenizers-379"><a href="#AdjListTokenizers-379"><span class="linenos">379</span></a><span class="sd">			- `shuffle`: For each edge, the leading coord is selected randomly.</span>
</span><span id="AdjListTokenizers-380"><a href="#AdjListTokenizers-380"><span class="linenos">380</span></a><span class="sd">			- `all`: Each edge appears twice in the tokenization, appearing with both leading coords.</span>
</span><span id="AdjListTokenizers-381"><a href="#AdjListTokenizers-381"><span class="linenos">381</span></a><span class="sd">			- `evens`, `odds`: The leading coord is the one belonging to that coord subset. See `EdgeSubsets.ChessboardSublattice` for details.</span>
</span><span id="AdjListTokenizers-382"><a href="#AdjListTokenizers-382"><span class="linenos">382</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="AdjListTokenizers-383"><a href="#AdjListTokenizers-383"><span class="linenos">383</span></a>
</span><span id="AdjListTokenizers-384"><a href="#AdjListTokenizers-384"><span class="linenos">384</span></a>		<span class="n">pre</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">assert_type</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="AdjListTokenizers-385"><a href="#AdjListTokenizers-385"><span class="linenos">385</span></a>		<span class="n">post</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="AdjListTokenizers-386"><a href="#AdjListTokenizers-386"><span class="linenos">386</span></a>		<span class="n">shuffle_d0</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="AdjListTokenizers-387"><a href="#AdjListTokenizers-387"><span class="linenos">387</span></a>		<span class="n">edge_grouping</span><span class="p">:</span> <span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">_EdgeGrouping</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="AdjListTokenizers-388"><a href="#AdjListTokenizers-388"><span class="linenos">388</span></a>			<span class="n">default</span><span class="o">=</span><span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">Ungrouped</span><span class="p">(),</span>
</span><span id="AdjListTokenizers-389"><a href="#AdjListTokenizers-389"><span class="linenos">389</span></a>			<span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">EdgeGroupings</span><span class="p">),</span>
</span><span id="AdjListTokenizers-390"><a href="#AdjListTokenizers-390"><span class="linenos">390</span></a>		<span class="p">)</span>
</span><span id="AdjListTokenizers-391"><a href="#AdjListTokenizers-391"><span class="linenos">391</span></a>		<span class="n">edge_subset</span><span class="p">:</span> <span class="n">EdgeSubsets</span><span class="o">.</span><span class="n">_EdgeSubset</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="AdjListTokenizers-392"><a href="#AdjListTokenizers-392"><span class="linenos">392</span></a>			<span class="n">default</span><span class="o">=</span><span class="n">EdgeSubsets</span><span class="o">.</span><span class="n">ConnectionEdges</span><span class="p">(),</span>
</span><span id="AdjListTokenizers-393"><a href="#AdjListTokenizers-393"><span class="linenos">393</span></a>			<span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">EdgeSubsets</span><span class="p">),</span>
</span><span id="AdjListTokenizers-394"><a href="#AdjListTokenizers-394"><span class="linenos">394</span></a>		<span class="p">)</span>
</span><span id="AdjListTokenizers-395"><a href="#AdjListTokenizers-395"><span class="linenos">395</span></a>		<span class="n">edge_permuter</span><span class="p">:</span> <span class="n">EdgePermuters</span><span class="o">.</span><span class="n">_EdgePermuter</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="AdjListTokenizers-396"><a href="#AdjListTokenizers-396"><span class="linenos">396</span></a>			<span class="n">default</span><span class="o">=</span><span class="n">EdgePermuters</span><span class="o">.</span><span class="n">RandomCoords</span><span class="p">(),</span>
</span><span id="AdjListTokenizers-397"><a href="#AdjListTokenizers-397"><span class="linenos">397</span></a>			<span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">EdgePermuters</span><span class="p">),</span>
</span><span id="AdjListTokenizers-398"><a href="#AdjListTokenizers-398"><span class="linenos">398</span></a>		<span class="p">)</span>
</span><span id="AdjListTokenizers-399"><a href="#AdjListTokenizers-399"><span class="linenos">399</span></a>
</span><span id="AdjListTokenizers-400"><a href="#AdjListTokenizers-400"><span class="linenos">400</span></a>		<span class="nd">@classmethod</span>
</span><span id="AdjListTokenizers-401"><a href="#AdjListTokenizers-401"><span class="linenos">401</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="AdjListTokenizers-402"><a href="#AdjListTokenizers-402"><span class="linenos">402</span></a>			<span class="k">return</span> <span class="n">AdjListTokenizers</span><span class="o">.</span><span class="n">key</span>
</span><span id="AdjListTokenizers-403"><a href="#AdjListTokenizers-403"><span class="linenos">403</span></a>
</span><span id="AdjListTokenizers-404"><a href="#AdjListTokenizers-404"><span class="linenos">404</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="AdjListTokenizers-405"><a href="#AdjListTokenizers-405"><span class="linenos">405</span></a>			<span class="c1"># No invalid instances possible within data member type hint bounds</span>
</span><span id="AdjListTokenizers-406"><a href="#AdjListTokenizers-406"><span class="linenos">406</span></a>			<span class="k">return</span> <span class="kc">True</span>
</span><span id="AdjListTokenizers-407"><a href="#AdjListTokenizers-407"><span class="linenos">407</span></a>
</span><span id="AdjListTokenizers-408"><a href="#AdjListTokenizers-408"><span class="linenos">408</span></a>		<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="AdjListTokenizers-409"><a href="#AdjListTokenizers-409"><span class="linenos">409</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_tokenization_callables</span><span class="p">(</span>
</span><span id="AdjListTokenizers-410"><a href="#AdjListTokenizers-410"><span class="linenos">410</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="AdjListTokenizers-411"><a href="#AdjListTokenizers-411"><span class="linenos">411</span></a>			<span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">,</span>
</span><span id="AdjListTokenizers-412"><a href="#AdjListTokenizers-412"><span class="linenos">412</span></a>			<span class="n">is_conn</span><span class="p">:</span> <span class="n">Bool</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot; edges&quot;</span><span class="p">],</span>
</span><span id="AdjListTokenizers-413"><a href="#AdjListTokenizers-413"><span class="linenos">413</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="AdjListTokenizers-414"><a href="#AdjListTokenizers-414"><span class="linenos">414</span></a>			<span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="AdjListTokenizers-415"><a href="#AdjListTokenizers-415"><span class="linenos">415</span></a>			<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="AdjListTokenizers-416"><a href="#AdjListTokenizers-416"><span class="linenos">416</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Callable</span><span class="p">]:</span>
</span><span id="AdjListTokenizers-417"><a href="#AdjListTokenizers-417"><span class="linenos">417</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns a sequence of callables which take an index in `edges` and return parts of that edge tokenization.</span>
</span><span id="AdjListTokenizers-418"><a href="#AdjListTokenizers-418"><span class="linenos">418</span></a>
</span><span id="AdjListTokenizers-419"><a href="#AdjListTokenizers-419"><span class="linenos">419</span></a><span class="sd">			# Returns</span>
</span><span id="AdjListTokenizers-420"><a href="#AdjListTokenizers-420"><span class="linenos">420</span></a><span class="sd">			- `[0]`: leading coord tokens</span>
</span><span id="AdjListTokenizers-421"><a href="#AdjListTokenizers-421"><span class="linenos">421</span></a><span class="sd">			- `[1]`: connector tokens</span>
</span><span id="AdjListTokenizers-422"><a href="#AdjListTokenizers-422"><span class="linenos">422</span></a><span class="sd">			- `[2]`: trailing coord tokens</span>
</span><span id="AdjListTokenizers-423"><a href="#AdjListTokenizers-423"><span class="linenos">423</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="AdjListTokenizers-424"><a href="#AdjListTokenizers-424"><span class="linenos">424</span></a>			<span class="k">pass</span>
</span><span id="AdjListTokenizers-425"><a href="#AdjListTokenizers-425"><span class="linenos">425</span></a>
</span><span id="AdjListTokenizers-426"><a href="#AdjListTokenizers-426"><span class="linenos">426</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_tokenize_edge_grouping</span><span class="p">(</span>
</span><span id="AdjListTokenizers-427"><a href="#AdjListTokenizers-427"><span class="linenos">427</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="AdjListTokenizers-428"><a href="#AdjListTokenizers-428"><span class="linenos">428</span></a>			<span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">,</span>
</span><span id="AdjListTokenizers-429"><a href="#AdjListTokenizers-429"><span class="linenos">429</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">,</span>
</span><span id="AdjListTokenizers-430"><a href="#AdjListTokenizers-430"><span class="linenos">430</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="AdjListTokenizers-431"><a href="#AdjListTokenizers-431"><span class="linenos">431</span></a>			<span class="n">group_params</span><span class="p">:</span> <span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">_GroupingTokenParams</span><span class="p">,</span>
</span><span id="AdjListTokenizers-432"><a href="#AdjListTokenizers-432"><span class="linenos">432</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="AdjListTokenizers-433"><a href="#AdjListTokenizers-433"><span class="linenos">433</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Tokenizes a single edge grouping.&quot;&quot;&quot;</span>
</span><span id="AdjListTokenizers-434"><a href="#AdjListTokenizers-434"><span class="linenos">434</span></a>			<span class="n">cxn_ord</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">group_params</span><span class="p">[</span><span class="s2">&quot;connection_token_ordinal&quot;</span><span class="p">]</span>
</span><span id="AdjListTokenizers-435"><a href="#AdjListTokenizers-435"><span class="linenos">435</span></a>			<span class="n">is_conn</span><span class="p">:</span> <span class="n">Bool</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">edges</span><span class="p">]</span> <span class="o">=</span> <span class="n">is_connection</span><span class="p">(</span>
</span><span id="AdjListTokenizers-436"><a href="#AdjListTokenizers-436"><span class="linenos">436</span></a>				<span class="n">edges</span><span class="p">,</span>
</span><span id="AdjListTokenizers-437"><a href="#AdjListTokenizers-437"><span class="linenos">437</span></a>				<span class="n">maze</span><span class="o">.</span><span class="n">connection_list</span><span class="p">,</span>
</span><span id="AdjListTokenizers-438"><a href="#AdjListTokenizers-438"><span class="linenos">438</span></a>			<span class="p">)</span>
</span><span id="AdjListTokenizers-439"><a href="#AdjListTokenizers-439"><span class="linenos">439</span></a>			<span class="n">tokenize_callables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tokenization_callables</span><span class="p">(</span>
</span><span id="AdjListTokenizers-440"><a href="#AdjListTokenizers-440"><span class="linenos">440</span></a>				<span class="n">edges</span><span class="p">,</span>
</span><span id="AdjListTokenizers-441"><a href="#AdjListTokenizers-441"><span class="linenos">441</span></a>				<span class="n">is_conn</span><span class="p">,</span>
</span><span id="AdjListTokenizers-442"><a href="#AdjListTokenizers-442"><span class="linenos">442</span></a>				<span class="n">coord_tokenizer</span><span class="p">,</span>
</span><span id="AdjListTokenizers-443"><a href="#AdjListTokenizers-443"><span class="linenos">443</span></a>			<span class="p">)</span>
</span><span id="AdjListTokenizers-444"><a href="#AdjListTokenizers-444"><span class="linenos">444</span></a>
</span><span id="AdjListTokenizers-445"><a href="#AdjListTokenizers-445"><span class="linenos">445</span></a>			<span class="k">if</span> <span class="n">group_params</span><span class="p">[</span><span class="s2">&quot;grouped&quot;</span><span class="p">]:</span>
</span><span id="AdjListTokenizers-446"><a href="#AdjListTokenizers-446"><span class="linenos">446</span></a>				<span class="c1"># If grouped</span>
</span><span id="AdjListTokenizers-447"><a href="#AdjListTokenizers-447"><span class="linenos">447</span></a>				<span class="n">callable_permutation</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="k">if</span> <span class="n">cxn_ord</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="AdjListTokenizers-448"><a href="#AdjListTokenizers-448"><span class="linenos">448</span></a>				<span class="n">repeated_callables</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="AdjListTokenizers-449"><a href="#AdjListTokenizers-449"><span class="linenos">449</span></a>					<span class="n">tokenize_callables</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">callable_permutation</span>
</span><span id="AdjListTokenizers-450"><a href="#AdjListTokenizers-450"><span class="linenos">450</span></a>				<span class="p">]</span>
</span><span id="AdjListTokenizers-451"><a href="#AdjListTokenizers-451"><span class="linenos">451</span></a>				<span class="k">return</span> <span class="n">flatten</span><span class="p">(</span>
</span><span id="AdjListTokenizers-452"><a href="#AdjListTokenizers-452"><span class="linenos">452</span></a>					<span class="p">[</span>
</span><span id="AdjListTokenizers-453"><a href="#AdjListTokenizers-453"><span class="linenos">453</span></a>						<span class="n">tokenize_callables</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="mi">0</span><span class="p">),</span>
</span><span id="AdjListTokenizers-454"><a href="#AdjListTokenizers-454"><span class="linenos">454</span></a>						<span class="p">[</span>
</span><span id="AdjListTokenizers-455"><a href="#AdjListTokenizers-455"><span class="linenos">455</span></a>							<span class="p">[</span>
</span><span id="AdjListTokenizers-456"><a href="#AdjListTokenizers-456"><span class="linenos">456</span></a>								<span class="o">*</span><span class="p">[</span>
</span><span id="AdjListTokenizers-457"><a href="#AdjListTokenizers-457"><span class="linenos">457</span></a>									<span class="n">tok_callable</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="AdjListTokenizers-458"><a href="#AdjListTokenizers-458"><span class="linenos">458</span></a>									<span class="k">for</span> <span class="n">tok_callable</span> <span class="ow">in</span> <span class="n">repeated_callables</span>
</span><span id="AdjListTokenizers-459"><a href="#AdjListTokenizers-459"><span class="linenos">459</span></a>								<span class="p">],</span>
</span><span id="AdjListTokenizers-460"><a href="#AdjListTokenizers-460"><span class="linenos">460</span></a>								<span class="o">*</span><span class="p">(</span>
</span><span id="AdjListTokenizers-461"><a href="#AdjListTokenizers-461"><span class="linenos">461</span></a>									<span class="p">(</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_INTRA</span><span class="p">,)</span>
</span><span id="AdjListTokenizers-462"><a href="#AdjListTokenizers-462"><span class="linenos">462</span></a>									<span class="k">if</span> <span class="n">group_params</span><span class="p">[</span><span class="s2">&quot;intra&quot;</span><span class="p">]</span>
</span><span id="AdjListTokenizers-463"><a href="#AdjListTokenizers-463"><span class="linenos">463</span></a>									<span class="k">else</span> <span class="p">()</span>
</span><span id="AdjListTokenizers-464"><a href="#AdjListTokenizers-464"><span class="linenos">464</span></a>								<span class="p">),</span>
</span><span id="AdjListTokenizers-465"><a href="#AdjListTokenizers-465"><span class="linenos">465</span></a>							<span class="p">]</span>
</span><span id="AdjListTokenizers-466"><a href="#AdjListTokenizers-466"><span class="linenos">466</span></a>							<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">edges</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="AdjListTokenizers-467"><a href="#AdjListTokenizers-467"><span class="linenos">467</span></a>						<span class="p">],</span>
</span><span id="AdjListTokenizers-468"><a href="#AdjListTokenizers-468"><span class="linenos">468</span></a>					<span class="p">],</span>
</span><span id="AdjListTokenizers-469"><a href="#AdjListTokenizers-469"><span class="linenos">469</span></a>				<span class="p">)</span>
</span><span id="AdjListTokenizers-470"><a href="#AdjListTokenizers-470"><span class="linenos">470</span></a>			<span class="k">else</span><span class="p">:</span>
</span><span id="AdjListTokenizers-471"><a href="#AdjListTokenizers-471"><span class="linenos">471</span></a>				<span class="c1"># If ungrouped</span>
</span><span id="AdjListTokenizers-472"><a href="#AdjListTokenizers-472"><span class="linenos">472</span></a>				<span class="n">callable_permutation</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</span><span id="AdjListTokenizers-473"><a href="#AdjListTokenizers-473"><span class="linenos">473</span></a>				<span class="n">callable_permutation</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">cxn_ord</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="AdjListTokenizers-474"><a href="#AdjListTokenizers-474"><span class="linenos">474</span></a>				<span class="n">tokenize_callables</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="AdjListTokenizers-475"><a href="#AdjListTokenizers-475"><span class="linenos">475</span></a>					<span class="n">tokenize_callables</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">callable_permutation</span>
</span><span id="AdjListTokenizers-476"><a href="#AdjListTokenizers-476"><span class="linenos">476</span></a>				<span class="p">]</span>
</span><span id="AdjListTokenizers-477"><a href="#AdjListTokenizers-477"><span class="linenos">477</span></a>
</span><span id="AdjListTokenizers-478"><a href="#AdjListTokenizers-478"><span class="linenos">478</span></a>				<span class="k">return</span> <span class="n">flatten</span><span class="p">(</span>
</span><span id="AdjListTokenizers-479"><a href="#AdjListTokenizers-479"><span class="linenos">479</span></a>					<span class="p">[</span>
</span><span id="AdjListTokenizers-480"><a href="#AdjListTokenizers-480"><span class="linenos">480</span></a>						<span class="p">[</span>
</span><span id="AdjListTokenizers-481"><a href="#AdjListTokenizers-481"><span class="linenos">481</span></a>							<span class="p">[</span>
</span><span id="AdjListTokenizers-482"><a href="#AdjListTokenizers-482"><span class="linenos">482</span></a>								<span class="o">*</span><span class="p">[</span>
</span><span id="AdjListTokenizers-483"><a href="#AdjListTokenizers-483"><span class="linenos">483</span></a>									<span class="n">tok_callable</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="AdjListTokenizers-484"><a href="#AdjListTokenizers-484"><span class="linenos">484</span></a>									<span class="k">for</span> <span class="n">tok_callable</span> <span class="ow">in</span> <span class="n">tokenize_callables</span>
</span><span id="AdjListTokenizers-485"><a href="#AdjListTokenizers-485"><span class="linenos">485</span></a>								<span class="p">],</span>
</span><span id="AdjListTokenizers-486"><a href="#AdjListTokenizers-486"><span class="linenos">486</span></a>								<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">(</span>
</span><span id="AdjListTokenizers-487"><a href="#AdjListTokenizers-487"><span class="linenos">487</span></a>									<span class="p">(</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_INTRA</span><span class="p">,),</span>
</span><span id="AdjListTokenizers-488"><a href="#AdjListTokenizers-488"><span class="linenos">488</span></a>									<span class="n">group_params</span><span class="p">,</span>
</span><span id="AdjListTokenizers-489"><a href="#AdjListTokenizers-489"><span class="linenos">489</span></a>									<span class="s2">&quot;intra&quot;</span><span class="p">,</span>
</span><span id="AdjListTokenizers-490"><a href="#AdjListTokenizers-490"><span class="linenos">490</span></a>								<span class="p">),</span>
</span><span id="AdjListTokenizers-491"><a href="#AdjListTokenizers-491"><span class="linenos">491</span></a>							<span class="p">]</span>
</span><span id="AdjListTokenizers-492"><a href="#AdjListTokenizers-492"><span class="linenos">492</span></a>							<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">edges</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="AdjListTokenizers-493"><a href="#AdjListTokenizers-493"><span class="linenos">493</span></a>						<span class="p">],</span>
</span><span id="AdjListTokenizers-494"><a href="#AdjListTokenizers-494"><span class="linenos">494</span></a>					<span class="p">],</span>
</span><span id="AdjListTokenizers-495"><a href="#AdjListTokenizers-495"><span class="linenos">495</span></a>				<span class="p">)</span>
</span><span id="AdjListTokenizers-496"><a href="#AdjListTokenizers-496"><span class="linenos">496</span></a>
</span><span id="AdjListTokenizers-497"><a href="#AdjListTokenizers-497"><span class="linenos">497</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="AdjListTokenizers-498"><a href="#AdjListTokenizers-498"><span class="linenos">498</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="AdjListTokenizers-499"><a href="#AdjListTokenizers-499"><span class="linenos">499</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">,</span>
</span><span id="AdjListTokenizers-500"><a href="#AdjListTokenizers-500"><span class="linenos">500</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="AdjListTokenizers-501"><a href="#AdjListTokenizers-501"><span class="linenos">501</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="AdjListTokenizers-502"><a href="#AdjListTokenizers-502"><span class="linenos">502</span></a>			<span class="c1"># Get the set of edges to be tokenized</span>
</span><span id="AdjListTokenizers-503"><a href="#AdjListTokenizers-503"><span class="linenos">503</span></a>			<span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_subset</span><span class="o">.</span><span class="n">_get_edges</span><span class="p">(</span><span class="n">maze</span><span class="p">)</span>
</span><span id="AdjListTokenizers-504"><a href="#AdjListTokenizers-504"><span class="linenos">504</span></a>			<span class="c1"># Systematically permute the leading coord of each edge</span>
</span><span id="AdjListTokenizers-505"><a href="#AdjListTokenizers-505"><span class="linenos">505</span></a>			<span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_permuter</span><span class="o">.</span><span class="n">_permute</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
</span><span id="AdjListTokenizers-506"><a href="#AdjListTokenizers-506"><span class="linenos">506</span></a>			<span class="n">group_params</span><span class="p">:</span> <span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">_GroupingTokenParams</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="AdjListTokenizers-507"><a href="#AdjListTokenizers-507"><span class="linenos">507</span></a>				<span class="bp">self</span><span class="o">.</span><span class="n">edge_grouping</span><span class="o">.</span><span class="n">_token_params</span><span class="p">()</span>
</span><span id="AdjListTokenizers-508"><a href="#AdjListTokenizers-508"><span class="linenos">508</span></a>			<span class="p">)</span>
</span><span id="AdjListTokenizers-509"><a href="#AdjListTokenizers-509"><span class="linenos">509</span></a>			<span class="c1"># then, we need to group the edges</span>
</span><span id="AdjListTokenizers-510"><a href="#AdjListTokenizers-510"><span class="linenos">510</span></a>			<span class="n">groups</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ConnectionArray</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_grouping</span><span class="o">.</span><span class="n">_group_edges</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
</span><span id="AdjListTokenizers-511"><a href="#AdjListTokenizers-511"><span class="linenos">511</span></a>			<span class="c1"># shuffle the groups if specified</span>
</span><span id="AdjListTokenizers-512"><a href="#AdjListTokenizers-512"><span class="linenos">512</span></a>			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shuffle_d0</span><span class="p">:</span>
</span><span id="AdjListTokenizers-513"><a href="#AdjListTokenizers-513"><span class="linenos">513</span></a>				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="AdjListTokenizers-514"><a href="#AdjListTokenizers-514"><span class="linenos">514</span></a>					<span class="n">_NUMPY_RNG</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="AdjListTokenizers-515"><a href="#AdjListTokenizers-515"><span class="linenos">515</span></a>				<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="AdjListTokenizers-516"><a href="#AdjListTokenizers-516"><span class="linenos">516</span></a>					<span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span>
</span><span id="AdjListTokenizers-517"><a href="#AdjListTokenizers-517"><span class="linenos">517</span></a>				<span class="k">else</span><span class="p">:</span>
</span><span id="AdjListTokenizers-518"><a href="#AdjListTokenizers-518"><span class="linenos">518</span></a>					<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;`groups` is an unexpected type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span><span class="si">}</span><span class="s2">. Only types `list` and `np.ndarray` are currently supported.&quot;</span>
</span><span id="AdjListTokenizers-519"><a href="#AdjListTokenizers-519"><span class="linenos">519</span></a>					<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
</span><span id="AdjListTokenizers-520"><a href="#AdjListTokenizers-520"><span class="linenos">520</span></a>			<span class="c1"># Tokenize each group with optional delimiters</span>
</span><span id="AdjListTokenizers-521"><a href="#AdjListTokenizers-521"><span class="linenos">521</span></a>			<span class="n">tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="AdjListTokenizers-522"><a href="#AdjListTokenizers-522"><span class="linenos">522</span></a>				<span class="n">flatten</span><span class="p">(</span>
</span><span id="AdjListTokenizers-523"><a href="#AdjListTokenizers-523"><span class="linenos">523</span></a>					<span class="p">[</span>
</span><span id="AdjListTokenizers-524"><a href="#AdjListTokenizers-524"><span class="linenos">524</span></a>						<span class="p">[</span>
</span><span id="AdjListTokenizers-525"><a href="#AdjListTokenizers-525"><span class="linenos">525</span></a>							<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">(</span>
</span><span id="AdjListTokenizers-526"><a href="#AdjListTokenizers-526"><span class="linenos">526</span></a>								<span class="p">(</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_PRE</span><span class="p">,),</span>
</span><span id="AdjListTokenizers-527"><a href="#AdjListTokenizers-527"><span class="linenos">527</span></a>								<span class="bp">self</span><span class="p">,</span>
</span><span id="AdjListTokenizers-528"><a href="#AdjListTokenizers-528"><span class="linenos">528</span></a>								<span class="s2">&quot;pre&quot;</span><span class="p">,</span>
</span><span id="AdjListTokenizers-529"><a href="#AdjListTokenizers-529"><span class="linenos">529</span></a>							<span class="p">),</span>
</span><span id="AdjListTokenizers-530"><a href="#AdjListTokenizers-530"><span class="linenos">530</span></a>							<span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_tokenize_edge_grouping</span><span class="p">(</span>
</span><span id="AdjListTokenizers-531"><a href="#AdjListTokenizers-531"><span class="linenos">531</span></a>								<span class="n">group</span><span class="p">,</span>
</span><span id="AdjListTokenizers-532"><a href="#AdjListTokenizers-532"><span class="linenos">532</span></a>								<span class="n">maze</span><span class="p">,</span>
</span><span id="AdjListTokenizers-533"><a href="#AdjListTokenizers-533"><span class="linenos">533</span></a>								<span class="n">coord_tokenizer</span><span class="p">,</span>
</span><span id="AdjListTokenizers-534"><a href="#AdjListTokenizers-534"><span class="linenos">534</span></a>								<span class="n">group_params</span><span class="p">,</span>
</span><span id="AdjListTokenizers-535"><a href="#AdjListTokenizers-535"><span class="linenos">535</span></a>							<span class="p">),</span>
</span><span id="AdjListTokenizers-536"><a href="#AdjListTokenizers-536"><span class="linenos">536</span></a>							<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">(</span>
</span><span id="AdjListTokenizers-537"><a href="#AdjListTokenizers-537"><span class="linenos">537</span></a>								<span class="p">(</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJACENCY_ENDLINE</span><span class="p">,),</span>
</span><span id="AdjListTokenizers-538"><a href="#AdjListTokenizers-538"><span class="linenos">538</span></a>								<span class="bp">self</span><span class="p">,</span>
</span><span id="AdjListTokenizers-539"><a href="#AdjListTokenizers-539"><span class="linenos">539</span></a>								<span class="s2">&quot;post&quot;</span><span class="p">,</span>
</span><span id="AdjListTokenizers-540"><a href="#AdjListTokenizers-540"><span class="linenos">540</span></a>							<span class="p">),</span>
</span><span id="AdjListTokenizers-541"><a href="#AdjListTokenizers-541"><span class="linenos">541</span></a>						<span class="p">]</span>
</span><span id="AdjListTokenizers-542"><a href="#AdjListTokenizers-542"><span class="linenos">542</span></a>						<span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span>
</span><span id="AdjListTokenizers-543"><a href="#AdjListTokenizers-543"><span class="linenos">543</span></a>					<span class="p">],</span>
</span><span id="AdjListTokenizers-544"><a href="#AdjListTokenizers-544"><span class="linenos">544</span></a>				<span class="p">),</span>
</span><span id="AdjListTokenizers-545"><a href="#AdjListTokenizers-545"><span class="linenos">545</span></a>			<span class="p">)</span>
</span><span id="AdjListTokenizers-546"><a href="#AdjListTokenizers-546"><span class="linenos">546</span></a>			<span class="k">return</span> <span class="n">tokens</span>
</span><span id="AdjListTokenizers-547"><a href="#AdjListTokenizers-547"><span class="linenos">547</span></a>
</span><span id="AdjListTokenizers-548"><a href="#AdjListTokenizers-548"><span class="linenos">548</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="AdjListTokenizers-549"><a href="#AdjListTokenizers-549"><span class="linenos">549</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">AdjListCoord</span><span class="p">(</span><span class="n">_AdjListTokenizer</span><span class="p">):</span>
</span><span id="AdjListTokenizers-550"><a href="#AdjListTokenizers-550"><span class="linenos">550</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Represents an edge group as tokens for the leading coord followed by coord tokens for the other group members.&quot;&quot;&quot;</span>
</span><span id="AdjListTokenizers-551"><a href="#AdjListTokenizers-551"><span class="linenos">551</span></a>
</span><span id="AdjListTokenizers-552"><a href="#AdjListTokenizers-552"><span class="linenos">552</span></a>		<span class="n">edge_permuter</span><span class="p">:</span> <span class="n">EdgePermuters</span><span class="o">.</span><span class="n">_EdgePermuter</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="AdjListTokenizers-553"><a href="#AdjListTokenizers-553"><span class="linenos">553</span></a>			<span class="n">default</span><span class="o">=</span><span class="n">EdgePermuters</span><span class="o">.</span><span class="n">RandomCoords</span><span class="p">(),</span>
</span><span id="AdjListTokenizers-554"><a href="#AdjListTokenizers-554"><span class="linenos">554</span></a>			<span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">EdgePermuters</span><span class="p">),</span>
</span><span id="AdjListTokenizers-555"><a href="#AdjListTokenizers-555"><span class="linenos">555</span></a>		<span class="p">)</span>
</span><span id="AdjListTokenizers-556"><a href="#AdjListTokenizers-556"><span class="linenos">556</span></a>
</span><span id="AdjListTokenizers-557"><a href="#AdjListTokenizers-557"><span class="linenos">557</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_tokenization_callables</span><span class="p">(</span>
</span><span id="AdjListTokenizers-558"><a href="#AdjListTokenizers-558"><span class="linenos">558</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="AdjListTokenizers-559"><a href="#AdjListTokenizers-559"><span class="linenos">559</span></a>			<span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">,</span>
</span><span id="AdjListTokenizers-560"><a href="#AdjListTokenizers-560"><span class="linenos">560</span></a>			<span class="n">is_conn</span><span class="p">:</span> <span class="n">Bool</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot; edges&quot;</span><span class="p">],</span>
</span><span id="AdjListTokenizers-561"><a href="#AdjListTokenizers-561"><span class="linenos">561</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="AdjListTokenizers-562"><a href="#AdjListTokenizers-562"><span class="linenos">562</span></a>			<span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="AdjListTokenizers-563"><a href="#AdjListTokenizers-563"><span class="linenos">563</span></a>			<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="AdjListTokenizers-564"><a href="#AdjListTokenizers-564"><span class="linenos">564</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Callable</span><span class="p">]:</span>
</span><span id="AdjListTokenizers-565"><a href="#AdjListTokenizers-565"><span class="linenos">565</span></a>			<span class="c1"># Map from `is_conn` to the tokens which represent connections and walls</span>
</span><span id="AdjListTokenizers-566"><a href="#AdjListTokenizers-566"><span class="linenos">566</span></a>			<span class="n">conn_token_map</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="AdjListTokenizers-567"><a href="#AdjListTokenizers-567"><span class="linenos">567</span></a>				<span class="kc">True</span><span class="p">:</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">CONNECTOR</span><span class="p">,</span>
</span><span id="AdjListTokenizers-568"><a href="#AdjListTokenizers-568"><span class="linenos">568</span></a>				<span class="kc">False</span><span class="p">:</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_WALL</span><span class="p">,</span>
</span><span id="AdjListTokenizers-569"><a href="#AdjListTokenizers-569"><span class="linenos">569</span></a>			<span class="p">}</span>
</span><span id="AdjListTokenizers-570"><a href="#AdjListTokenizers-570"><span class="linenos">570</span></a>			<span class="k">return</span> <span class="p">[</span>
</span><span id="AdjListTokenizers-571"><a href="#AdjListTokenizers-571"><span class="linenos">571</span></a>				<span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
</span><span id="AdjListTokenizers-572"><a href="#AdjListTokenizers-572"><span class="linenos">572</span></a>				<span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">conn_token_map</span><span class="p">[</span><span class="n">is_conn</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
</span><span id="AdjListTokenizers-573"><a href="#AdjListTokenizers-573"><span class="linenos">573</span></a>				<span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
</span><span id="AdjListTokenizers-574"><a href="#AdjListTokenizers-574"><span class="linenos">574</span></a>			<span class="p">]</span>
</span><span id="AdjListTokenizers-575"><a href="#AdjListTokenizers-575"><span class="linenos">575</span></a>
</span><span id="AdjListTokenizers-576"><a href="#AdjListTokenizers-576"><span class="linenos">576</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="AdjListTokenizers-577"><a href="#AdjListTokenizers-577"><span class="linenos">577</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">AdjListCardinal</span><span class="p">(</span><span class="n">_AdjListTokenizer</span><span class="p">):</span>
</span><span id="AdjListTokenizers-578"><a href="#AdjListTokenizers-578"><span class="linenos">578</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Represents an edge group as coord tokens for the leading coord and cardinal tokens relative to the leading coord for the other group members.</span>
</span><span id="AdjListTokenizers-579"><a href="#AdjListTokenizers-579"><span class="linenos">579</span></a>
</span><span id="AdjListTokenizers-580"><a href="#AdjListTokenizers-580"><span class="linenos">580</span></a><span class="sd">		# Parameters</span>
</span><span id="AdjListTokenizers-581"><a href="#AdjListTokenizers-581"><span class="linenos">581</span></a><span class="sd">		- `coord_first`: Whether the leading coord token(s) should come before or after the sequence of cardinal tokens.</span>
</span><span id="AdjListTokenizers-582"><a href="#AdjListTokenizers-582"><span class="linenos">582</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="AdjListTokenizers-583"><a href="#AdjListTokenizers-583"><span class="linenos">583</span></a>
</span><span id="AdjListTokenizers-584"><a href="#AdjListTokenizers-584"><span class="linenos">584</span></a>		<span class="n">edge_permuter</span><span class="p">:</span> <span class="n">EdgePermuters</span><span class="o">.</span><span class="n">_EdgePermuter</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="AdjListTokenizers-585"><a href="#AdjListTokenizers-585"><span class="linenos">585</span></a>			<span class="n">default</span><span class="o">=</span><span class="n">EdgePermuters</span><span class="o">.</span><span class="n">BothCoords</span><span class="p">(),</span>
</span><span id="AdjListTokenizers-586"><a href="#AdjListTokenizers-586"><span class="linenos">586</span></a>			<span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">EdgePermuters</span><span class="p">),</span>
</span><span id="AdjListTokenizers-587"><a href="#AdjListTokenizers-587"><span class="linenos">587</span></a>		<span class="p">)</span>
</span><span id="AdjListTokenizers-588"><a href="#AdjListTokenizers-588"><span class="linenos">588</span></a>
</span><span id="AdjListTokenizers-589"><a href="#AdjListTokenizers-589"><span class="linenos">589</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_tokenization_callables</span><span class="p">(</span>
</span><span id="AdjListTokenizers-590"><a href="#AdjListTokenizers-590"><span class="linenos">590</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="AdjListTokenizers-591"><a href="#AdjListTokenizers-591"><span class="linenos">591</span></a>			<span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">,</span>
</span><span id="AdjListTokenizers-592"><a href="#AdjListTokenizers-592"><span class="linenos">592</span></a>			<span class="n">is_conn</span><span class="p">:</span> <span class="n">Bool</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot; edges&quot;</span><span class="p">],</span>
</span><span id="AdjListTokenizers-593"><a href="#AdjListTokenizers-593"><span class="linenos">593</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="AdjListTokenizers-594"><a href="#AdjListTokenizers-594"><span class="linenos">594</span></a>			<span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="AdjListTokenizers-595"><a href="#AdjListTokenizers-595"><span class="linenos">595</span></a>			<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="AdjListTokenizers-596"><a href="#AdjListTokenizers-596"><span class="linenos">596</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Callable</span><span class="p">]:</span>
</span><span id="AdjListTokenizers-597"><a href="#AdjListTokenizers-597"><span class="linenos">597</span></a>			<span class="c1"># Map from `is_conn` to the tokens which represent connections and walls</span>
</span><span id="AdjListTokenizers-598"><a href="#AdjListTokenizers-598"><span class="linenos">598</span></a>			<span class="n">conn_token_map</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="AdjListTokenizers-599"><a href="#AdjListTokenizers-599"><span class="linenos">599</span></a>				<span class="kc">True</span><span class="p">:</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">CONNECTOR</span><span class="p">,</span>
</span><span id="AdjListTokenizers-600"><a href="#AdjListTokenizers-600"><span class="linenos">600</span></a>				<span class="kc">False</span><span class="p">:</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_WALL</span><span class="p">,</span>
</span><span id="AdjListTokenizers-601"><a href="#AdjListTokenizers-601"><span class="linenos">601</span></a>			<span class="p">}</span>
</span><span id="AdjListTokenizers-602"><a href="#AdjListTokenizers-602"><span class="linenos">602</span></a>			<span class="k">return</span> <span class="p">[</span>
</span><span id="AdjListTokenizers-603"><a href="#AdjListTokenizers-603"><span class="linenos">603</span></a>				<span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
</span><span id="AdjListTokenizers-604"><a href="#AdjListTokenizers-604"><span class="linenos">604</span></a>				<span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">conn_token_map</span><span class="p">[</span><span class="n">is_conn</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
</span><span id="AdjListTokenizers-605"><a href="#AdjListTokenizers-605"><span class="linenos">605</span></a>				<span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">get_cardinal_direction</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
</span><span id="AdjListTokenizers-606"><a href="#AdjListTokenizers-606"><span class="linenos">606</span></a>			<span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Namespace for <code>_AdjListTokenizer</code> subclass hierarchy used by <code>MazeTokenizerModular</code>.</p>
</div>


                            <div id="AdjListTokenizers.key" class="classattr">
                                <div class="attr variable">
            <span class="name">key</span>        =
<span class="default_value">&#39;adj_list_tokenizer&#39;</span>

        
    </div>
    <a class="headerlink" href="#AdjListTokenizers.key"></a>
    
    

                            </div>
                </section>
                <section id="AdjListTokenizers.AdjListCoord">
                            <input id="AdjListTokenizers.AdjListCoord-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">AdjListTokenizers.AdjListCoord</span><wbr>(<span class="base"><a href="#AdjListTokenizers._AdjListTokenizer">AdjListTokenizers._AdjListTokenizer</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="AdjListTokenizers.AdjListCoord-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L547-L573" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#AdjListTokenizers.AdjListCoord"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdjListTokenizers.AdjListCoord-548"><a href="#AdjListTokenizers.AdjListCoord-548"><span class="linenos">548</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord-549"><a href="#AdjListTokenizers.AdjListCoord-549"><span class="linenos">549</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">AdjListCoord</span><span class="p">(</span><span class="n">_AdjListTokenizer</span><span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCoord-550"><a href="#AdjListTokenizers.AdjListCoord-550"><span class="linenos">550</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Represents an edge group as tokens for the leading coord followed by coord tokens for the other group members.&quot;&quot;&quot;</span>
</span><span id="AdjListTokenizers.AdjListCoord-551"><a href="#AdjListTokenizers.AdjListCoord-551"><span class="linenos">551</span></a>
</span><span id="AdjListTokenizers.AdjListCoord-552"><a href="#AdjListTokenizers.AdjListCoord-552"><span class="linenos">552</span></a>		<span class="n">edge_permuter</span><span class="p">:</span> <span class="n">EdgePermuters</span><span class="o">.</span><span class="n">_EdgePermuter</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCoord-553"><a href="#AdjListTokenizers.AdjListCoord-553"><span class="linenos">553</span></a>			<span class="n">default</span><span class="o">=</span><span class="n">EdgePermuters</span><span class="o">.</span><span class="n">RandomCoords</span><span class="p">(),</span>
</span><span id="AdjListTokenizers.AdjListCoord-554"><a href="#AdjListTokenizers.AdjListCoord-554"><span class="linenos">554</span></a>			<span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">EdgePermuters</span><span class="p">),</span>
</span><span id="AdjListTokenizers.AdjListCoord-555"><a href="#AdjListTokenizers.AdjListCoord-555"><span class="linenos">555</span></a>		<span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord-556"><a href="#AdjListTokenizers.AdjListCoord-556"><span class="linenos">556</span></a>
</span><span id="AdjListTokenizers.AdjListCoord-557"><a href="#AdjListTokenizers.AdjListCoord-557"><span class="linenos">557</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_tokenization_callables</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCoord-558"><a href="#AdjListTokenizers.AdjListCoord-558"><span class="linenos">558</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCoord-559"><a href="#AdjListTokenizers.AdjListCoord-559"><span class="linenos">559</span></a>			<span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCoord-560"><a href="#AdjListTokenizers.AdjListCoord-560"><span class="linenos">560</span></a>			<span class="n">is_conn</span><span class="p">:</span> <span class="n">Bool</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot; edges&quot;</span><span class="p">],</span>
</span><span id="AdjListTokenizers.AdjListCoord-561"><a href="#AdjListTokenizers.AdjListCoord-561"><span class="linenos">561</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCoord-562"><a href="#AdjListTokenizers.AdjListCoord-562"><span class="linenos">562</span></a>			<span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCoord-563"><a href="#AdjListTokenizers.AdjListCoord-563"><span class="linenos">563</span></a>			<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCoord-564"><a href="#AdjListTokenizers.AdjListCoord-564"><span class="linenos">564</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Callable</span><span class="p">]:</span>
</span><span id="AdjListTokenizers.AdjListCoord-565"><a href="#AdjListTokenizers.AdjListCoord-565"><span class="linenos">565</span></a>			<span class="c1"># Map from `is_conn` to the tokens which represent connections and walls</span>
</span><span id="AdjListTokenizers.AdjListCoord-566"><a href="#AdjListTokenizers.AdjListCoord-566"><span class="linenos">566</span></a>			<span class="n">conn_token_map</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="AdjListTokenizers.AdjListCoord-567"><a href="#AdjListTokenizers.AdjListCoord-567"><span class="linenos">567</span></a>				<span class="kc">True</span><span class="p">:</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">CONNECTOR</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCoord-568"><a href="#AdjListTokenizers.AdjListCoord-568"><span class="linenos">568</span></a>				<span class="kc">False</span><span class="p">:</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_WALL</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCoord-569"><a href="#AdjListTokenizers.AdjListCoord-569"><span class="linenos">569</span></a>			<span class="p">}</span>
</span><span id="AdjListTokenizers.AdjListCoord-570"><a href="#AdjListTokenizers.AdjListCoord-570"><span class="linenos">570</span></a>			<span class="k">return</span> <span class="p">[</span>
</span><span id="AdjListTokenizers.AdjListCoord-571"><a href="#AdjListTokenizers.AdjListCoord-571"><span class="linenos">571</span></a>				<span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
</span><span id="AdjListTokenizers.AdjListCoord-572"><a href="#AdjListTokenizers.AdjListCoord-572"><span class="linenos">572</span></a>				<span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">conn_token_map</span><span class="p">[</span><span class="n">is_conn</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
</span><span id="AdjListTokenizers.AdjListCoord-573"><a href="#AdjListTokenizers.AdjListCoord-573"><span class="linenos">573</span></a>				<span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
</span><span id="AdjListTokenizers.AdjListCoord-574"><a href="#AdjListTokenizers.AdjListCoord-574"><span class="linenos">574</span></a>			<span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Represents an edge group as tokens for the leading coord followed by coord tokens for the other group members.</p>
</div>


                            <div id="AdjListTokenizers.AdjListCoord.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">AdjListTokenizers.AdjListCoord</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">pre</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">post</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">shuffle_d0</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">edge_grouping</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">_EdgeGrouping</span> <span class="o">=</span> <span class="n"><a href="#EdgeGroupings.Ungrouped">EdgeGroupings.Ungrouped</a></span><span class="p">(</span><span class="n">connection_token_ordinal</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>,</span><span class="param">	<span class="n">edge_subset</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">EdgeSubsets</span><span class="o">.</span><span class="n">_EdgeSubset</span> <span class="o">=</span> <span class="n"><a href="#EdgeSubsets.ConnectionEdges">EdgeSubsets.ConnectionEdges</a></span><span class="p">(</span><span class="n">walls</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>,</span><span class="param">	<span class="n">edge_permuter</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">EdgePermuters</span><span class="o">.</span><span class="n">_EdgePermuter</span> <span class="o">=</span> <span class="n"><a href="#EdgePermuters.RandomCoords">EdgePermuters.RandomCoords</a></span><span class="p">()</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#AdjListTokenizers.AdjListCoord">AdjListTokenizers.AdjListCoord</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#AdjListTokenizers.AdjListCoord">AdjListTokenizers.AdjListCoord</a>&#39;&gt;&quot;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#AdjListTokenizers.AdjListCoord.__init__"></a>
    
    

                            </div>
                            <div id="AdjListTokenizers.AdjListCoord.edge_permuter" class="classattr">
                                <div class="attr variable">
            <span class="name">edge_permuter</span><span class="annotation">: maze_dataset.tokenization.modular.elements.EdgePermuters._EdgePermuter</span>        =
<span class="default_value"><a href="#EdgePermuters.RandomCoords">EdgePermuters.RandomCoords()</a></span>

        
    </div>
    <a class="headerlink" href="#AdjListTokenizers.AdjListCoord.edge_permuter"></a>
    
    

                            </div>
                            <div id="AdjListTokenizers.AdjListCoord.serialize" class="classattr">
                                        <input id="AdjListTokenizers.AdjListCoord.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="AdjListTokenizers.AdjListCoord.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L713-L769" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#AdjListTokenizers.AdjListCoord.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdjListTokenizers.AdjListCoord.serialize-714"><a href="#AdjListTokenizers.AdjListCoord.serialize-714"><span class="linenos">714</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-715"><a href="#AdjListTokenizers.AdjListCoord.serialize-715"><span class="linenos">715</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-716"><a href="#AdjListTokenizers.AdjListCoord.serialize-716"><span class="linenos">716</span></a>                <span class="n">_FORMAT_KEY</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-717"><a href="#AdjListTokenizers.AdjListCoord.serialize-717"><span class="linenos">717</span></a>            <span class="p">}</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-718"><a href="#AdjListTokenizers.AdjListCoord.serialize-718"><span class="linenos">718</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-719"><a href="#AdjListTokenizers.AdjListCoord.serialize-719"><span class="linenos">719</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-720"><a href="#AdjListTokenizers.AdjListCoord.serialize-720"><span class="linenos">720</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-721"><a href="#AdjListTokenizers.AdjListCoord.serialize-721"><span class="linenos">721</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-722"><a href="#AdjListTokenizers.AdjListCoord.serialize-722"><span class="linenos">722</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-723"><a href="#AdjListTokenizers.AdjListCoord.serialize-723"><span class="linenos">723</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-724"><a href="#AdjListTokenizers.AdjListCoord.serialize-724"><span class="linenos">724</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-725"><a href="#AdjListTokenizers.AdjListCoord.serialize-725"><span class="linenos">725</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-726"><a href="#AdjListTokenizers.AdjListCoord.serialize-726"><span class="linenos">726</span></a>                    <span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-727"><a href="#AdjListTokenizers.AdjListCoord.serialize-727"><span class="linenos">727</span></a>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-728"><a href="#AdjListTokenizers.AdjListCoord.serialize-728"><span class="linenos">728</span></a>                <span class="c1"># try to save it</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-729"><a href="#AdjListTokenizers.AdjListCoord.serialize-729"><span class="linenos">729</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-730"><a href="#AdjListTokenizers.AdjListCoord.serialize-730"><span class="linenos">730</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-731"><a href="#AdjListTokenizers.AdjListCoord.serialize-731"><span class="linenos">731</span></a>                        <span class="c1"># get the val</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-732"><a href="#AdjListTokenizers.AdjListCoord.serialize-732"><span class="linenos">732</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-733"><a href="#AdjListTokenizers.AdjListCoord.serialize-733"><span class="linenos">733</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-734"><a href="#AdjListTokenizers.AdjListCoord.serialize-734"><span class="linenos">734</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-735"><a href="#AdjListTokenizers.AdjListCoord.serialize-735"><span class="linenos">735</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-736"><a href="#AdjListTokenizers.AdjListCoord.serialize-736"><span class="linenos">736</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-737"><a href="#AdjListTokenizers.AdjListCoord.serialize-737"><span class="linenos">737</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-738"><a href="#AdjListTokenizers.AdjListCoord.serialize-738"><span class="linenos">738</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-739"><a href="#AdjListTokenizers.AdjListCoord.serialize-739"><span class="linenos">739</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-740"><a href="#AdjListTokenizers.AdjListCoord.serialize-740"><span class="linenos">740</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-741"><a href="#AdjListTokenizers.AdjListCoord.serialize-741"><span class="linenos">741</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-742"><a href="#AdjListTokenizers.AdjListCoord.serialize-742"><span class="linenos">742</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-743"><a href="#AdjListTokenizers.AdjListCoord.serialize-743"><span class="linenos">743</span></a>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-744"><a href="#AdjListTokenizers.AdjListCoord.serialize-744"><span class="linenos">744</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-745"><a href="#AdjListTokenizers.AdjListCoord.serialize-745"><span class="linenos">745</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-746"><a href="#AdjListTokenizers.AdjListCoord.serialize-746"><span class="linenos">746</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-747"><a href="#AdjListTokenizers.AdjListCoord.serialize-747"><span class="linenos">747</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-748"><a href="#AdjListTokenizers.AdjListCoord.serialize-748"><span class="linenos">748</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-749"><a href="#AdjListTokenizers.AdjListCoord.serialize-749"><span class="linenos">749</span></a>                                <span class="p">[</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-750"><a href="#AdjListTokenizers.AdjListCoord.serialize-750"><span class="linenos">750</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-751"><a href="#AdjListTokenizers.AdjListCoord.serialize-751"><span class="linenos">751</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-752"><a href="#AdjListTokenizers.AdjListCoord.serialize-752"><span class="linenos">752</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-753"><a href="#AdjListTokenizers.AdjListCoord.serialize-753"><span class="linenos">753</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-754"><a href="#AdjListTokenizers.AdjListCoord.serialize-754"><span class="linenos">754</span></a>                                <span class="p">]</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-755"><a href="#AdjListTokenizers.AdjListCoord.serialize-755"><span class="linenos">755</span></a>                            <span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-756"><a href="#AdjListTokenizers.AdjListCoord.serialize-756"><span class="linenos">756</span></a>                        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-757"><a href="#AdjListTokenizers.AdjListCoord.serialize-757"><span class="linenos">757</span></a>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-758"><a href="#AdjListTokenizers.AdjListCoord.serialize-758"><span class="linenos">758</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-759"><a href="#AdjListTokenizers.AdjListCoord.serialize-759"><span class="linenos">759</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-760"><a href="#AdjListTokenizers.AdjListCoord.serialize-760"><span class="linenos">760</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-761"><a href="#AdjListTokenizers.AdjListCoord.serialize-761"><span class="linenos">761</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-762"><a href="#AdjListTokenizers.AdjListCoord.serialize-762"><span class="linenos">762</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-763"><a href="#AdjListTokenizers.AdjListCoord.serialize-763"><span class="linenos">763</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-764"><a href="#AdjListTokenizers.AdjListCoord.serialize-764"><span class="linenos">764</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-765"><a href="#AdjListTokenizers.AdjListCoord.serialize-765"><span class="linenos">765</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-766"><a href="#AdjListTokenizers.AdjListCoord.serialize-766"><span class="linenos">766</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-767"><a href="#AdjListTokenizers.AdjListCoord.serialize-767"><span class="linenos">767</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-768"><a href="#AdjListTokenizers.AdjListCoord.serialize-768"><span class="linenos">768</span></a>                    <span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-769"><a href="#AdjListTokenizers.AdjListCoord.serialize-769"><span class="linenos">769</span></a>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-770"><a href="#AdjListTokenizers.AdjListCoord.serialize-770"><span class="linenos">770</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="AdjListTokenizers.AdjListCoord.load" class="classattr">
                                        <input id="AdjListTokenizers.AdjListCoord.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="AdjListTokenizers.AdjListCoord.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L776-L862" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#AdjListTokenizers.AdjListCoord.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdjListTokenizers.AdjListCoord.load-777"><a href="#AdjListTokenizers.AdjListCoord.load-777"><span class="linenos">777</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-778"><a href="#AdjListTokenizers.AdjListCoord.load-778"><span class="linenos">778</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-779"><a href="#AdjListTokenizers.AdjListCoord.load-779"><span class="linenos">779</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-780"><a href="#AdjListTokenizers.AdjListCoord.load-780"><span class="linenos">780</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-781"><a href="#AdjListTokenizers.AdjListCoord.load-781"><span class="linenos">781</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-782"><a href="#AdjListTokenizers.AdjListCoord.load-782"><span class="linenos">782</span></a>
</span><span id="AdjListTokenizers.AdjListCoord.load-783"><a href="#AdjListTokenizers.AdjListCoord.load-783"><span class="linenos">783</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-784"><a href="#AdjListTokenizers.AdjListCoord.load-784"><span class="linenos">784</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-785"><a href="#AdjListTokenizers.AdjListCoord.load-785"><span class="linenos">785</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-786"><a href="#AdjListTokenizers.AdjListCoord.load-786"><span class="linenos">786</span></a>
</span><span id="AdjListTokenizers.AdjListCoord.load-787"><a href="#AdjListTokenizers.AdjListCoord.load-787"><span class="linenos">787</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-788"><a href="#AdjListTokenizers.AdjListCoord.load-788"><span class="linenos">788</span></a>
</span><span id="AdjListTokenizers.AdjListCoord.load-789"><a href="#AdjListTokenizers.AdjListCoord.load-789"><span class="linenos">789</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-790"><a href="#AdjListTokenizers.AdjListCoord.load-790"><span class="linenos">790</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-791"><a href="#AdjListTokenizers.AdjListCoord.load-791"><span class="linenos">791</span></a>
</span><span id="AdjListTokenizers.AdjListCoord.load-792"><a href="#AdjListTokenizers.AdjListCoord.load-792"><span class="linenos">792</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-793"><a href="#AdjListTokenizers.AdjListCoord.load-793"><span class="linenos">793</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-794"><a href="#AdjListTokenizers.AdjListCoord.load-794"><span class="linenos">794</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-795"><a href="#AdjListTokenizers.AdjListCoord.load-795"><span class="linenos">795</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-796"><a href="#AdjListTokenizers.AdjListCoord.load-796"><span class="linenos">796</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-797"><a href="#AdjListTokenizers.AdjListCoord.load-797"><span class="linenos">797</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-798"><a href="#AdjListTokenizers.AdjListCoord.load-798"><span class="linenos">798</span></a>
</span><span id="AdjListTokenizers.AdjListCoord.load-799"><a href="#AdjListTokenizers.AdjListCoord.load-799"><span class="linenos">799</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-800"><a href="#AdjListTokenizers.AdjListCoord.load-800"><span class="linenos">800</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-801"><a href="#AdjListTokenizers.AdjListCoord.load-801"><span class="linenos">801</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-802"><a href="#AdjListTokenizers.AdjListCoord.load-802"><span class="linenos">802</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-803"><a href="#AdjListTokenizers.AdjListCoord.load-803"><span class="linenos">803</span></a>
</span><span id="AdjListTokenizers.AdjListCoord.load-804"><a href="#AdjListTokenizers.AdjListCoord.load-804"><span class="linenos">804</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-805"><a href="#AdjListTokenizers.AdjListCoord.load-805"><span class="linenos">805</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-806"><a href="#AdjListTokenizers.AdjListCoord.load-806"><span class="linenos">806</span></a>
</span><span id="AdjListTokenizers.AdjListCoord.load-807"><a href="#AdjListTokenizers.AdjListCoord.load-807"><span class="linenos">807</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-808"><a href="#AdjListTokenizers.AdjListCoord.load-808"><span class="linenos">808</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-809"><a href="#AdjListTokenizers.AdjListCoord.load-809"><span class="linenos">809</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-810"><a href="#AdjListTokenizers.AdjListCoord.load-810"><span class="linenos">810</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-811"><a href="#AdjListTokenizers.AdjListCoord.load-811"><span class="linenos">811</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-812"><a href="#AdjListTokenizers.AdjListCoord.load-812"><span class="linenos">812</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-813"><a href="#AdjListTokenizers.AdjListCoord.load-813"><span class="linenos">813</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-814"><a href="#AdjListTokenizers.AdjListCoord.load-814"><span class="linenos">814</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-815"><a href="#AdjListTokenizers.AdjListCoord.load-815"><span class="linenos">815</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-816"><a href="#AdjListTokenizers.AdjListCoord.load-816"><span class="linenos">816</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-817"><a href="#AdjListTokenizers.AdjListCoord.load-817"><span class="linenos">817</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-818"><a href="#AdjListTokenizers.AdjListCoord.load-818"><span class="linenos">818</span></a>                    <span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-819"><a href="#AdjListTokenizers.AdjListCoord.load-819"><span class="linenos">819</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-820"><a href="#AdjListTokenizers.AdjListCoord.load-820"><span class="linenos">820</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-821"><a href="#AdjListTokenizers.AdjListCoord.load-821"><span class="linenos">821</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-822"><a href="#AdjListTokenizers.AdjListCoord.load-822"><span class="linenos">822</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-823"><a href="#AdjListTokenizers.AdjListCoord.load-823"><span class="linenos">823</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-824"><a href="#AdjListTokenizers.AdjListCoord.load-824"><span class="linenos">824</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-825"><a href="#AdjListTokenizers.AdjListCoord.load-825"><span class="linenos">825</span></a>                            <span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-826"><a href="#AdjListTokenizers.AdjListCoord.load-826"><span class="linenos">826</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-827"><a href="#AdjListTokenizers.AdjListCoord.load-827"><span class="linenos">827</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-828"><a href="#AdjListTokenizers.AdjListCoord.load-828"><span class="linenos">828</span></a>                        <span class="k">pass</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-829"><a href="#AdjListTokenizers.AdjListCoord.load-829"><span class="linenos">829</span></a>
</span><span id="AdjListTokenizers.AdjListCoord.load-830"><a href="#AdjListTokenizers.AdjListCoord.load-830"><span class="linenos">830</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-831"><a href="#AdjListTokenizers.AdjListCoord.load-831"><span class="linenos">831</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-832"><a href="#AdjListTokenizers.AdjListCoord.load-832"><span class="linenos">832</span></a>
</span><span id="AdjListTokenizers.AdjListCoord.load-833"><a href="#AdjListTokenizers.AdjListCoord.load-833"><span class="linenos">833</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-834"><a href="#AdjListTokenizers.AdjListCoord.load-834"><span class="linenos">834</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-835"><a href="#AdjListTokenizers.AdjListCoord.load-835"><span class="linenos">835</span></a>
</span><span id="AdjListTokenizers.AdjListCoord.load-836"><a href="#AdjListTokenizers.AdjListCoord.load-836"><span class="linenos">836</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-837"><a href="#AdjListTokenizers.AdjListCoord.load-837"><span class="linenos">837</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-838"><a href="#AdjListTokenizers.AdjListCoord.load-838"><span class="linenos">838</span></a>                <span class="n">fields_valid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-839"><a href="#AdjListTokenizers.AdjListCoord.load-839"><span class="linenos">839</span></a>                    <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-840"><a href="#AdjListTokenizers.AdjListCoord.load-840"><span class="linenos">840</span></a>                        <span class="n">output</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-841"><a href="#AdjListTokenizers.AdjListCoord.load-841"><span class="linenos">841</span></a>                        <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-842"><a href="#AdjListTokenizers.AdjListCoord.load-842"><span class="linenos">842</span></a>                    <span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-843"><a href="#AdjListTokenizers.AdjListCoord.load-843"><span class="linenos">843</span></a>                <span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-844"><a href="#AdjListTokenizers.AdjListCoord.load-844"><span class="linenos">844</span></a>
</span><span id="AdjListTokenizers.AdjListCoord.load-845"><a href="#AdjListTokenizers.AdjListCoord.load-845"><span class="linenos">845</span></a>                <span class="c1"># if there are any fields that are not valid, raise an error</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-846"><a href="#AdjListTokenizers.AdjListCoord.load-846"><span class="linenos">846</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">fields_valid</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-847"><a href="#AdjListTokenizers.AdjListCoord.load-847"><span class="linenos">847</span></a>                    <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-848"><a href="#AdjListTokenizers.AdjListCoord.load-848"><span class="linenos">848</span></a>                        <span class="sa">f</span><span class="s2">&quot;Type mismatch in fields of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-849"><a href="#AdjListTokenizers.AdjListCoord.load-849"><span class="linenos">849</span></a>                        <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-850"><a href="#AdjListTokenizers.AdjListCoord.load-850"><span class="linenos">850</span></a>                            <span class="p">[</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-851"><a href="#AdjListTokenizers.AdjListCoord.load-851"><span class="linenos">851</span></a>                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">:</span><span class="se">\t</span><span class="s2">expected </span><span class="si">{</span><span class="n">cls_type_hints</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="si">= }</span><span class="s2">, but got value </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-852"><a href="#AdjListTokenizers.AdjListCoord.load-852"><span class="linenos">852</span></a>                                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">fields_valid</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-853"><a href="#AdjListTokenizers.AdjListCoord.load-853"><span class="linenos">853</span></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-854"><a href="#AdjListTokenizers.AdjListCoord.load-854"><span class="linenos">854</span></a>                            <span class="p">]</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-855"><a href="#AdjListTokenizers.AdjListCoord.load-855"><span class="linenos">855</span></a>                        <span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-856"><a href="#AdjListTokenizers.AdjListCoord.load-856"><span class="linenos">856</span></a>                    <span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-857"><a href="#AdjListTokenizers.AdjListCoord.load-857"><span class="linenos">857</span></a>
</span><span id="AdjListTokenizers.AdjListCoord.load-858"><a href="#AdjListTokenizers.AdjListCoord.load-858"><span class="linenos">858</span></a>                    <span class="n">on_typecheck_mismatch</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-859"><a href="#AdjListTokenizers.AdjListCoord.load-859"><span class="linenos">859</span></a>                        <span class="n">msg</span><span class="p">,</span> <span class="n">except_cls</span><span class="o">=</span><span class="n">FieldTypeMismatchError</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-860"><a href="#AdjListTokenizers.AdjListCoord.load-860"><span class="linenos">860</span></a>                    <span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-861"><a href="#AdjListTokenizers.AdjListCoord.load-861"><span class="linenos">861</span></a>
</span><span id="AdjListTokenizers.AdjListCoord.load-862"><a href="#AdjListTokenizers.AdjListCoord.load-862"><span class="linenos">862</span></a>            <span class="c1"># return the new instance</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-863"><a href="#AdjListTokenizers.AdjListCoord.load-863"><span class="linenos">863</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="AdjListTokenizers.AdjListCoord.validate_fields_types" class="classattr">
                                        <input id="AdjListTokenizers.AdjListCoord.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="AdjListTokenizers.AdjListCoord.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L282-L291" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#AdjListTokenizers.AdjListCoord.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdjListTokenizers.AdjListCoord.validate_fields_types-283"><a href="#AdjListTokenizers.AdjListCoord.validate_fields_types-283"><span class="linenos">283</span></a><span class="k">def</span><span class="w"> </span><span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCoord.validate_fields_types-284"><a href="#AdjListTokenizers.AdjListCoord.validate_fields_types-284"><span class="linenos">284</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCoord.validate_fields_types-285"><a href="#AdjListTokenizers.AdjListCoord.validate_fields_types-285"><span class="linenos">285</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCoord.validate_fields_types-286"><a href="#AdjListTokenizers.AdjListCoord.validate_fields_types-286"><span class="linenos">286</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCoord.validate_fields_types-287"><a href="#AdjListTokenizers.AdjListCoord.validate_fields_types-287"><span class="linenos">287</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="AdjListTokenizers.AdjListCoord.validate_fields_types-288"><a href="#AdjListTokenizers.AdjListCoord.validate_fields_types-288"><span class="linenos">288</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCoord.validate_fields_types-289"><a href="#AdjListTokenizers.AdjListCoord.validate_fields_types-289"><span class="linenos">289</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCoord.validate_fields_types-290"><a href="#AdjListTokenizers.AdjListCoord.validate_fields_types-290"><span class="linenos">290</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="AdjListTokenizers.AdjListCoord.validate_fields_types-291"><a href="#AdjListTokenizers.AdjListCoord.validate_fields_types-291"><span class="linenos">291</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="AdjListTokenizers.AdjListCoord.validate_fields_types-292"><a href="#AdjListTokenizers.AdjListCoord.validate_fields_types-292"><span class="linenos">292</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#AdjListTokenizers._AdjListTokenizer">AdjListTokenizers._AdjListTokenizer</a></dt>
                                <dd id="AdjListTokenizers.AdjListCoord.pre" class="variable"><a href="#AdjListTokenizers._AdjListTokenizer.pre">pre</a></dd>
                <dd id="AdjListTokenizers.AdjListCoord.post" class="variable"><a href="#AdjListTokenizers._AdjListTokenizer.post">post</a></dd>
                <dd id="AdjListTokenizers.AdjListCoord.shuffle_d0" class="variable"><a href="#AdjListTokenizers._AdjListTokenizer.shuffle_d0">shuffle_d0</a></dd>
                <dd id="AdjListTokenizers.AdjListCoord.edge_grouping" class="variable"><a href="#AdjListTokenizers._AdjListTokenizer.edge_grouping">edge_grouping</a></dd>
                <dd id="AdjListTokenizers.AdjListCoord.edge_subset" class="variable"><a href="#AdjListTokenizers._AdjListTokenizer.edge_subset">edge_subset</a></dd>
                <dd id="AdjListTokenizers.AdjListCoord.attribute_key" class="function"><a href="#AdjListTokenizers._AdjListTokenizer.attribute_key">attribute_key</a></dd>
                <dd id="AdjListTokenizers.AdjListCoord.is_valid" class="function"><a href="#AdjListTokenizers._AdjListTokenizer.is_valid">is_valid</a></dd>
                <dd id="AdjListTokenizers.AdjListCoord.to_tokens" class="function"><a href="#AdjListTokenizers._AdjListTokenizer.to_tokens">to_tokens</a></dd>

            </div>
            <div><dt><a href="element_base.html#_TokenizerElement">maze_dataset.tokenization.modular.element_base._TokenizerElement</a></dt>
                                <dd id="AdjListTokenizers.AdjListCoord.name" class="variable"><a href="element_base.html#_TokenizerElement.name">name</a></dd>
                <dd id="AdjListTokenizers.AdjListCoord.tokenizer_elements" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="AdjListTokenizers.AdjListCoord.tokenizer_element_tree" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="AdjListTokenizers.AdjListCoord.tokenizer_element_dict" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="AdjListTokenizers.AdjListCoord.validate_field_type" class="function">validate_field_type</dd>
                <dd id="AdjListTokenizers.AdjListCoord.diff" class="function">diff</dd>
                <dd id="AdjListTokenizers.AdjListCoord.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="AdjListTokenizers.AdjListCardinal">
                            <input id="AdjListTokenizers.AdjListCardinal-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">AdjListTokenizers.AdjListCardinal</span><wbr>(<span class="base"><a href="#AdjListTokenizers._AdjListTokenizer">AdjListTokenizers._AdjListTokenizer</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="AdjListTokenizers.AdjListCardinal-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L575-L605" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#AdjListTokenizers.AdjListCardinal"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdjListTokenizers.AdjListCardinal-576"><a href="#AdjListTokenizers.AdjListCardinal-576"><span class="linenos">576</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal-577"><a href="#AdjListTokenizers.AdjListCardinal-577"><span class="linenos">577</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">AdjListCardinal</span><span class="p">(</span><span class="n">_AdjListTokenizer</span><span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCardinal-578"><a href="#AdjListTokenizers.AdjListCardinal-578"><span class="linenos">578</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Represents an edge group as coord tokens for the leading coord and cardinal tokens relative to the leading coord for the other group members.</span>
</span><span id="AdjListTokenizers.AdjListCardinal-579"><a href="#AdjListTokenizers.AdjListCardinal-579"><span class="linenos">579</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal-580"><a href="#AdjListTokenizers.AdjListCardinal-580"><span class="linenos">580</span></a><span class="sd">		# Parameters</span>
</span><span id="AdjListTokenizers.AdjListCardinal-581"><a href="#AdjListTokenizers.AdjListCardinal-581"><span class="linenos">581</span></a><span class="sd">		- `coord_first`: Whether the leading coord token(s) should come before or after the sequence of cardinal tokens.</span>
</span><span id="AdjListTokenizers.AdjListCardinal-582"><a href="#AdjListTokenizers.AdjListCardinal-582"><span class="linenos">582</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="AdjListTokenizers.AdjListCardinal-583"><a href="#AdjListTokenizers.AdjListCardinal-583"><span class="linenos">583</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal-584"><a href="#AdjListTokenizers.AdjListCardinal-584"><span class="linenos">584</span></a>		<span class="n">edge_permuter</span><span class="p">:</span> <span class="n">EdgePermuters</span><span class="o">.</span><span class="n">_EdgePermuter</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCardinal-585"><a href="#AdjListTokenizers.AdjListCardinal-585"><span class="linenos">585</span></a>			<span class="n">default</span><span class="o">=</span><span class="n">EdgePermuters</span><span class="o">.</span><span class="n">BothCoords</span><span class="p">(),</span>
</span><span id="AdjListTokenizers.AdjListCardinal-586"><a href="#AdjListTokenizers.AdjListCardinal-586"><span class="linenos">586</span></a>			<span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">EdgePermuters</span><span class="p">),</span>
</span><span id="AdjListTokenizers.AdjListCardinal-587"><a href="#AdjListTokenizers.AdjListCardinal-587"><span class="linenos">587</span></a>		<span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal-588"><a href="#AdjListTokenizers.AdjListCardinal-588"><span class="linenos">588</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal-589"><a href="#AdjListTokenizers.AdjListCardinal-589"><span class="linenos">589</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_tokenization_callables</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCardinal-590"><a href="#AdjListTokenizers.AdjListCardinal-590"><span class="linenos">590</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCardinal-591"><a href="#AdjListTokenizers.AdjListCardinal-591"><span class="linenos">591</span></a>			<span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCardinal-592"><a href="#AdjListTokenizers.AdjListCardinal-592"><span class="linenos">592</span></a>			<span class="n">is_conn</span><span class="p">:</span> <span class="n">Bool</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot; edges&quot;</span><span class="p">],</span>
</span><span id="AdjListTokenizers.AdjListCardinal-593"><a href="#AdjListTokenizers.AdjListCardinal-593"><span class="linenos">593</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCardinal-594"><a href="#AdjListTokenizers.AdjListCardinal-594"><span class="linenos">594</span></a>			<span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCardinal-595"><a href="#AdjListTokenizers.AdjListCardinal-595"><span class="linenos">595</span></a>			<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCardinal-596"><a href="#AdjListTokenizers.AdjListCardinal-596"><span class="linenos">596</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Callable</span><span class="p">]:</span>
</span><span id="AdjListTokenizers.AdjListCardinal-597"><a href="#AdjListTokenizers.AdjListCardinal-597"><span class="linenos">597</span></a>			<span class="c1"># Map from `is_conn` to the tokens which represent connections and walls</span>
</span><span id="AdjListTokenizers.AdjListCardinal-598"><a href="#AdjListTokenizers.AdjListCardinal-598"><span class="linenos">598</span></a>			<span class="n">conn_token_map</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="AdjListTokenizers.AdjListCardinal-599"><a href="#AdjListTokenizers.AdjListCardinal-599"><span class="linenos">599</span></a>				<span class="kc">True</span><span class="p">:</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">CONNECTOR</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCardinal-600"><a href="#AdjListTokenizers.AdjListCardinal-600"><span class="linenos">600</span></a>				<span class="kc">False</span><span class="p">:</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_WALL</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCardinal-601"><a href="#AdjListTokenizers.AdjListCardinal-601"><span class="linenos">601</span></a>			<span class="p">}</span>
</span><span id="AdjListTokenizers.AdjListCardinal-602"><a href="#AdjListTokenizers.AdjListCardinal-602"><span class="linenos">602</span></a>			<span class="k">return</span> <span class="p">[</span>
</span><span id="AdjListTokenizers.AdjListCardinal-603"><a href="#AdjListTokenizers.AdjListCardinal-603"><span class="linenos">603</span></a>				<span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
</span><span id="AdjListTokenizers.AdjListCardinal-604"><a href="#AdjListTokenizers.AdjListCardinal-604"><span class="linenos">604</span></a>				<span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">conn_token_map</span><span class="p">[</span><span class="n">is_conn</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
</span><span id="AdjListTokenizers.AdjListCardinal-605"><a href="#AdjListTokenizers.AdjListCardinal-605"><span class="linenos">605</span></a>				<span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">get_cardinal_direction</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
</span><span id="AdjListTokenizers.AdjListCardinal-606"><a href="#AdjListTokenizers.AdjListCardinal-606"><span class="linenos">606</span></a>			<span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Represents an edge group as coord tokens for the leading coord and cardinal tokens relative to the leading coord for the other group members.</p>

<h1 id="parameters">Parameters</h1>

<ul>
<li><code>coord_first</code>: Whether the leading coord token(s) should come before or after the sequence of cardinal tokens.</li>
</ul>
</div>


                            <div id="AdjListTokenizers.AdjListCardinal.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">AdjListTokenizers.AdjListCardinal</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">pre</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">post</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">shuffle_d0</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">edge_grouping</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">_EdgeGrouping</span> <span class="o">=</span> <span class="n"><a href="#EdgeGroupings.Ungrouped">EdgeGroupings.Ungrouped</a></span><span class="p">(</span><span class="n">connection_token_ordinal</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>,</span><span class="param">	<span class="n">edge_subset</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">EdgeSubsets</span><span class="o">.</span><span class="n">_EdgeSubset</span> <span class="o">=</span> <span class="n"><a href="#EdgeSubsets.ConnectionEdges">EdgeSubsets.ConnectionEdges</a></span><span class="p">(</span><span class="n">walls</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>,</span><span class="param">	<span class="n">edge_permuter</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">EdgePermuters</span><span class="o">.</span><span class="n">_EdgePermuter</span> <span class="o">=</span> <span class="n"><a href="#EdgePermuters.BothCoords">EdgePermuters.BothCoords</a></span><span class="p">()</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#AdjListTokenizers.AdjListCardinal">AdjListTokenizers.AdjListCardinal</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#AdjListTokenizers.AdjListCardinal">AdjListTokenizers.AdjListCardinal</a>&#39;&gt;&quot;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#AdjListTokenizers.AdjListCardinal.__init__"></a>
    
    

                            </div>
                            <div id="AdjListTokenizers.AdjListCardinal.edge_permuter" class="classattr">
                                <div class="attr variable">
            <span class="name">edge_permuter</span><span class="annotation">: maze_dataset.tokenization.modular.elements.EdgePermuters._EdgePermuter</span>        =
<span class="default_value"><a href="#EdgePermuters.BothCoords">EdgePermuters.BothCoords()</a></span>

        
    </div>
    <a class="headerlink" href="#AdjListTokenizers.AdjListCardinal.edge_permuter"></a>
    
    

                            </div>
                            <div id="AdjListTokenizers.AdjListCardinal.serialize" class="classattr">
                                        <input id="AdjListTokenizers.AdjListCardinal.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="AdjListTokenizers.AdjListCardinal.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L713-L769" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#AdjListTokenizers.AdjListCardinal.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdjListTokenizers.AdjListCardinal.serialize-714"><a href="#AdjListTokenizers.AdjListCardinal.serialize-714"><span class="linenos">714</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-715"><a href="#AdjListTokenizers.AdjListCardinal.serialize-715"><span class="linenos">715</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-716"><a href="#AdjListTokenizers.AdjListCardinal.serialize-716"><span class="linenos">716</span></a>                <span class="n">_FORMAT_KEY</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-717"><a href="#AdjListTokenizers.AdjListCardinal.serialize-717"><span class="linenos">717</span></a>            <span class="p">}</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-718"><a href="#AdjListTokenizers.AdjListCardinal.serialize-718"><span class="linenos">718</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-719"><a href="#AdjListTokenizers.AdjListCardinal.serialize-719"><span class="linenos">719</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-720"><a href="#AdjListTokenizers.AdjListCardinal.serialize-720"><span class="linenos">720</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-721"><a href="#AdjListTokenizers.AdjListCardinal.serialize-721"><span class="linenos">721</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-722"><a href="#AdjListTokenizers.AdjListCardinal.serialize-722"><span class="linenos">722</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-723"><a href="#AdjListTokenizers.AdjListCardinal.serialize-723"><span class="linenos">723</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-724"><a href="#AdjListTokenizers.AdjListCardinal.serialize-724"><span class="linenos">724</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-725"><a href="#AdjListTokenizers.AdjListCardinal.serialize-725"><span class="linenos">725</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-726"><a href="#AdjListTokenizers.AdjListCardinal.serialize-726"><span class="linenos">726</span></a>                    <span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-727"><a href="#AdjListTokenizers.AdjListCardinal.serialize-727"><span class="linenos">727</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-728"><a href="#AdjListTokenizers.AdjListCardinal.serialize-728"><span class="linenos">728</span></a>                <span class="c1"># try to save it</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-729"><a href="#AdjListTokenizers.AdjListCardinal.serialize-729"><span class="linenos">729</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-730"><a href="#AdjListTokenizers.AdjListCardinal.serialize-730"><span class="linenos">730</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-731"><a href="#AdjListTokenizers.AdjListCardinal.serialize-731"><span class="linenos">731</span></a>                        <span class="c1"># get the val</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-732"><a href="#AdjListTokenizers.AdjListCardinal.serialize-732"><span class="linenos">732</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-733"><a href="#AdjListTokenizers.AdjListCardinal.serialize-733"><span class="linenos">733</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-734"><a href="#AdjListTokenizers.AdjListCardinal.serialize-734"><span class="linenos">734</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-735"><a href="#AdjListTokenizers.AdjListCardinal.serialize-735"><span class="linenos">735</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-736"><a href="#AdjListTokenizers.AdjListCardinal.serialize-736"><span class="linenos">736</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-737"><a href="#AdjListTokenizers.AdjListCardinal.serialize-737"><span class="linenos">737</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-738"><a href="#AdjListTokenizers.AdjListCardinal.serialize-738"><span class="linenos">738</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-739"><a href="#AdjListTokenizers.AdjListCardinal.serialize-739"><span class="linenos">739</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-740"><a href="#AdjListTokenizers.AdjListCardinal.serialize-740"><span class="linenos">740</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-741"><a href="#AdjListTokenizers.AdjListCardinal.serialize-741"><span class="linenos">741</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-742"><a href="#AdjListTokenizers.AdjListCardinal.serialize-742"><span class="linenos">742</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-743"><a href="#AdjListTokenizers.AdjListCardinal.serialize-743"><span class="linenos">743</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-744"><a href="#AdjListTokenizers.AdjListCardinal.serialize-744"><span class="linenos">744</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-745"><a href="#AdjListTokenizers.AdjListCardinal.serialize-745"><span class="linenos">745</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-746"><a href="#AdjListTokenizers.AdjListCardinal.serialize-746"><span class="linenos">746</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-747"><a href="#AdjListTokenizers.AdjListCardinal.serialize-747"><span class="linenos">747</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-748"><a href="#AdjListTokenizers.AdjListCardinal.serialize-748"><span class="linenos">748</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-749"><a href="#AdjListTokenizers.AdjListCardinal.serialize-749"><span class="linenos">749</span></a>                                <span class="p">[</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-750"><a href="#AdjListTokenizers.AdjListCardinal.serialize-750"><span class="linenos">750</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-751"><a href="#AdjListTokenizers.AdjListCardinal.serialize-751"><span class="linenos">751</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-752"><a href="#AdjListTokenizers.AdjListCardinal.serialize-752"><span class="linenos">752</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-753"><a href="#AdjListTokenizers.AdjListCardinal.serialize-753"><span class="linenos">753</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-754"><a href="#AdjListTokenizers.AdjListCardinal.serialize-754"><span class="linenos">754</span></a>                                <span class="p">]</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-755"><a href="#AdjListTokenizers.AdjListCardinal.serialize-755"><span class="linenos">755</span></a>                            <span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-756"><a href="#AdjListTokenizers.AdjListCardinal.serialize-756"><span class="linenos">756</span></a>                        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-757"><a href="#AdjListTokenizers.AdjListCardinal.serialize-757"><span class="linenos">757</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-758"><a href="#AdjListTokenizers.AdjListCardinal.serialize-758"><span class="linenos">758</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-759"><a href="#AdjListTokenizers.AdjListCardinal.serialize-759"><span class="linenos">759</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-760"><a href="#AdjListTokenizers.AdjListCardinal.serialize-760"><span class="linenos">760</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-761"><a href="#AdjListTokenizers.AdjListCardinal.serialize-761"><span class="linenos">761</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-762"><a href="#AdjListTokenizers.AdjListCardinal.serialize-762"><span class="linenos">762</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-763"><a href="#AdjListTokenizers.AdjListCardinal.serialize-763"><span class="linenos">763</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-764"><a href="#AdjListTokenizers.AdjListCardinal.serialize-764"><span class="linenos">764</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-765"><a href="#AdjListTokenizers.AdjListCardinal.serialize-765"><span class="linenos">765</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-766"><a href="#AdjListTokenizers.AdjListCardinal.serialize-766"><span class="linenos">766</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-767"><a href="#AdjListTokenizers.AdjListCardinal.serialize-767"><span class="linenos">767</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-768"><a href="#AdjListTokenizers.AdjListCardinal.serialize-768"><span class="linenos">768</span></a>                    <span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-769"><a href="#AdjListTokenizers.AdjListCardinal.serialize-769"><span class="linenos">769</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-770"><a href="#AdjListTokenizers.AdjListCardinal.serialize-770"><span class="linenos">770</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="AdjListTokenizers.AdjListCardinal.load" class="classattr">
                                        <input id="AdjListTokenizers.AdjListCardinal.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="AdjListTokenizers.AdjListCardinal.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L776-L862" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#AdjListTokenizers.AdjListCardinal.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdjListTokenizers.AdjListCardinal.load-777"><a href="#AdjListTokenizers.AdjListCardinal.load-777"><span class="linenos">777</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-778"><a href="#AdjListTokenizers.AdjListCardinal.load-778"><span class="linenos">778</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-779"><a href="#AdjListTokenizers.AdjListCardinal.load-779"><span class="linenos">779</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-780"><a href="#AdjListTokenizers.AdjListCardinal.load-780"><span class="linenos">780</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-781"><a href="#AdjListTokenizers.AdjListCardinal.load-781"><span class="linenos">781</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-782"><a href="#AdjListTokenizers.AdjListCardinal.load-782"><span class="linenos">782</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal.load-783"><a href="#AdjListTokenizers.AdjListCardinal.load-783"><span class="linenos">783</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-784"><a href="#AdjListTokenizers.AdjListCardinal.load-784"><span class="linenos">784</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-785"><a href="#AdjListTokenizers.AdjListCardinal.load-785"><span class="linenos">785</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-786"><a href="#AdjListTokenizers.AdjListCardinal.load-786"><span class="linenos">786</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal.load-787"><a href="#AdjListTokenizers.AdjListCardinal.load-787"><span class="linenos">787</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-788"><a href="#AdjListTokenizers.AdjListCardinal.load-788"><span class="linenos">788</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal.load-789"><a href="#AdjListTokenizers.AdjListCardinal.load-789"><span class="linenos">789</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-790"><a href="#AdjListTokenizers.AdjListCardinal.load-790"><span class="linenos">790</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-791"><a href="#AdjListTokenizers.AdjListCardinal.load-791"><span class="linenos">791</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal.load-792"><a href="#AdjListTokenizers.AdjListCardinal.load-792"><span class="linenos">792</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-793"><a href="#AdjListTokenizers.AdjListCardinal.load-793"><span class="linenos">793</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-794"><a href="#AdjListTokenizers.AdjListCardinal.load-794"><span class="linenos">794</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-795"><a href="#AdjListTokenizers.AdjListCardinal.load-795"><span class="linenos">795</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-796"><a href="#AdjListTokenizers.AdjListCardinal.load-796"><span class="linenos">796</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-797"><a href="#AdjListTokenizers.AdjListCardinal.load-797"><span class="linenos">797</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-798"><a href="#AdjListTokenizers.AdjListCardinal.load-798"><span class="linenos">798</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal.load-799"><a href="#AdjListTokenizers.AdjListCardinal.load-799"><span class="linenos">799</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-800"><a href="#AdjListTokenizers.AdjListCardinal.load-800"><span class="linenos">800</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-801"><a href="#AdjListTokenizers.AdjListCardinal.load-801"><span class="linenos">801</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-802"><a href="#AdjListTokenizers.AdjListCardinal.load-802"><span class="linenos">802</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-803"><a href="#AdjListTokenizers.AdjListCardinal.load-803"><span class="linenos">803</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal.load-804"><a href="#AdjListTokenizers.AdjListCardinal.load-804"><span class="linenos">804</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-805"><a href="#AdjListTokenizers.AdjListCardinal.load-805"><span class="linenos">805</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-806"><a href="#AdjListTokenizers.AdjListCardinal.load-806"><span class="linenos">806</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal.load-807"><a href="#AdjListTokenizers.AdjListCardinal.load-807"><span class="linenos">807</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-808"><a href="#AdjListTokenizers.AdjListCardinal.load-808"><span class="linenos">808</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-809"><a href="#AdjListTokenizers.AdjListCardinal.load-809"><span class="linenos">809</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-810"><a href="#AdjListTokenizers.AdjListCardinal.load-810"><span class="linenos">810</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-811"><a href="#AdjListTokenizers.AdjListCardinal.load-811"><span class="linenos">811</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-812"><a href="#AdjListTokenizers.AdjListCardinal.load-812"><span class="linenos">812</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-813"><a href="#AdjListTokenizers.AdjListCardinal.load-813"><span class="linenos">813</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-814"><a href="#AdjListTokenizers.AdjListCardinal.load-814"><span class="linenos">814</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-815"><a href="#AdjListTokenizers.AdjListCardinal.load-815"><span class="linenos">815</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-816"><a href="#AdjListTokenizers.AdjListCardinal.load-816"><span class="linenos">816</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-817"><a href="#AdjListTokenizers.AdjListCardinal.load-817"><span class="linenos">817</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-818"><a href="#AdjListTokenizers.AdjListCardinal.load-818"><span class="linenos">818</span></a>                    <span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-819"><a href="#AdjListTokenizers.AdjListCardinal.load-819"><span class="linenos">819</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-820"><a href="#AdjListTokenizers.AdjListCardinal.load-820"><span class="linenos">820</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-821"><a href="#AdjListTokenizers.AdjListCardinal.load-821"><span class="linenos">821</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-822"><a href="#AdjListTokenizers.AdjListCardinal.load-822"><span class="linenos">822</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-823"><a href="#AdjListTokenizers.AdjListCardinal.load-823"><span class="linenos">823</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-824"><a href="#AdjListTokenizers.AdjListCardinal.load-824"><span class="linenos">824</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-825"><a href="#AdjListTokenizers.AdjListCardinal.load-825"><span class="linenos">825</span></a>                            <span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-826"><a href="#AdjListTokenizers.AdjListCardinal.load-826"><span class="linenos">826</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-827"><a href="#AdjListTokenizers.AdjListCardinal.load-827"><span class="linenos">827</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-828"><a href="#AdjListTokenizers.AdjListCardinal.load-828"><span class="linenos">828</span></a>                        <span class="k">pass</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-829"><a href="#AdjListTokenizers.AdjListCardinal.load-829"><span class="linenos">829</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal.load-830"><a href="#AdjListTokenizers.AdjListCardinal.load-830"><span class="linenos">830</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-831"><a href="#AdjListTokenizers.AdjListCardinal.load-831"><span class="linenos">831</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-832"><a href="#AdjListTokenizers.AdjListCardinal.load-832"><span class="linenos">832</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal.load-833"><a href="#AdjListTokenizers.AdjListCardinal.load-833"><span class="linenos">833</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-834"><a href="#AdjListTokenizers.AdjListCardinal.load-834"><span class="linenos">834</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-835"><a href="#AdjListTokenizers.AdjListCardinal.load-835"><span class="linenos">835</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal.load-836"><a href="#AdjListTokenizers.AdjListCardinal.load-836"><span class="linenos">836</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-837"><a href="#AdjListTokenizers.AdjListCardinal.load-837"><span class="linenos">837</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-838"><a href="#AdjListTokenizers.AdjListCardinal.load-838"><span class="linenos">838</span></a>                <span class="n">fields_valid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-839"><a href="#AdjListTokenizers.AdjListCardinal.load-839"><span class="linenos">839</span></a>                    <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-840"><a href="#AdjListTokenizers.AdjListCardinal.load-840"><span class="linenos">840</span></a>                        <span class="n">output</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-841"><a href="#AdjListTokenizers.AdjListCardinal.load-841"><span class="linenos">841</span></a>                        <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-842"><a href="#AdjListTokenizers.AdjListCardinal.load-842"><span class="linenos">842</span></a>                    <span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-843"><a href="#AdjListTokenizers.AdjListCardinal.load-843"><span class="linenos">843</span></a>                <span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-844"><a href="#AdjListTokenizers.AdjListCardinal.load-844"><span class="linenos">844</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal.load-845"><a href="#AdjListTokenizers.AdjListCardinal.load-845"><span class="linenos">845</span></a>                <span class="c1"># if there are any fields that are not valid, raise an error</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-846"><a href="#AdjListTokenizers.AdjListCardinal.load-846"><span class="linenos">846</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">fields_valid</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-847"><a href="#AdjListTokenizers.AdjListCardinal.load-847"><span class="linenos">847</span></a>                    <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-848"><a href="#AdjListTokenizers.AdjListCardinal.load-848"><span class="linenos">848</span></a>                        <span class="sa">f</span><span class="s2">&quot;Type mismatch in fields of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-849"><a href="#AdjListTokenizers.AdjListCardinal.load-849"><span class="linenos">849</span></a>                        <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-850"><a href="#AdjListTokenizers.AdjListCardinal.load-850"><span class="linenos">850</span></a>                            <span class="p">[</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-851"><a href="#AdjListTokenizers.AdjListCardinal.load-851"><span class="linenos">851</span></a>                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">:</span><span class="se">\t</span><span class="s2">expected </span><span class="si">{</span><span class="n">cls_type_hints</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="si">= }</span><span class="s2">, but got value </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-852"><a href="#AdjListTokenizers.AdjListCardinal.load-852"><span class="linenos">852</span></a>                                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">fields_valid</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-853"><a href="#AdjListTokenizers.AdjListCardinal.load-853"><span class="linenos">853</span></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-854"><a href="#AdjListTokenizers.AdjListCardinal.load-854"><span class="linenos">854</span></a>                            <span class="p">]</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-855"><a href="#AdjListTokenizers.AdjListCardinal.load-855"><span class="linenos">855</span></a>                        <span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-856"><a href="#AdjListTokenizers.AdjListCardinal.load-856"><span class="linenos">856</span></a>                    <span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-857"><a href="#AdjListTokenizers.AdjListCardinal.load-857"><span class="linenos">857</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal.load-858"><a href="#AdjListTokenizers.AdjListCardinal.load-858"><span class="linenos">858</span></a>                    <span class="n">on_typecheck_mismatch</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-859"><a href="#AdjListTokenizers.AdjListCardinal.load-859"><span class="linenos">859</span></a>                        <span class="n">msg</span><span class="p">,</span> <span class="n">except_cls</span><span class="o">=</span><span class="n">FieldTypeMismatchError</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-860"><a href="#AdjListTokenizers.AdjListCardinal.load-860"><span class="linenos">860</span></a>                    <span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-861"><a href="#AdjListTokenizers.AdjListCardinal.load-861"><span class="linenos">861</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal.load-862"><a href="#AdjListTokenizers.AdjListCardinal.load-862"><span class="linenos">862</span></a>            <span class="c1"># return the new instance</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-863"><a href="#AdjListTokenizers.AdjListCardinal.load-863"><span class="linenos">863</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="AdjListTokenizers.AdjListCardinal.validate_fields_types" class="classattr">
                                        <input id="AdjListTokenizers.AdjListCardinal.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="AdjListTokenizers.AdjListCardinal.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L282-L291" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#AdjListTokenizers.AdjListCardinal.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdjListTokenizers.AdjListCardinal.validate_fields_types-283"><a href="#AdjListTokenizers.AdjListCardinal.validate_fields_types-283"><span class="linenos">283</span></a><span class="k">def</span><span class="w"> </span><span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCardinal.validate_fields_types-284"><a href="#AdjListTokenizers.AdjListCardinal.validate_fields_types-284"><span class="linenos">284</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCardinal.validate_fields_types-285"><a href="#AdjListTokenizers.AdjListCardinal.validate_fields_types-285"><span class="linenos">285</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCardinal.validate_fields_types-286"><a href="#AdjListTokenizers.AdjListCardinal.validate_fields_types-286"><span class="linenos">286</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCardinal.validate_fields_types-287"><a href="#AdjListTokenizers.AdjListCardinal.validate_fields_types-287"><span class="linenos">287</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="AdjListTokenizers.AdjListCardinal.validate_fields_types-288"><a href="#AdjListTokenizers.AdjListCardinal.validate_fields_types-288"><span class="linenos">288</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCardinal.validate_fields_types-289"><a href="#AdjListTokenizers.AdjListCardinal.validate_fields_types-289"><span class="linenos">289</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCardinal.validate_fields_types-290"><a href="#AdjListTokenizers.AdjListCardinal.validate_fields_types-290"><span class="linenos">290</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="AdjListTokenizers.AdjListCardinal.validate_fields_types-291"><a href="#AdjListTokenizers.AdjListCardinal.validate_fields_types-291"><span class="linenos">291</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="AdjListTokenizers.AdjListCardinal.validate_fields_types-292"><a href="#AdjListTokenizers.AdjListCardinal.validate_fields_types-292"><span class="linenos">292</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#AdjListTokenizers._AdjListTokenizer">AdjListTokenizers._AdjListTokenizer</a></dt>
                                <dd id="AdjListTokenizers.AdjListCardinal.pre" class="variable"><a href="#AdjListTokenizers._AdjListTokenizer.pre">pre</a></dd>
                <dd id="AdjListTokenizers.AdjListCardinal.post" class="variable"><a href="#AdjListTokenizers._AdjListTokenizer.post">post</a></dd>
                <dd id="AdjListTokenizers.AdjListCardinal.shuffle_d0" class="variable"><a href="#AdjListTokenizers._AdjListTokenizer.shuffle_d0">shuffle_d0</a></dd>
                <dd id="AdjListTokenizers.AdjListCardinal.edge_grouping" class="variable"><a href="#AdjListTokenizers._AdjListTokenizer.edge_grouping">edge_grouping</a></dd>
                <dd id="AdjListTokenizers.AdjListCardinal.edge_subset" class="variable"><a href="#AdjListTokenizers._AdjListTokenizer.edge_subset">edge_subset</a></dd>
                <dd id="AdjListTokenizers.AdjListCardinal.attribute_key" class="function"><a href="#AdjListTokenizers._AdjListTokenizer.attribute_key">attribute_key</a></dd>
                <dd id="AdjListTokenizers.AdjListCardinal.is_valid" class="function"><a href="#AdjListTokenizers._AdjListTokenizer.is_valid">is_valid</a></dd>
                <dd id="AdjListTokenizers.AdjListCardinal.to_tokens" class="function"><a href="#AdjListTokenizers._AdjListTokenizer.to_tokens">to_tokens</a></dd>

            </div>
            <div><dt><a href="element_base.html#_TokenizerElement">maze_dataset.tokenization.modular.element_base._TokenizerElement</a></dt>
                                <dd id="AdjListTokenizers.AdjListCardinal.name" class="variable"><a href="element_base.html#_TokenizerElement.name">name</a></dd>
                <dd id="AdjListTokenizers.AdjListCardinal.tokenizer_elements" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="AdjListTokenizers.AdjListCardinal.tokenizer_element_tree" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="AdjListTokenizers.AdjListCardinal.tokenizer_element_dict" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="AdjListTokenizers.AdjListCardinal.validate_field_type" class="function">validate_field_type</dd>
                <dd id="AdjListTokenizers.AdjListCardinal.diff" class="function">diff</dd>
                <dd id="AdjListTokenizers.AdjListCardinal.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="TargetTokenizers">
                            <input id="TargetTokenizers-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">TargetTokenizers</span><wbr>(<span class="base"><a href="element_base.html#__TokenizerElementNamespace">maze_dataset.tokenization.modular.element_base.__TokenizerElementNamespace</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="TargetTokenizers-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L608-L664" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#TargetTokenizers"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TargetTokenizers-609"><a href="#TargetTokenizers-609"><span class="linenos">609</span></a><span class="k">class</span><span class="w"> </span><span class="nc">TargetTokenizers</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="TargetTokenizers-610"><a href="#TargetTokenizers-610"><span class="linenos">610</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Namespace for `_TargetTokenizer` subclass hierarchy used by `MazeTokenizerModular`.&quot;&quot;&quot;</span>
</span><span id="TargetTokenizers-611"><a href="#TargetTokenizers-611"><span class="linenos">611</span></a>
</span><span id="TargetTokenizers-612"><a href="#TargetTokenizers-612"><span class="linenos">612</span></a>	<span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;target_tokenizer&quot;</span>
</span><span id="TargetTokenizers-613"><a href="#TargetTokenizers-613"><span class="linenos">613</span></a>
</span><span id="TargetTokenizers-614"><a href="#TargetTokenizers-614"><span class="linenos">614</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="TargetTokenizers-615"><a href="#TargetTokenizers-615"><span class="linenos">615</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">_TargetTokenizer</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="TargetTokenizers-616"><a href="#TargetTokenizers-616"><span class="linenos">616</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Superclass of tokenizers for maze targets.&quot;&quot;&quot;</span>
</span><span id="TargetTokenizers-617"><a href="#TargetTokenizers-617"><span class="linenos">617</span></a>
</span><span id="TargetTokenizers-618"><a href="#TargetTokenizers-618"><span class="linenos">618</span></a>		<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="TargetTokenizers-619"><a href="#TargetTokenizers-619"><span class="linenos">619</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="TargetTokenizers-620"><a href="#TargetTokenizers-620"><span class="linenos">620</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="TargetTokenizers-621"><a href="#TargetTokenizers-621"><span class="linenos">621</span></a>			<span class="n">targets</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Coord</span><span class="p">],</span>
</span><span id="TargetTokenizers-622"><a href="#TargetTokenizers-622"><span class="linenos">622</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="TargetTokenizers-623"><a href="#TargetTokenizers-623"><span class="linenos">623</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="TargetTokenizers-624"><a href="#TargetTokenizers-624"><span class="linenos">624</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns tokens representing the target.&quot;&quot;&quot;</span>
</span><span id="TargetTokenizers-625"><a href="#TargetTokenizers-625"><span class="linenos">625</span></a>			<span class="k">pass</span>
</span><span id="TargetTokenizers-626"><a href="#TargetTokenizers-626"><span class="linenos">626</span></a>
</span><span id="TargetTokenizers-627"><a href="#TargetTokenizers-627"><span class="linenos">627</span></a>		<span class="nd">@classmethod</span>
</span><span id="TargetTokenizers-628"><a href="#TargetTokenizers-628"><span class="linenos">628</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="TargetTokenizers-629"><a href="#TargetTokenizers-629"><span class="linenos">629</span></a>			<span class="k">return</span> <span class="n">TargetTokenizers</span><span class="o">.</span><span class="n">key</span>
</span><span id="TargetTokenizers-630"><a href="#TargetTokenizers-630"><span class="linenos">630</span></a>
</span><span id="TargetTokenizers-631"><a href="#TargetTokenizers-631"><span class="linenos">631</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="TargetTokenizers-632"><a href="#TargetTokenizers-632"><span class="linenos">632</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">Unlabeled</span><span class="p">(</span><span class="n">_TargetTokenizer</span><span class="p">):</span>
</span><span id="TargetTokenizers-633"><a href="#TargetTokenizers-633"><span class="linenos">633</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Targets are simply listed as coord tokens.</span>
</span><span id="TargetTokenizers-634"><a href="#TargetTokenizers-634"><span class="linenos">634</span></a>
</span><span id="TargetTokenizers-635"><a href="#TargetTokenizers-635"><span class="linenos">635</span></a><span class="sd">		- `post`: Whether all coords include an integral following delimiter token</span>
</span><span id="TargetTokenizers-636"><a href="#TargetTokenizers-636"><span class="linenos">636</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="TargetTokenizers-637"><a href="#TargetTokenizers-637"><span class="linenos">637</span></a>
</span><span id="TargetTokenizers-638"><a href="#TargetTokenizers-638"><span class="linenos">638</span></a>		<span class="n">post</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="TargetTokenizers-639"><a href="#TargetTokenizers-639"><span class="linenos">639</span></a>
</span><span id="TargetTokenizers-640"><a href="#TargetTokenizers-640"><span class="linenos">640</span></a>		<span class="c1"># inherit docstring</span>
</span><span id="TargetTokenizers-641"><a href="#TargetTokenizers-641"><span class="linenos">641</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>  <span class="c1"># noqa: D102</span>
</span><span id="TargetTokenizers-642"><a href="#TargetTokenizers-642"><span class="linenos">642</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="TargetTokenizers-643"><a href="#TargetTokenizers-643"><span class="linenos">643</span></a>			<span class="n">targets</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Coord</span><span class="p">],</span>
</span><span id="TargetTokenizers-644"><a href="#TargetTokenizers-644"><span class="linenos">644</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="TargetTokenizers-645"><a href="#TargetTokenizers-645"><span class="linenos">645</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="TargetTokenizers-646"><a href="#TargetTokenizers-646"><span class="linenos">646</span></a>			<span class="k">return</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="TargetTokenizers-647"><a href="#TargetTokenizers-647"><span class="linenos">647</span></a>				<span class="n">flatten</span><span class="p">(</span>
</span><span id="TargetTokenizers-648"><a href="#TargetTokenizers-648"><span class="linenos">648</span></a>					<span class="p">[</span>
</span><span id="TargetTokenizers-649"><a href="#TargetTokenizers-649"><span class="linenos">649</span></a>						<span class="p">[</span>
</span><span id="TargetTokenizers-650"><a href="#TargetTokenizers-650"><span class="linenos">650</span></a>							<span class="o">*</span><span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
</span><span id="TargetTokenizers-651"><a href="#TargetTokenizers-651"><span class="linenos">651</span></a>							<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">(</span>
</span><span id="TargetTokenizers-652"><a href="#TargetTokenizers-652"><span class="linenos">652</span></a>								<span class="p">[</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_POST</span><span class="p">],</span>
</span><span id="TargetTokenizers-653"><a href="#TargetTokenizers-653"><span class="linenos">653</span></a>								<span class="bp">self</span><span class="p">,</span>
</span><span id="TargetTokenizers-654"><a href="#TargetTokenizers-654"><span class="linenos">654</span></a>								<span class="s2">&quot;post&quot;</span><span class="p">,</span>
</span><span id="TargetTokenizers-655"><a href="#TargetTokenizers-655"><span class="linenos">655</span></a>							<span class="p">),</span>
</span><span id="TargetTokenizers-656"><a href="#TargetTokenizers-656"><span class="linenos">656</span></a>						<span class="p">]</span>
</span><span id="TargetTokenizers-657"><a href="#TargetTokenizers-657"><span class="linenos">657</span></a>						<span class="k">for</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">targets</span>
</span><span id="TargetTokenizers-658"><a href="#TargetTokenizers-658"><span class="linenos">658</span></a>					<span class="p">],</span>
</span><span id="TargetTokenizers-659"><a href="#TargetTokenizers-659"><span class="linenos">659</span></a>				<span class="p">),</span>
</span><span id="TargetTokenizers-660"><a href="#TargetTokenizers-660"><span class="linenos">660</span></a>			<span class="p">)</span>
</span><span id="TargetTokenizers-661"><a href="#TargetTokenizers-661"><span class="linenos">661</span></a>
</span><span id="TargetTokenizers-662"><a href="#TargetTokenizers-662"><span class="linenos">662</span></a>		<span class="c1"># inherit docstring</span>
</span><span id="TargetTokenizers-663"><a href="#TargetTokenizers-663"><span class="linenos">663</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># noqa: D102</span>
</span><span id="TargetTokenizers-664"><a href="#TargetTokenizers-664"><span class="linenos">664</span></a>			<span class="c1"># No invalid instances possible within data member type hint bounds</span>
</span><span id="TargetTokenizers-665"><a href="#TargetTokenizers-665"><span class="linenos">665</span></a>			<span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Namespace for <code>_TargetTokenizer</code> subclass hierarchy used by <code>MazeTokenizerModular</code>.</p>
</div>


                            <div id="TargetTokenizers.key" class="classattr">
                                <div class="attr variable">
            <span class="name">key</span>        =
<span class="default_value">&#39;target_tokenizer&#39;</span>

        
    </div>
    <a class="headerlink" href="#TargetTokenizers.key"></a>
    
    

                            </div>
                </section>
                <section id="TargetTokenizers.Unlabeled">
                            <input id="TargetTokenizers.Unlabeled-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">TargetTokenizers.Unlabeled</span><wbr>(<span class="base"><a href="#TargetTokenizers._TargetTokenizer">TargetTokenizers._TargetTokenizer</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="TargetTokenizers.Unlabeled-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L630-L664" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#TargetTokenizers.Unlabeled"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TargetTokenizers.Unlabeled-631"><a href="#TargetTokenizers.Unlabeled-631"><span class="linenos">631</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled-632"><a href="#TargetTokenizers.Unlabeled-632"><span class="linenos">632</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">Unlabeled</span><span class="p">(</span><span class="n">_TargetTokenizer</span><span class="p">):</span>
</span><span id="TargetTokenizers.Unlabeled-633"><a href="#TargetTokenizers.Unlabeled-633"><span class="linenos">633</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Targets are simply listed as coord tokens.</span>
</span><span id="TargetTokenizers.Unlabeled-634"><a href="#TargetTokenizers.Unlabeled-634"><span class="linenos">634</span></a>
</span><span id="TargetTokenizers.Unlabeled-635"><a href="#TargetTokenizers.Unlabeled-635"><span class="linenos">635</span></a><span class="sd">		- `post`: Whether all coords include an integral following delimiter token</span>
</span><span id="TargetTokenizers.Unlabeled-636"><a href="#TargetTokenizers.Unlabeled-636"><span class="linenos">636</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="TargetTokenizers.Unlabeled-637"><a href="#TargetTokenizers.Unlabeled-637"><span class="linenos">637</span></a>
</span><span id="TargetTokenizers.Unlabeled-638"><a href="#TargetTokenizers.Unlabeled-638"><span class="linenos">638</span></a>		<span class="n">post</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled-639"><a href="#TargetTokenizers.Unlabeled-639"><span class="linenos">639</span></a>
</span><span id="TargetTokenizers.Unlabeled-640"><a href="#TargetTokenizers.Unlabeled-640"><span class="linenos">640</span></a>		<span class="c1"># inherit docstring</span>
</span><span id="TargetTokenizers.Unlabeled-641"><a href="#TargetTokenizers.Unlabeled-641"><span class="linenos">641</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>  <span class="c1"># noqa: D102</span>
</span><span id="TargetTokenizers.Unlabeled-642"><a href="#TargetTokenizers.Unlabeled-642"><span class="linenos">642</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="TargetTokenizers.Unlabeled-643"><a href="#TargetTokenizers.Unlabeled-643"><span class="linenos">643</span></a>			<span class="n">targets</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Coord</span><span class="p">],</span>
</span><span id="TargetTokenizers.Unlabeled-644"><a href="#TargetTokenizers.Unlabeled-644"><span class="linenos">644</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="TargetTokenizers.Unlabeled-645"><a href="#TargetTokenizers.Unlabeled-645"><span class="linenos">645</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="TargetTokenizers.Unlabeled-646"><a href="#TargetTokenizers.Unlabeled-646"><span class="linenos">646</span></a>			<span class="k">return</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled-647"><a href="#TargetTokenizers.Unlabeled-647"><span class="linenos">647</span></a>				<span class="n">flatten</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled-648"><a href="#TargetTokenizers.Unlabeled-648"><span class="linenos">648</span></a>					<span class="p">[</span>
</span><span id="TargetTokenizers.Unlabeled-649"><a href="#TargetTokenizers.Unlabeled-649"><span class="linenos">649</span></a>						<span class="p">[</span>
</span><span id="TargetTokenizers.Unlabeled-650"><a href="#TargetTokenizers.Unlabeled-650"><span class="linenos">650</span></a>							<span class="o">*</span><span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
</span><span id="TargetTokenizers.Unlabeled-651"><a href="#TargetTokenizers.Unlabeled-651"><span class="linenos">651</span></a>							<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled-652"><a href="#TargetTokenizers.Unlabeled-652"><span class="linenos">652</span></a>								<span class="p">[</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_POST</span><span class="p">],</span>
</span><span id="TargetTokenizers.Unlabeled-653"><a href="#TargetTokenizers.Unlabeled-653"><span class="linenos">653</span></a>								<span class="bp">self</span><span class="p">,</span>
</span><span id="TargetTokenizers.Unlabeled-654"><a href="#TargetTokenizers.Unlabeled-654"><span class="linenos">654</span></a>								<span class="s2">&quot;post&quot;</span><span class="p">,</span>
</span><span id="TargetTokenizers.Unlabeled-655"><a href="#TargetTokenizers.Unlabeled-655"><span class="linenos">655</span></a>							<span class="p">),</span>
</span><span id="TargetTokenizers.Unlabeled-656"><a href="#TargetTokenizers.Unlabeled-656"><span class="linenos">656</span></a>						<span class="p">]</span>
</span><span id="TargetTokenizers.Unlabeled-657"><a href="#TargetTokenizers.Unlabeled-657"><span class="linenos">657</span></a>						<span class="k">for</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">targets</span>
</span><span id="TargetTokenizers.Unlabeled-658"><a href="#TargetTokenizers.Unlabeled-658"><span class="linenos">658</span></a>					<span class="p">],</span>
</span><span id="TargetTokenizers.Unlabeled-659"><a href="#TargetTokenizers.Unlabeled-659"><span class="linenos">659</span></a>				<span class="p">),</span>
</span><span id="TargetTokenizers.Unlabeled-660"><a href="#TargetTokenizers.Unlabeled-660"><span class="linenos">660</span></a>			<span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled-661"><a href="#TargetTokenizers.Unlabeled-661"><span class="linenos">661</span></a>
</span><span id="TargetTokenizers.Unlabeled-662"><a href="#TargetTokenizers.Unlabeled-662"><span class="linenos">662</span></a>		<span class="c1"># inherit docstring</span>
</span><span id="TargetTokenizers.Unlabeled-663"><a href="#TargetTokenizers.Unlabeled-663"><span class="linenos">663</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># noqa: D102</span>
</span><span id="TargetTokenizers.Unlabeled-664"><a href="#TargetTokenizers.Unlabeled-664"><span class="linenos">664</span></a>			<span class="c1"># No invalid instances possible within data member type hint bounds</span>
</span><span id="TargetTokenizers.Unlabeled-665"><a href="#TargetTokenizers.Unlabeled-665"><span class="linenos">665</span></a>			<span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Targets are simply listed as coord tokens.</p>

<ul>
<li><code><a href="#TargetTokenizers.Unlabeled.post">post</a></code>: Whether all coords include an integral following delimiter token</li>
</ul>
</div>


                            <div id="TargetTokenizers.Unlabeled.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">TargetTokenizers.Unlabeled</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#TargetTokenizers.Unlabeled">TargetTokenizers.Unlabeled</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#TargetTokenizers.Unlabeled">TargetTokenizers.Unlabeled</a>&#39;&gt;&quot;</span>,</span><span class="param">	<span class="n">post</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#TargetTokenizers.Unlabeled.__init__"></a>
    
    

                            </div>
                            <div id="TargetTokenizers.Unlabeled.post" class="classattr">
                                <div class="attr variable">
            <span class="name">post</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#TargetTokenizers.Unlabeled.post"></a>
    
    

                            </div>
                            <div id="TargetTokenizers.Unlabeled.to_tokens" class="classattr">
                                        <input id="TargetTokenizers.Unlabeled.to_tokens-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_tokens</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">targets</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">jaxtyping</span><span class="o">.</span><span class="n">Int8</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="s1">&#39;row_col=2&#39;</span><span class="p">]]</span>,</span><span class="param">	<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="TargetTokenizers.Unlabeled.to_tokens-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L640-L659" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#TargetTokenizers.Unlabeled.to_tokens"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TargetTokenizers.Unlabeled.to_tokens-641"><a href="#TargetTokenizers.Unlabeled.to_tokens-641"><span class="linenos">641</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>  <span class="c1"># noqa: D102</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-642"><a href="#TargetTokenizers.Unlabeled.to_tokens-642"><span class="linenos">642</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-643"><a href="#TargetTokenizers.Unlabeled.to_tokens-643"><span class="linenos">643</span></a>			<span class="n">targets</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Coord</span><span class="p">],</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-644"><a href="#TargetTokenizers.Unlabeled.to_tokens-644"><span class="linenos">644</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-645"><a href="#TargetTokenizers.Unlabeled.to_tokens-645"><span class="linenos">645</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-646"><a href="#TargetTokenizers.Unlabeled.to_tokens-646"><span class="linenos">646</span></a>			<span class="k">return</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-647"><a href="#TargetTokenizers.Unlabeled.to_tokens-647"><span class="linenos">647</span></a>				<span class="n">flatten</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-648"><a href="#TargetTokenizers.Unlabeled.to_tokens-648"><span class="linenos">648</span></a>					<span class="p">[</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-649"><a href="#TargetTokenizers.Unlabeled.to_tokens-649"><span class="linenos">649</span></a>						<span class="p">[</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-650"><a href="#TargetTokenizers.Unlabeled.to_tokens-650"><span class="linenos">650</span></a>							<span class="o">*</span><span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-651"><a href="#TargetTokenizers.Unlabeled.to_tokens-651"><span class="linenos">651</span></a>							<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-652"><a href="#TargetTokenizers.Unlabeled.to_tokens-652"><span class="linenos">652</span></a>								<span class="p">[</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_POST</span><span class="p">],</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-653"><a href="#TargetTokenizers.Unlabeled.to_tokens-653"><span class="linenos">653</span></a>								<span class="bp">self</span><span class="p">,</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-654"><a href="#TargetTokenizers.Unlabeled.to_tokens-654"><span class="linenos">654</span></a>								<span class="s2">&quot;post&quot;</span><span class="p">,</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-655"><a href="#TargetTokenizers.Unlabeled.to_tokens-655"><span class="linenos">655</span></a>							<span class="p">),</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-656"><a href="#TargetTokenizers.Unlabeled.to_tokens-656"><span class="linenos">656</span></a>						<span class="p">]</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-657"><a href="#TargetTokenizers.Unlabeled.to_tokens-657"><span class="linenos">657</span></a>						<span class="k">for</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">targets</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-658"><a href="#TargetTokenizers.Unlabeled.to_tokens-658"><span class="linenos">658</span></a>					<span class="p">],</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-659"><a href="#TargetTokenizers.Unlabeled.to_tokens-659"><span class="linenos">659</span></a>				<span class="p">),</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-660"><a href="#TargetTokenizers.Unlabeled.to_tokens-660"><span class="linenos">660</span></a>			<span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns tokens representing the target.</p>
</div>


                            </div>
                            <div id="TargetTokenizers.Unlabeled.is_valid" class="classattr">
                                        <input id="TargetTokenizers.Unlabeled.is_valid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_valid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="TargetTokenizers.Unlabeled.is_valid-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L662-L664" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#TargetTokenizers.Unlabeled.is_valid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TargetTokenizers.Unlabeled.is_valid-663"><a href="#TargetTokenizers.Unlabeled.is_valid-663"><span class="linenos">663</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># noqa: D102</span>
</span><span id="TargetTokenizers.Unlabeled.is_valid-664"><a href="#TargetTokenizers.Unlabeled.is_valid-664"><span class="linenos">664</span></a>			<span class="c1"># No invalid instances possible within data member type hint bounds</span>
</span><span id="TargetTokenizers.Unlabeled.is_valid-665"><a href="#TargetTokenizers.Unlabeled.is_valid-665"><span class="linenos">665</span></a>			<span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Returns if <code>self</code> contains data members capable of producing an overall valid <code>MazeTokenizerModular</code>.</p>

<p>Some <code>_TokenizerElement</code> instances may be created which are not useful despite obeying data member type hints.
<code><a href="#TargetTokenizers.Unlabeled.is_valid">is_valid</a></code> allows for more precise detection of invalid <code>_TokenizerElement</code>s beyond type hinting alone.
If type hints are sufficient to constrain the possible instances of some subclass, then this method may simply <code>return True</code> for that subclass.</p>

<h1 id="types-of-invalidity">Types of Invalidity</h1>

<p>In nontrivial implementations of this method, each conditional clause should contain a comment classifying the reason for invalidity and one of the types below.
Invalidity types, in ascending order of invalidity:</p>

<ul>
<li>Uninteresting: These tokenizers might be used to train functional models, but the schemes are not interesting to study.
E.g., <code>_TokenizerElement</code>s which are strictly worse than some alternative.</li>
<li>Duplicate: These tokenizers have identical tokenization behavior as some other valid tokenizers.</li>
<li>Untrainable: Training functional models using these tokenizers would be (nearly) impossible.</li>
<li>Erroneous: These tokenizers might raise exceptions during use.</li>
</ul>

<h1 id="development">Development</h1>

<p><code>is_invalid</code> is implemented to always return <code>True</code> in some abstract classes where all currently possible subclass instances are valid.
When adding new subclasses or data members, the developer should check if any such blanket statement of validity still holds and update it as neccesary.</p>

<h2 id="nesting">Nesting</h2>

<p>In general, when implementing this method, there is no need to recursively call <code><a href="#TargetTokenizers.Unlabeled.is_valid">is_valid</a></code> on nested <code>_TokenizerElement</code>s contained in the class.
In other words, failures of <code><a href="#TargetTokenizers.Unlabeled.is_valid">is_valid</a></code> need not bubble up to the top of the nested <code>_TokenizerElement</code> tree.
<code>MazeTokenizerModular.is_valid</code> calls <code><a href="#TargetTokenizers.Unlabeled.is_valid">is_valid</a></code> on each of its <code>_TokenizerElement</code>s individually, so failure at any level will be detected.</p>

<h2 id="types-of-invalidity-2">Types of Invalidity</h2>

<p>If it's judged to be useful, the types of invalidity could be implemented with an Enum or similar rather than only living in comments.
This could be used to create more or less stringent filters on the valid <code>_TokenizerElement</code> instances.</p>
</div>


                            </div>
                            <div id="TargetTokenizers.Unlabeled.serialize" class="classattr">
                                        <input id="TargetTokenizers.Unlabeled.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="TargetTokenizers.Unlabeled.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L713-L769" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#TargetTokenizers.Unlabeled.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TargetTokenizers.Unlabeled.serialize-714"><a href="#TargetTokenizers.Unlabeled.serialize-714"><span class="linenos">714</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-715"><a href="#TargetTokenizers.Unlabeled.serialize-715"><span class="linenos">715</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-716"><a href="#TargetTokenizers.Unlabeled.serialize-716"><span class="linenos">716</span></a>                <span class="n">_FORMAT_KEY</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-717"><a href="#TargetTokenizers.Unlabeled.serialize-717"><span class="linenos">717</span></a>            <span class="p">}</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-718"><a href="#TargetTokenizers.Unlabeled.serialize-718"><span class="linenos">718</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-719"><a href="#TargetTokenizers.Unlabeled.serialize-719"><span class="linenos">719</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-720"><a href="#TargetTokenizers.Unlabeled.serialize-720"><span class="linenos">720</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-721"><a href="#TargetTokenizers.Unlabeled.serialize-721"><span class="linenos">721</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-722"><a href="#TargetTokenizers.Unlabeled.serialize-722"><span class="linenos">722</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-723"><a href="#TargetTokenizers.Unlabeled.serialize-723"><span class="linenos">723</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-724"><a href="#TargetTokenizers.Unlabeled.serialize-724"><span class="linenos">724</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-725"><a href="#TargetTokenizers.Unlabeled.serialize-725"><span class="linenos">725</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-726"><a href="#TargetTokenizers.Unlabeled.serialize-726"><span class="linenos">726</span></a>                    <span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-727"><a href="#TargetTokenizers.Unlabeled.serialize-727"><span class="linenos">727</span></a>
</span><span id="TargetTokenizers.Unlabeled.serialize-728"><a href="#TargetTokenizers.Unlabeled.serialize-728"><span class="linenos">728</span></a>                <span class="c1"># try to save it</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-729"><a href="#TargetTokenizers.Unlabeled.serialize-729"><span class="linenos">729</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-730"><a href="#TargetTokenizers.Unlabeled.serialize-730"><span class="linenos">730</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-731"><a href="#TargetTokenizers.Unlabeled.serialize-731"><span class="linenos">731</span></a>                        <span class="c1"># get the val</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-732"><a href="#TargetTokenizers.Unlabeled.serialize-732"><span class="linenos">732</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-733"><a href="#TargetTokenizers.Unlabeled.serialize-733"><span class="linenos">733</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-734"><a href="#TargetTokenizers.Unlabeled.serialize-734"><span class="linenos">734</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-735"><a href="#TargetTokenizers.Unlabeled.serialize-735"><span class="linenos">735</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-736"><a href="#TargetTokenizers.Unlabeled.serialize-736"><span class="linenos">736</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-737"><a href="#TargetTokenizers.Unlabeled.serialize-737"><span class="linenos">737</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-738"><a href="#TargetTokenizers.Unlabeled.serialize-738"><span class="linenos">738</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-739"><a href="#TargetTokenizers.Unlabeled.serialize-739"><span class="linenos">739</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-740"><a href="#TargetTokenizers.Unlabeled.serialize-740"><span class="linenos">740</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-741"><a href="#TargetTokenizers.Unlabeled.serialize-741"><span class="linenos">741</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-742"><a href="#TargetTokenizers.Unlabeled.serialize-742"><span class="linenos">742</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-743"><a href="#TargetTokenizers.Unlabeled.serialize-743"><span class="linenos">743</span></a>
</span><span id="TargetTokenizers.Unlabeled.serialize-744"><a href="#TargetTokenizers.Unlabeled.serialize-744"><span class="linenos">744</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-745"><a href="#TargetTokenizers.Unlabeled.serialize-745"><span class="linenos">745</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-746"><a href="#TargetTokenizers.Unlabeled.serialize-746"><span class="linenos">746</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-747"><a href="#TargetTokenizers.Unlabeled.serialize-747"><span class="linenos">747</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-748"><a href="#TargetTokenizers.Unlabeled.serialize-748"><span class="linenos">748</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-749"><a href="#TargetTokenizers.Unlabeled.serialize-749"><span class="linenos">749</span></a>                                <span class="p">[</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-750"><a href="#TargetTokenizers.Unlabeled.serialize-750"><span class="linenos">750</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-751"><a href="#TargetTokenizers.Unlabeled.serialize-751"><span class="linenos">751</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-752"><a href="#TargetTokenizers.Unlabeled.serialize-752"><span class="linenos">752</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-753"><a href="#TargetTokenizers.Unlabeled.serialize-753"><span class="linenos">753</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-754"><a href="#TargetTokenizers.Unlabeled.serialize-754"><span class="linenos">754</span></a>                                <span class="p">]</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-755"><a href="#TargetTokenizers.Unlabeled.serialize-755"><span class="linenos">755</span></a>                            <span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-756"><a href="#TargetTokenizers.Unlabeled.serialize-756"><span class="linenos">756</span></a>                        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-757"><a href="#TargetTokenizers.Unlabeled.serialize-757"><span class="linenos">757</span></a>
</span><span id="TargetTokenizers.Unlabeled.serialize-758"><a href="#TargetTokenizers.Unlabeled.serialize-758"><span class="linenos">758</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-759"><a href="#TargetTokenizers.Unlabeled.serialize-759"><span class="linenos">759</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-760"><a href="#TargetTokenizers.Unlabeled.serialize-760"><span class="linenos">760</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-761"><a href="#TargetTokenizers.Unlabeled.serialize-761"><span class="linenos">761</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-762"><a href="#TargetTokenizers.Unlabeled.serialize-762"><span class="linenos">762</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-763"><a href="#TargetTokenizers.Unlabeled.serialize-763"><span class="linenos">763</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-764"><a href="#TargetTokenizers.Unlabeled.serialize-764"><span class="linenos">764</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-765"><a href="#TargetTokenizers.Unlabeled.serialize-765"><span class="linenos">765</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-766"><a href="#TargetTokenizers.Unlabeled.serialize-766"><span class="linenos">766</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-767"><a href="#TargetTokenizers.Unlabeled.serialize-767"><span class="linenos">767</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-768"><a href="#TargetTokenizers.Unlabeled.serialize-768"><span class="linenos">768</span></a>                    <span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-769"><a href="#TargetTokenizers.Unlabeled.serialize-769"><span class="linenos">769</span></a>
</span><span id="TargetTokenizers.Unlabeled.serialize-770"><a href="#TargetTokenizers.Unlabeled.serialize-770"><span class="linenos">770</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="TargetTokenizers.Unlabeled.load" class="classattr">
                                        <input id="TargetTokenizers.Unlabeled.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="TargetTokenizers.Unlabeled.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L776-L862" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#TargetTokenizers.Unlabeled.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TargetTokenizers.Unlabeled.load-777"><a href="#TargetTokenizers.Unlabeled.load-777"><span class="linenos">777</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="TargetTokenizers.Unlabeled.load-778"><a href="#TargetTokenizers.Unlabeled.load-778"><span class="linenos">778</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="TargetTokenizers.Unlabeled.load-779"><a href="#TargetTokenizers.Unlabeled.load-779"><span class="linenos">779</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="TargetTokenizers.Unlabeled.load-780"><a href="#TargetTokenizers.Unlabeled.load-780"><span class="linenos">780</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="TargetTokenizers.Unlabeled.load-781"><a href="#TargetTokenizers.Unlabeled.load-781"><span class="linenos">781</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="TargetTokenizers.Unlabeled.load-782"><a href="#TargetTokenizers.Unlabeled.load-782"><span class="linenos">782</span></a>
</span><span id="TargetTokenizers.Unlabeled.load-783"><a href="#TargetTokenizers.Unlabeled.load-783"><span class="linenos">783</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.load-784"><a href="#TargetTokenizers.Unlabeled.load-784"><span class="linenos">784</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="TargetTokenizers.Unlabeled.load-785"><a href="#TargetTokenizers.Unlabeled.load-785"><span class="linenos">785</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="TargetTokenizers.Unlabeled.load-786"><a href="#TargetTokenizers.Unlabeled.load-786"><span class="linenos">786</span></a>
</span><span id="TargetTokenizers.Unlabeled.load-787"><a href="#TargetTokenizers.Unlabeled.load-787"><span class="linenos">787</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.load-788"><a href="#TargetTokenizers.Unlabeled.load-788"><span class="linenos">788</span></a>
</span><span id="TargetTokenizers.Unlabeled.load-789"><a href="#TargetTokenizers.Unlabeled.load-789"><span class="linenos">789</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="TargetTokenizers.Unlabeled.load-790"><a href="#TargetTokenizers.Unlabeled.load-790"><span class="linenos">790</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="TargetTokenizers.Unlabeled.load-791"><a href="#TargetTokenizers.Unlabeled.load-791"><span class="linenos">791</span></a>
</span><span id="TargetTokenizers.Unlabeled.load-792"><a href="#TargetTokenizers.Unlabeled.load-792"><span class="linenos">792</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="TargetTokenizers.Unlabeled.load-793"><a href="#TargetTokenizers.Unlabeled.load-793"><span class="linenos">793</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="TargetTokenizers.Unlabeled.load-794"><a href="#TargetTokenizers.Unlabeled.load-794"><span class="linenos">794</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="TargetTokenizers.Unlabeled.load-795"><a href="#TargetTokenizers.Unlabeled.load-795"><span class="linenos">795</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.load-796"><a href="#TargetTokenizers.Unlabeled.load-796"><span class="linenos">796</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="TargetTokenizers.Unlabeled.load-797"><a href="#TargetTokenizers.Unlabeled.load-797"><span class="linenos">797</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="TargetTokenizers.Unlabeled.load-798"><a href="#TargetTokenizers.Unlabeled.load-798"><span class="linenos">798</span></a>
</span><span id="TargetTokenizers.Unlabeled.load-799"><a href="#TargetTokenizers.Unlabeled.load-799"><span class="linenos">799</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="TargetTokenizers.Unlabeled.load-800"><a href="#TargetTokenizers.Unlabeled.load-800"><span class="linenos">800</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="TargetTokenizers.Unlabeled.load-801"><a href="#TargetTokenizers.Unlabeled.load-801"><span class="linenos">801</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="TargetTokenizers.Unlabeled.load-802"><a href="#TargetTokenizers.Unlabeled.load-802"><span class="linenos">802</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="TargetTokenizers.Unlabeled.load-803"><a href="#TargetTokenizers.Unlabeled.load-803"><span class="linenos">803</span></a>
</span><span id="TargetTokenizers.Unlabeled.load-804"><a href="#TargetTokenizers.Unlabeled.load-804"><span class="linenos">804</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="TargetTokenizers.Unlabeled.load-805"><a href="#TargetTokenizers.Unlabeled.load-805"><span class="linenos">805</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.load-806"><a href="#TargetTokenizers.Unlabeled.load-806"><span class="linenos">806</span></a>
</span><span id="TargetTokenizers.Unlabeled.load-807"><a href="#TargetTokenizers.Unlabeled.load-807"><span class="linenos">807</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="TargetTokenizers.Unlabeled.load-808"><a href="#TargetTokenizers.Unlabeled.load-808"><span class="linenos">808</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="TargetTokenizers.Unlabeled.load-809"><a href="#TargetTokenizers.Unlabeled.load-809"><span class="linenos">809</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="TargetTokenizers.Unlabeled.load-810"><a href="#TargetTokenizers.Unlabeled.load-810"><span class="linenos">810</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.load-811"><a href="#TargetTokenizers.Unlabeled.load-811"><span class="linenos">811</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="TargetTokenizers.Unlabeled.load-812"><a href="#TargetTokenizers.Unlabeled.load-812"><span class="linenos">812</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="TargetTokenizers.Unlabeled.load-813"><a href="#TargetTokenizers.Unlabeled.load-813"><span class="linenos">813</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.load-814"><a href="#TargetTokenizers.Unlabeled.load-814"><span class="linenos">814</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.load-815"><a href="#TargetTokenizers.Unlabeled.load-815"><span class="linenos">815</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="TargetTokenizers.Unlabeled.load-816"><a href="#TargetTokenizers.Unlabeled.load-816"><span class="linenos">816</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.load-817"><a href="#TargetTokenizers.Unlabeled.load-817"><span class="linenos">817</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.load-818"><a href="#TargetTokenizers.Unlabeled.load-818"><span class="linenos">818</span></a>                    <span class="p">):</span>
</span><span id="TargetTokenizers.Unlabeled.load-819"><a href="#TargetTokenizers.Unlabeled.load-819"><span class="linenos">819</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="TargetTokenizers.Unlabeled.load-820"><a href="#TargetTokenizers.Unlabeled.load-820"><span class="linenos">820</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="TargetTokenizers.Unlabeled.load-821"><a href="#TargetTokenizers.Unlabeled.load-821"><span class="linenos">821</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.load-822"><a href="#TargetTokenizers.Unlabeled.load-822"><span class="linenos">822</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="TargetTokenizers.Unlabeled.load-823"><a href="#TargetTokenizers.Unlabeled.load-823"><span class="linenos">823</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.load-824"><a href="#TargetTokenizers.Unlabeled.load-824"><span class="linenos">824</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="TargetTokenizers.Unlabeled.load-825"><a href="#TargetTokenizers.Unlabeled.load-825"><span class="linenos">825</span></a>                            <span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.load-826"><a href="#TargetTokenizers.Unlabeled.load-826"><span class="linenos">826</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="TargetTokenizers.Unlabeled.load-827"><a href="#TargetTokenizers.Unlabeled.load-827"><span class="linenos">827</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="TargetTokenizers.Unlabeled.load-828"><a href="#TargetTokenizers.Unlabeled.load-828"><span class="linenos">828</span></a>                        <span class="k">pass</span>
</span><span id="TargetTokenizers.Unlabeled.load-829"><a href="#TargetTokenizers.Unlabeled.load-829"><span class="linenos">829</span></a>
</span><span id="TargetTokenizers.Unlabeled.load-830"><a href="#TargetTokenizers.Unlabeled.load-830"><span class="linenos">830</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="TargetTokenizers.Unlabeled.load-831"><a href="#TargetTokenizers.Unlabeled.load-831"><span class="linenos">831</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="TargetTokenizers.Unlabeled.load-832"><a href="#TargetTokenizers.Unlabeled.load-832"><span class="linenos">832</span></a>
</span><span id="TargetTokenizers.Unlabeled.load-833"><a href="#TargetTokenizers.Unlabeled.load-833"><span class="linenos">833</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="TargetTokenizers.Unlabeled.load-834"><a href="#TargetTokenizers.Unlabeled.load-834"><span class="linenos">834</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.load-835"><a href="#TargetTokenizers.Unlabeled.load-835"><span class="linenos">835</span></a>
</span><span id="TargetTokenizers.Unlabeled.load-836"><a href="#TargetTokenizers.Unlabeled.load-836"><span class="linenos">836</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="TargetTokenizers.Unlabeled.load-837"><a href="#TargetTokenizers.Unlabeled.load-837"><span class="linenos">837</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="TargetTokenizers.Unlabeled.load-838"><a href="#TargetTokenizers.Unlabeled.load-838"><span class="linenos">838</span></a>                <span class="n">fields_valid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.load-839"><a href="#TargetTokenizers.Unlabeled.load-839"><span class="linenos">839</span></a>                    <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.load-840"><a href="#TargetTokenizers.Unlabeled.load-840"><span class="linenos">840</span></a>                        <span class="n">output</span><span class="p">,</span>
</span><span id="TargetTokenizers.Unlabeled.load-841"><a href="#TargetTokenizers.Unlabeled.load-841"><span class="linenos">841</span></a>                        <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">,</span>
</span><span id="TargetTokenizers.Unlabeled.load-842"><a href="#TargetTokenizers.Unlabeled.load-842"><span class="linenos">842</span></a>                    <span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.load-843"><a href="#TargetTokenizers.Unlabeled.load-843"><span class="linenos">843</span></a>                <span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.load-844"><a href="#TargetTokenizers.Unlabeled.load-844"><span class="linenos">844</span></a>
</span><span id="TargetTokenizers.Unlabeled.load-845"><a href="#TargetTokenizers.Unlabeled.load-845"><span class="linenos">845</span></a>                <span class="c1"># if there are any fields that are not valid, raise an error</span>
</span><span id="TargetTokenizers.Unlabeled.load-846"><a href="#TargetTokenizers.Unlabeled.load-846"><span class="linenos">846</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">fields_valid</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="TargetTokenizers.Unlabeled.load-847"><a href="#TargetTokenizers.Unlabeled.load-847"><span class="linenos">847</span></a>                    <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.load-848"><a href="#TargetTokenizers.Unlabeled.load-848"><span class="linenos">848</span></a>                        <span class="sa">f</span><span class="s2">&quot;Type mismatch in fields of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="TargetTokenizers.Unlabeled.load-849"><a href="#TargetTokenizers.Unlabeled.load-849"><span class="linenos">849</span></a>                        <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.load-850"><a href="#TargetTokenizers.Unlabeled.load-850"><span class="linenos">850</span></a>                            <span class="p">[</span>
</span><span id="TargetTokenizers.Unlabeled.load-851"><a href="#TargetTokenizers.Unlabeled.load-851"><span class="linenos">851</span></a>                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">:</span><span class="se">\t</span><span class="s2">expected </span><span class="si">{</span><span class="n">cls_type_hints</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="si">= }</span><span class="s2">, but got value </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="TargetTokenizers.Unlabeled.load-852"><a href="#TargetTokenizers.Unlabeled.load-852"><span class="linenos">852</span></a>                                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">fields_valid</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="TargetTokenizers.Unlabeled.load-853"><a href="#TargetTokenizers.Unlabeled.load-853"><span class="linenos">853</span></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span>
</span><span id="TargetTokenizers.Unlabeled.load-854"><a href="#TargetTokenizers.Unlabeled.load-854"><span class="linenos">854</span></a>                            <span class="p">]</span>
</span><span id="TargetTokenizers.Unlabeled.load-855"><a href="#TargetTokenizers.Unlabeled.load-855"><span class="linenos">855</span></a>                        <span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.load-856"><a href="#TargetTokenizers.Unlabeled.load-856"><span class="linenos">856</span></a>                    <span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.load-857"><a href="#TargetTokenizers.Unlabeled.load-857"><span class="linenos">857</span></a>
</span><span id="TargetTokenizers.Unlabeled.load-858"><a href="#TargetTokenizers.Unlabeled.load-858"><span class="linenos">858</span></a>                    <span class="n">on_typecheck_mismatch</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.load-859"><a href="#TargetTokenizers.Unlabeled.load-859"><span class="linenos">859</span></a>                        <span class="n">msg</span><span class="p">,</span> <span class="n">except_cls</span><span class="o">=</span><span class="n">FieldTypeMismatchError</span>
</span><span id="TargetTokenizers.Unlabeled.load-860"><a href="#TargetTokenizers.Unlabeled.load-860"><span class="linenos">860</span></a>                    <span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.load-861"><a href="#TargetTokenizers.Unlabeled.load-861"><span class="linenos">861</span></a>
</span><span id="TargetTokenizers.Unlabeled.load-862"><a href="#TargetTokenizers.Unlabeled.load-862"><span class="linenos">862</span></a>            <span class="c1"># return the new instance</span>
</span><span id="TargetTokenizers.Unlabeled.load-863"><a href="#TargetTokenizers.Unlabeled.load-863"><span class="linenos">863</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="TargetTokenizers.Unlabeled.validate_fields_types" class="classattr">
                                        <input id="TargetTokenizers.Unlabeled.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="TargetTokenizers.Unlabeled.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L282-L291" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#TargetTokenizers.Unlabeled.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TargetTokenizers.Unlabeled.validate_fields_types-283"><a href="#TargetTokenizers.Unlabeled.validate_fields_types-283"><span class="linenos">283</span></a><span class="k">def</span><span class="w"> </span><span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.validate_fields_types-284"><a href="#TargetTokenizers.Unlabeled.validate_fields_types-284"><span class="linenos">284</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="TargetTokenizers.Unlabeled.validate_fields_types-285"><a href="#TargetTokenizers.Unlabeled.validate_fields_types-285"><span class="linenos">285</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="TargetTokenizers.Unlabeled.validate_fields_types-286"><a href="#TargetTokenizers.Unlabeled.validate_fields_types-286"><span class="linenos">286</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="TargetTokenizers.Unlabeled.validate_fields_types-287"><a href="#TargetTokenizers.Unlabeled.validate_fields_types-287"><span class="linenos">287</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="TargetTokenizers.Unlabeled.validate_fields_types-288"><a href="#TargetTokenizers.Unlabeled.validate_fields_types-288"><span class="linenos">288</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.validate_fields_types-289"><a href="#TargetTokenizers.Unlabeled.validate_fields_types-289"><span class="linenos">289</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.validate_fields_types-290"><a href="#TargetTokenizers.Unlabeled.validate_fields_types-290"><span class="linenos">290</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="TargetTokenizers.Unlabeled.validate_fields_types-291"><a href="#TargetTokenizers.Unlabeled.validate_fields_types-291"><span class="linenos">291</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="TargetTokenizers.Unlabeled.validate_fields_types-292"><a href="#TargetTokenizers.Unlabeled.validate_fields_types-292"><span class="linenos">292</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#TargetTokenizers._TargetTokenizer">TargetTokenizers._TargetTokenizer</a></dt>
                                <dd id="TargetTokenizers.Unlabeled.attribute_key" class="function"><a href="#TargetTokenizers._TargetTokenizer.attribute_key">attribute_key</a></dd>

            </div>
            <div><dt><a href="element_base.html#_TokenizerElement">maze_dataset.tokenization.modular.element_base._TokenizerElement</a></dt>
                                <dd id="TargetTokenizers.Unlabeled.name" class="variable"><a href="element_base.html#_TokenizerElement.name">name</a></dd>
                <dd id="TargetTokenizers.Unlabeled.tokenizer_elements" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="TargetTokenizers.Unlabeled.tokenizer_element_tree" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="TargetTokenizers.Unlabeled.tokenizer_element_dict" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="TargetTokenizers.Unlabeled.validate_field_type" class="function">validate_field_type</dd>
                <dd id="TargetTokenizers.Unlabeled.diff" class="function">diff</dd>
                <dd id="TargetTokenizers.Unlabeled.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="StepSizes">
                            <input id="StepSizes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">StepSizes</span><wbr>(<span class="base"><a href="element_base.html#__TokenizerElementNamespace">maze_dataset.tokenization.modular.element_base.__TokenizerElementNamespace</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L667-L762" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes-668"><a href="#StepSizes-668"><span class="linenos">668</span></a><span class="k">class</span><span class="w"> </span><span class="nc">StepSizes</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="StepSizes-669"><a href="#StepSizes-669"><span class="linenos">669</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Namespace for `_StepSize` subclass hierarchy used by `MazeTokenizerModular`.&quot;&quot;&quot;</span>
</span><span id="StepSizes-670"><a href="#StepSizes-670"><span class="linenos">670</span></a>
</span><span id="StepSizes-671"><a href="#StepSizes-671"><span class="linenos">671</span></a>	<span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;step_size&quot;</span>
</span><span id="StepSizes-672"><a href="#StepSizes-672"><span class="linenos">672</span></a>
</span><span id="StepSizes-673"><a href="#StepSizes-673"><span class="linenos">673</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepSizes-674"><a href="#StepSizes-674"><span class="linenos">674</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">_StepSize</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="StepSizes-675"><a href="#StepSizes-675"><span class="linenos">675</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Specifies which coords in `maze.solution` are used to represent the path.&quot;&quot;&quot;</span>
</span><span id="StepSizes-676"><a href="#StepSizes-676"><span class="linenos">676</span></a>
</span><span id="StepSizes-677"><a href="#StepSizes-677"><span class="linenos">677</span></a>		<span class="nd">@classmethod</span>
</span><span id="StepSizes-678"><a href="#StepSizes-678"><span class="linenos">678</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="StepSizes-679"><a href="#StepSizes-679"><span class="linenos">679</span></a>			<span class="k">return</span> <span class="n">StepSizes</span><span class="o">.</span><span class="n">key</span>
</span><span id="StepSizes-680"><a href="#StepSizes-680"><span class="linenos">680</span></a>
</span><span id="StepSizes-681"><a href="#StepSizes-681"><span class="linenos">681</span></a>		<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>  <span class="c1"># TODO: make this a static/class method, allowing ForksAndStraightaways to skip object construction at every call</span>
</span><span id="StepSizes-682"><a href="#StepSizes-682"><span class="linenos">682</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_step_single_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="StepSizes-683"><a href="#StepSizes-683"><span class="linenos">683</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns the indices of `maze.solution` corresponding to the steps to be tokenized.&quot;&quot;&quot;</span>
</span><span id="StepSizes-684"><a href="#StepSizes-684"><span class="linenos">684</span></a>			<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="StepSizes-685"><a href="#StepSizes-685"><span class="linenos">685</span></a>				<span class="s2">&quot;Subclasses must implement `StepSize.step_indices.&quot;</span><span class="p">,</span>
</span><span id="StepSizes-686"><a href="#StepSizes-686"><span class="linenos">686</span></a>			<span class="p">)</span>
</span><span id="StepSizes-687"><a href="#StepSizes-687"><span class="linenos">687</span></a>
</span><span id="StepSizes-688"><a href="#StepSizes-688"><span class="linenos">688</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">step_start_end_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
</span><span id="StepSizes-689"><a href="#StepSizes-689"><span class="linenos">689</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns steps as tuples of starting and ending positions for each step.&quot;&quot;&quot;</span>
</span><span id="StepSizes-690"><a href="#StepSizes-690"><span class="linenos">690</span></a>			<span class="n">indices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_step_single_indices</span><span class="p">(</span><span class="n">maze</span><span class="p">)</span>
</span><span id="StepSizes-691"><a href="#StepSizes-691"><span class="linenos">691</span></a>			<span class="c1"># TODO: RUF007 Prefer `itertools.pairwise()` over `zip()` when iterating over successive pairs</span>
</span><span id="StepSizes-692"><a href="#StepSizes-692"><span class="linenos">692</span></a>			<span class="k">return</span> <span class="p">[</span>
</span><span id="StepSizes-693"><a href="#StepSizes-693"><span class="linenos">693</span></a>				<span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
</span><span id="StepSizes-694"><a href="#StepSizes-694"><span class="linenos">694</span></a>				<span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">indices</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">indices</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># noqa: RUF007</span>
</span><span id="StepSizes-695"><a href="#StepSizes-695"><span class="linenos">695</span></a>			<span class="p">]</span>
</span><span id="StepSizes-696"><a href="#StepSizes-696"><span class="linenos">696</span></a>
</span><span id="StepSizes-697"><a href="#StepSizes-697"><span class="linenos">697</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="StepSizes-698"><a href="#StepSizes-698"><span class="linenos">698</span></a>			<span class="c1"># No invalid instances possible within data member type hint bounds</span>
</span><span id="StepSizes-699"><a href="#StepSizes-699"><span class="linenos">699</span></a>			<span class="k">return</span> <span class="kc">True</span>
</span><span id="StepSizes-700"><a href="#StepSizes-700"><span class="linenos">700</span></a>
</span><span id="StepSizes-701"><a href="#StepSizes-701"><span class="linenos">701</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepSizes-702"><a href="#StepSizes-702"><span class="linenos">702</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">Singles</span><span class="p">(</span><span class="n">_StepSize</span><span class="p">):</span>
</span><span id="StepSizes-703"><a href="#StepSizes-703"><span class="linenos">703</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Every coord in `maze.solution` is represented.</span>
</span><span id="StepSizes-704"><a href="#StepSizes-704"><span class="linenos">704</span></a>
</span><span id="StepSizes-705"><a href="#StepSizes-705"><span class="linenos">705</span></a><span class="sd">		Legacy tokenizers all use this behavior.</span>
</span><span id="StepSizes-706"><a href="#StepSizes-706"><span class="linenos">706</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="StepSizes-707"><a href="#StepSizes-707"><span class="linenos">707</span></a>
</span><span id="StepSizes-708"><a href="#StepSizes-708"><span class="linenos">708</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_step_single_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="StepSizes-709"><a href="#StepSizes-709"><span class="linenos">709</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns the indices of `maze.solution` corresponding to the steps to be tokenized.&quot;&quot;&quot;</span>
</span><span id="StepSizes-710"><a href="#StepSizes-710"><span class="linenos">710</span></a>			<span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span><span id="StepSizes-711"><a href="#StepSizes-711"><span class="linenos">711</span></a>
</span><span id="StepSizes-712"><a href="#StepSizes-712"><span class="linenos">712</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepSizes-713"><a href="#StepSizes-713"><span class="linenos">713</span></a>	<span class="nd">@mark_as_unsupported</span><span class="p">(</span><span class="n">_unsupported_is_invalid</span><span class="p">)</span>
</span><span id="StepSizes-714"><a href="#StepSizes-714"><span class="linenos">714</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">Straightaways</span><span class="p">(</span><span class="n">_StepSize</span><span class="p">):</span>
</span><span id="StepSizes-715"><a href="#StepSizes-715"><span class="linenos">715</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Only coords where the path turns are represented in the path.</span>
</span><span id="StepSizes-716"><a href="#StepSizes-716"><span class="linenos">716</span></a>
</span><span id="StepSizes-717"><a href="#StepSizes-717"><span class="linenos">717</span></a><span class="sd">		I.e., the path is represented as a sequence of straightaways,</span>
</span><span id="StepSizes-718"><a href="#StepSizes-718"><span class="linenos">718</span></a><span class="sd">		specified by the coords at the turns.</span>
</span><span id="StepSizes-719"><a href="#StepSizes-719"><span class="linenos">719</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="StepSizes-720"><a href="#StepSizes-720"><span class="linenos">720</span></a>
</span><span id="StepSizes-721"><a href="#StepSizes-721"><span class="linenos">721</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_step_single_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="StepSizes-722"><a href="#StepSizes-722"><span class="linenos">722</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns the indices of `maze.solution` corresponding to the steps to be tokenized.&quot;&quot;&quot;</span>
</span><span id="StepSizes-723"><a href="#StepSizes-723"><span class="linenos">723</span></a>			<span class="n">last_turn_coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span><span id="StepSizes-724"><a href="#StepSizes-724"><span class="linenos">724</span></a>			<span class="n">indices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="StepSizes-725"><a href="#StepSizes-725"><span class="linenos">725</span></a>			<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">coord</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">):</span>
</span><span id="StepSizes-726"><a href="#StepSizes-726"><span class="linenos">726</span></a>				<span class="k">if</span> <span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">last_turn_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">last_turn_coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="StepSizes-727"><a href="#StepSizes-727"><span class="linenos">727</span></a>					<span class="n">indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="StepSizes-728"><a href="#StepSizes-728"><span class="linenos">728</span></a>					<span class="n">last_turn_coord</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span><span id="StepSizes-729"><a href="#StepSizes-729"><span class="linenos">729</span></a>			<span class="n">indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="StepSizes-730"><a href="#StepSizes-730"><span class="linenos">730</span></a>			<span class="k">return</span> <span class="n">indices</span>
</span><span id="StepSizes-731"><a href="#StepSizes-731"><span class="linenos">731</span></a>
</span><span id="StepSizes-732"><a href="#StepSizes-732"><span class="linenos">732</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepSizes-733"><a href="#StepSizes-733"><span class="linenos">733</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">Forks</span><span class="p">(</span><span class="n">_StepSize</span><span class="p">):</span>
</span><span id="StepSizes-734"><a href="#StepSizes-734"><span class="linenos">734</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Only coords at forks, where the path has &gt;=2 options for the next step are included.</span>
</span><span id="StepSizes-735"><a href="#StepSizes-735"><span class="linenos">735</span></a>
</span><span id="StepSizes-736"><a href="#StepSizes-736"><span class="linenos">736</span></a><span class="sd">		Excludes the option of backtracking.</span>
</span><span id="StepSizes-737"><a href="#StepSizes-737"><span class="linenos">737</span></a><span class="sd">		The starting and ending coords are always included.</span>
</span><span id="StepSizes-738"><a href="#StepSizes-738"><span class="linenos">738</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="StepSizes-739"><a href="#StepSizes-739"><span class="linenos">739</span></a>
</span><span id="StepSizes-740"><a href="#StepSizes-740"><span class="linenos">740</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_step_single_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="StepSizes-741"><a href="#StepSizes-741"><span class="linenos">741</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns the indices of `maze.solution` corresponding to the steps to be tokenized.&quot;&quot;&quot;</span>
</span><span id="StepSizes-742"><a href="#StepSizes-742"><span class="linenos">742</span></a>			<span class="k">return</span> <span class="n">maze</span><span class="o">.</span><span class="n">get_solution_forking_points</span><span class="p">(</span><span class="n">always_include_endpoints</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="StepSizes-743"><a href="#StepSizes-743"><span class="linenos">743</span></a>
</span><span id="StepSizes-744"><a href="#StepSizes-744"><span class="linenos">744</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepSizes-745"><a href="#StepSizes-745"><span class="linenos">745</span></a>	<span class="nd">@mark_as_unsupported</span><span class="p">(</span><span class="n">_unsupported_is_invalid</span><span class="p">)</span>
</span><span id="StepSizes-746"><a href="#StepSizes-746"><span class="linenos">746</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">ForksAndStraightaways</span><span class="p">(</span><span class="n">_StepSize</span><span class="p">):</span>
</span><span id="StepSizes-747"><a href="#StepSizes-747"><span class="linenos">747</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Includes the union of the coords included by `Forks` and `Straightaways`.</span>
</span><span id="StepSizes-748"><a href="#StepSizes-748"><span class="linenos">748</span></a>
</span><span id="StepSizes-749"><a href="#StepSizes-749"><span class="linenos">749</span></a><span class="sd">		See documentation for those classes for details.</span>
</span><span id="StepSizes-750"><a href="#StepSizes-750"><span class="linenos">750</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="StepSizes-751"><a href="#StepSizes-751"><span class="linenos">751</span></a>
</span><span id="StepSizes-752"><a href="#StepSizes-752"><span class="linenos">752</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_step_single_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="StepSizes-753"><a href="#StepSizes-753"><span class="linenos">753</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns the indices of `maze.solution` corresponding to the steps to be tokenized.&quot;&quot;&quot;</span>
</span><span id="StepSizes-754"><a href="#StepSizes-754"><span class="linenos">754</span></a>			<span class="k">return</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="StepSizes-755"><a href="#StepSizes-755"><span class="linenos">755</span></a>				<span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span>
</span><span id="StepSizes-756"><a href="#StepSizes-756"><span class="linenos">756</span></a>					<span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="StepSizes-757"><a href="#StepSizes-757"><span class="linenos">757</span></a>						<span class="p">(</span>
</span><span id="StepSizes-758"><a href="#StepSizes-758"><span class="linenos">758</span></a>							<span class="n">StepSizes</span><span class="o">.</span><span class="n">Straightaways</span><span class="p">()</span><span class="o">.</span><span class="n">_step_single_indices</span><span class="p">(</span><span class="n">maze</span><span class="p">),</span>
</span><span id="StepSizes-759"><a href="#StepSizes-759"><span class="linenos">759</span></a>							<span class="n">StepSizes</span><span class="o">.</span><span class="n">Forks</span><span class="p">()</span><span class="o">.</span><span class="n">_step_single_indices</span><span class="p">(</span><span class="n">maze</span><span class="p">),</span>
</span><span id="StepSizes-760"><a href="#StepSizes-760"><span class="linenos">760</span></a>						<span class="p">),</span>
</span><span id="StepSizes-761"><a href="#StepSizes-761"><span class="linenos">761</span></a>					<span class="p">),</span>
</span><span id="StepSizes-762"><a href="#StepSizes-762"><span class="linenos">762</span></a>				<span class="p">),</span>
</span><span id="StepSizes-763"><a href="#StepSizes-763"><span class="linenos">763</span></a>			<span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Namespace for <code>_StepSize</code> subclass hierarchy used by <code>MazeTokenizerModular</code>.</p>
</div>


                            <div id="StepSizes.key" class="classattr">
                                <div class="attr variable">
            <span class="name">key</span>        =
<span class="default_value">&#39;step_size&#39;</span>

        
    </div>
    <a class="headerlink" href="#StepSizes.key"></a>
    
    

                            </div>
                </section>
                <section id="StepSizes.Singles">
                            <input id="StepSizes.Singles-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">StepSizes.Singles</span><wbr>(<span class="base"><a href="#StepSizes._StepSize">StepSizes._StepSize</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.Singles-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L700-L709" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.Singles"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.Singles-701"><a href="#StepSizes.Singles-701"><span class="linenos">701</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepSizes.Singles-702"><a href="#StepSizes.Singles-702"><span class="linenos">702</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">Singles</span><span class="p">(</span><span class="n">_StepSize</span><span class="p">):</span>
</span><span id="StepSizes.Singles-703"><a href="#StepSizes.Singles-703"><span class="linenos">703</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Every coord in `maze.solution` is represented.</span>
</span><span id="StepSizes.Singles-704"><a href="#StepSizes.Singles-704"><span class="linenos">704</span></a>
</span><span id="StepSizes.Singles-705"><a href="#StepSizes.Singles-705"><span class="linenos">705</span></a><span class="sd">		Legacy tokenizers all use this behavior.</span>
</span><span id="StepSizes.Singles-706"><a href="#StepSizes.Singles-706"><span class="linenos">706</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="StepSizes.Singles-707"><a href="#StepSizes.Singles-707"><span class="linenos">707</span></a>
</span><span id="StepSizes.Singles-708"><a href="#StepSizes.Singles-708"><span class="linenos">708</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_step_single_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="StepSizes.Singles-709"><a href="#StepSizes.Singles-709"><span class="linenos">709</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns the indices of `maze.solution` corresponding to the steps to be tokenized.&quot;&quot;&quot;</span>
</span><span id="StepSizes.Singles-710"><a href="#StepSizes.Singles-710"><span class="linenos">710</span></a>			<span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span></pre></div>


            <div class="docstring"><p>Every coord in <code>maze.solution</code> is represented.</p>

<p>Legacy tokenizers all use this behavior.</p>
</div>


                            <div id="StepSizes.Singles.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">StepSizes.Singles</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#StepSizes.Singles">StepSizes.Singles</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#StepSizes.Singles">StepSizes.Singles</a>&#39;&gt;&quot;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#StepSizes.Singles.__init__"></a>
    
    

                            </div>
                            <div id="StepSizes.Singles.serialize" class="classattr">
                                        <input id="StepSizes.Singles.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.Singles.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L713-L769" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.Singles.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.Singles.serialize-714"><a href="#StepSizes.Singles.serialize-714"><span class="linenos">714</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="StepSizes.Singles.serialize-715"><a href="#StepSizes.Singles.serialize-715"><span class="linenos">715</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="StepSizes.Singles.serialize-716"><a href="#StepSizes.Singles.serialize-716"><span class="linenos">716</span></a>                <span class="n">_FORMAT_KEY</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="StepSizes.Singles.serialize-717"><a href="#StepSizes.Singles.serialize-717"><span class="linenos">717</span></a>            <span class="p">}</span>
</span><span id="StepSizes.Singles.serialize-718"><a href="#StepSizes.Singles.serialize-718"><span class="linenos">718</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="StepSizes.Singles.serialize-719"><a href="#StepSizes.Singles.serialize-719"><span class="linenos">719</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="StepSizes.Singles.serialize-720"><a href="#StepSizes.Singles.serialize-720"><span class="linenos">720</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="StepSizes.Singles.serialize-721"><a href="#StepSizes.Singles.serialize-721"><span class="linenos">721</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="StepSizes.Singles.serialize-722"><a href="#StepSizes.Singles.serialize-722"><span class="linenos">722</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="StepSizes.Singles.serialize-723"><a href="#StepSizes.Singles.serialize-723"><span class="linenos">723</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="StepSizes.Singles.serialize-724"><a href="#StepSizes.Singles.serialize-724"><span class="linenos">724</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="StepSizes.Singles.serialize-725"><a href="#StepSizes.Singles.serialize-725"><span class="linenos">725</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="StepSizes.Singles.serialize-726"><a href="#StepSizes.Singles.serialize-726"><span class="linenos">726</span></a>                    <span class="p">)</span>
</span><span id="StepSizes.Singles.serialize-727"><a href="#StepSizes.Singles.serialize-727"><span class="linenos">727</span></a>
</span><span id="StepSizes.Singles.serialize-728"><a href="#StepSizes.Singles.serialize-728"><span class="linenos">728</span></a>                <span class="c1"># try to save it</span>
</span><span id="StepSizes.Singles.serialize-729"><a href="#StepSizes.Singles.serialize-729"><span class="linenos">729</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="StepSizes.Singles.serialize-730"><a href="#StepSizes.Singles.serialize-730"><span class="linenos">730</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="StepSizes.Singles.serialize-731"><a href="#StepSizes.Singles.serialize-731"><span class="linenos">731</span></a>                        <span class="c1"># get the val</span>
</span><span id="StepSizes.Singles.serialize-732"><a href="#StepSizes.Singles.serialize-732"><span class="linenos">732</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="StepSizes.Singles.serialize-733"><a href="#StepSizes.Singles.serialize-733"><span class="linenos">733</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="StepSizes.Singles.serialize-734"><a href="#StepSizes.Singles.serialize-734"><span class="linenos">734</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="StepSizes.Singles.serialize-735"><a href="#StepSizes.Singles.serialize-735"><span class="linenos">735</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="StepSizes.Singles.serialize-736"><a href="#StepSizes.Singles.serialize-736"><span class="linenos">736</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="StepSizes.Singles.serialize-737"><a href="#StepSizes.Singles.serialize-737"><span class="linenos">737</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="StepSizes.Singles.serialize-738"><a href="#StepSizes.Singles.serialize-738"><span class="linenos">738</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="StepSizes.Singles.serialize-739"><a href="#StepSizes.Singles.serialize-739"><span class="linenos">739</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="StepSizes.Singles.serialize-740"><a href="#StepSizes.Singles.serialize-740"><span class="linenos">740</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="StepSizes.Singles.serialize-741"><a href="#StepSizes.Singles.serialize-741"><span class="linenos">741</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="StepSizes.Singles.serialize-742"><a href="#StepSizes.Singles.serialize-742"><span class="linenos">742</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepSizes.Singles.serialize-743"><a href="#StepSizes.Singles.serialize-743"><span class="linenos">743</span></a>
</span><span id="StepSizes.Singles.serialize-744"><a href="#StepSizes.Singles.serialize-744"><span class="linenos">744</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="StepSizes.Singles.serialize-745"><a href="#StepSizes.Singles.serialize-745"><span class="linenos">745</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepSizes.Singles.serialize-746"><a href="#StepSizes.Singles.serialize-746"><span class="linenos">746</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="StepSizes.Singles.serialize-747"><a href="#StepSizes.Singles.serialize-747"><span class="linenos">747</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="StepSizes.Singles.serialize-748"><a href="#StepSizes.Singles.serialize-748"><span class="linenos">748</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="StepSizes.Singles.serialize-749"><a href="#StepSizes.Singles.serialize-749"><span class="linenos">749</span></a>                                <span class="p">[</span>
</span><span id="StepSizes.Singles.serialize-750"><a href="#StepSizes.Singles.serialize-750"><span class="linenos">750</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepSizes.Singles.serialize-751"><a href="#StepSizes.Singles.serialize-751"><span class="linenos">751</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepSizes.Singles.serialize-752"><a href="#StepSizes.Singles.serialize-752"><span class="linenos">752</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepSizes.Singles.serialize-753"><a href="#StepSizes.Singles.serialize-753"><span class="linenos">753</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepSizes.Singles.serialize-754"><a href="#StepSizes.Singles.serialize-754"><span class="linenos">754</span></a>                                <span class="p">]</span>
</span><span id="StepSizes.Singles.serialize-755"><a href="#StepSizes.Singles.serialize-755"><span class="linenos">755</span></a>                            <span class="p">)</span>
</span><span id="StepSizes.Singles.serialize-756"><a href="#StepSizes.Singles.serialize-756"><span class="linenos">756</span></a>                        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</span><span id="StepSizes.Singles.serialize-757"><a href="#StepSizes.Singles.serialize-757"><span class="linenos">757</span></a>
</span><span id="StepSizes.Singles.serialize-758"><a href="#StepSizes.Singles.serialize-758"><span class="linenos">758</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="StepSizes.Singles.serialize-759"><a href="#StepSizes.Singles.serialize-759"><span class="linenos">759</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="StepSizes.Singles.serialize-760"><a href="#StepSizes.Singles.serialize-760"><span class="linenos">760</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="StepSizes.Singles.serialize-761"><a href="#StepSizes.Singles.serialize-761"><span class="linenos">761</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="StepSizes.Singles.serialize-762"><a href="#StepSizes.Singles.serialize-762"><span class="linenos">762</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepSizes.Singles.serialize-763"><a href="#StepSizes.Singles.serialize-763"><span class="linenos">763</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="StepSizes.Singles.serialize-764"><a href="#StepSizes.Singles.serialize-764"><span class="linenos">764</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="StepSizes.Singles.serialize-765"><a href="#StepSizes.Singles.serialize-765"><span class="linenos">765</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Singles.serialize-766"><a href="#StepSizes.Singles.serialize-766"><span class="linenos">766</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Singles.serialize-767"><a href="#StepSizes.Singles.serialize-767"><span class="linenos">767</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Singles.serialize-768"><a href="#StepSizes.Singles.serialize-768"><span class="linenos">768</span></a>                    <span class="p">)</span>
</span><span id="StepSizes.Singles.serialize-769"><a href="#StepSizes.Singles.serialize-769"><span class="linenos">769</span></a>
</span><span id="StepSizes.Singles.serialize-770"><a href="#StepSizes.Singles.serialize-770"><span class="linenos">770</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="StepSizes.Singles.load" class="classattr">
                                        <input id="StepSizes.Singles.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.Singles.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L776-L862" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.Singles.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.Singles.load-777"><a href="#StepSizes.Singles.load-777"><span class="linenos">777</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="StepSizes.Singles.load-778"><a href="#StepSizes.Singles.load-778"><span class="linenos">778</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="StepSizes.Singles.load-779"><a href="#StepSizes.Singles.load-779"><span class="linenos">779</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="StepSizes.Singles.load-780"><a href="#StepSizes.Singles.load-780"><span class="linenos">780</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="StepSizes.Singles.load-781"><a href="#StepSizes.Singles.load-781"><span class="linenos">781</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="StepSizes.Singles.load-782"><a href="#StepSizes.Singles.load-782"><span class="linenos">782</span></a>
</span><span id="StepSizes.Singles.load-783"><a href="#StepSizes.Singles.load-783"><span class="linenos">783</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="StepSizes.Singles.load-784"><a href="#StepSizes.Singles.load-784"><span class="linenos">784</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="StepSizes.Singles.load-785"><a href="#StepSizes.Singles.load-785"><span class="linenos">785</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Singles.load-786"><a href="#StepSizes.Singles.load-786"><span class="linenos">786</span></a>
</span><span id="StepSizes.Singles.load-787"><a href="#StepSizes.Singles.load-787"><span class="linenos">787</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="StepSizes.Singles.load-788"><a href="#StepSizes.Singles.load-788"><span class="linenos">788</span></a>
</span><span id="StepSizes.Singles.load-789"><a href="#StepSizes.Singles.load-789"><span class="linenos">789</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="StepSizes.Singles.load-790"><a href="#StepSizes.Singles.load-790"><span class="linenos">790</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="StepSizes.Singles.load-791"><a href="#StepSizes.Singles.load-791"><span class="linenos">791</span></a>
</span><span id="StepSizes.Singles.load-792"><a href="#StepSizes.Singles.load-792"><span class="linenos">792</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="StepSizes.Singles.load-793"><a href="#StepSizes.Singles.load-793"><span class="linenos">793</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="StepSizes.Singles.load-794"><a href="#StepSizes.Singles.load-794"><span class="linenos">794</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="StepSizes.Singles.load-795"><a href="#StepSizes.Singles.load-795"><span class="linenos">795</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="StepSizes.Singles.load-796"><a href="#StepSizes.Singles.load-796"><span class="linenos">796</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="StepSizes.Singles.load-797"><a href="#StepSizes.Singles.load-797"><span class="linenos">797</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="StepSizes.Singles.load-798"><a href="#StepSizes.Singles.load-798"><span class="linenos">798</span></a>
</span><span id="StepSizes.Singles.load-799"><a href="#StepSizes.Singles.load-799"><span class="linenos">799</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="StepSizes.Singles.load-800"><a href="#StepSizes.Singles.load-800"><span class="linenos">800</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="StepSizes.Singles.load-801"><a href="#StepSizes.Singles.load-801"><span class="linenos">801</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="StepSizes.Singles.load-802"><a href="#StepSizes.Singles.load-802"><span class="linenos">802</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="StepSizes.Singles.load-803"><a href="#StepSizes.Singles.load-803"><span class="linenos">803</span></a>
</span><span id="StepSizes.Singles.load-804"><a href="#StepSizes.Singles.load-804"><span class="linenos">804</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="StepSizes.Singles.load-805"><a href="#StepSizes.Singles.load-805"><span class="linenos">805</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="StepSizes.Singles.load-806"><a href="#StepSizes.Singles.load-806"><span class="linenos">806</span></a>
</span><span id="StepSizes.Singles.load-807"><a href="#StepSizes.Singles.load-807"><span class="linenos">807</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="StepSizes.Singles.load-808"><a href="#StepSizes.Singles.load-808"><span class="linenos">808</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="StepSizes.Singles.load-809"><a href="#StepSizes.Singles.load-809"><span class="linenos">809</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="StepSizes.Singles.load-810"><a href="#StepSizes.Singles.load-810"><span class="linenos">810</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepSizes.Singles.load-811"><a href="#StepSizes.Singles.load-811"><span class="linenos">811</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="StepSizes.Singles.load-812"><a href="#StepSizes.Singles.load-812"><span class="linenos">812</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="StepSizes.Singles.load-813"><a href="#StepSizes.Singles.load-813"><span class="linenos">813</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="StepSizes.Singles.load-814"><a href="#StepSizes.Singles.load-814"><span class="linenos">814</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="StepSizes.Singles.load-815"><a href="#StepSizes.Singles.load-815"><span class="linenos">815</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="StepSizes.Singles.load-816"><a href="#StepSizes.Singles.load-816"><span class="linenos">816</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="StepSizes.Singles.load-817"><a href="#StepSizes.Singles.load-817"><span class="linenos">817</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="StepSizes.Singles.load-818"><a href="#StepSizes.Singles.load-818"><span class="linenos">818</span></a>                    <span class="p">):</span>
</span><span id="StepSizes.Singles.load-819"><a href="#StepSizes.Singles.load-819"><span class="linenos">819</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="StepSizes.Singles.load-820"><a href="#StepSizes.Singles.load-820"><span class="linenos">820</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="StepSizes.Singles.load-821"><a href="#StepSizes.Singles.load-821"><span class="linenos">821</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepSizes.Singles.load-822"><a href="#StepSizes.Singles.load-822"><span class="linenos">822</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="StepSizes.Singles.load-823"><a href="#StepSizes.Singles.load-823"><span class="linenos">823</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="StepSizes.Singles.load-824"><a href="#StepSizes.Singles.load-824"><span class="linenos">824</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Singles.load-825"><a href="#StepSizes.Singles.load-825"><span class="linenos">825</span></a>                            <span class="p">)</span>
</span><span id="StepSizes.Singles.load-826"><a href="#StepSizes.Singles.load-826"><span class="linenos">826</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="StepSizes.Singles.load-827"><a href="#StepSizes.Singles.load-827"><span class="linenos">827</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="StepSizes.Singles.load-828"><a href="#StepSizes.Singles.load-828"><span class="linenos">828</span></a>                        <span class="k">pass</span>
</span><span id="StepSizes.Singles.load-829"><a href="#StepSizes.Singles.load-829"><span class="linenos">829</span></a>
</span><span id="StepSizes.Singles.load-830"><a href="#StepSizes.Singles.load-830"><span class="linenos">830</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="StepSizes.Singles.load-831"><a href="#StepSizes.Singles.load-831"><span class="linenos">831</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepSizes.Singles.load-832"><a href="#StepSizes.Singles.load-832"><span class="linenos">832</span></a>
</span><span id="StepSizes.Singles.load-833"><a href="#StepSizes.Singles.load-833"><span class="linenos">833</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="StepSizes.Singles.load-834"><a href="#StepSizes.Singles.load-834"><span class="linenos">834</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="StepSizes.Singles.load-835"><a href="#StepSizes.Singles.load-835"><span class="linenos">835</span></a>
</span><span id="StepSizes.Singles.load-836"><a href="#StepSizes.Singles.load-836"><span class="linenos">836</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="StepSizes.Singles.load-837"><a href="#StepSizes.Singles.load-837"><span class="linenos">837</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="StepSizes.Singles.load-838"><a href="#StepSizes.Singles.load-838"><span class="linenos">838</span></a>                <span class="n">fields_valid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="StepSizes.Singles.load-839"><a href="#StepSizes.Singles.load-839"><span class="linenos">839</span></a>                    <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="StepSizes.Singles.load-840"><a href="#StepSizes.Singles.load-840"><span class="linenos">840</span></a>                        <span class="n">output</span><span class="p">,</span>
</span><span id="StepSizes.Singles.load-841"><a href="#StepSizes.Singles.load-841"><span class="linenos">841</span></a>                        <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">,</span>
</span><span id="StepSizes.Singles.load-842"><a href="#StepSizes.Singles.load-842"><span class="linenos">842</span></a>                    <span class="p">)</span>
</span><span id="StepSizes.Singles.load-843"><a href="#StepSizes.Singles.load-843"><span class="linenos">843</span></a>                <span class="p">)</span>
</span><span id="StepSizes.Singles.load-844"><a href="#StepSizes.Singles.load-844"><span class="linenos">844</span></a>
</span><span id="StepSizes.Singles.load-845"><a href="#StepSizes.Singles.load-845"><span class="linenos">845</span></a>                <span class="c1"># if there are any fields that are not valid, raise an error</span>
</span><span id="StepSizes.Singles.load-846"><a href="#StepSizes.Singles.load-846"><span class="linenos">846</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">fields_valid</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="StepSizes.Singles.load-847"><a href="#StepSizes.Singles.load-847"><span class="linenos">847</span></a>                    <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="StepSizes.Singles.load-848"><a href="#StepSizes.Singles.load-848"><span class="linenos">848</span></a>                        <span class="sa">f</span><span class="s2">&quot;Type mismatch in fields of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Singles.load-849"><a href="#StepSizes.Singles.load-849"><span class="linenos">849</span></a>                        <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="StepSizes.Singles.load-850"><a href="#StepSizes.Singles.load-850"><span class="linenos">850</span></a>                            <span class="p">[</span>
</span><span id="StepSizes.Singles.load-851"><a href="#StepSizes.Singles.load-851"><span class="linenos">851</span></a>                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">:</span><span class="se">\t</span><span class="s2">expected </span><span class="si">{</span><span class="n">cls_type_hints</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="si">= }</span><span class="s2">, but got value </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Singles.load-852"><a href="#StepSizes.Singles.load-852"><span class="linenos">852</span></a>                                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">fields_valid</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="StepSizes.Singles.load-853"><a href="#StepSizes.Singles.load-853"><span class="linenos">853</span></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span>
</span><span id="StepSizes.Singles.load-854"><a href="#StepSizes.Singles.load-854"><span class="linenos">854</span></a>                            <span class="p">]</span>
</span><span id="StepSizes.Singles.load-855"><a href="#StepSizes.Singles.load-855"><span class="linenos">855</span></a>                        <span class="p">)</span>
</span><span id="StepSizes.Singles.load-856"><a href="#StepSizes.Singles.load-856"><span class="linenos">856</span></a>                    <span class="p">)</span>
</span><span id="StepSizes.Singles.load-857"><a href="#StepSizes.Singles.load-857"><span class="linenos">857</span></a>
</span><span id="StepSizes.Singles.load-858"><a href="#StepSizes.Singles.load-858"><span class="linenos">858</span></a>                    <span class="n">on_typecheck_mismatch</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
</span><span id="StepSizes.Singles.load-859"><a href="#StepSizes.Singles.load-859"><span class="linenos">859</span></a>                        <span class="n">msg</span><span class="p">,</span> <span class="n">except_cls</span><span class="o">=</span><span class="n">FieldTypeMismatchError</span>
</span><span id="StepSizes.Singles.load-860"><a href="#StepSizes.Singles.load-860"><span class="linenos">860</span></a>                    <span class="p">)</span>
</span><span id="StepSizes.Singles.load-861"><a href="#StepSizes.Singles.load-861"><span class="linenos">861</span></a>
</span><span id="StepSizes.Singles.load-862"><a href="#StepSizes.Singles.load-862"><span class="linenos">862</span></a>            <span class="c1"># return the new instance</span>
</span><span id="StepSizes.Singles.load-863"><a href="#StepSizes.Singles.load-863"><span class="linenos">863</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="StepSizes.Singles.validate_fields_types" class="classattr">
                                        <input id="StepSizes.Singles.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.Singles.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L282-L291" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.Singles.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.Singles.validate_fields_types-283"><a href="#StepSizes.Singles.validate_fields_types-283"><span class="linenos">283</span></a><span class="k">def</span><span class="w"> </span><span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="StepSizes.Singles.validate_fields_types-284"><a href="#StepSizes.Singles.validate_fields_types-284"><span class="linenos">284</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="StepSizes.Singles.validate_fields_types-285"><a href="#StepSizes.Singles.validate_fields_types-285"><span class="linenos">285</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="StepSizes.Singles.validate_fields_types-286"><a href="#StepSizes.Singles.validate_fields_types-286"><span class="linenos">286</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="StepSizes.Singles.validate_fields_types-287"><a href="#StepSizes.Singles.validate_fields_types-287"><span class="linenos">287</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="StepSizes.Singles.validate_fields_types-288"><a href="#StepSizes.Singles.validate_fields_types-288"><span class="linenos">288</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="StepSizes.Singles.validate_fields_types-289"><a href="#StepSizes.Singles.validate_fields_types-289"><span class="linenos">289</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="StepSizes.Singles.validate_fields_types-290"><a href="#StepSizes.Singles.validate_fields_types-290"><span class="linenos">290</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="StepSizes.Singles.validate_fields_types-291"><a href="#StepSizes.Singles.validate_fields_types-291"><span class="linenos">291</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="StepSizes.Singles.validate_fields_types-292"><a href="#StepSizes.Singles.validate_fields_types-292"><span class="linenos">292</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#StepSizes._StepSize">StepSizes._StepSize</a></dt>
                                <dd id="StepSizes.Singles.attribute_key" class="function"><a href="#StepSizes._StepSize.attribute_key">attribute_key</a></dd>
                <dd id="StepSizes.Singles.step_start_end_indices" class="function"><a href="#StepSizes._StepSize.step_start_end_indices">step_start_end_indices</a></dd>
                <dd id="StepSizes.Singles.is_valid" class="function"><a href="#StepSizes._StepSize.is_valid">is_valid</a></dd>

            </div>
            <div><dt><a href="element_base.html#_TokenizerElement">maze_dataset.tokenization.modular.element_base._TokenizerElement</a></dt>
                                <dd id="StepSizes.Singles.name" class="variable"><a href="element_base.html#_TokenizerElement.name">name</a></dd>
                <dd id="StepSizes.Singles.tokenizer_elements" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="StepSizes.Singles.tokenizer_element_tree" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="StepSizes.Singles.tokenizer_element_dict" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>
                <dd id="StepSizes.Singles.to_tokens" class="function"><a href="element_base.html#_TokenizerElement.to_tokens">to_tokens</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="StepSizes.Singles.validate_field_type" class="function">validate_field_type</dd>
                <dd id="StepSizes.Singles.diff" class="function">diff</dd>
                <dd id="StepSizes.Singles.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="StepSizes.Straightaways">
                            <input id="StepSizes.Straightaways-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>
        <div class="decorator">@mark_as_unsupported(_unsupported_is_invalid)</div>

    <span class="def">class</span>
    <span class="name">StepSizes.Straightaways</span><wbr>(<span class="base"><a href="#StepSizes._StepSize">StepSizes._StepSize</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.Straightaways-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L711-L729" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.Straightaways"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.Straightaways-712"><a href="#StepSizes.Straightaways-712"><span class="linenos">712</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways-713"><a href="#StepSizes.Straightaways-713"><span class="linenos">713</span></a>	<span class="nd">@mark_as_unsupported</span><span class="p">(</span><span class="n">_unsupported_is_invalid</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways-714"><a href="#StepSizes.Straightaways-714"><span class="linenos">714</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">Straightaways</span><span class="p">(</span><span class="n">_StepSize</span><span class="p">):</span>
</span><span id="StepSizes.Straightaways-715"><a href="#StepSizes.Straightaways-715"><span class="linenos">715</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Only coords where the path turns are represented in the path.</span>
</span><span id="StepSizes.Straightaways-716"><a href="#StepSizes.Straightaways-716"><span class="linenos">716</span></a>
</span><span id="StepSizes.Straightaways-717"><a href="#StepSizes.Straightaways-717"><span class="linenos">717</span></a><span class="sd">		I.e., the path is represented as a sequence of straightaways,</span>
</span><span id="StepSizes.Straightaways-718"><a href="#StepSizes.Straightaways-718"><span class="linenos">718</span></a><span class="sd">		specified by the coords at the turns.</span>
</span><span id="StepSizes.Straightaways-719"><a href="#StepSizes.Straightaways-719"><span class="linenos">719</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="StepSizes.Straightaways-720"><a href="#StepSizes.Straightaways-720"><span class="linenos">720</span></a>
</span><span id="StepSizes.Straightaways-721"><a href="#StepSizes.Straightaways-721"><span class="linenos">721</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_step_single_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="StepSizes.Straightaways-722"><a href="#StepSizes.Straightaways-722"><span class="linenos">722</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns the indices of `maze.solution` corresponding to the steps to be tokenized.&quot;&quot;&quot;</span>
</span><span id="StepSizes.Straightaways-723"><a href="#StepSizes.Straightaways-723"><span class="linenos">723</span></a>			<span class="n">last_turn_coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span><span id="StepSizes.Straightaways-724"><a href="#StepSizes.Straightaways-724"><span class="linenos">724</span></a>			<span class="n">indices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="StepSizes.Straightaways-725"><a href="#StepSizes.Straightaways-725"><span class="linenos">725</span></a>			<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">coord</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">):</span>
</span><span id="StepSizes.Straightaways-726"><a href="#StepSizes.Straightaways-726"><span class="linenos">726</span></a>				<span class="k">if</span> <span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">last_turn_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">last_turn_coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="StepSizes.Straightaways-727"><a href="#StepSizes.Straightaways-727"><span class="linenos">727</span></a>					<span class="n">indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways-728"><a href="#StepSizes.Straightaways-728"><span class="linenos">728</span></a>					<span class="n">last_turn_coord</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span><span id="StepSizes.Straightaways-729"><a href="#StepSizes.Straightaways-729"><span class="linenos">729</span></a>			<span class="n">indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways-730"><a href="#StepSizes.Straightaways-730"><span class="linenos">730</span></a>			<span class="k">return</span> <span class="n">indices</span>
</span></pre></div>


            <div class="docstring"><p>Only coords where the path turns are represented in the path.</p>

<p>I.e., the path is represented as a sequence of straightaways,
specified by the coords at the turns.</p>
</div>


                            <div id="StepSizes.Straightaways.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">StepSizes.Straightaways</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#StepSizes.Straightaways">StepSizes.Straightaways</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#StepSizes.Straightaways">StepSizes.Straightaways</a>&#39;&gt;&quot;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#StepSizes.Straightaways.__init__"></a>
    
    

                            </div>
                            <div id="StepSizes.Straightaways.is_valid" class="classattr">
                                        <input id="StepSizes.Straightaways.is_valid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_valid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.Straightaways.is_valid-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L256-L265" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.Straightaways.is_valid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.Straightaways.is_valid-257"><a href="#StepSizes.Straightaways.is_valid-257"><span class="linenos">257</span></a><span class="k">def</span><span class="w"> </span><span class="nf">_unsupported_is_invalid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># noqa: ANN001</span>
</span><span id="StepSizes.Straightaways.is_valid-258"><a href="#StepSizes.Straightaways.is_valid-258"><span class="linenos">258</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Default implementation of `is_valid` for `mark_as_unsupported`-decorated classes&quot;&quot;&quot;</span>
</span><span id="StepSizes.Straightaways.is_valid-259"><a href="#StepSizes.Straightaways.is_valid-259"><span class="linenos">259</span></a>	<span class="k">if</span> <span class="n">do_except</span><span class="p">:</span>
</span><span id="StepSizes.Straightaways.is_valid-260"><a href="#StepSizes.Straightaways.is_valid-260"><span class="linenos">260</span></a>		<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="StepSizes.Straightaways.is_valid-261"><a href="#StepSizes.Straightaways.is_valid-261"><span class="linenos">261</span></a>			<span class="sa">f</span><span class="s2">&quot;Class `</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2">, marked as unsupported, is not valid.&quot;</span>
</span><span id="StepSizes.Straightaways.is_valid-262"><a href="#StepSizes.Straightaways.is_valid-262"><span class="linenos">262</span></a>			<span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Straightaways.is_valid-263"><a href="#StepSizes.Straightaways.is_valid-263"><span class="linenos">263</span></a>		<span class="p">)</span>
</span><span id="StepSizes.Straightaways.is_valid-264"><a href="#StepSizes.Straightaways.is_valid-264"><span class="linenos">264</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways.is_valid-265"><a href="#StepSizes.Straightaways.is_valid-265"><span class="linenos">265</span></a>
</span><span id="StepSizes.Straightaways.is_valid-266"><a href="#StepSizes.Straightaways.is_valid-266"><span class="linenos">266</span></a>	<span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Default implementation of <code><a href="#StepSizes.Straightaways.is_valid">is_valid</a></code> for <code>mark_as_unsupported</code>-decorated classes</p>
</div>


                            </div>
                            <div id="StepSizes.Straightaways.serialize" class="classattr">
                                        <input id="StepSizes.Straightaways.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.Straightaways.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L713-L769" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.Straightaways.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.Straightaways.serialize-714"><a href="#StepSizes.Straightaways.serialize-714"><span class="linenos">714</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="StepSizes.Straightaways.serialize-715"><a href="#StepSizes.Straightaways.serialize-715"><span class="linenos">715</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="StepSizes.Straightaways.serialize-716"><a href="#StepSizes.Straightaways.serialize-716"><span class="linenos">716</span></a>                <span class="n">_FORMAT_KEY</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="StepSizes.Straightaways.serialize-717"><a href="#StepSizes.Straightaways.serialize-717"><span class="linenos">717</span></a>            <span class="p">}</span>
</span><span id="StepSizes.Straightaways.serialize-718"><a href="#StepSizes.Straightaways.serialize-718"><span class="linenos">718</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="StepSizes.Straightaways.serialize-719"><a href="#StepSizes.Straightaways.serialize-719"><span class="linenos">719</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="StepSizes.Straightaways.serialize-720"><a href="#StepSizes.Straightaways.serialize-720"><span class="linenos">720</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="StepSizes.Straightaways.serialize-721"><a href="#StepSizes.Straightaways.serialize-721"><span class="linenos">721</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="StepSizes.Straightaways.serialize-722"><a href="#StepSizes.Straightaways.serialize-722"><span class="linenos">722</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="StepSizes.Straightaways.serialize-723"><a href="#StepSizes.Straightaways.serialize-723"><span class="linenos">723</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="StepSizes.Straightaways.serialize-724"><a href="#StepSizes.Straightaways.serialize-724"><span class="linenos">724</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="StepSizes.Straightaways.serialize-725"><a href="#StepSizes.Straightaways.serialize-725"><span class="linenos">725</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="StepSizes.Straightaways.serialize-726"><a href="#StepSizes.Straightaways.serialize-726"><span class="linenos">726</span></a>                    <span class="p">)</span>
</span><span id="StepSizes.Straightaways.serialize-727"><a href="#StepSizes.Straightaways.serialize-727"><span class="linenos">727</span></a>
</span><span id="StepSizes.Straightaways.serialize-728"><a href="#StepSizes.Straightaways.serialize-728"><span class="linenos">728</span></a>                <span class="c1"># try to save it</span>
</span><span id="StepSizes.Straightaways.serialize-729"><a href="#StepSizes.Straightaways.serialize-729"><span class="linenos">729</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="StepSizes.Straightaways.serialize-730"><a href="#StepSizes.Straightaways.serialize-730"><span class="linenos">730</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="StepSizes.Straightaways.serialize-731"><a href="#StepSizes.Straightaways.serialize-731"><span class="linenos">731</span></a>                        <span class="c1"># get the val</span>
</span><span id="StepSizes.Straightaways.serialize-732"><a href="#StepSizes.Straightaways.serialize-732"><span class="linenos">732</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways.serialize-733"><a href="#StepSizes.Straightaways.serialize-733"><span class="linenos">733</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="StepSizes.Straightaways.serialize-734"><a href="#StepSizes.Straightaways.serialize-734"><span class="linenos">734</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="StepSizes.Straightaways.serialize-735"><a href="#StepSizes.Straightaways.serialize-735"><span class="linenos">735</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="StepSizes.Straightaways.serialize-736"><a href="#StepSizes.Straightaways.serialize-736"><span class="linenos">736</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="StepSizes.Straightaways.serialize-737"><a href="#StepSizes.Straightaways.serialize-737"><span class="linenos">737</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="StepSizes.Straightaways.serialize-738"><a href="#StepSizes.Straightaways.serialize-738"><span class="linenos">738</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="StepSizes.Straightaways.serialize-739"><a href="#StepSizes.Straightaways.serialize-739"><span class="linenos">739</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="StepSizes.Straightaways.serialize-740"><a href="#StepSizes.Straightaways.serialize-740"><span class="linenos">740</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="StepSizes.Straightaways.serialize-741"><a href="#StepSizes.Straightaways.serialize-741"><span class="linenos">741</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="StepSizes.Straightaways.serialize-742"><a href="#StepSizes.Straightaways.serialize-742"><span class="linenos">742</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways.serialize-743"><a href="#StepSizes.Straightaways.serialize-743"><span class="linenos">743</span></a>
</span><span id="StepSizes.Straightaways.serialize-744"><a href="#StepSizes.Straightaways.serialize-744"><span class="linenos">744</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="StepSizes.Straightaways.serialize-745"><a href="#StepSizes.Straightaways.serialize-745"><span class="linenos">745</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepSizes.Straightaways.serialize-746"><a href="#StepSizes.Straightaways.serialize-746"><span class="linenos">746</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="StepSizes.Straightaways.serialize-747"><a href="#StepSizes.Straightaways.serialize-747"><span class="linenos">747</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="StepSizes.Straightaways.serialize-748"><a href="#StepSizes.Straightaways.serialize-748"><span class="linenos">748</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="StepSizes.Straightaways.serialize-749"><a href="#StepSizes.Straightaways.serialize-749"><span class="linenos">749</span></a>                                <span class="p">[</span>
</span><span id="StepSizes.Straightaways.serialize-750"><a href="#StepSizes.Straightaways.serialize-750"><span class="linenos">750</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepSizes.Straightaways.serialize-751"><a href="#StepSizes.Straightaways.serialize-751"><span class="linenos">751</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepSizes.Straightaways.serialize-752"><a href="#StepSizes.Straightaways.serialize-752"><span class="linenos">752</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepSizes.Straightaways.serialize-753"><a href="#StepSizes.Straightaways.serialize-753"><span class="linenos">753</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepSizes.Straightaways.serialize-754"><a href="#StepSizes.Straightaways.serialize-754"><span class="linenos">754</span></a>                                <span class="p">]</span>
</span><span id="StepSizes.Straightaways.serialize-755"><a href="#StepSizes.Straightaways.serialize-755"><span class="linenos">755</span></a>                            <span class="p">)</span>
</span><span id="StepSizes.Straightaways.serialize-756"><a href="#StepSizes.Straightaways.serialize-756"><span class="linenos">756</span></a>                        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</span><span id="StepSizes.Straightaways.serialize-757"><a href="#StepSizes.Straightaways.serialize-757"><span class="linenos">757</span></a>
</span><span id="StepSizes.Straightaways.serialize-758"><a href="#StepSizes.Straightaways.serialize-758"><span class="linenos">758</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="StepSizes.Straightaways.serialize-759"><a href="#StepSizes.Straightaways.serialize-759"><span class="linenos">759</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="StepSizes.Straightaways.serialize-760"><a href="#StepSizes.Straightaways.serialize-760"><span class="linenos">760</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="StepSizes.Straightaways.serialize-761"><a href="#StepSizes.Straightaways.serialize-761"><span class="linenos">761</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways.serialize-762"><a href="#StepSizes.Straightaways.serialize-762"><span class="linenos">762</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepSizes.Straightaways.serialize-763"><a href="#StepSizes.Straightaways.serialize-763"><span class="linenos">763</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="StepSizes.Straightaways.serialize-764"><a href="#StepSizes.Straightaways.serialize-764"><span class="linenos">764</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="StepSizes.Straightaways.serialize-765"><a href="#StepSizes.Straightaways.serialize-765"><span class="linenos">765</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Straightaways.serialize-766"><a href="#StepSizes.Straightaways.serialize-766"><span class="linenos">766</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Straightaways.serialize-767"><a href="#StepSizes.Straightaways.serialize-767"><span class="linenos">767</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Straightaways.serialize-768"><a href="#StepSizes.Straightaways.serialize-768"><span class="linenos">768</span></a>                    <span class="p">)</span>
</span><span id="StepSizes.Straightaways.serialize-769"><a href="#StepSizes.Straightaways.serialize-769"><span class="linenos">769</span></a>
</span><span id="StepSizes.Straightaways.serialize-770"><a href="#StepSizes.Straightaways.serialize-770"><span class="linenos">770</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="StepSizes.Straightaways.load" class="classattr">
                                        <input id="StepSizes.Straightaways.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.Straightaways.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L776-L862" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.Straightaways.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.Straightaways.load-777"><a href="#StepSizes.Straightaways.load-777"><span class="linenos">777</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="StepSizes.Straightaways.load-778"><a href="#StepSizes.Straightaways.load-778"><span class="linenos">778</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="StepSizes.Straightaways.load-779"><a href="#StepSizes.Straightaways.load-779"><span class="linenos">779</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="StepSizes.Straightaways.load-780"><a href="#StepSizes.Straightaways.load-780"><span class="linenos">780</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="StepSizes.Straightaways.load-781"><a href="#StepSizes.Straightaways.load-781"><span class="linenos">781</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="StepSizes.Straightaways.load-782"><a href="#StepSizes.Straightaways.load-782"><span class="linenos">782</span></a>
</span><span id="StepSizes.Straightaways.load-783"><a href="#StepSizes.Straightaways.load-783"><span class="linenos">783</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="StepSizes.Straightaways.load-784"><a href="#StepSizes.Straightaways.load-784"><span class="linenos">784</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="StepSizes.Straightaways.load-785"><a href="#StepSizes.Straightaways.load-785"><span class="linenos">785</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Straightaways.load-786"><a href="#StepSizes.Straightaways.load-786"><span class="linenos">786</span></a>
</span><span id="StepSizes.Straightaways.load-787"><a href="#StepSizes.Straightaways.load-787"><span class="linenos">787</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways.load-788"><a href="#StepSizes.Straightaways.load-788"><span class="linenos">788</span></a>
</span><span id="StepSizes.Straightaways.load-789"><a href="#StepSizes.Straightaways.load-789"><span class="linenos">789</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="StepSizes.Straightaways.load-790"><a href="#StepSizes.Straightaways.load-790"><span class="linenos">790</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="StepSizes.Straightaways.load-791"><a href="#StepSizes.Straightaways.load-791"><span class="linenos">791</span></a>
</span><span id="StepSizes.Straightaways.load-792"><a href="#StepSizes.Straightaways.load-792"><span class="linenos">792</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="StepSizes.Straightaways.load-793"><a href="#StepSizes.Straightaways.load-793"><span class="linenos">793</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="StepSizes.Straightaways.load-794"><a href="#StepSizes.Straightaways.load-794"><span class="linenos">794</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="StepSizes.Straightaways.load-795"><a href="#StepSizes.Straightaways.load-795"><span class="linenos">795</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="StepSizes.Straightaways.load-796"><a href="#StepSizes.Straightaways.load-796"><span class="linenos">796</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="StepSizes.Straightaways.load-797"><a href="#StepSizes.Straightaways.load-797"><span class="linenos">797</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="StepSizes.Straightaways.load-798"><a href="#StepSizes.Straightaways.load-798"><span class="linenos">798</span></a>
</span><span id="StepSizes.Straightaways.load-799"><a href="#StepSizes.Straightaways.load-799"><span class="linenos">799</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="StepSizes.Straightaways.load-800"><a href="#StepSizes.Straightaways.load-800"><span class="linenos">800</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="StepSizes.Straightaways.load-801"><a href="#StepSizes.Straightaways.load-801"><span class="linenos">801</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="StepSizes.Straightaways.load-802"><a href="#StepSizes.Straightaways.load-802"><span class="linenos">802</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="StepSizes.Straightaways.load-803"><a href="#StepSizes.Straightaways.load-803"><span class="linenos">803</span></a>
</span><span id="StepSizes.Straightaways.load-804"><a href="#StepSizes.Straightaways.load-804"><span class="linenos">804</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="StepSizes.Straightaways.load-805"><a href="#StepSizes.Straightaways.load-805"><span class="linenos">805</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways.load-806"><a href="#StepSizes.Straightaways.load-806"><span class="linenos">806</span></a>
</span><span id="StepSizes.Straightaways.load-807"><a href="#StepSizes.Straightaways.load-807"><span class="linenos">807</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="StepSizes.Straightaways.load-808"><a href="#StepSizes.Straightaways.load-808"><span class="linenos">808</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="StepSizes.Straightaways.load-809"><a href="#StepSizes.Straightaways.load-809"><span class="linenos">809</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="StepSizes.Straightaways.load-810"><a href="#StepSizes.Straightaways.load-810"><span class="linenos">810</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways.load-811"><a href="#StepSizes.Straightaways.load-811"><span class="linenos">811</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="StepSizes.Straightaways.load-812"><a href="#StepSizes.Straightaways.load-812"><span class="linenos">812</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="StepSizes.Straightaways.load-813"><a href="#StepSizes.Straightaways.load-813"><span class="linenos">813</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways.load-814"><a href="#StepSizes.Straightaways.load-814"><span class="linenos">814</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="StepSizes.Straightaways.load-815"><a href="#StepSizes.Straightaways.load-815"><span class="linenos">815</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="StepSizes.Straightaways.load-816"><a href="#StepSizes.Straightaways.load-816"><span class="linenos">816</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways.load-817"><a href="#StepSizes.Straightaways.load-817"><span class="linenos">817</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways.load-818"><a href="#StepSizes.Straightaways.load-818"><span class="linenos">818</span></a>                    <span class="p">):</span>
</span><span id="StepSizes.Straightaways.load-819"><a href="#StepSizes.Straightaways.load-819"><span class="linenos">819</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="StepSizes.Straightaways.load-820"><a href="#StepSizes.Straightaways.load-820"><span class="linenos">820</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="StepSizes.Straightaways.load-821"><a href="#StepSizes.Straightaways.load-821"><span class="linenos">821</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways.load-822"><a href="#StepSizes.Straightaways.load-822"><span class="linenos">822</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="StepSizes.Straightaways.load-823"><a href="#StepSizes.Straightaways.load-823"><span class="linenos">823</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="StepSizes.Straightaways.load-824"><a href="#StepSizes.Straightaways.load-824"><span class="linenos">824</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Straightaways.load-825"><a href="#StepSizes.Straightaways.load-825"><span class="linenos">825</span></a>                            <span class="p">)</span>
</span><span id="StepSizes.Straightaways.load-826"><a href="#StepSizes.Straightaways.load-826"><span class="linenos">826</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="StepSizes.Straightaways.load-827"><a href="#StepSizes.Straightaways.load-827"><span class="linenos">827</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="StepSizes.Straightaways.load-828"><a href="#StepSizes.Straightaways.load-828"><span class="linenos">828</span></a>                        <span class="k">pass</span>
</span><span id="StepSizes.Straightaways.load-829"><a href="#StepSizes.Straightaways.load-829"><span class="linenos">829</span></a>
</span><span id="StepSizes.Straightaways.load-830"><a href="#StepSizes.Straightaways.load-830"><span class="linenos">830</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="StepSizes.Straightaways.load-831"><a href="#StepSizes.Straightaways.load-831"><span class="linenos">831</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepSizes.Straightaways.load-832"><a href="#StepSizes.Straightaways.load-832"><span class="linenos">832</span></a>
</span><span id="StepSizes.Straightaways.load-833"><a href="#StepSizes.Straightaways.load-833"><span class="linenos">833</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="StepSizes.Straightaways.load-834"><a href="#StepSizes.Straightaways.load-834"><span class="linenos">834</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways.load-835"><a href="#StepSizes.Straightaways.load-835"><span class="linenos">835</span></a>
</span><span id="StepSizes.Straightaways.load-836"><a href="#StepSizes.Straightaways.load-836"><span class="linenos">836</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="StepSizes.Straightaways.load-837"><a href="#StepSizes.Straightaways.load-837"><span class="linenos">837</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="StepSizes.Straightaways.load-838"><a href="#StepSizes.Straightaways.load-838"><span class="linenos">838</span></a>                <span class="n">fields_valid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="StepSizes.Straightaways.load-839"><a href="#StepSizes.Straightaways.load-839"><span class="linenos">839</span></a>                    <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="StepSizes.Straightaways.load-840"><a href="#StepSizes.Straightaways.load-840"><span class="linenos">840</span></a>                        <span class="n">output</span><span class="p">,</span>
</span><span id="StepSizes.Straightaways.load-841"><a href="#StepSizes.Straightaways.load-841"><span class="linenos">841</span></a>                        <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">,</span>
</span><span id="StepSizes.Straightaways.load-842"><a href="#StepSizes.Straightaways.load-842"><span class="linenos">842</span></a>                    <span class="p">)</span>
</span><span id="StepSizes.Straightaways.load-843"><a href="#StepSizes.Straightaways.load-843"><span class="linenos">843</span></a>                <span class="p">)</span>
</span><span id="StepSizes.Straightaways.load-844"><a href="#StepSizes.Straightaways.load-844"><span class="linenos">844</span></a>
</span><span id="StepSizes.Straightaways.load-845"><a href="#StepSizes.Straightaways.load-845"><span class="linenos">845</span></a>                <span class="c1"># if there are any fields that are not valid, raise an error</span>
</span><span id="StepSizes.Straightaways.load-846"><a href="#StepSizes.Straightaways.load-846"><span class="linenos">846</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">fields_valid</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="StepSizes.Straightaways.load-847"><a href="#StepSizes.Straightaways.load-847"><span class="linenos">847</span></a>                    <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="StepSizes.Straightaways.load-848"><a href="#StepSizes.Straightaways.load-848"><span class="linenos">848</span></a>                        <span class="sa">f</span><span class="s2">&quot;Type mismatch in fields of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Straightaways.load-849"><a href="#StepSizes.Straightaways.load-849"><span class="linenos">849</span></a>                        <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="StepSizes.Straightaways.load-850"><a href="#StepSizes.Straightaways.load-850"><span class="linenos">850</span></a>                            <span class="p">[</span>
</span><span id="StepSizes.Straightaways.load-851"><a href="#StepSizes.Straightaways.load-851"><span class="linenos">851</span></a>                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">:</span><span class="se">\t</span><span class="s2">expected </span><span class="si">{</span><span class="n">cls_type_hints</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="si">= }</span><span class="s2">, but got value </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Straightaways.load-852"><a href="#StepSizes.Straightaways.load-852"><span class="linenos">852</span></a>                                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">fields_valid</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="StepSizes.Straightaways.load-853"><a href="#StepSizes.Straightaways.load-853"><span class="linenos">853</span></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span>
</span><span id="StepSizes.Straightaways.load-854"><a href="#StepSizes.Straightaways.load-854"><span class="linenos">854</span></a>                            <span class="p">]</span>
</span><span id="StepSizes.Straightaways.load-855"><a href="#StepSizes.Straightaways.load-855"><span class="linenos">855</span></a>                        <span class="p">)</span>
</span><span id="StepSizes.Straightaways.load-856"><a href="#StepSizes.Straightaways.load-856"><span class="linenos">856</span></a>                    <span class="p">)</span>
</span><span id="StepSizes.Straightaways.load-857"><a href="#StepSizes.Straightaways.load-857"><span class="linenos">857</span></a>
</span><span id="StepSizes.Straightaways.load-858"><a href="#StepSizes.Straightaways.load-858"><span class="linenos">858</span></a>                    <span class="n">on_typecheck_mismatch</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
</span><span id="StepSizes.Straightaways.load-859"><a href="#StepSizes.Straightaways.load-859"><span class="linenos">859</span></a>                        <span class="n">msg</span><span class="p">,</span> <span class="n">except_cls</span><span class="o">=</span><span class="n">FieldTypeMismatchError</span>
</span><span id="StepSizes.Straightaways.load-860"><a href="#StepSizes.Straightaways.load-860"><span class="linenos">860</span></a>                    <span class="p">)</span>
</span><span id="StepSizes.Straightaways.load-861"><a href="#StepSizes.Straightaways.load-861"><span class="linenos">861</span></a>
</span><span id="StepSizes.Straightaways.load-862"><a href="#StepSizes.Straightaways.load-862"><span class="linenos">862</span></a>            <span class="c1"># return the new instance</span>
</span><span id="StepSizes.Straightaways.load-863"><a href="#StepSizes.Straightaways.load-863"><span class="linenos">863</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="StepSizes.Straightaways.validate_fields_types" class="classattr">
                                        <input id="StepSizes.Straightaways.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.Straightaways.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L282-L291" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.Straightaways.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.Straightaways.validate_fields_types-283"><a href="#StepSizes.Straightaways.validate_fields_types-283"><span class="linenos">283</span></a><span class="k">def</span><span class="w"> </span><span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="StepSizes.Straightaways.validate_fields_types-284"><a href="#StepSizes.Straightaways.validate_fields_types-284"><span class="linenos">284</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="StepSizes.Straightaways.validate_fields_types-285"><a href="#StepSizes.Straightaways.validate_fields_types-285"><span class="linenos">285</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="StepSizes.Straightaways.validate_fields_types-286"><a href="#StepSizes.Straightaways.validate_fields_types-286"><span class="linenos">286</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="StepSizes.Straightaways.validate_fields_types-287"><a href="#StepSizes.Straightaways.validate_fields_types-287"><span class="linenos">287</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="StepSizes.Straightaways.validate_fields_types-288"><a href="#StepSizes.Straightaways.validate_fields_types-288"><span class="linenos">288</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="StepSizes.Straightaways.validate_fields_types-289"><a href="#StepSizes.Straightaways.validate_fields_types-289"><span class="linenos">289</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="StepSizes.Straightaways.validate_fields_types-290"><a href="#StepSizes.Straightaways.validate_fields_types-290"><span class="linenos">290</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="StepSizes.Straightaways.validate_fields_types-291"><a href="#StepSizes.Straightaways.validate_fields_types-291"><span class="linenos">291</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="StepSizes.Straightaways.validate_fields_types-292"><a href="#StepSizes.Straightaways.validate_fields_types-292"><span class="linenos">292</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#StepSizes._StepSize">StepSizes._StepSize</a></dt>
                                <dd id="StepSizes.Straightaways.attribute_key" class="function"><a href="#StepSizes._StepSize.attribute_key">attribute_key</a></dd>
                <dd id="StepSizes.Straightaways.step_start_end_indices" class="function"><a href="#StepSizes._StepSize.step_start_end_indices">step_start_end_indices</a></dd>

            </div>
            <div><dt><a href="element_base.html#_TokenizerElement">maze_dataset.tokenization.modular.element_base._TokenizerElement</a></dt>
                                <dd id="StepSizes.Straightaways.name" class="variable"><a href="element_base.html#_TokenizerElement.name">name</a></dd>
                <dd id="StepSizes.Straightaways.tokenizer_elements" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="StepSizes.Straightaways.tokenizer_element_tree" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="StepSizes.Straightaways.tokenizer_element_dict" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>
                <dd id="StepSizes.Straightaways.to_tokens" class="function"><a href="element_base.html#_TokenizerElement.to_tokens">to_tokens</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="StepSizes.Straightaways.validate_field_type" class="function">validate_field_type</dd>
                <dd id="StepSizes.Straightaways.diff" class="function">diff</dd>
                <dd id="StepSizes.Straightaways.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="StepSizes.Forks">
                            <input id="StepSizes.Forks-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">StepSizes.Forks</span><wbr>(<span class="base"><a href="#StepSizes._StepSize">StepSizes._StepSize</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.Forks-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L731-L741" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.Forks"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.Forks-732"><a href="#StepSizes.Forks-732"><span class="linenos">732</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepSizes.Forks-733"><a href="#StepSizes.Forks-733"><span class="linenos">733</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">Forks</span><span class="p">(</span><span class="n">_StepSize</span><span class="p">):</span>
</span><span id="StepSizes.Forks-734"><a href="#StepSizes.Forks-734"><span class="linenos">734</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Only coords at forks, where the path has &gt;=2 options for the next step are included.</span>
</span><span id="StepSizes.Forks-735"><a href="#StepSizes.Forks-735"><span class="linenos">735</span></a>
</span><span id="StepSizes.Forks-736"><a href="#StepSizes.Forks-736"><span class="linenos">736</span></a><span class="sd">		Excludes the option of backtracking.</span>
</span><span id="StepSizes.Forks-737"><a href="#StepSizes.Forks-737"><span class="linenos">737</span></a><span class="sd">		The starting and ending coords are always included.</span>
</span><span id="StepSizes.Forks-738"><a href="#StepSizes.Forks-738"><span class="linenos">738</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="StepSizes.Forks-739"><a href="#StepSizes.Forks-739"><span class="linenos">739</span></a>
</span><span id="StepSizes.Forks-740"><a href="#StepSizes.Forks-740"><span class="linenos">740</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_step_single_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="StepSizes.Forks-741"><a href="#StepSizes.Forks-741"><span class="linenos">741</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns the indices of `maze.solution` corresponding to the steps to be tokenized.&quot;&quot;&quot;</span>
</span><span id="StepSizes.Forks-742"><a href="#StepSizes.Forks-742"><span class="linenos">742</span></a>			<span class="k">return</span> <span class="n">maze</span><span class="o">.</span><span class="n">get_solution_forking_points</span><span class="p">(</span><span class="n">always_include_endpoints</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Only coords at forks, where the path has &gt;=2 options for the next step are included.</p>

<p>Excludes the option of backtracking.
The starting and ending coords are always included.</p>
</div>


                            <div id="StepSizes.Forks.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">StepSizes.Forks</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#StepSizes.Forks">StepSizes.Forks</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#StepSizes.Forks">StepSizes.Forks</a>&#39;&gt;&quot;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#StepSizes.Forks.__init__"></a>
    
    

                            </div>
                            <div id="StepSizes.Forks.serialize" class="classattr">
                                        <input id="StepSizes.Forks.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.Forks.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L713-L769" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.Forks.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.Forks.serialize-714"><a href="#StepSizes.Forks.serialize-714"><span class="linenos">714</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="StepSizes.Forks.serialize-715"><a href="#StepSizes.Forks.serialize-715"><span class="linenos">715</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="StepSizes.Forks.serialize-716"><a href="#StepSizes.Forks.serialize-716"><span class="linenos">716</span></a>                <span class="n">_FORMAT_KEY</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="StepSizes.Forks.serialize-717"><a href="#StepSizes.Forks.serialize-717"><span class="linenos">717</span></a>            <span class="p">}</span>
</span><span id="StepSizes.Forks.serialize-718"><a href="#StepSizes.Forks.serialize-718"><span class="linenos">718</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="StepSizes.Forks.serialize-719"><a href="#StepSizes.Forks.serialize-719"><span class="linenos">719</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="StepSizes.Forks.serialize-720"><a href="#StepSizes.Forks.serialize-720"><span class="linenos">720</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="StepSizes.Forks.serialize-721"><a href="#StepSizes.Forks.serialize-721"><span class="linenos">721</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="StepSizes.Forks.serialize-722"><a href="#StepSizes.Forks.serialize-722"><span class="linenos">722</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="StepSizes.Forks.serialize-723"><a href="#StepSizes.Forks.serialize-723"><span class="linenos">723</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="StepSizes.Forks.serialize-724"><a href="#StepSizes.Forks.serialize-724"><span class="linenos">724</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="StepSizes.Forks.serialize-725"><a href="#StepSizes.Forks.serialize-725"><span class="linenos">725</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="StepSizes.Forks.serialize-726"><a href="#StepSizes.Forks.serialize-726"><span class="linenos">726</span></a>                    <span class="p">)</span>
</span><span id="StepSizes.Forks.serialize-727"><a href="#StepSizes.Forks.serialize-727"><span class="linenos">727</span></a>
</span><span id="StepSizes.Forks.serialize-728"><a href="#StepSizes.Forks.serialize-728"><span class="linenos">728</span></a>                <span class="c1"># try to save it</span>
</span><span id="StepSizes.Forks.serialize-729"><a href="#StepSizes.Forks.serialize-729"><span class="linenos">729</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="StepSizes.Forks.serialize-730"><a href="#StepSizes.Forks.serialize-730"><span class="linenos">730</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="StepSizes.Forks.serialize-731"><a href="#StepSizes.Forks.serialize-731"><span class="linenos">731</span></a>                        <span class="c1"># get the val</span>
</span><span id="StepSizes.Forks.serialize-732"><a href="#StepSizes.Forks.serialize-732"><span class="linenos">732</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="StepSizes.Forks.serialize-733"><a href="#StepSizes.Forks.serialize-733"><span class="linenos">733</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="StepSizes.Forks.serialize-734"><a href="#StepSizes.Forks.serialize-734"><span class="linenos">734</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="StepSizes.Forks.serialize-735"><a href="#StepSizes.Forks.serialize-735"><span class="linenos">735</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="StepSizes.Forks.serialize-736"><a href="#StepSizes.Forks.serialize-736"><span class="linenos">736</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="StepSizes.Forks.serialize-737"><a href="#StepSizes.Forks.serialize-737"><span class="linenos">737</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="StepSizes.Forks.serialize-738"><a href="#StepSizes.Forks.serialize-738"><span class="linenos">738</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="StepSizes.Forks.serialize-739"><a href="#StepSizes.Forks.serialize-739"><span class="linenos">739</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="StepSizes.Forks.serialize-740"><a href="#StepSizes.Forks.serialize-740"><span class="linenos">740</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="StepSizes.Forks.serialize-741"><a href="#StepSizes.Forks.serialize-741"><span class="linenos">741</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="StepSizes.Forks.serialize-742"><a href="#StepSizes.Forks.serialize-742"><span class="linenos">742</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepSizes.Forks.serialize-743"><a href="#StepSizes.Forks.serialize-743"><span class="linenos">743</span></a>
</span><span id="StepSizes.Forks.serialize-744"><a href="#StepSizes.Forks.serialize-744"><span class="linenos">744</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="StepSizes.Forks.serialize-745"><a href="#StepSizes.Forks.serialize-745"><span class="linenos">745</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepSizes.Forks.serialize-746"><a href="#StepSizes.Forks.serialize-746"><span class="linenos">746</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="StepSizes.Forks.serialize-747"><a href="#StepSizes.Forks.serialize-747"><span class="linenos">747</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="StepSizes.Forks.serialize-748"><a href="#StepSizes.Forks.serialize-748"><span class="linenos">748</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="StepSizes.Forks.serialize-749"><a href="#StepSizes.Forks.serialize-749"><span class="linenos">749</span></a>                                <span class="p">[</span>
</span><span id="StepSizes.Forks.serialize-750"><a href="#StepSizes.Forks.serialize-750"><span class="linenos">750</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepSizes.Forks.serialize-751"><a href="#StepSizes.Forks.serialize-751"><span class="linenos">751</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepSizes.Forks.serialize-752"><a href="#StepSizes.Forks.serialize-752"><span class="linenos">752</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepSizes.Forks.serialize-753"><a href="#StepSizes.Forks.serialize-753"><span class="linenos">753</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepSizes.Forks.serialize-754"><a href="#StepSizes.Forks.serialize-754"><span class="linenos">754</span></a>                                <span class="p">]</span>
</span><span id="StepSizes.Forks.serialize-755"><a href="#StepSizes.Forks.serialize-755"><span class="linenos">755</span></a>                            <span class="p">)</span>
</span><span id="StepSizes.Forks.serialize-756"><a href="#StepSizes.Forks.serialize-756"><span class="linenos">756</span></a>                        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</span><span id="StepSizes.Forks.serialize-757"><a href="#StepSizes.Forks.serialize-757"><span class="linenos">757</span></a>
</span><span id="StepSizes.Forks.serialize-758"><a href="#StepSizes.Forks.serialize-758"><span class="linenos">758</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="StepSizes.Forks.serialize-759"><a href="#StepSizes.Forks.serialize-759"><span class="linenos">759</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="StepSizes.Forks.serialize-760"><a href="#StepSizes.Forks.serialize-760"><span class="linenos">760</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="StepSizes.Forks.serialize-761"><a href="#StepSizes.Forks.serialize-761"><span class="linenos">761</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="StepSizes.Forks.serialize-762"><a href="#StepSizes.Forks.serialize-762"><span class="linenos">762</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepSizes.Forks.serialize-763"><a href="#StepSizes.Forks.serialize-763"><span class="linenos">763</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="StepSizes.Forks.serialize-764"><a href="#StepSizes.Forks.serialize-764"><span class="linenos">764</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="StepSizes.Forks.serialize-765"><a href="#StepSizes.Forks.serialize-765"><span class="linenos">765</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Forks.serialize-766"><a href="#StepSizes.Forks.serialize-766"><span class="linenos">766</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Forks.serialize-767"><a href="#StepSizes.Forks.serialize-767"><span class="linenos">767</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Forks.serialize-768"><a href="#StepSizes.Forks.serialize-768"><span class="linenos">768</span></a>                    <span class="p">)</span>
</span><span id="StepSizes.Forks.serialize-769"><a href="#StepSizes.Forks.serialize-769"><span class="linenos">769</span></a>
</span><span id="StepSizes.Forks.serialize-770"><a href="#StepSizes.Forks.serialize-770"><span class="linenos">770</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="StepSizes.Forks.load" class="classattr">
                                        <input id="StepSizes.Forks.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.Forks.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L776-L862" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.Forks.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.Forks.load-777"><a href="#StepSizes.Forks.load-777"><span class="linenos">777</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="StepSizes.Forks.load-778"><a href="#StepSizes.Forks.load-778"><span class="linenos">778</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="StepSizes.Forks.load-779"><a href="#StepSizes.Forks.load-779"><span class="linenos">779</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="StepSizes.Forks.load-780"><a href="#StepSizes.Forks.load-780"><span class="linenos">780</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="StepSizes.Forks.load-781"><a href="#StepSizes.Forks.load-781"><span class="linenos">781</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="StepSizes.Forks.load-782"><a href="#StepSizes.Forks.load-782"><span class="linenos">782</span></a>
</span><span id="StepSizes.Forks.load-783"><a href="#StepSizes.Forks.load-783"><span class="linenos">783</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="StepSizes.Forks.load-784"><a href="#StepSizes.Forks.load-784"><span class="linenos">784</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="StepSizes.Forks.load-785"><a href="#StepSizes.Forks.load-785"><span class="linenos">785</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Forks.load-786"><a href="#StepSizes.Forks.load-786"><span class="linenos">786</span></a>
</span><span id="StepSizes.Forks.load-787"><a href="#StepSizes.Forks.load-787"><span class="linenos">787</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="StepSizes.Forks.load-788"><a href="#StepSizes.Forks.load-788"><span class="linenos">788</span></a>
</span><span id="StepSizes.Forks.load-789"><a href="#StepSizes.Forks.load-789"><span class="linenos">789</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="StepSizes.Forks.load-790"><a href="#StepSizes.Forks.load-790"><span class="linenos">790</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="StepSizes.Forks.load-791"><a href="#StepSizes.Forks.load-791"><span class="linenos">791</span></a>
</span><span id="StepSizes.Forks.load-792"><a href="#StepSizes.Forks.load-792"><span class="linenos">792</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="StepSizes.Forks.load-793"><a href="#StepSizes.Forks.load-793"><span class="linenos">793</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="StepSizes.Forks.load-794"><a href="#StepSizes.Forks.load-794"><span class="linenos">794</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="StepSizes.Forks.load-795"><a href="#StepSizes.Forks.load-795"><span class="linenos">795</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="StepSizes.Forks.load-796"><a href="#StepSizes.Forks.load-796"><span class="linenos">796</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="StepSizes.Forks.load-797"><a href="#StepSizes.Forks.load-797"><span class="linenos">797</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="StepSizes.Forks.load-798"><a href="#StepSizes.Forks.load-798"><span class="linenos">798</span></a>
</span><span id="StepSizes.Forks.load-799"><a href="#StepSizes.Forks.load-799"><span class="linenos">799</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="StepSizes.Forks.load-800"><a href="#StepSizes.Forks.load-800"><span class="linenos">800</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="StepSizes.Forks.load-801"><a href="#StepSizes.Forks.load-801"><span class="linenos">801</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="StepSizes.Forks.load-802"><a href="#StepSizes.Forks.load-802"><span class="linenos">802</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="StepSizes.Forks.load-803"><a href="#StepSizes.Forks.load-803"><span class="linenos">803</span></a>
</span><span id="StepSizes.Forks.load-804"><a href="#StepSizes.Forks.load-804"><span class="linenos">804</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="StepSizes.Forks.load-805"><a href="#StepSizes.Forks.load-805"><span class="linenos">805</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="StepSizes.Forks.load-806"><a href="#StepSizes.Forks.load-806"><span class="linenos">806</span></a>
</span><span id="StepSizes.Forks.load-807"><a href="#StepSizes.Forks.load-807"><span class="linenos">807</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="StepSizes.Forks.load-808"><a href="#StepSizes.Forks.load-808"><span class="linenos">808</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="StepSizes.Forks.load-809"><a href="#StepSizes.Forks.load-809"><span class="linenos">809</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="StepSizes.Forks.load-810"><a href="#StepSizes.Forks.load-810"><span class="linenos">810</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepSizes.Forks.load-811"><a href="#StepSizes.Forks.load-811"><span class="linenos">811</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="StepSizes.Forks.load-812"><a href="#StepSizes.Forks.load-812"><span class="linenos">812</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="StepSizes.Forks.load-813"><a href="#StepSizes.Forks.load-813"><span class="linenos">813</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="StepSizes.Forks.load-814"><a href="#StepSizes.Forks.load-814"><span class="linenos">814</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="StepSizes.Forks.load-815"><a href="#StepSizes.Forks.load-815"><span class="linenos">815</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="StepSizes.Forks.load-816"><a href="#StepSizes.Forks.load-816"><span class="linenos">816</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="StepSizes.Forks.load-817"><a href="#StepSizes.Forks.load-817"><span class="linenos">817</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="StepSizes.Forks.load-818"><a href="#StepSizes.Forks.load-818"><span class="linenos">818</span></a>                    <span class="p">):</span>
</span><span id="StepSizes.Forks.load-819"><a href="#StepSizes.Forks.load-819"><span class="linenos">819</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="StepSizes.Forks.load-820"><a href="#StepSizes.Forks.load-820"><span class="linenos">820</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="StepSizes.Forks.load-821"><a href="#StepSizes.Forks.load-821"><span class="linenos">821</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepSizes.Forks.load-822"><a href="#StepSizes.Forks.load-822"><span class="linenos">822</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="StepSizes.Forks.load-823"><a href="#StepSizes.Forks.load-823"><span class="linenos">823</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="StepSizes.Forks.load-824"><a href="#StepSizes.Forks.load-824"><span class="linenos">824</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Forks.load-825"><a href="#StepSizes.Forks.load-825"><span class="linenos">825</span></a>                            <span class="p">)</span>
</span><span id="StepSizes.Forks.load-826"><a href="#StepSizes.Forks.load-826"><span class="linenos">826</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="StepSizes.Forks.load-827"><a href="#StepSizes.Forks.load-827"><span class="linenos">827</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="StepSizes.Forks.load-828"><a href="#StepSizes.Forks.load-828"><span class="linenos">828</span></a>                        <span class="k">pass</span>
</span><span id="StepSizes.Forks.load-829"><a href="#StepSizes.Forks.load-829"><span class="linenos">829</span></a>
</span><span id="StepSizes.Forks.load-830"><a href="#StepSizes.Forks.load-830"><span class="linenos">830</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="StepSizes.Forks.load-831"><a href="#StepSizes.Forks.load-831"><span class="linenos">831</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepSizes.Forks.load-832"><a href="#StepSizes.Forks.load-832"><span class="linenos">832</span></a>
</span><span id="StepSizes.Forks.load-833"><a href="#StepSizes.Forks.load-833"><span class="linenos">833</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="StepSizes.Forks.load-834"><a href="#StepSizes.Forks.load-834"><span class="linenos">834</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="StepSizes.Forks.load-835"><a href="#StepSizes.Forks.load-835"><span class="linenos">835</span></a>
</span><span id="StepSizes.Forks.load-836"><a href="#StepSizes.Forks.load-836"><span class="linenos">836</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="StepSizes.Forks.load-837"><a href="#StepSizes.Forks.load-837"><span class="linenos">837</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="StepSizes.Forks.load-838"><a href="#StepSizes.Forks.load-838"><span class="linenos">838</span></a>                <span class="n">fields_valid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="StepSizes.Forks.load-839"><a href="#StepSizes.Forks.load-839"><span class="linenos">839</span></a>                    <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="StepSizes.Forks.load-840"><a href="#StepSizes.Forks.load-840"><span class="linenos">840</span></a>                        <span class="n">output</span><span class="p">,</span>
</span><span id="StepSizes.Forks.load-841"><a href="#StepSizes.Forks.load-841"><span class="linenos">841</span></a>                        <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">,</span>
</span><span id="StepSizes.Forks.load-842"><a href="#StepSizes.Forks.load-842"><span class="linenos">842</span></a>                    <span class="p">)</span>
</span><span id="StepSizes.Forks.load-843"><a href="#StepSizes.Forks.load-843"><span class="linenos">843</span></a>                <span class="p">)</span>
</span><span id="StepSizes.Forks.load-844"><a href="#StepSizes.Forks.load-844"><span class="linenos">844</span></a>
</span><span id="StepSizes.Forks.load-845"><a href="#StepSizes.Forks.load-845"><span class="linenos">845</span></a>                <span class="c1"># if there are any fields that are not valid, raise an error</span>
</span><span id="StepSizes.Forks.load-846"><a href="#StepSizes.Forks.load-846"><span class="linenos">846</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">fields_valid</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="StepSizes.Forks.load-847"><a href="#StepSizes.Forks.load-847"><span class="linenos">847</span></a>                    <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="StepSizes.Forks.load-848"><a href="#StepSizes.Forks.load-848"><span class="linenos">848</span></a>                        <span class="sa">f</span><span class="s2">&quot;Type mismatch in fields of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Forks.load-849"><a href="#StepSizes.Forks.load-849"><span class="linenos">849</span></a>                        <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="StepSizes.Forks.load-850"><a href="#StepSizes.Forks.load-850"><span class="linenos">850</span></a>                            <span class="p">[</span>
</span><span id="StepSizes.Forks.load-851"><a href="#StepSizes.Forks.load-851"><span class="linenos">851</span></a>                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">:</span><span class="se">\t</span><span class="s2">expected </span><span class="si">{</span><span class="n">cls_type_hints</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="si">= }</span><span class="s2">, but got value </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Forks.load-852"><a href="#StepSizes.Forks.load-852"><span class="linenos">852</span></a>                                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">fields_valid</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="StepSizes.Forks.load-853"><a href="#StepSizes.Forks.load-853"><span class="linenos">853</span></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span>
</span><span id="StepSizes.Forks.load-854"><a href="#StepSizes.Forks.load-854"><span class="linenos">854</span></a>                            <span class="p">]</span>
</span><span id="StepSizes.Forks.load-855"><a href="#StepSizes.Forks.load-855"><span class="linenos">855</span></a>                        <span class="p">)</span>
</span><span id="StepSizes.Forks.load-856"><a href="#StepSizes.Forks.load-856"><span class="linenos">856</span></a>                    <span class="p">)</span>
</span><span id="StepSizes.Forks.load-857"><a href="#StepSizes.Forks.load-857"><span class="linenos">857</span></a>
</span><span id="StepSizes.Forks.load-858"><a href="#StepSizes.Forks.load-858"><span class="linenos">858</span></a>                    <span class="n">on_typecheck_mismatch</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
</span><span id="StepSizes.Forks.load-859"><a href="#StepSizes.Forks.load-859"><span class="linenos">859</span></a>                        <span class="n">msg</span><span class="p">,</span> <span class="n">except_cls</span><span class="o">=</span><span class="n">FieldTypeMismatchError</span>
</span><span id="StepSizes.Forks.load-860"><a href="#StepSizes.Forks.load-860"><span class="linenos">860</span></a>                    <span class="p">)</span>
</span><span id="StepSizes.Forks.load-861"><a href="#StepSizes.Forks.load-861"><span class="linenos">861</span></a>
</span><span id="StepSizes.Forks.load-862"><a href="#StepSizes.Forks.load-862"><span class="linenos">862</span></a>            <span class="c1"># return the new instance</span>
</span><span id="StepSizes.Forks.load-863"><a href="#StepSizes.Forks.load-863"><span class="linenos">863</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="StepSizes.Forks.validate_fields_types" class="classattr">
                                        <input id="StepSizes.Forks.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.Forks.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L282-L291" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.Forks.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.Forks.validate_fields_types-283"><a href="#StepSizes.Forks.validate_fields_types-283"><span class="linenos">283</span></a><span class="k">def</span><span class="w"> </span><span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="StepSizes.Forks.validate_fields_types-284"><a href="#StepSizes.Forks.validate_fields_types-284"><span class="linenos">284</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="StepSizes.Forks.validate_fields_types-285"><a href="#StepSizes.Forks.validate_fields_types-285"><span class="linenos">285</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="StepSizes.Forks.validate_fields_types-286"><a href="#StepSizes.Forks.validate_fields_types-286"><span class="linenos">286</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="StepSizes.Forks.validate_fields_types-287"><a href="#StepSizes.Forks.validate_fields_types-287"><span class="linenos">287</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="StepSizes.Forks.validate_fields_types-288"><a href="#StepSizes.Forks.validate_fields_types-288"><span class="linenos">288</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="StepSizes.Forks.validate_fields_types-289"><a href="#StepSizes.Forks.validate_fields_types-289"><span class="linenos">289</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="StepSizes.Forks.validate_fields_types-290"><a href="#StepSizes.Forks.validate_fields_types-290"><span class="linenos">290</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="StepSizes.Forks.validate_fields_types-291"><a href="#StepSizes.Forks.validate_fields_types-291"><span class="linenos">291</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="StepSizes.Forks.validate_fields_types-292"><a href="#StepSizes.Forks.validate_fields_types-292"><span class="linenos">292</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#StepSizes._StepSize">StepSizes._StepSize</a></dt>
                                <dd id="StepSizes.Forks.attribute_key" class="function"><a href="#StepSizes._StepSize.attribute_key">attribute_key</a></dd>
                <dd id="StepSizes.Forks.step_start_end_indices" class="function"><a href="#StepSizes._StepSize.step_start_end_indices">step_start_end_indices</a></dd>
                <dd id="StepSizes.Forks.is_valid" class="function"><a href="#StepSizes._StepSize.is_valid">is_valid</a></dd>

            </div>
            <div><dt><a href="element_base.html#_TokenizerElement">maze_dataset.tokenization.modular.element_base._TokenizerElement</a></dt>
                                <dd id="StepSizes.Forks.name" class="variable"><a href="element_base.html#_TokenizerElement.name">name</a></dd>
                <dd id="StepSizes.Forks.tokenizer_elements" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="StepSizes.Forks.tokenizer_element_tree" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="StepSizes.Forks.tokenizer_element_dict" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>
                <dd id="StepSizes.Forks.to_tokens" class="function"><a href="element_base.html#_TokenizerElement.to_tokens">to_tokens</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="StepSizes.Forks.validate_field_type" class="function">validate_field_type</dd>
                <dd id="StepSizes.Forks.diff" class="function">diff</dd>
                <dd id="StepSizes.Forks.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="StepSizes.ForksAndStraightaways">
                            <input id="StepSizes.ForksAndStraightaways-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>
        <div class="decorator">@mark_as_unsupported(_unsupported_is_invalid)</div>

    <span class="def">class</span>
    <span class="name">StepSizes.ForksAndStraightaways</span><wbr>(<span class="base"><a href="#StepSizes._StepSize">StepSizes._StepSize</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.ForksAndStraightaways-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L743-L762" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.ForksAndStraightaways"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.ForksAndStraightaways-744"><a href="#StepSizes.ForksAndStraightaways-744"><span class="linenos">744</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways-745"><a href="#StepSizes.ForksAndStraightaways-745"><span class="linenos">745</span></a>	<span class="nd">@mark_as_unsupported</span><span class="p">(</span><span class="n">_unsupported_is_invalid</span><span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways-746"><a href="#StepSizes.ForksAndStraightaways-746"><span class="linenos">746</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">ForksAndStraightaways</span><span class="p">(</span><span class="n">_StepSize</span><span class="p">):</span>
</span><span id="StepSizes.ForksAndStraightaways-747"><a href="#StepSizes.ForksAndStraightaways-747"><span class="linenos">747</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Includes the union of the coords included by `Forks` and `Straightaways`.</span>
</span><span id="StepSizes.ForksAndStraightaways-748"><a href="#StepSizes.ForksAndStraightaways-748"><span class="linenos">748</span></a>
</span><span id="StepSizes.ForksAndStraightaways-749"><a href="#StepSizes.ForksAndStraightaways-749"><span class="linenos">749</span></a><span class="sd">		See documentation for those classes for details.</span>
</span><span id="StepSizes.ForksAndStraightaways-750"><a href="#StepSizes.ForksAndStraightaways-750"><span class="linenos">750</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="StepSizes.ForksAndStraightaways-751"><a href="#StepSizes.ForksAndStraightaways-751"><span class="linenos">751</span></a>
</span><span id="StepSizes.ForksAndStraightaways-752"><a href="#StepSizes.ForksAndStraightaways-752"><span class="linenos">752</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_step_single_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="StepSizes.ForksAndStraightaways-753"><a href="#StepSizes.ForksAndStraightaways-753"><span class="linenos">753</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns the indices of `maze.solution` corresponding to the steps to be tokenized.&quot;&quot;&quot;</span>
</span><span id="StepSizes.ForksAndStraightaways-754"><a href="#StepSizes.ForksAndStraightaways-754"><span class="linenos">754</span></a>			<span class="k">return</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways-755"><a href="#StepSizes.ForksAndStraightaways-755"><span class="linenos">755</span></a>				<span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways-756"><a href="#StepSizes.ForksAndStraightaways-756"><span class="linenos">756</span></a>					<span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways-757"><a href="#StepSizes.ForksAndStraightaways-757"><span class="linenos">757</span></a>						<span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways-758"><a href="#StepSizes.ForksAndStraightaways-758"><span class="linenos">758</span></a>							<span class="n">StepSizes</span><span class="o">.</span><span class="n">Straightaways</span><span class="p">()</span><span class="o">.</span><span class="n">_step_single_indices</span><span class="p">(</span><span class="n">maze</span><span class="p">),</span>
</span><span id="StepSizes.ForksAndStraightaways-759"><a href="#StepSizes.ForksAndStraightaways-759"><span class="linenos">759</span></a>							<span class="n">StepSizes</span><span class="o">.</span><span class="n">Forks</span><span class="p">()</span><span class="o">.</span><span class="n">_step_single_indices</span><span class="p">(</span><span class="n">maze</span><span class="p">),</span>
</span><span id="StepSizes.ForksAndStraightaways-760"><a href="#StepSizes.ForksAndStraightaways-760"><span class="linenos">760</span></a>						<span class="p">),</span>
</span><span id="StepSizes.ForksAndStraightaways-761"><a href="#StepSizes.ForksAndStraightaways-761"><span class="linenos">761</span></a>					<span class="p">),</span>
</span><span id="StepSizes.ForksAndStraightaways-762"><a href="#StepSizes.ForksAndStraightaways-762"><span class="linenos">762</span></a>				<span class="p">),</span>
</span><span id="StepSizes.ForksAndStraightaways-763"><a href="#StepSizes.ForksAndStraightaways-763"><span class="linenos">763</span></a>			<span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Includes the union of the coords included by <code><a href="#StepSizes.Forks">Forks</a></code> and <code><a href="#StepSizes.Straightaways">Straightaways</a></code>.</p>

<p>See documentation for those classes for details.</p>
</div>


                            <div id="StepSizes.ForksAndStraightaways.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">StepSizes.ForksAndStraightaways</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#StepSizes.ForksAndStraightaways">StepSizes.ForksAndStraightaways</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#StepSizes.ForksAndStraightaways">StepSizes.ForksAndStraightaways</a>&#39;&gt;&quot;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#StepSizes.ForksAndStraightaways.__init__"></a>
    
    

                            </div>
                            <div id="StepSizes.ForksAndStraightaways.is_valid" class="classattr">
                                        <input id="StepSizes.ForksAndStraightaways.is_valid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_valid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.ForksAndStraightaways.is_valid-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L256-L265" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.ForksAndStraightaways.is_valid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.ForksAndStraightaways.is_valid-257"><a href="#StepSizes.ForksAndStraightaways.is_valid-257"><span class="linenos">257</span></a><span class="k">def</span><span class="w"> </span><span class="nf">_unsupported_is_invalid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># noqa: ANN001</span>
</span><span id="StepSizes.ForksAndStraightaways.is_valid-258"><a href="#StepSizes.ForksAndStraightaways.is_valid-258"><span class="linenos">258</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Default implementation of `is_valid` for `mark_as_unsupported`-decorated classes&quot;&quot;&quot;</span>
</span><span id="StepSizes.ForksAndStraightaways.is_valid-259"><a href="#StepSizes.ForksAndStraightaways.is_valid-259"><span class="linenos">259</span></a>	<span class="k">if</span> <span class="n">do_except</span><span class="p">:</span>
</span><span id="StepSizes.ForksAndStraightaways.is_valid-260"><a href="#StepSizes.ForksAndStraightaways.is_valid-260"><span class="linenos">260</span></a>		<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways.is_valid-261"><a href="#StepSizes.ForksAndStraightaways.is_valid-261"><span class="linenos">261</span></a>			<span class="sa">f</span><span class="s2">&quot;Class `</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2">, marked as unsupported, is not valid.&quot;</span>
</span><span id="StepSizes.ForksAndStraightaways.is_valid-262"><a href="#StepSizes.ForksAndStraightaways.is_valid-262"><span class="linenos">262</span></a>			<span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.ForksAndStraightaways.is_valid-263"><a href="#StepSizes.ForksAndStraightaways.is_valid-263"><span class="linenos">263</span></a>		<span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.is_valid-264"><a href="#StepSizes.ForksAndStraightaways.is_valid-264"><span class="linenos">264</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.is_valid-265"><a href="#StepSizes.ForksAndStraightaways.is_valid-265"><span class="linenos">265</span></a>
</span><span id="StepSizes.ForksAndStraightaways.is_valid-266"><a href="#StepSizes.ForksAndStraightaways.is_valid-266"><span class="linenos">266</span></a>	<span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Default implementation of <code><a href="#StepSizes.ForksAndStraightaways.is_valid">is_valid</a></code> for <code>mark_as_unsupported</code>-decorated classes</p>
</div>


                            </div>
                            <div id="StepSizes.ForksAndStraightaways.serialize" class="classattr">
                                        <input id="StepSizes.ForksAndStraightaways.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.ForksAndStraightaways.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L713-L769" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.ForksAndStraightaways.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.ForksAndStraightaways.serialize-714"><a href="#StepSizes.ForksAndStraightaways.serialize-714"><span class="linenos">714</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-715"><a href="#StepSizes.ForksAndStraightaways.serialize-715"><span class="linenos">715</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-716"><a href="#StepSizes.ForksAndStraightaways.serialize-716"><span class="linenos">716</span></a>                <span class="n">_FORMAT_KEY</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-717"><a href="#StepSizes.ForksAndStraightaways.serialize-717"><span class="linenos">717</span></a>            <span class="p">}</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-718"><a href="#StepSizes.ForksAndStraightaways.serialize-718"><span class="linenos">718</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-719"><a href="#StepSizes.ForksAndStraightaways.serialize-719"><span class="linenos">719</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-720"><a href="#StepSizes.ForksAndStraightaways.serialize-720"><span class="linenos">720</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-721"><a href="#StepSizes.ForksAndStraightaways.serialize-721"><span class="linenos">721</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-722"><a href="#StepSizes.ForksAndStraightaways.serialize-722"><span class="linenos">722</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-723"><a href="#StepSizes.ForksAndStraightaways.serialize-723"><span class="linenos">723</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-724"><a href="#StepSizes.ForksAndStraightaways.serialize-724"><span class="linenos">724</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-725"><a href="#StepSizes.ForksAndStraightaways.serialize-725"><span class="linenos">725</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-726"><a href="#StepSizes.ForksAndStraightaways.serialize-726"><span class="linenos">726</span></a>                    <span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-727"><a href="#StepSizes.ForksAndStraightaways.serialize-727"><span class="linenos">727</span></a>
</span><span id="StepSizes.ForksAndStraightaways.serialize-728"><a href="#StepSizes.ForksAndStraightaways.serialize-728"><span class="linenos">728</span></a>                <span class="c1"># try to save it</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-729"><a href="#StepSizes.ForksAndStraightaways.serialize-729"><span class="linenos">729</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-730"><a href="#StepSizes.ForksAndStraightaways.serialize-730"><span class="linenos">730</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-731"><a href="#StepSizes.ForksAndStraightaways.serialize-731"><span class="linenos">731</span></a>                        <span class="c1"># get the val</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-732"><a href="#StepSizes.ForksAndStraightaways.serialize-732"><span class="linenos">732</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-733"><a href="#StepSizes.ForksAndStraightaways.serialize-733"><span class="linenos">733</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-734"><a href="#StepSizes.ForksAndStraightaways.serialize-734"><span class="linenos">734</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-735"><a href="#StepSizes.ForksAndStraightaways.serialize-735"><span class="linenos">735</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-736"><a href="#StepSizes.ForksAndStraightaways.serialize-736"><span class="linenos">736</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-737"><a href="#StepSizes.ForksAndStraightaways.serialize-737"><span class="linenos">737</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-738"><a href="#StepSizes.ForksAndStraightaways.serialize-738"><span class="linenos">738</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-739"><a href="#StepSizes.ForksAndStraightaways.serialize-739"><span class="linenos">739</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-740"><a href="#StepSizes.ForksAndStraightaways.serialize-740"><span class="linenos">740</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-741"><a href="#StepSizes.ForksAndStraightaways.serialize-741"><span class="linenos">741</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-742"><a href="#StepSizes.ForksAndStraightaways.serialize-742"><span class="linenos">742</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-743"><a href="#StepSizes.ForksAndStraightaways.serialize-743"><span class="linenos">743</span></a>
</span><span id="StepSizes.ForksAndStraightaways.serialize-744"><a href="#StepSizes.ForksAndStraightaways.serialize-744"><span class="linenos">744</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-745"><a href="#StepSizes.ForksAndStraightaways.serialize-745"><span class="linenos">745</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-746"><a href="#StepSizes.ForksAndStraightaways.serialize-746"><span class="linenos">746</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-747"><a href="#StepSizes.ForksAndStraightaways.serialize-747"><span class="linenos">747</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-748"><a href="#StepSizes.ForksAndStraightaways.serialize-748"><span class="linenos">748</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-749"><a href="#StepSizes.ForksAndStraightaways.serialize-749"><span class="linenos">749</span></a>                                <span class="p">[</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-750"><a href="#StepSizes.ForksAndStraightaways.serialize-750"><span class="linenos">750</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-751"><a href="#StepSizes.ForksAndStraightaways.serialize-751"><span class="linenos">751</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-752"><a href="#StepSizes.ForksAndStraightaways.serialize-752"><span class="linenos">752</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-753"><a href="#StepSizes.ForksAndStraightaways.serialize-753"><span class="linenos">753</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-754"><a href="#StepSizes.ForksAndStraightaways.serialize-754"><span class="linenos">754</span></a>                                <span class="p">]</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-755"><a href="#StepSizes.ForksAndStraightaways.serialize-755"><span class="linenos">755</span></a>                            <span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-756"><a href="#StepSizes.ForksAndStraightaways.serialize-756"><span class="linenos">756</span></a>                        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-757"><a href="#StepSizes.ForksAndStraightaways.serialize-757"><span class="linenos">757</span></a>
</span><span id="StepSizes.ForksAndStraightaways.serialize-758"><a href="#StepSizes.ForksAndStraightaways.serialize-758"><span class="linenos">758</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-759"><a href="#StepSizes.ForksAndStraightaways.serialize-759"><span class="linenos">759</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-760"><a href="#StepSizes.ForksAndStraightaways.serialize-760"><span class="linenos">760</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-761"><a href="#StepSizes.ForksAndStraightaways.serialize-761"><span class="linenos">761</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-762"><a href="#StepSizes.ForksAndStraightaways.serialize-762"><span class="linenos">762</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-763"><a href="#StepSizes.ForksAndStraightaways.serialize-763"><span class="linenos">763</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-764"><a href="#StepSizes.ForksAndStraightaways.serialize-764"><span class="linenos">764</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-765"><a href="#StepSizes.ForksAndStraightaways.serialize-765"><span class="linenos">765</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-766"><a href="#StepSizes.ForksAndStraightaways.serialize-766"><span class="linenos">766</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-767"><a href="#StepSizes.ForksAndStraightaways.serialize-767"><span class="linenos">767</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-768"><a href="#StepSizes.ForksAndStraightaways.serialize-768"><span class="linenos">768</span></a>                    <span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-769"><a href="#StepSizes.ForksAndStraightaways.serialize-769"><span class="linenos">769</span></a>
</span><span id="StepSizes.ForksAndStraightaways.serialize-770"><a href="#StepSizes.ForksAndStraightaways.serialize-770"><span class="linenos">770</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="StepSizes.ForksAndStraightaways.load" class="classattr">
                                        <input id="StepSizes.ForksAndStraightaways.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.ForksAndStraightaways.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L776-L862" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.ForksAndStraightaways.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.ForksAndStraightaways.load-777"><a href="#StepSizes.ForksAndStraightaways.load-777"><span class="linenos">777</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="StepSizes.ForksAndStraightaways.load-778"><a href="#StepSizes.ForksAndStraightaways.load-778"><span class="linenos">778</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="StepSizes.ForksAndStraightaways.load-779"><a href="#StepSizes.ForksAndStraightaways.load-779"><span class="linenos">779</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="StepSizes.ForksAndStraightaways.load-780"><a href="#StepSizes.ForksAndStraightaways.load-780"><span class="linenos">780</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="StepSizes.ForksAndStraightaways.load-781"><a href="#StepSizes.ForksAndStraightaways.load-781"><span class="linenos">781</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="StepSizes.ForksAndStraightaways.load-782"><a href="#StepSizes.ForksAndStraightaways.load-782"><span class="linenos">782</span></a>
</span><span id="StepSizes.ForksAndStraightaways.load-783"><a href="#StepSizes.ForksAndStraightaways.load-783"><span class="linenos">783</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways.load-784"><a href="#StepSizes.ForksAndStraightaways.load-784"><span class="linenos">784</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="StepSizes.ForksAndStraightaways.load-785"><a href="#StepSizes.ForksAndStraightaways.load-785"><span class="linenos">785</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.ForksAndStraightaways.load-786"><a href="#StepSizes.ForksAndStraightaways.load-786"><span class="linenos">786</span></a>
</span><span id="StepSizes.ForksAndStraightaways.load-787"><a href="#StepSizes.ForksAndStraightaways.load-787"><span class="linenos">787</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.load-788"><a href="#StepSizes.ForksAndStraightaways.load-788"><span class="linenos">788</span></a>
</span><span id="StepSizes.ForksAndStraightaways.load-789"><a href="#StepSizes.ForksAndStraightaways.load-789"><span class="linenos">789</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="StepSizes.ForksAndStraightaways.load-790"><a href="#StepSizes.ForksAndStraightaways.load-790"><span class="linenos">790</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="StepSizes.ForksAndStraightaways.load-791"><a href="#StepSizes.ForksAndStraightaways.load-791"><span class="linenos">791</span></a>
</span><span id="StepSizes.ForksAndStraightaways.load-792"><a href="#StepSizes.ForksAndStraightaways.load-792"><span class="linenos">792</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="StepSizes.ForksAndStraightaways.load-793"><a href="#StepSizes.ForksAndStraightaways.load-793"><span class="linenos">793</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="StepSizes.ForksAndStraightaways.load-794"><a href="#StepSizes.ForksAndStraightaways.load-794"><span class="linenos">794</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="StepSizes.ForksAndStraightaways.load-795"><a href="#StepSizes.ForksAndStraightaways.load-795"><span class="linenos">795</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways.load-796"><a href="#StepSizes.ForksAndStraightaways.load-796"><span class="linenos">796</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="StepSizes.ForksAndStraightaways.load-797"><a href="#StepSizes.ForksAndStraightaways.load-797"><span class="linenos">797</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="StepSizes.ForksAndStraightaways.load-798"><a href="#StepSizes.ForksAndStraightaways.load-798"><span class="linenos">798</span></a>
</span><span id="StepSizes.ForksAndStraightaways.load-799"><a href="#StepSizes.ForksAndStraightaways.load-799"><span class="linenos">799</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="StepSizes.ForksAndStraightaways.load-800"><a href="#StepSizes.ForksAndStraightaways.load-800"><span class="linenos">800</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="StepSizes.ForksAndStraightaways.load-801"><a href="#StepSizes.ForksAndStraightaways.load-801"><span class="linenos">801</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="StepSizes.ForksAndStraightaways.load-802"><a href="#StepSizes.ForksAndStraightaways.load-802"><span class="linenos">802</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="StepSizes.ForksAndStraightaways.load-803"><a href="#StepSizes.ForksAndStraightaways.load-803"><span class="linenos">803</span></a>
</span><span id="StepSizes.ForksAndStraightaways.load-804"><a href="#StepSizes.ForksAndStraightaways.load-804"><span class="linenos">804</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="StepSizes.ForksAndStraightaways.load-805"><a href="#StepSizes.ForksAndStraightaways.load-805"><span class="linenos">805</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.load-806"><a href="#StepSizes.ForksAndStraightaways.load-806"><span class="linenos">806</span></a>
</span><span id="StepSizes.ForksAndStraightaways.load-807"><a href="#StepSizes.ForksAndStraightaways.load-807"><span class="linenos">807</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="StepSizes.ForksAndStraightaways.load-808"><a href="#StepSizes.ForksAndStraightaways.load-808"><span class="linenos">808</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="StepSizes.ForksAndStraightaways.load-809"><a href="#StepSizes.ForksAndStraightaways.load-809"><span class="linenos">809</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="StepSizes.ForksAndStraightaways.load-810"><a href="#StepSizes.ForksAndStraightaways.load-810"><span class="linenos">810</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.load-811"><a href="#StepSizes.ForksAndStraightaways.load-811"><span class="linenos">811</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="StepSizes.ForksAndStraightaways.load-812"><a href="#StepSizes.ForksAndStraightaways.load-812"><span class="linenos">812</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="StepSizes.ForksAndStraightaways.load-813"><a href="#StepSizes.ForksAndStraightaways.load-813"><span class="linenos">813</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.load-814"><a href="#StepSizes.ForksAndStraightaways.load-814"><span class="linenos">814</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways.load-815"><a href="#StepSizes.ForksAndStraightaways.load-815"><span class="linenos">815</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="StepSizes.ForksAndStraightaways.load-816"><a href="#StepSizes.ForksAndStraightaways.load-816"><span class="linenos">816</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.load-817"><a href="#StepSizes.ForksAndStraightaways.load-817"><span class="linenos">817</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.load-818"><a href="#StepSizes.ForksAndStraightaways.load-818"><span class="linenos">818</span></a>                    <span class="p">):</span>
</span><span id="StepSizes.ForksAndStraightaways.load-819"><a href="#StepSizes.ForksAndStraightaways.load-819"><span class="linenos">819</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="StepSizes.ForksAndStraightaways.load-820"><a href="#StepSizes.ForksAndStraightaways.load-820"><span class="linenos">820</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="StepSizes.ForksAndStraightaways.load-821"><a href="#StepSizes.ForksAndStraightaways.load-821"><span class="linenos">821</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.load-822"><a href="#StepSizes.ForksAndStraightaways.load-822"><span class="linenos">822</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="StepSizes.ForksAndStraightaways.load-823"><a href="#StepSizes.ForksAndStraightaways.load-823"><span class="linenos">823</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways.load-824"><a href="#StepSizes.ForksAndStraightaways.load-824"><span class="linenos">824</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.ForksAndStraightaways.load-825"><a href="#StepSizes.ForksAndStraightaways.load-825"><span class="linenos">825</span></a>                            <span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.load-826"><a href="#StepSizes.ForksAndStraightaways.load-826"><span class="linenos">826</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="StepSizes.ForksAndStraightaways.load-827"><a href="#StepSizes.ForksAndStraightaways.load-827"><span class="linenos">827</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="StepSizes.ForksAndStraightaways.load-828"><a href="#StepSizes.ForksAndStraightaways.load-828"><span class="linenos">828</span></a>                        <span class="k">pass</span>
</span><span id="StepSizes.ForksAndStraightaways.load-829"><a href="#StepSizes.ForksAndStraightaways.load-829"><span class="linenos">829</span></a>
</span><span id="StepSizes.ForksAndStraightaways.load-830"><a href="#StepSizes.ForksAndStraightaways.load-830"><span class="linenos">830</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="StepSizes.ForksAndStraightaways.load-831"><a href="#StepSizes.ForksAndStraightaways.load-831"><span class="linenos">831</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepSizes.ForksAndStraightaways.load-832"><a href="#StepSizes.ForksAndStraightaways.load-832"><span class="linenos">832</span></a>
</span><span id="StepSizes.ForksAndStraightaways.load-833"><a href="#StepSizes.ForksAndStraightaways.load-833"><span class="linenos">833</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="StepSizes.ForksAndStraightaways.load-834"><a href="#StepSizes.ForksAndStraightaways.load-834"><span class="linenos">834</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.load-835"><a href="#StepSizes.ForksAndStraightaways.load-835"><span class="linenos">835</span></a>
</span><span id="StepSizes.ForksAndStraightaways.load-836"><a href="#StepSizes.ForksAndStraightaways.load-836"><span class="linenos">836</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="StepSizes.ForksAndStraightaways.load-837"><a href="#StepSizes.ForksAndStraightaways.load-837"><span class="linenos">837</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="StepSizes.ForksAndStraightaways.load-838"><a href="#StepSizes.ForksAndStraightaways.load-838"><span class="linenos">838</span></a>                <span class="n">fields_valid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways.load-839"><a href="#StepSizes.ForksAndStraightaways.load-839"><span class="linenos">839</span></a>                    <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways.load-840"><a href="#StepSizes.ForksAndStraightaways.load-840"><span class="linenos">840</span></a>                        <span class="n">output</span><span class="p">,</span>
</span><span id="StepSizes.ForksAndStraightaways.load-841"><a href="#StepSizes.ForksAndStraightaways.load-841"><span class="linenos">841</span></a>                        <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">,</span>
</span><span id="StepSizes.ForksAndStraightaways.load-842"><a href="#StepSizes.ForksAndStraightaways.load-842"><span class="linenos">842</span></a>                    <span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.load-843"><a href="#StepSizes.ForksAndStraightaways.load-843"><span class="linenos">843</span></a>                <span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.load-844"><a href="#StepSizes.ForksAndStraightaways.load-844"><span class="linenos">844</span></a>
</span><span id="StepSizes.ForksAndStraightaways.load-845"><a href="#StepSizes.ForksAndStraightaways.load-845"><span class="linenos">845</span></a>                <span class="c1"># if there are any fields that are not valid, raise an error</span>
</span><span id="StepSizes.ForksAndStraightaways.load-846"><a href="#StepSizes.ForksAndStraightaways.load-846"><span class="linenos">846</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">fields_valid</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="StepSizes.ForksAndStraightaways.load-847"><a href="#StepSizes.ForksAndStraightaways.load-847"><span class="linenos">847</span></a>                    <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways.load-848"><a href="#StepSizes.ForksAndStraightaways.load-848"><span class="linenos">848</span></a>                        <span class="sa">f</span><span class="s2">&quot;Type mismatch in fields of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="StepSizes.ForksAndStraightaways.load-849"><a href="#StepSizes.ForksAndStraightaways.load-849"><span class="linenos">849</span></a>                        <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways.load-850"><a href="#StepSizes.ForksAndStraightaways.load-850"><span class="linenos">850</span></a>                            <span class="p">[</span>
</span><span id="StepSizes.ForksAndStraightaways.load-851"><a href="#StepSizes.ForksAndStraightaways.load-851"><span class="linenos">851</span></a>                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">:</span><span class="se">\t</span><span class="s2">expected </span><span class="si">{</span><span class="n">cls_type_hints</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="si">= }</span><span class="s2">, but got value </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.ForksAndStraightaways.load-852"><a href="#StepSizes.ForksAndStraightaways.load-852"><span class="linenos">852</span></a>                                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">fields_valid</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="StepSizes.ForksAndStraightaways.load-853"><a href="#StepSizes.ForksAndStraightaways.load-853"><span class="linenos">853</span></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span>
</span><span id="StepSizes.ForksAndStraightaways.load-854"><a href="#StepSizes.ForksAndStraightaways.load-854"><span class="linenos">854</span></a>                            <span class="p">]</span>
</span><span id="StepSizes.ForksAndStraightaways.load-855"><a href="#StepSizes.ForksAndStraightaways.load-855"><span class="linenos">855</span></a>                        <span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.load-856"><a href="#StepSizes.ForksAndStraightaways.load-856"><span class="linenos">856</span></a>                    <span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.load-857"><a href="#StepSizes.ForksAndStraightaways.load-857"><span class="linenos">857</span></a>
</span><span id="StepSizes.ForksAndStraightaways.load-858"><a href="#StepSizes.ForksAndStraightaways.load-858"><span class="linenos">858</span></a>                    <span class="n">on_typecheck_mismatch</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways.load-859"><a href="#StepSizes.ForksAndStraightaways.load-859"><span class="linenos">859</span></a>                        <span class="n">msg</span><span class="p">,</span> <span class="n">except_cls</span><span class="o">=</span><span class="n">FieldTypeMismatchError</span>
</span><span id="StepSizes.ForksAndStraightaways.load-860"><a href="#StepSizes.ForksAndStraightaways.load-860"><span class="linenos">860</span></a>                    <span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.load-861"><a href="#StepSizes.ForksAndStraightaways.load-861"><span class="linenos">861</span></a>
</span><span id="StepSizes.ForksAndStraightaways.load-862"><a href="#StepSizes.ForksAndStraightaways.load-862"><span class="linenos">862</span></a>            <span class="c1"># return the new instance</span>
</span><span id="StepSizes.ForksAndStraightaways.load-863"><a href="#StepSizes.ForksAndStraightaways.load-863"><span class="linenos">863</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="StepSizes.ForksAndStraightaways.validate_fields_types" class="classattr">
                                        <input id="StepSizes.ForksAndStraightaways.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.ForksAndStraightaways.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L282-L291" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.ForksAndStraightaways.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.ForksAndStraightaways.validate_fields_types-283"><a href="#StepSizes.ForksAndStraightaways.validate_fields_types-283"><span class="linenos">283</span></a><span class="k">def</span><span class="w"> </span><span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways.validate_fields_types-284"><a href="#StepSizes.ForksAndStraightaways.validate_fields_types-284"><span class="linenos">284</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="StepSizes.ForksAndStraightaways.validate_fields_types-285"><a href="#StepSizes.ForksAndStraightaways.validate_fields_types-285"><span class="linenos">285</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="StepSizes.ForksAndStraightaways.validate_fields_types-286"><a href="#StepSizes.ForksAndStraightaways.validate_fields_types-286"><span class="linenos">286</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="StepSizes.ForksAndStraightaways.validate_fields_types-287"><a href="#StepSizes.ForksAndStraightaways.validate_fields_types-287"><span class="linenos">287</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="StepSizes.ForksAndStraightaways.validate_fields_types-288"><a href="#StepSizes.ForksAndStraightaways.validate_fields_types-288"><span class="linenos">288</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways.validate_fields_types-289"><a href="#StepSizes.ForksAndStraightaways.validate_fields_types-289"><span class="linenos">289</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways.validate_fields_types-290"><a href="#StepSizes.ForksAndStraightaways.validate_fields_types-290"><span class="linenos">290</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="StepSizes.ForksAndStraightaways.validate_fields_types-291"><a href="#StepSizes.ForksAndStraightaways.validate_fields_types-291"><span class="linenos">291</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="StepSizes.ForksAndStraightaways.validate_fields_types-292"><a href="#StepSizes.ForksAndStraightaways.validate_fields_types-292"><span class="linenos">292</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#StepSizes._StepSize">StepSizes._StepSize</a></dt>
                                <dd id="StepSizes.ForksAndStraightaways.attribute_key" class="function"><a href="#StepSizes._StepSize.attribute_key">attribute_key</a></dd>
                <dd id="StepSizes.ForksAndStraightaways.step_start_end_indices" class="function"><a href="#StepSizes._StepSize.step_start_end_indices">step_start_end_indices</a></dd>

            </div>
            <div><dt><a href="element_base.html#_TokenizerElement">maze_dataset.tokenization.modular.element_base._TokenizerElement</a></dt>
                                <dd id="StepSizes.ForksAndStraightaways.name" class="variable"><a href="element_base.html#_TokenizerElement.name">name</a></dd>
                <dd id="StepSizes.ForksAndStraightaways.tokenizer_elements" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="StepSizes.ForksAndStraightaways.tokenizer_element_tree" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="StepSizes.ForksAndStraightaways.tokenizer_element_dict" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>
                <dd id="StepSizes.ForksAndStraightaways.to_tokens" class="function"><a href="element_base.html#_TokenizerElement.to_tokens">to_tokens</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="StepSizes.ForksAndStraightaways.validate_field_type" class="function">validate_field_type</dd>
                <dd id="StepSizes.ForksAndStraightaways.diff" class="function">diff</dd>
                <dd id="StepSizes.ForksAndStraightaways.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="StepTokenizers">
                            <input id="StepTokenizers-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">StepTokenizers</span><wbr>(<span class="base"><a href="element_base.html#__TokenizerElementNamespace">maze_dataset.tokenization.modular.element_base.__TokenizerElementNamespace</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L765-L900" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers-766"><a href="#StepTokenizers-766"><span class="linenos">766</span></a><span class="k">class</span><span class="w"> </span><span class="nc">StepTokenizers</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="StepTokenizers-767"><a href="#StepTokenizers-767"><span class="linenos">767</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Namespace for `_StepTokenizer` subclass hierarchy used by `MazeTokenizerModular`.&quot;&quot;&quot;</span>
</span><span id="StepTokenizers-768"><a href="#StepTokenizers-768"><span class="linenos">768</span></a>
</span><span id="StepTokenizers-769"><a href="#StepTokenizers-769"><span class="linenos">769</span></a>	<span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;step_tokenizers&quot;</span>
</span><span id="StepTokenizers-770"><a href="#StepTokenizers-770"><span class="linenos">770</span></a>
</span><span id="StepTokenizers-771"><a href="#StepTokenizers-771"><span class="linenos">771</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepTokenizers-772"><a href="#StepTokenizers-772"><span class="linenos">772</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">_StepTokenizer</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="StepTokenizers-773"><a href="#StepTokenizers-773"><span class="linenos">773</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Specifies how a single step (as specified by an instance of `_StepSize`) is tokenized.&quot;&quot;&quot;</span>
</span><span id="StepTokenizers-774"><a href="#StepTokenizers-774"><span class="linenos">774</span></a>
</span><span id="StepTokenizers-775"><a href="#StepTokenizers-775"><span class="linenos">775</span></a>		<span class="nd">@classmethod</span>
</span><span id="StepTokenizers-776"><a href="#StepTokenizers-776"><span class="linenos">776</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="StepTokenizers-777"><a href="#StepTokenizers-777"><span class="linenos">777</span></a>			<span class="k">return</span> <span class="n">StepTokenizers</span><span class="o">.</span><span class="n">key</span>
</span><span id="StepTokenizers-778"><a href="#StepTokenizers-778"><span class="linenos">778</span></a>
</span><span id="StepTokenizers-779"><a href="#StepTokenizers-779"><span class="linenos">779</span></a>		<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="StepTokenizers-780"><a href="#StepTokenizers-780"><span class="linenos">780</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="StepTokenizers-781"><a href="#StepTokenizers-781"><span class="linenos">781</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="StepTokenizers-782"><a href="#StepTokenizers-782"><span class="linenos">782</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="StepTokenizers-783"><a href="#StepTokenizers-783"><span class="linenos">783</span></a>			<span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers-784"><a href="#StepTokenizers-784"><span class="linenos">784</span></a>			<span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers-785"><a href="#StepTokenizers-785"><span class="linenos">785</span></a>			<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="StepTokenizers-786"><a href="#StepTokenizers-786"><span class="linenos">786</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="StepTokenizers-787"><a href="#StepTokenizers-787"><span class="linenos">787</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Tokenizes a single step in the solution.</span>
</span><span id="StepTokenizers-788"><a href="#StepTokenizers-788"><span class="linenos">788</span></a>
</span><span id="StepTokenizers-789"><a href="#StepTokenizers-789"><span class="linenos">789</span></a><span class="sd">			# Parameters</span>
</span><span id="StepTokenizers-790"><a href="#StepTokenizers-790"><span class="linenos">790</span></a><span class="sd">			- `maze`: Maze to be tokenized</span>
</span><span id="StepTokenizers-791"><a href="#StepTokenizers-791"><span class="linenos">791</span></a><span class="sd">			- `start_index`: The index of the Coord in `maze.solution` at which the current step starts</span>
</span><span id="StepTokenizers-792"><a href="#StepTokenizers-792"><span class="linenos">792</span></a><span class="sd">			- `end_index`: The index of the Coord in `maze.solution` at which the current step ends</span>
</span><span id="StepTokenizers-793"><a href="#StepTokenizers-793"><span class="linenos">793</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="StepTokenizers-794"><a href="#StepTokenizers-794"><span class="linenos">794</span></a>			<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="StepTokenizers-795"><a href="#StepTokenizers-795"><span class="linenos">795</span></a>				<span class="s2">&quot;Subclasses must implement `StepTokenizer.to_tokens.&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers-796"><a href="#StepTokenizers-796"><span class="linenos">796</span></a>			<span class="p">)</span>
</span><span id="StepTokenizers-797"><a href="#StepTokenizers-797"><span class="linenos">797</span></a>
</span><span id="StepTokenizers-798"><a href="#StepTokenizers-798"><span class="linenos">798</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="StepTokenizers-799"><a href="#StepTokenizers-799"><span class="linenos">799</span></a>			<span class="c1"># No invalid instances possible within data member type hint bounds</span>
</span><span id="StepTokenizers-800"><a href="#StepTokenizers-800"><span class="linenos">800</span></a>			<span class="k">return</span> <span class="kc">True</span>
</span><span id="StepTokenizers-801"><a href="#StepTokenizers-801"><span class="linenos">801</span></a>
</span><span id="StepTokenizers-802"><a href="#StepTokenizers-802"><span class="linenos">802</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepTokenizers-803"><a href="#StepTokenizers-803"><span class="linenos">803</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">Coord</span><span class="p">(</span><span class="n">_StepTokenizer</span><span class="p">):</span>
</span><span id="StepTokenizers-804"><a href="#StepTokenizers-804"><span class="linenos">804</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;A direct tokenization of the end position coord represents the step.&quot;&quot;&quot;</span>
</span><span id="StepTokenizers-805"><a href="#StepTokenizers-805"><span class="linenos">805</span></a>
</span><span id="StepTokenizers-806"><a href="#StepTokenizers-806"><span class="linenos">806</span></a>		<span class="c1"># inherit docstring</span>
</span><span id="StepTokenizers-807"><a href="#StepTokenizers-807"><span class="linenos">807</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>  <span class="c1"># noqa: D102</span>
</span><span id="StepTokenizers-808"><a href="#StepTokenizers-808"><span class="linenos">808</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="StepTokenizers-809"><a href="#StepTokenizers-809"><span class="linenos">809</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="StepTokenizers-810"><a href="#StepTokenizers-810"><span class="linenos">810</span></a>			<span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers-811"><a href="#StepTokenizers-811"><span class="linenos">811</span></a>			<span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers-812"><a href="#StepTokenizers-812"><span class="linenos">812</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="StepTokenizers-813"><a href="#StepTokenizers-813"><span class="linenos">813</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="StepTokenizers-814"><a href="#StepTokenizers-814"><span class="linenos">814</span></a>			<span class="k">return</span> <span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">end_index</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span>
</span><span id="StepTokenizers-815"><a href="#StepTokenizers-815"><span class="linenos">815</span></a>
</span><span id="StepTokenizers-816"><a href="#StepTokenizers-816"><span class="linenos">816</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepTokenizers-817"><a href="#StepTokenizers-817"><span class="linenos">817</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">Cardinal</span><span class="p">(</span><span class="n">_StepTokenizer</span><span class="p">):</span>
</span><span id="StepTokenizers-818"><a href="#StepTokenizers-818"><span class="linenos">818</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;A step is tokenized with a cardinal direction token.</span>
</span><span id="StepTokenizers-819"><a href="#StepTokenizers-819"><span class="linenos">819</span></a>
</span><span id="StepTokenizers-820"><a href="#StepTokenizers-820"><span class="linenos">820</span></a><span class="sd">		It is the direction of the step from the starting position along the solution.</span>
</span><span id="StepTokenizers-821"><a href="#StepTokenizers-821"><span class="linenos">821</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="StepTokenizers-822"><a href="#StepTokenizers-822"><span class="linenos">822</span></a>
</span><span id="StepTokenizers-823"><a href="#StepTokenizers-823"><span class="linenos">823</span></a>		<span class="c1"># inherit docstring</span>
</span><span id="StepTokenizers-824"><a href="#StepTokenizers-824"><span class="linenos">824</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>  <span class="c1"># noqa: D102</span>
</span><span id="StepTokenizers-825"><a href="#StepTokenizers-825"><span class="linenos">825</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="StepTokenizers-826"><a href="#StepTokenizers-826"><span class="linenos">826</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="StepTokenizers-827"><a href="#StepTokenizers-827"><span class="linenos">827</span></a>			<span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers-828"><a href="#StepTokenizers-828"><span class="linenos">828</span></a>			<span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers-829"><a href="#StepTokenizers-829"><span class="linenos">829</span></a>			<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="StepTokenizers-830"><a href="#StepTokenizers-830"><span class="linenos">830</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="StepTokenizers-831"><a href="#StepTokenizers-831"><span class="linenos">831</span></a>			<span class="k">return</span> <span class="p">[</span>
</span><span id="StepTokenizers-832"><a href="#StepTokenizers-832"><span class="linenos">832</span></a>				<span class="n">get_cardinal_direction</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">start_index</span> <span class="p">:</span> <span class="n">start_index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]),</span>
</span><span id="StepTokenizers-833"><a href="#StepTokenizers-833"><span class="linenos">833</span></a>			<span class="p">]</span>
</span><span id="StepTokenizers-834"><a href="#StepTokenizers-834"><span class="linenos">834</span></a>
</span><span id="StepTokenizers-835"><a href="#StepTokenizers-835"><span class="linenos">835</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepTokenizers-836"><a href="#StepTokenizers-836"><span class="linenos">836</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">Relative</span><span class="p">(</span><span class="n">_StepTokenizer</span><span class="p">):</span>
</span><span id="StepTokenizers-837"><a href="#StepTokenizers-837"><span class="linenos">837</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Tokenizes a solution step using relative first-person directions (right, left, forward, etc.).</span>
</span><span id="StepTokenizers-838"><a href="#StepTokenizers-838"><span class="linenos">838</span></a>
</span><span id="StepTokenizers-839"><a href="#StepTokenizers-839"><span class="linenos">839</span></a><span class="sd">		To simplify the indeterminacy, at the start of a solution the &quot;agent&quot; solving the maze is assumed to be facing NORTH.</span>
</span><span id="StepTokenizers-840"><a href="#StepTokenizers-840"><span class="linenos">840</span></a><span class="sd">		Similarly to `Cardinal`, the direction is that of the step from the starting position.</span>
</span><span id="StepTokenizers-841"><a href="#StepTokenizers-841"><span class="linenos">841</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="StepTokenizers-842"><a href="#StepTokenizers-842"><span class="linenos">842</span></a>
</span><span id="StepTokenizers-843"><a href="#StepTokenizers-843"><span class="linenos">843</span></a>		<span class="c1"># inherit docstring</span>
</span><span id="StepTokenizers-844"><a href="#StepTokenizers-844"><span class="linenos">844</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>  <span class="c1"># noqa: D102</span>
</span><span id="StepTokenizers-845"><a href="#StepTokenizers-845"><span class="linenos">845</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="StepTokenizers-846"><a href="#StepTokenizers-846"><span class="linenos">846</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="StepTokenizers-847"><a href="#StepTokenizers-847"><span class="linenos">847</span></a>			<span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers-848"><a href="#StepTokenizers-848"><span class="linenos">848</span></a>			<span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers-849"><a href="#StepTokenizers-849"><span class="linenos">849</span></a>			<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="StepTokenizers-850"><a href="#StepTokenizers-850"><span class="linenos">850</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="StepTokenizers-851"><a href="#StepTokenizers-851"><span class="linenos">851</span></a>			<span class="k">if</span> <span class="n">start_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="StepTokenizers-852"><a href="#StepTokenizers-852"><span class="linenos">852</span></a>				<span class="n">start</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="StepTokenizers-853"><a href="#StepTokenizers-853"><span class="linenos">853</span></a>				<span class="n">previous</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="StepTokenizers-854"><a href="#StepTokenizers-854"><span class="linenos">854</span></a>				<span class="k">return</span> <span class="p">[</span>
</span><span id="StepTokenizers-855"><a href="#StepTokenizers-855"><span class="linenos">855</span></a>					<span class="n">get_relative_direction</span><span class="p">(</span>
</span><span id="StepTokenizers-856"><a href="#StepTokenizers-856"><span class="linenos">856</span></a>						<span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="StepTokenizers-857"><a href="#StepTokenizers-857"><span class="linenos">857</span></a>							<span class="p">(</span>
</span><span id="StepTokenizers-858"><a href="#StepTokenizers-858"><span class="linenos">858</span></a>								<span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">previous</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span><span id="StepTokenizers-859"><a href="#StepTokenizers-859"><span class="linenos">859</span></a>								<span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">start_index</span> <span class="p">:</span> <span class="n">start_index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">],</span>
</span><span id="StepTokenizers-860"><a href="#StepTokenizers-860"><span class="linenos">860</span></a>							<span class="p">),</span>
</span><span id="StepTokenizers-861"><a href="#StepTokenizers-861"><span class="linenos">861</span></a>							<span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="StepTokenizers-862"><a href="#StepTokenizers-862"><span class="linenos">862</span></a>						<span class="p">),</span>
</span><span id="StepTokenizers-863"><a href="#StepTokenizers-863"><span class="linenos">863</span></a>					<span class="p">),</span>
</span><span id="StepTokenizers-864"><a href="#StepTokenizers-864"><span class="linenos">864</span></a>				<span class="p">]</span>
</span><span id="StepTokenizers-865"><a href="#StepTokenizers-865"><span class="linenos">865</span></a>			<span class="k">return</span> <span class="p">[</span>
</span><span id="StepTokenizers-866"><a href="#StepTokenizers-866"><span class="linenos">866</span></a>				<span class="n">get_relative_direction</span><span class="p">(</span>
</span><span id="StepTokenizers-867"><a href="#StepTokenizers-867"><span class="linenos">867</span></a>					<span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">start_index</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">start_index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">],</span>
</span><span id="StepTokenizers-868"><a href="#StepTokenizers-868"><span class="linenos">868</span></a>				<span class="p">),</span>
</span><span id="StepTokenizers-869"><a href="#StepTokenizers-869"><span class="linenos">869</span></a>			<span class="p">]</span>
</span><span id="StepTokenizers-870"><a href="#StepTokenizers-870"><span class="linenos">870</span></a>
</span><span id="StepTokenizers-871"><a href="#StepTokenizers-871"><span class="linenos">871</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepTokenizers-872"><a href="#StepTokenizers-872"><span class="linenos">872</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">Distance</span><span class="p">(</span><span class="n">_StepTokenizer</span><span class="p">):</span>
</span><span id="StepTokenizers-873"><a href="#StepTokenizers-873"><span class="linenos">873</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;A count of the number of individual steps from the starting point to the end point.</span>
</span><span id="StepTokenizers-874"><a href="#StepTokenizers-874"><span class="linenos">874</span></a>
</span><span id="StepTokenizers-875"><a href="#StepTokenizers-875"><span class="linenos">875</span></a><span class="sd">		Contains no information about directionality, only the distance traveled in the step.</span>
</span><span id="StepTokenizers-876"><a href="#StepTokenizers-876"><span class="linenos">876</span></a><span class="sd">		`Distance` must be combined with at least one other `_StepTokenizer` in a `StepTokenizerPermutation`.</span>
</span><span id="StepTokenizers-877"><a href="#StepTokenizers-877"><span class="linenos">877</span></a><span class="sd">		This constraint is enforced in `_PathTokenizer.is_valid`.</span>
</span><span id="StepTokenizers-878"><a href="#StepTokenizers-878"><span class="linenos">878</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="StepTokenizers-879"><a href="#StepTokenizers-879"><span class="linenos">879</span></a>
</span><span id="StepTokenizers-880"><a href="#StepTokenizers-880"><span class="linenos">880</span></a>		<span class="c1"># inherit docstring</span>
</span><span id="StepTokenizers-881"><a href="#StepTokenizers-881"><span class="linenos">881</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>  <span class="c1"># noqa: D102</span>
</span><span id="StepTokenizers-882"><a href="#StepTokenizers-882"><span class="linenos">882</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="StepTokenizers-883"><a href="#StepTokenizers-883"><span class="linenos">883</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="StepTokenizers-884"><a href="#StepTokenizers-884"><span class="linenos">884</span></a>			<span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers-885"><a href="#StepTokenizers-885"><span class="linenos">885</span></a>			<span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers-886"><a href="#StepTokenizers-886"><span class="linenos">886</span></a>			<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="StepTokenizers-887"><a href="#StepTokenizers-887"><span class="linenos">887</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="StepTokenizers-888"><a href="#StepTokenizers-888"><span class="linenos">888</span></a>			<span class="n">d</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">end_index</span> <span class="o">-</span> <span class="n">start_index</span>
</span><span id="StepTokenizers-889"><a href="#StepTokenizers-889"><span class="linenos">889</span></a>			<span class="k">return</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">VOCAB</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;I_</span><span class="si">{</span><span class="n">d</span><span class="si">:</span><span class="s2">03</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)]</span>
</span><span id="StepTokenizers-890"><a href="#StepTokenizers-890"><span class="linenos">890</span></a>
</span><span id="StepTokenizers-891"><a href="#StepTokenizers-891"><span class="linenos">891</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StepTokenizers-892"><a href="#StepTokenizers-892"><span class="linenos">892</span></a><span class="sd">	`StepTokenizerPermutation`</span>
</span><span id="StepTokenizers-893"><a href="#StepTokenizers-893"><span class="linenos">893</span></a><span class="sd">	A sequence of unique `_StepTokenizer`s.</span>
</span><span id="StepTokenizers-894"><a href="#StepTokenizers-894"><span class="linenos">894</span></a><span class="sd">	This type exists mostly just for the clarity and convenience of `_PathTokenizer` code.</span>
</span><span id="StepTokenizers-895"><a href="#StepTokenizers-895"><span class="linenos">895</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="StepTokenizers-896"><a href="#StepTokenizers-896"><span class="linenos">896</span></a>	<span class="n">StepTokenizerPermutation</span><span class="p">:</span> <span class="nb">type</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="StepTokenizers-897"><a href="#StepTokenizers-897"><span class="linenos">897</span></a>		<span class="nb">tuple</span><span class="p">[</span><span class="n">_StepTokenizer</span><span class="p">]</span>
</span><span id="StepTokenizers-898"><a href="#StepTokenizers-898"><span class="linenos">898</span></a>		<span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">_StepTokenizer</span><span class="p">]</span>
</span><span id="StepTokenizers-899"><a href="#StepTokenizers-899"><span class="linenos">899</span></a>		<span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">_StepTokenizer</span><span class="p">]</span>
</span><span id="StepTokenizers-900"><a href="#StepTokenizers-900"><span class="linenos">900</span></a>		<span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">_StepTokenizer</span><span class="p">]</span>
</span><span id="StepTokenizers-901"><a href="#StepTokenizers-901"><span class="linenos">901</span></a>	<span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Namespace for <code>_StepTokenizer</code> subclass hierarchy used by <code>MazeTokenizerModular</code>.</p>
</div>


                            <div id="StepTokenizers.key" class="classattr">
                                <div class="attr variable">
            <span class="name">key</span>        =
<span class="default_value">&#39;step_tokenizers&#39;</span>

        
    </div>
    <a class="headerlink" href="#StepTokenizers.key"></a>
    
    

                            </div>
                            <div id="StepTokenizers.StepTokenizerPermutation" class="classattr">
                                <div class="attr variable">
            <span class="name">StepTokenizerPermutation</span><span class="annotation">: type</span>        =
<input id="StepTokenizers.StepTokenizerPermutation-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="StepTokenizers.StepTokenizerPermutation-view-value"></label><span class="default_value">tuple[maze_dataset.tokenization.modular.elements.StepTokenizers._StepTokenizer] | tuple[maze_dataset.tokenization.modular.elements.StepTokenizers._StepTokenizer, maze_dataset.tokenization.modular.elements.StepTokenizers._StepTokenizer] | tuple[maze_dataset.tokenization.modular.elements.StepTokenizers._StepTokenizer, maze_dataset.tokenization.modular.elements.StepTokenizers._StepTokenizer, maze_dataset.tokenization.modular.elements.StepTokenizers._StepTokenizer] | tuple[maze_dataset.tokenization.modular.elements.StepTokenizers._StepTokenizer, maze_dataset.tokenization.modular.elements.StepTokenizers._StepTokenizer, maze_dataset.tokenization.modular.elements.StepTokenizers._StepTokenizer, maze_dataset.tokenization.modular.elements.StepTokenizers._StepTokenizer]</span>

        
    </div>
    <a class="headerlink" href="#StepTokenizers.StepTokenizerPermutation"></a>
    
    

                            </div>
                </section>
                <section id="StepTokenizers.Coord">
                            <input id="StepTokenizers.Coord-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">StepTokenizers.Coord</span><wbr>(<span class="base"><a href="#StepTokenizers._StepTokenizer">StepTokenizers._StepTokenizer</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Coord-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L801-L813" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Coord"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Coord-802"><a href="#StepTokenizers.Coord-802"><span class="linenos">802</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepTokenizers.Coord-803"><a href="#StepTokenizers.Coord-803"><span class="linenos">803</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">Coord</span><span class="p">(</span><span class="n">_StepTokenizer</span><span class="p">):</span>
</span><span id="StepTokenizers.Coord-804"><a href="#StepTokenizers.Coord-804"><span class="linenos">804</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;A direct tokenization of the end position coord represents the step.&quot;&quot;&quot;</span>
</span><span id="StepTokenizers.Coord-805"><a href="#StepTokenizers.Coord-805"><span class="linenos">805</span></a>
</span><span id="StepTokenizers.Coord-806"><a href="#StepTokenizers.Coord-806"><span class="linenos">806</span></a>		<span class="c1"># inherit docstring</span>
</span><span id="StepTokenizers.Coord-807"><a href="#StepTokenizers.Coord-807"><span class="linenos">807</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>  <span class="c1"># noqa: D102</span>
</span><span id="StepTokenizers.Coord-808"><a href="#StepTokenizers.Coord-808"><span class="linenos">808</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord-809"><a href="#StepTokenizers.Coord-809"><span class="linenos">809</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord-810"><a href="#StepTokenizers.Coord-810"><span class="linenos">810</span></a>			<span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord-811"><a href="#StepTokenizers.Coord-811"><span class="linenos">811</span></a>			<span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord-812"><a href="#StepTokenizers.Coord-812"><span class="linenos">812</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord-813"><a href="#StepTokenizers.Coord-813"><span class="linenos">813</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="StepTokenizers.Coord-814"><a href="#StepTokenizers.Coord-814"><span class="linenos">814</span></a>			<span class="k">return</span> <span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">end_index</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>A direct tokenization of the end position coord represents the step.</p>
</div>


                            <div id="StepTokenizers.Coord.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">StepTokenizers.Coord</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#StepTokenizers.Coord">StepTokenizers.Coord</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#StepTokenizers.Coord">StepTokenizers.Coord</a>&#39;&gt;&quot;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#StepTokenizers.Coord.__init__"></a>
    
    

                            </div>
                            <div id="StepTokenizers.Coord.to_tokens" class="classattr">
                                        <input id="StepTokenizers.Coord.to_tokens-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_tokens</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">maze</span><span class="p">:</span> <span class="n"><a href="../../../maze_dataset.html#SolvedMaze">maze_dataset.SolvedMaze</a></span>,</span><span class="param">	<span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Coord.to_tokens-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L806-L813" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Coord.to_tokens"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Coord.to_tokens-807"><a href="#StepTokenizers.Coord.to_tokens-807"><span class="linenos">807</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>  <span class="c1"># noqa: D102</span>
</span><span id="StepTokenizers.Coord.to_tokens-808"><a href="#StepTokenizers.Coord.to_tokens-808"><span class="linenos">808</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord.to_tokens-809"><a href="#StepTokenizers.Coord.to_tokens-809"><span class="linenos">809</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord.to_tokens-810"><a href="#StepTokenizers.Coord.to_tokens-810"><span class="linenos">810</span></a>			<span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord.to_tokens-811"><a href="#StepTokenizers.Coord.to_tokens-811"><span class="linenos">811</span></a>			<span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord.to_tokens-812"><a href="#StepTokenizers.Coord.to_tokens-812"><span class="linenos">812</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord.to_tokens-813"><a href="#StepTokenizers.Coord.to_tokens-813"><span class="linenos">813</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="StepTokenizers.Coord.to_tokens-814"><a href="#StepTokenizers.Coord.to_tokens-814"><span class="linenos">814</span></a>			<span class="k">return</span> <span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">end_index</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Tokenizes a single step in the solution.</p>

<h1 id="parameters">Parameters</h1>

<ul>
<li><code>maze</code>: Maze to be tokenized</li>
<li><code>start_index</code>: The index of the Coord in <code>maze.solution</code> at which the current step starts</li>
<li><code>end_index</code>: The index of the Coord in <code>maze.solution</code> at which the current step ends</li>
</ul>
</div>


                            </div>
                            <div id="StepTokenizers.Coord.serialize" class="classattr">
                                        <input id="StepTokenizers.Coord.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Coord.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L713-L769" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Coord.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Coord.serialize-714"><a href="#StepTokenizers.Coord.serialize-714"><span class="linenos">714</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="StepTokenizers.Coord.serialize-715"><a href="#StepTokenizers.Coord.serialize-715"><span class="linenos">715</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="StepTokenizers.Coord.serialize-716"><a href="#StepTokenizers.Coord.serialize-716"><span class="linenos">716</span></a>                <span class="n">_FORMAT_KEY</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="StepTokenizers.Coord.serialize-717"><a href="#StepTokenizers.Coord.serialize-717"><span class="linenos">717</span></a>            <span class="p">}</span>
</span><span id="StepTokenizers.Coord.serialize-718"><a href="#StepTokenizers.Coord.serialize-718"><span class="linenos">718</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="StepTokenizers.Coord.serialize-719"><a href="#StepTokenizers.Coord.serialize-719"><span class="linenos">719</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="StepTokenizers.Coord.serialize-720"><a href="#StepTokenizers.Coord.serialize-720"><span class="linenos">720</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="StepTokenizers.Coord.serialize-721"><a href="#StepTokenizers.Coord.serialize-721"><span class="linenos">721</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="StepTokenizers.Coord.serialize-722"><a href="#StepTokenizers.Coord.serialize-722"><span class="linenos">722</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="StepTokenizers.Coord.serialize-723"><a href="#StepTokenizers.Coord.serialize-723"><span class="linenos">723</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="StepTokenizers.Coord.serialize-724"><a href="#StepTokenizers.Coord.serialize-724"><span class="linenos">724</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="StepTokenizers.Coord.serialize-725"><a href="#StepTokenizers.Coord.serialize-725"><span class="linenos">725</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="StepTokenizers.Coord.serialize-726"><a href="#StepTokenizers.Coord.serialize-726"><span class="linenos">726</span></a>                    <span class="p">)</span>
</span><span id="StepTokenizers.Coord.serialize-727"><a href="#StepTokenizers.Coord.serialize-727"><span class="linenos">727</span></a>
</span><span id="StepTokenizers.Coord.serialize-728"><a href="#StepTokenizers.Coord.serialize-728"><span class="linenos">728</span></a>                <span class="c1"># try to save it</span>
</span><span id="StepTokenizers.Coord.serialize-729"><a href="#StepTokenizers.Coord.serialize-729"><span class="linenos">729</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="StepTokenizers.Coord.serialize-730"><a href="#StepTokenizers.Coord.serialize-730"><span class="linenos">730</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="StepTokenizers.Coord.serialize-731"><a href="#StepTokenizers.Coord.serialize-731"><span class="linenos">731</span></a>                        <span class="c1"># get the val</span>
</span><span id="StepTokenizers.Coord.serialize-732"><a href="#StepTokenizers.Coord.serialize-732"><span class="linenos">732</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="StepTokenizers.Coord.serialize-733"><a href="#StepTokenizers.Coord.serialize-733"><span class="linenos">733</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="StepTokenizers.Coord.serialize-734"><a href="#StepTokenizers.Coord.serialize-734"><span class="linenos">734</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="StepTokenizers.Coord.serialize-735"><a href="#StepTokenizers.Coord.serialize-735"><span class="linenos">735</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="StepTokenizers.Coord.serialize-736"><a href="#StepTokenizers.Coord.serialize-736"><span class="linenos">736</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="StepTokenizers.Coord.serialize-737"><a href="#StepTokenizers.Coord.serialize-737"><span class="linenos">737</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="StepTokenizers.Coord.serialize-738"><a href="#StepTokenizers.Coord.serialize-738"><span class="linenos">738</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="StepTokenizers.Coord.serialize-739"><a href="#StepTokenizers.Coord.serialize-739"><span class="linenos">739</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="StepTokenizers.Coord.serialize-740"><a href="#StepTokenizers.Coord.serialize-740"><span class="linenos">740</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="StepTokenizers.Coord.serialize-741"><a href="#StepTokenizers.Coord.serialize-741"><span class="linenos">741</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="StepTokenizers.Coord.serialize-742"><a href="#StepTokenizers.Coord.serialize-742"><span class="linenos">742</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepTokenizers.Coord.serialize-743"><a href="#StepTokenizers.Coord.serialize-743"><span class="linenos">743</span></a>
</span><span id="StepTokenizers.Coord.serialize-744"><a href="#StepTokenizers.Coord.serialize-744"><span class="linenos">744</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="StepTokenizers.Coord.serialize-745"><a href="#StepTokenizers.Coord.serialize-745"><span class="linenos">745</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepTokenizers.Coord.serialize-746"><a href="#StepTokenizers.Coord.serialize-746"><span class="linenos">746</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="StepTokenizers.Coord.serialize-747"><a href="#StepTokenizers.Coord.serialize-747"><span class="linenos">747</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="StepTokenizers.Coord.serialize-748"><a href="#StepTokenizers.Coord.serialize-748"><span class="linenos">748</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="StepTokenizers.Coord.serialize-749"><a href="#StepTokenizers.Coord.serialize-749"><span class="linenos">749</span></a>                                <span class="p">[</span>
</span><span id="StepTokenizers.Coord.serialize-750"><a href="#StepTokenizers.Coord.serialize-750"><span class="linenos">750</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord.serialize-751"><a href="#StepTokenizers.Coord.serialize-751"><span class="linenos">751</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord.serialize-752"><a href="#StepTokenizers.Coord.serialize-752"><span class="linenos">752</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord.serialize-753"><a href="#StepTokenizers.Coord.serialize-753"><span class="linenos">753</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord.serialize-754"><a href="#StepTokenizers.Coord.serialize-754"><span class="linenos">754</span></a>                                <span class="p">]</span>
</span><span id="StepTokenizers.Coord.serialize-755"><a href="#StepTokenizers.Coord.serialize-755"><span class="linenos">755</span></a>                            <span class="p">)</span>
</span><span id="StepTokenizers.Coord.serialize-756"><a href="#StepTokenizers.Coord.serialize-756"><span class="linenos">756</span></a>                        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</span><span id="StepTokenizers.Coord.serialize-757"><a href="#StepTokenizers.Coord.serialize-757"><span class="linenos">757</span></a>
</span><span id="StepTokenizers.Coord.serialize-758"><a href="#StepTokenizers.Coord.serialize-758"><span class="linenos">758</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="StepTokenizers.Coord.serialize-759"><a href="#StepTokenizers.Coord.serialize-759"><span class="linenos">759</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="StepTokenizers.Coord.serialize-760"><a href="#StepTokenizers.Coord.serialize-760"><span class="linenos">760</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="StepTokenizers.Coord.serialize-761"><a href="#StepTokenizers.Coord.serialize-761"><span class="linenos">761</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="StepTokenizers.Coord.serialize-762"><a href="#StepTokenizers.Coord.serialize-762"><span class="linenos">762</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepTokenizers.Coord.serialize-763"><a href="#StepTokenizers.Coord.serialize-763"><span class="linenos">763</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="StepTokenizers.Coord.serialize-764"><a href="#StepTokenizers.Coord.serialize-764"><span class="linenos">764</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="StepTokenizers.Coord.serialize-765"><a href="#StepTokenizers.Coord.serialize-765"><span class="linenos">765</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Coord.serialize-766"><a href="#StepTokenizers.Coord.serialize-766"><span class="linenos">766</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Coord.serialize-767"><a href="#StepTokenizers.Coord.serialize-767"><span class="linenos">767</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Coord.serialize-768"><a href="#StepTokenizers.Coord.serialize-768"><span class="linenos">768</span></a>                    <span class="p">)</span>
</span><span id="StepTokenizers.Coord.serialize-769"><a href="#StepTokenizers.Coord.serialize-769"><span class="linenos">769</span></a>
</span><span id="StepTokenizers.Coord.serialize-770"><a href="#StepTokenizers.Coord.serialize-770"><span class="linenos">770</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="StepTokenizers.Coord.load" class="classattr">
                                        <input id="StepTokenizers.Coord.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Coord.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L776-L862" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Coord.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Coord.load-777"><a href="#StepTokenizers.Coord.load-777"><span class="linenos">777</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="StepTokenizers.Coord.load-778"><a href="#StepTokenizers.Coord.load-778"><span class="linenos">778</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="StepTokenizers.Coord.load-779"><a href="#StepTokenizers.Coord.load-779"><span class="linenos">779</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="StepTokenizers.Coord.load-780"><a href="#StepTokenizers.Coord.load-780"><span class="linenos">780</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="StepTokenizers.Coord.load-781"><a href="#StepTokenizers.Coord.load-781"><span class="linenos">781</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="StepTokenizers.Coord.load-782"><a href="#StepTokenizers.Coord.load-782"><span class="linenos">782</span></a>
</span><span id="StepTokenizers.Coord.load-783"><a href="#StepTokenizers.Coord.load-783"><span class="linenos">783</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="StepTokenizers.Coord.load-784"><a href="#StepTokenizers.Coord.load-784"><span class="linenos">784</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="StepTokenizers.Coord.load-785"><a href="#StepTokenizers.Coord.load-785"><span class="linenos">785</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Coord.load-786"><a href="#StepTokenizers.Coord.load-786"><span class="linenos">786</span></a>
</span><span id="StepTokenizers.Coord.load-787"><a href="#StepTokenizers.Coord.load-787"><span class="linenos">787</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="StepTokenizers.Coord.load-788"><a href="#StepTokenizers.Coord.load-788"><span class="linenos">788</span></a>
</span><span id="StepTokenizers.Coord.load-789"><a href="#StepTokenizers.Coord.load-789"><span class="linenos">789</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="StepTokenizers.Coord.load-790"><a href="#StepTokenizers.Coord.load-790"><span class="linenos">790</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="StepTokenizers.Coord.load-791"><a href="#StepTokenizers.Coord.load-791"><span class="linenos">791</span></a>
</span><span id="StepTokenizers.Coord.load-792"><a href="#StepTokenizers.Coord.load-792"><span class="linenos">792</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="StepTokenizers.Coord.load-793"><a href="#StepTokenizers.Coord.load-793"><span class="linenos">793</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="StepTokenizers.Coord.load-794"><a href="#StepTokenizers.Coord.load-794"><span class="linenos">794</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="StepTokenizers.Coord.load-795"><a href="#StepTokenizers.Coord.load-795"><span class="linenos">795</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="StepTokenizers.Coord.load-796"><a href="#StepTokenizers.Coord.load-796"><span class="linenos">796</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="StepTokenizers.Coord.load-797"><a href="#StepTokenizers.Coord.load-797"><span class="linenos">797</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="StepTokenizers.Coord.load-798"><a href="#StepTokenizers.Coord.load-798"><span class="linenos">798</span></a>
</span><span id="StepTokenizers.Coord.load-799"><a href="#StepTokenizers.Coord.load-799"><span class="linenos">799</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="StepTokenizers.Coord.load-800"><a href="#StepTokenizers.Coord.load-800"><span class="linenos">800</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="StepTokenizers.Coord.load-801"><a href="#StepTokenizers.Coord.load-801"><span class="linenos">801</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="StepTokenizers.Coord.load-802"><a href="#StepTokenizers.Coord.load-802"><span class="linenos">802</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="StepTokenizers.Coord.load-803"><a href="#StepTokenizers.Coord.load-803"><span class="linenos">803</span></a>
</span><span id="StepTokenizers.Coord.load-804"><a href="#StepTokenizers.Coord.load-804"><span class="linenos">804</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="StepTokenizers.Coord.load-805"><a href="#StepTokenizers.Coord.load-805"><span class="linenos">805</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="StepTokenizers.Coord.load-806"><a href="#StepTokenizers.Coord.load-806"><span class="linenos">806</span></a>
</span><span id="StepTokenizers.Coord.load-807"><a href="#StepTokenizers.Coord.load-807"><span class="linenos">807</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="StepTokenizers.Coord.load-808"><a href="#StepTokenizers.Coord.load-808"><span class="linenos">808</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="StepTokenizers.Coord.load-809"><a href="#StepTokenizers.Coord.load-809"><span class="linenos">809</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="StepTokenizers.Coord.load-810"><a href="#StepTokenizers.Coord.load-810"><span class="linenos">810</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepTokenizers.Coord.load-811"><a href="#StepTokenizers.Coord.load-811"><span class="linenos">811</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="StepTokenizers.Coord.load-812"><a href="#StepTokenizers.Coord.load-812"><span class="linenos">812</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="StepTokenizers.Coord.load-813"><a href="#StepTokenizers.Coord.load-813"><span class="linenos">813</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="StepTokenizers.Coord.load-814"><a href="#StepTokenizers.Coord.load-814"><span class="linenos">814</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="StepTokenizers.Coord.load-815"><a href="#StepTokenizers.Coord.load-815"><span class="linenos">815</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="StepTokenizers.Coord.load-816"><a href="#StepTokenizers.Coord.load-816"><span class="linenos">816</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="StepTokenizers.Coord.load-817"><a href="#StepTokenizers.Coord.load-817"><span class="linenos">817</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="StepTokenizers.Coord.load-818"><a href="#StepTokenizers.Coord.load-818"><span class="linenos">818</span></a>                    <span class="p">):</span>
</span><span id="StepTokenizers.Coord.load-819"><a href="#StepTokenizers.Coord.load-819"><span class="linenos">819</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="StepTokenizers.Coord.load-820"><a href="#StepTokenizers.Coord.load-820"><span class="linenos">820</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="StepTokenizers.Coord.load-821"><a href="#StepTokenizers.Coord.load-821"><span class="linenos">821</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepTokenizers.Coord.load-822"><a href="#StepTokenizers.Coord.load-822"><span class="linenos">822</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="StepTokenizers.Coord.load-823"><a href="#StepTokenizers.Coord.load-823"><span class="linenos">823</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="StepTokenizers.Coord.load-824"><a href="#StepTokenizers.Coord.load-824"><span class="linenos">824</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Coord.load-825"><a href="#StepTokenizers.Coord.load-825"><span class="linenos">825</span></a>                            <span class="p">)</span>
</span><span id="StepTokenizers.Coord.load-826"><a href="#StepTokenizers.Coord.load-826"><span class="linenos">826</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="StepTokenizers.Coord.load-827"><a href="#StepTokenizers.Coord.load-827"><span class="linenos">827</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="StepTokenizers.Coord.load-828"><a href="#StepTokenizers.Coord.load-828"><span class="linenos">828</span></a>                        <span class="k">pass</span>
</span><span id="StepTokenizers.Coord.load-829"><a href="#StepTokenizers.Coord.load-829"><span class="linenos">829</span></a>
</span><span id="StepTokenizers.Coord.load-830"><a href="#StepTokenizers.Coord.load-830"><span class="linenos">830</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="StepTokenizers.Coord.load-831"><a href="#StepTokenizers.Coord.load-831"><span class="linenos">831</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepTokenizers.Coord.load-832"><a href="#StepTokenizers.Coord.load-832"><span class="linenos">832</span></a>
</span><span id="StepTokenizers.Coord.load-833"><a href="#StepTokenizers.Coord.load-833"><span class="linenos">833</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="StepTokenizers.Coord.load-834"><a href="#StepTokenizers.Coord.load-834"><span class="linenos">834</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="StepTokenizers.Coord.load-835"><a href="#StepTokenizers.Coord.load-835"><span class="linenos">835</span></a>
</span><span id="StepTokenizers.Coord.load-836"><a href="#StepTokenizers.Coord.load-836"><span class="linenos">836</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="StepTokenizers.Coord.load-837"><a href="#StepTokenizers.Coord.load-837"><span class="linenos">837</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="StepTokenizers.Coord.load-838"><a href="#StepTokenizers.Coord.load-838"><span class="linenos">838</span></a>                <span class="n">fields_valid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="StepTokenizers.Coord.load-839"><a href="#StepTokenizers.Coord.load-839"><span class="linenos">839</span></a>                    <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="StepTokenizers.Coord.load-840"><a href="#StepTokenizers.Coord.load-840"><span class="linenos">840</span></a>                        <span class="n">output</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord.load-841"><a href="#StepTokenizers.Coord.load-841"><span class="linenos">841</span></a>                        <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord.load-842"><a href="#StepTokenizers.Coord.load-842"><span class="linenos">842</span></a>                    <span class="p">)</span>
</span><span id="StepTokenizers.Coord.load-843"><a href="#StepTokenizers.Coord.load-843"><span class="linenos">843</span></a>                <span class="p">)</span>
</span><span id="StepTokenizers.Coord.load-844"><a href="#StepTokenizers.Coord.load-844"><span class="linenos">844</span></a>
</span><span id="StepTokenizers.Coord.load-845"><a href="#StepTokenizers.Coord.load-845"><span class="linenos">845</span></a>                <span class="c1"># if there are any fields that are not valid, raise an error</span>
</span><span id="StepTokenizers.Coord.load-846"><a href="#StepTokenizers.Coord.load-846"><span class="linenos">846</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">fields_valid</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="StepTokenizers.Coord.load-847"><a href="#StepTokenizers.Coord.load-847"><span class="linenos">847</span></a>                    <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="StepTokenizers.Coord.load-848"><a href="#StepTokenizers.Coord.load-848"><span class="linenos">848</span></a>                        <span class="sa">f</span><span class="s2">&quot;Type mismatch in fields of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Coord.load-849"><a href="#StepTokenizers.Coord.load-849"><span class="linenos">849</span></a>                        <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="StepTokenizers.Coord.load-850"><a href="#StepTokenizers.Coord.load-850"><span class="linenos">850</span></a>                            <span class="p">[</span>
</span><span id="StepTokenizers.Coord.load-851"><a href="#StepTokenizers.Coord.load-851"><span class="linenos">851</span></a>                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">:</span><span class="se">\t</span><span class="s2">expected </span><span class="si">{</span><span class="n">cls_type_hints</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="si">= }</span><span class="s2">, but got value </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Coord.load-852"><a href="#StepTokenizers.Coord.load-852"><span class="linenos">852</span></a>                                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">fields_valid</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="StepTokenizers.Coord.load-853"><a href="#StepTokenizers.Coord.load-853"><span class="linenos">853</span></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span>
</span><span id="StepTokenizers.Coord.load-854"><a href="#StepTokenizers.Coord.load-854"><span class="linenos">854</span></a>                            <span class="p">]</span>
</span><span id="StepTokenizers.Coord.load-855"><a href="#StepTokenizers.Coord.load-855"><span class="linenos">855</span></a>                        <span class="p">)</span>
</span><span id="StepTokenizers.Coord.load-856"><a href="#StepTokenizers.Coord.load-856"><span class="linenos">856</span></a>                    <span class="p">)</span>
</span><span id="StepTokenizers.Coord.load-857"><a href="#StepTokenizers.Coord.load-857"><span class="linenos">857</span></a>
</span><span id="StepTokenizers.Coord.load-858"><a href="#StepTokenizers.Coord.load-858"><span class="linenos">858</span></a>                    <span class="n">on_typecheck_mismatch</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
</span><span id="StepTokenizers.Coord.load-859"><a href="#StepTokenizers.Coord.load-859"><span class="linenos">859</span></a>                        <span class="n">msg</span><span class="p">,</span> <span class="n">except_cls</span><span class="o">=</span><span class="n">FieldTypeMismatchError</span>
</span><span id="StepTokenizers.Coord.load-860"><a href="#StepTokenizers.Coord.load-860"><span class="linenos">860</span></a>                    <span class="p">)</span>
</span><span id="StepTokenizers.Coord.load-861"><a href="#StepTokenizers.Coord.load-861"><span class="linenos">861</span></a>
</span><span id="StepTokenizers.Coord.load-862"><a href="#StepTokenizers.Coord.load-862"><span class="linenos">862</span></a>            <span class="c1"># return the new instance</span>
</span><span id="StepTokenizers.Coord.load-863"><a href="#StepTokenizers.Coord.load-863"><span class="linenos">863</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="StepTokenizers.Coord.validate_fields_types" class="classattr">
                                        <input id="StepTokenizers.Coord.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Coord.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L282-L291" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Coord.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Coord.validate_fields_types-283"><a href="#StepTokenizers.Coord.validate_fields_types-283"><span class="linenos">283</span></a><span class="k">def</span><span class="w"> </span><span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="StepTokenizers.Coord.validate_fields_types-284"><a href="#StepTokenizers.Coord.validate_fields_types-284"><span class="linenos">284</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord.validate_fields_types-285"><a href="#StepTokenizers.Coord.validate_fields_types-285"><span class="linenos">285</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord.validate_fields_types-286"><a href="#StepTokenizers.Coord.validate_fields_types-286"><span class="linenos">286</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="StepTokenizers.Coord.validate_fields_types-287"><a href="#StepTokenizers.Coord.validate_fields_types-287"><span class="linenos">287</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="StepTokenizers.Coord.validate_fields_types-288"><a href="#StepTokenizers.Coord.validate_fields_types-288"><span class="linenos">288</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="StepTokenizers.Coord.validate_fields_types-289"><a href="#StepTokenizers.Coord.validate_fields_types-289"><span class="linenos">289</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="StepTokenizers.Coord.validate_fields_types-290"><a href="#StepTokenizers.Coord.validate_fields_types-290"><span class="linenos">290</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="StepTokenizers.Coord.validate_fields_types-291"><a href="#StepTokenizers.Coord.validate_fields_types-291"><span class="linenos">291</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="StepTokenizers.Coord.validate_fields_types-292"><a href="#StepTokenizers.Coord.validate_fields_types-292"><span class="linenos">292</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#StepTokenizers._StepTokenizer">StepTokenizers._StepTokenizer</a></dt>
                                <dd id="StepTokenizers.Coord.attribute_key" class="function"><a href="#StepTokenizers._StepTokenizer.attribute_key">attribute_key</a></dd>
                <dd id="StepTokenizers.Coord.is_valid" class="function"><a href="#StepTokenizers._StepTokenizer.is_valid">is_valid</a></dd>

            </div>
            <div><dt><a href="element_base.html#_TokenizerElement">maze_dataset.tokenization.modular.element_base._TokenizerElement</a></dt>
                                <dd id="StepTokenizers.Coord.name" class="variable"><a href="element_base.html#_TokenizerElement.name">name</a></dd>
                <dd id="StepTokenizers.Coord.tokenizer_elements" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="StepTokenizers.Coord.tokenizer_element_tree" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="StepTokenizers.Coord.tokenizer_element_dict" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="StepTokenizers.Coord.validate_field_type" class="function">validate_field_type</dd>
                <dd id="StepTokenizers.Coord.diff" class="function">diff</dd>
                <dd id="StepTokenizers.Coord.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="StepTokenizers.Cardinal">
                            <input id="StepTokenizers.Cardinal-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">StepTokenizers.Cardinal</span><wbr>(<span class="base"><a href="#StepTokenizers._StepTokenizer">StepTokenizers._StepTokenizer</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Cardinal-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L815-L832" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Cardinal"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Cardinal-816"><a href="#StepTokenizers.Cardinal-816"><span class="linenos">816</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepTokenizers.Cardinal-817"><a href="#StepTokenizers.Cardinal-817"><span class="linenos">817</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">Cardinal</span><span class="p">(</span><span class="n">_StepTokenizer</span><span class="p">):</span>
</span><span id="StepTokenizers.Cardinal-818"><a href="#StepTokenizers.Cardinal-818"><span class="linenos">818</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;A step is tokenized with a cardinal direction token.</span>
</span><span id="StepTokenizers.Cardinal-819"><a href="#StepTokenizers.Cardinal-819"><span class="linenos">819</span></a>
</span><span id="StepTokenizers.Cardinal-820"><a href="#StepTokenizers.Cardinal-820"><span class="linenos">820</span></a><span class="sd">		It is the direction of the step from the starting position along the solution.</span>
</span><span id="StepTokenizers.Cardinal-821"><a href="#StepTokenizers.Cardinal-821"><span class="linenos">821</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="StepTokenizers.Cardinal-822"><a href="#StepTokenizers.Cardinal-822"><span class="linenos">822</span></a>
</span><span id="StepTokenizers.Cardinal-823"><a href="#StepTokenizers.Cardinal-823"><span class="linenos">823</span></a>		<span class="c1"># inherit docstring</span>
</span><span id="StepTokenizers.Cardinal-824"><a href="#StepTokenizers.Cardinal-824"><span class="linenos">824</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>  <span class="c1"># noqa: D102</span>
</span><span id="StepTokenizers.Cardinal-825"><a href="#StepTokenizers.Cardinal-825"><span class="linenos">825</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="StepTokenizers.Cardinal-826"><a href="#StepTokenizers.Cardinal-826"><span class="linenos">826</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="StepTokenizers.Cardinal-827"><a href="#StepTokenizers.Cardinal-827"><span class="linenos">827</span></a>			<span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers.Cardinal-828"><a href="#StepTokenizers.Cardinal-828"><span class="linenos">828</span></a>			<span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers.Cardinal-829"><a href="#StepTokenizers.Cardinal-829"><span class="linenos">829</span></a>			<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="StepTokenizers.Cardinal-830"><a href="#StepTokenizers.Cardinal-830"><span class="linenos">830</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="StepTokenizers.Cardinal-831"><a href="#StepTokenizers.Cardinal-831"><span class="linenos">831</span></a>			<span class="k">return</span> <span class="p">[</span>
</span><span id="StepTokenizers.Cardinal-832"><a href="#StepTokenizers.Cardinal-832"><span class="linenos">832</span></a>				<span class="n">get_cardinal_direction</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">start_index</span> <span class="p">:</span> <span class="n">start_index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]),</span>
</span><span id="StepTokenizers.Cardinal-833"><a href="#StepTokenizers.Cardinal-833"><span class="linenos">833</span></a>			<span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>A step is tokenized with a cardinal direction token.</p>

<p>It is the direction of the step from the starting position along the solution.</p>
</div>


                            <div id="StepTokenizers.Cardinal.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">StepTokenizers.Cardinal</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#StepTokenizers.Cardinal">StepTokenizers.Cardinal</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#StepTokenizers.Cardinal">StepTokenizers.Cardinal</a>&#39;&gt;&quot;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#StepTokenizers.Cardinal.__init__"></a>
    
    

                            </div>
                            <div id="StepTokenizers.Cardinal.to_tokens" class="classattr">
                                        <input id="StepTokenizers.Cardinal.to_tokens-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_tokens</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">maze</span><span class="p">:</span> <span class="n"><a href="../../../maze_dataset.html#SolvedMaze">maze_dataset.SolvedMaze</a></span>,</span><span class="param">	<span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Cardinal.to_tokens-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L823-L832" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Cardinal.to_tokens"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Cardinal.to_tokens-824"><a href="#StepTokenizers.Cardinal.to_tokens-824"><span class="linenos">824</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>  <span class="c1"># noqa: D102</span>
</span><span id="StepTokenizers.Cardinal.to_tokens-825"><a href="#StepTokenizers.Cardinal.to_tokens-825"><span class="linenos">825</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="StepTokenizers.Cardinal.to_tokens-826"><a href="#StepTokenizers.Cardinal.to_tokens-826"><span class="linenos">826</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="StepTokenizers.Cardinal.to_tokens-827"><a href="#StepTokenizers.Cardinal.to_tokens-827"><span class="linenos">827</span></a>			<span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers.Cardinal.to_tokens-828"><a href="#StepTokenizers.Cardinal.to_tokens-828"><span class="linenos">828</span></a>			<span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers.Cardinal.to_tokens-829"><a href="#StepTokenizers.Cardinal.to_tokens-829"><span class="linenos">829</span></a>			<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="StepTokenizers.Cardinal.to_tokens-830"><a href="#StepTokenizers.Cardinal.to_tokens-830"><span class="linenos">830</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="StepTokenizers.Cardinal.to_tokens-831"><a href="#StepTokenizers.Cardinal.to_tokens-831"><span class="linenos">831</span></a>			<span class="k">return</span> <span class="p">[</span>
</span><span id="StepTokenizers.Cardinal.to_tokens-832"><a href="#StepTokenizers.Cardinal.to_tokens-832"><span class="linenos">832</span></a>				<span class="n">get_cardinal_direction</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">start_index</span> <span class="p">:</span> <span class="n">start_index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]),</span>
</span><span id="StepTokenizers.Cardinal.to_tokens-833"><a href="#StepTokenizers.Cardinal.to_tokens-833"><span class="linenos">833</span></a>			<span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Tokenizes a single step in the solution.</p>

<h1 id="parameters">Parameters</h1>

<ul>
<li><code>maze</code>: Maze to be tokenized</li>
<li><code>start_index</code>: The index of the Coord in <code>maze.solution</code> at which the current step starts</li>
<li><code>end_index</code>: The index of the Coord in <code>maze.solution</code> at which the current step ends</li>
</ul>
</div>


                            </div>
                            <div id="StepTokenizers.Cardinal.serialize" class="classattr">
                                        <input id="StepTokenizers.Cardinal.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Cardinal.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L713-L769" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Cardinal.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Cardinal.serialize-714"><a href="#StepTokenizers.Cardinal.serialize-714"><span class="linenos">714</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="StepTokenizers.Cardinal.serialize-715"><a href="#StepTokenizers.Cardinal.serialize-715"><span class="linenos">715</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="StepTokenizers.Cardinal.serialize-716"><a href="#StepTokenizers.Cardinal.serialize-716"><span class="linenos">716</span></a>                <span class="n">_FORMAT_KEY</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="StepTokenizers.Cardinal.serialize-717"><a href="#StepTokenizers.Cardinal.serialize-717"><span class="linenos">717</span></a>            <span class="p">}</span>
</span><span id="StepTokenizers.Cardinal.serialize-718"><a href="#StepTokenizers.Cardinal.serialize-718"><span class="linenos">718</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="StepTokenizers.Cardinal.serialize-719"><a href="#StepTokenizers.Cardinal.serialize-719"><span class="linenos">719</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="StepTokenizers.Cardinal.serialize-720"><a href="#StepTokenizers.Cardinal.serialize-720"><span class="linenos">720</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="StepTokenizers.Cardinal.serialize-721"><a href="#StepTokenizers.Cardinal.serialize-721"><span class="linenos">721</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="StepTokenizers.Cardinal.serialize-722"><a href="#StepTokenizers.Cardinal.serialize-722"><span class="linenos">722</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="StepTokenizers.Cardinal.serialize-723"><a href="#StepTokenizers.Cardinal.serialize-723"><span class="linenos">723</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="StepTokenizers.Cardinal.serialize-724"><a href="#StepTokenizers.Cardinal.serialize-724"><span class="linenos">724</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="StepTokenizers.Cardinal.serialize-725"><a href="#StepTokenizers.Cardinal.serialize-725"><span class="linenos">725</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="StepTokenizers.Cardinal.serialize-726"><a href="#StepTokenizers.Cardinal.serialize-726"><span class="linenos">726</span></a>                    <span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.serialize-727"><a href="#StepTokenizers.Cardinal.serialize-727"><span class="linenos">727</span></a>
</span><span id="StepTokenizers.Cardinal.serialize-728"><a href="#StepTokenizers.Cardinal.serialize-728"><span class="linenos">728</span></a>                <span class="c1"># try to save it</span>
</span><span id="StepTokenizers.Cardinal.serialize-729"><a href="#StepTokenizers.Cardinal.serialize-729"><span class="linenos">729</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="StepTokenizers.Cardinal.serialize-730"><a href="#StepTokenizers.Cardinal.serialize-730"><span class="linenos">730</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="StepTokenizers.Cardinal.serialize-731"><a href="#StepTokenizers.Cardinal.serialize-731"><span class="linenos">731</span></a>                        <span class="c1"># get the val</span>
</span><span id="StepTokenizers.Cardinal.serialize-732"><a href="#StepTokenizers.Cardinal.serialize-732"><span class="linenos">732</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.serialize-733"><a href="#StepTokenizers.Cardinal.serialize-733"><span class="linenos">733</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="StepTokenizers.Cardinal.serialize-734"><a href="#StepTokenizers.Cardinal.serialize-734"><span class="linenos">734</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="StepTokenizers.Cardinal.serialize-735"><a href="#StepTokenizers.Cardinal.serialize-735"><span class="linenos">735</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="StepTokenizers.Cardinal.serialize-736"><a href="#StepTokenizers.Cardinal.serialize-736"><span class="linenos">736</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="StepTokenizers.Cardinal.serialize-737"><a href="#StepTokenizers.Cardinal.serialize-737"><span class="linenos">737</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="StepTokenizers.Cardinal.serialize-738"><a href="#StepTokenizers.Cardinal.serialize-738"><span class="linenos">738</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="StepTokenizers.Cardinal.serialize-739"><a href="#StepTokenizers.Cardinal.serialize-739"><span class="linenos">739</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="StepTokenizers.Cardinal.serialize-740"><a href="#StepTokenizers.Cardinal.serialize-740"><span class="linenos">740</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="StepTokenizers.Cardinal.serialize-741"><a href="#StepTokenizers.Cardinal.serialize-741"><span class="linenos">741</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="StepTokenizers.Cardinal.serialize-742"><a href="#StepTokenizers.Cardinal.serialize-742"><span class="linenos">742</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.serialize-743"><a href="#StepTokenizers.Cardinal.serialize-743"><span class="linenos">743</span></a>
</span><span id="StepTokenizers.Cardinal.serialize-744"><a href="#StepTokenizers.Cardinal.serialize-744"><span class="linenos">744</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="StepTokenizers.Cardinal.serialize-745"><a href="#StepTokenizers.Cardinal.serialize-745"><span class="linenos">745</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepTokenizers.Cardinal.serialize-746"><a href="#StepTokenizers.Cardinal.serialize-746"><span class="linenos">746</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="StepTokenizers.Cardinal.serialize-747"><a href="#StepTokenizers.Cardinal.serialize-747"><span class="linenos">747</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="StepTokenizers.Cardinal.serialize-748"><a href="#StepTokenizers.Cardinal.serialize-748"><span class="linenos">748</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="StepTokenizers.Cardinal.serialize-749"><a href="#StepTokenizers.Cardinal.serialize-749"><span class="linenos">749</span></a>                                <span class="p">[</span>
</span><span id="StepTokenizers.Cardinal.serialize-750"><a href="#StepTokenizers.Cardinal.serialize-750"><span class="linenos">750</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers.Cardinal.serialize-751"><a href="#StepTokenizers.Cardinal.serialize-751"><span class="linenos">751</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers.Cardinal.serialize-752"><a href="#StepTokenizers.Cardinal.serialize-752"><span class="linenos">752</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers.Cardinal.serialize-753"><a href="#StepTokenizers.Cardinal.serialize-753"><span class="linenos">753</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers.Cardinal.serialize-754"><a href="#StepTokenizers.Cardinal.serialize-754"><span class="linenos">754</span></a>                                <span class="p">]</span>
</span><span id="StepTokenizers.Cardinal.serialize-755"><a href="#StepTokenizers.Cardinal.serialize-755"><span class="linenos">755</span></a>                            <span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.serialize-756"><a href="#StepTokenizers.Cardinal.serialize-756"><span class="linenos">756</span></a>                        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</span><span id="StepTokenizers.Cardinal.serialize-757"><a href="#StepTokenizers.Cardinal.serialize-757"><span class="linenos">757</span></a>
</span><span id="StepTokenizers.Cardinal.serialize-758"><a href="#StepTokenizers.Cardinal.serialize-758"><span class="linenos">758</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="StepTokenizers.Cardinal.serialize-759"><a href="#StepTokenizers.Cardinal.serialize-759"><span class="linenos">759</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="StepTokenizers.Cardinal.serialize-760"><a href="#StepTokenizers.Cardinal.serialize-760"><span class="linenos">760</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="StepTokenizers.Cardinal.serialize-761"><a href="#StepTokenizers.Cardinal.serialize-761"><span class="linenos">761</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.serialize-762"><a href="#StepTokenizers.Cardinal.serialize-762"><span class="linenos">762</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepTokenizers.Cardinal.serialize-763"><a href="#StepTokenizers.Cardinal.serialize-763"><span class="linenos">763</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="StepTokenizers.Cardinal.serialize-764"><a href="#StepTokenizers.Cardinal.serialize-764"><span class="linenos">764</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="StepTokenizers.Cardinal.serialize-765"><a href="#StepTokenizers.Cardinal.serialize-765"><span class="linenos">765</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Cardinal.serialize-766"><a href="#StepTokenizers.Cardinal.serialize-766"><span class="linenos">766</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Cardinal.serialize-767"><a href="#StepTokenizers.Cardinal.serialize-767"><span class="linenos">767</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Cardinal.serialize-768"><a href="#StepTokenizers.Cardinal.serialize-768"><span class="linenos">768</span></a>                    <span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.serialize-769"><a href="#StepTokenizers.Cardinal.serialize-769"><span class="linenos">769</span></a>
</span><span id="StepTokenizers.Cardinal.serialize-770"><a href="#StepTokenizers.Cardinal.serialize-770"><span class="linenos">770</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="StepTokenizers.Cardinal.load" class="classattr">
                                        <input id="StepTokenizers.Cardinal.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Cardinal.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L776-L862" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Cardinal.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Cardinal.load-777"><a href="#StepTokenizers.Cardinal.load-777"><span class="linenos">777</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="StepTokenizers.Cardinal.load-778"><a href="#StepTokenizers.Cardinal.load-778"><span class="linenos">778</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="StepTokenizers.Cardinal.load-779"><a href="#StepTokenizers.Cardinal.load-779"><span class="linenos">779</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="StepTokenizers.Cardinal.load-780"><a href="#StepTokenizers.Cardinal.load-780"><span class="linenos">780</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="StepTokenizers.Cardinal.load-781"><a href="#StepTokenizers.Cardinal.load-781"><span class="linenos">781</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="StepTokenizers.Cardinal.load-782"><a href="#StepTokenizers.Cardinal.load-782"><span class="linenos">782</span></a>
</span><span id="StepTokenizers.Cardinal.load-783"><a href="#StepTokenizers.Cardinal.load-783"><span class="linenos">783</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="StepTokenizers.Cardinal.load-784"><a href="#StepTokenizers.Cardinal.load-784"><span class="linenos">784</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="StepTokenizers.Cardinal.load-785"><a href="#StepTokenizers.Cardinal.load-785"><span class="linenos">785</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Cardinal.load-786"><a href="#StepTokenizers.Cardinal.load-786"><span class="linenos">786</span></a>
</span><span id="StepTokenizers.Cardinal.load-787"><a href="#StepTokenizers.Cardinal.load-787"><span class="linenos">787</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.load-788"><a href="#StepTokenizers.Cardinal.load-788"><span class="linenos">788</span></a>
</span><span id="StepTokenizers.Cardinal.load-789"><a href="#StepTokenizers.Cardinal.load-789"><span class="linenos">789</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="StepTokenizers.Cardinal.load-790"><a href="#StepTokenizers.Cardinal.load-790"><span class="linenos">790</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="StepTokenizers.Cardinal.load-791"><a href="#StepTokenizers.Cardinal.load-791"><span class="linenos">791</span></a>
</span><span id="StepTokenizers.Cardinal.load-792"><a href="#StepTokenizers.Cardinal.load-792"><span class="linenos">792</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="StepTokenizers.Cardinal.load-793"><a href="#StepTokenizers.Cardinal.load-793"><span class="linenos">793</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="StepTokenizers.Cardinal.load-794"><a href="#StepTokenizers.Cardinal.load-794"><span class="linenos">794</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="StepTokenizers.Cardinal.load-795"><a href="#StepTokenizers.Cardinal.load-795"><span class="linenos">795</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="StepTokenizers.Cardinal.load-796"><a href="#StepTokenizers.Cardinal.load-796"><span class="linenos">796</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="StepTokenizers.Cardinal.load-797"><a href="#StepTokenizers.Cardinal.load-797"><span class="linenos">797</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="StepTokenizers.Cardinal.load-798"><a href="#StepTokenizers.Cardinal.load-798"><span class="linenos">798</span></a>
</span><span id="StepTokenizers.Cardinal.load-799"><a href="#StepTokenizers.Cardinal.load-799"><span class="linenos">799</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="StepTokenizers.Cardinal.load-800"><a href="#StepTokenizers.Cardinal.load-800"><span class="linenos">800</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="StepTokenizers.Cardinal.load-801"><a href="#StepTokenizers.Cardinal.load-801"><span class="linenos">801</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="StepTokenizers.Cardinal.load-802"><a href="#StepTokenizers.Cardinal.load-802"><span class="linenos">802</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="StepTokenizers.Cardinal.load-803"><a href="#StepTokenizers.Cardinal.load-803"><span class="linenos">803</span></a>
</span><span id="StepTokenizers.Cardinal.load-804"><a href="#StepTokenizers.Cardinal.load-804"><span class="linenos">804</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="StepTokenizers.Cardinal.load-805"><a href="#StepTokenizers.Cardinal.load-805"><span class="linenos">805</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.load-806"><a href="#StepTokenizers.Cardinal.load-806"><span class="linenos">806</span></a>
</span><span id="StepTokenizers.Cardinal.load-807"><a href="#StepTokenizers.Cardinal.load-807"><span class="linenos">807</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="StepTokenizers.Cardinal.load-808"><a href="#StepTokenizers.Cardinal.load-808"><span class="linenos">808</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="StepTokenizers.Cardinal.load-809"><a href="#StepTokenizers.Cardinal.load-809"><span class="linenos">809</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="StepTokenizers.Cardinal.load-810"><a href="#StepTokenizers.Cardinal.load-810"><span class="linenos">810</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.load-811"><a href="#StepTokenizers.Cardinal.load-811"><span class="linenos">811</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="StepTokenizers.Cardinal.load-812"><a href="#StepTokenizers.Cardinal.load-812"><span class="linenos">812</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="StepTokenizers.Cardinal.load-813"><a href="#StepTokenizers.Cardinal.load-813"><span class="linenos">813</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.load-814"><a href="#StepTokenizers.Cardinal.load-814"><span class="linenos">814</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="StepTokenizers.Cardinal.load-815"><a href="#StepTokenizers.Cardinal.load-815"><span class="linenos">815</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="StepTokenizers.Cardinal.load-816"><a href="#StepTokenizers.Cardinal.load-816"><span class="linenos">816</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.load-817"><a href="#StepTokenizers.Cardinal.load-817"><span class="linenos">817</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.load-818"><a href="#StepTokenizers.Cardinal.load-818"><span class="linenos">818</span></a>                    <span class="p">):</span>
</span><span id="StepTokenizers.Cardinal.load-819"><a href="#StepTokenizers.Cardinal.load-819"><span class="linenos">819</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="StepTokenizers.Cardinal.load-820"><a href="#StepTokenizers.Cardinal.load-820"><span class="linenos">820</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="StepTokenizers.Cardinal.load-821"><a href="#StepTokenizers.Cardinal.load-821"><span class="linenos">821</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.load-822"><a href="#StepTokenizers.Cardinal.load-822"><span class="linenos">822</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="StepTokenizers.Cardinal.load-823"><a href="#StepTokenizers.Cardinal.load-823"><span class="linenos">823</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="StepTokenizers.Cardinal.load-824"><a href="#StepTokenizers.Cardinal.load-824"><span class="linenos">824</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Cardinal.load-825"><a href="#StepTokenizers.Cardinal.load-825"><span class="linenos">825</span></a>                            <span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.load-826"><a href="#StepTokenizers.Cardinal.load-826"><span class="linenos">826</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="StepTokenizers.Cardinal.load-827"><a href="#StepTokenizers.Cardinal.load-827"><span class="linenos">827</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="StepTokenizers.Cardinal.load-828"><a href="#StepTokenizers.Cardinal.load-828"><span class="linenos">828</span></a>                        <span class="k">pass</span>
</span><span id="StepTokenizers.Cardinal.load-829"><a href="#StepTokenizers.Cardinal.load-829"><span class="linenos">829</span></a>
</span><span id="StepTokenizers.Cardinal.load-830"><a href="#StepTokenizers.Cardinal.load-830"><span class="linenos">830</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="StepTokenizers.Cardinal.load-831"><a href="#StepTokenizers.Cardinal.load-831"><span class="linenos">831</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepTokenizers.Cardinal.load-832"><a href="#StepTokenizers.Cardinal.load-832"><span class="linenos">832</span></a>
</span><span id="StepTokenizers.Cardinal.load-833"><a href="#StepTokenizers.Cardinal.load-833"><span class="linenos">833</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="StepTokenizers.Cardinal.load-834"><a href="#StepTokenizers.Cardinal.load-834"><span class="linenos">834</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.load-835"><a href="#StepTokenizers.Cardinal.load-835"><span class="linenos">835</span></a>
</span><span id="StepTokenizers.Cardinal.load-836"><a href="#StepTokenizers.Cardinal.load-836"><span class="linenos">836</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="StepTokenizers.Cardinal.load-837"><a href="#StepTokenizers.Cardinal.load-837"><span class="linenos">837</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="StepTokenizers.Cardinal.load-838"><a href="#StepTokenizers.Cardinal.load-838"><span class="linenos">838</span></a>                <span class="n">fields_valid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="StepTokenizers.Cardinal.load-839"><a href="#StepTokenizers.Cardinal.load-839"><span class="linenos">839</span></a>                    <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="StepTokenizers.Cardinal.load-840"><a href="#StepTokenizers.Cardinal.load-840"><span class="linenos">840</span></a>                        <span class="n">output</span><span class="p">,</span>
</span><span id="StepTokenizers.Cardinal.load-841"><a href="#StepTokenizers.Cardinal.load-841"><span class="linenos">841</span></a>                        <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">,</span>
</span><span id="StepTokenizers.Cardinal.load-842"><a href="#StepTokenizers.Cardinal.load-842"><span class="linenos">842</span></a>                    <span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.load-843"><a href="#StepTokenizers.Cardinal.load-843"><span class="linenos">843</span></a>                <span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.load-844"><a href="#StepTokenizers.Cardinal.load-844"><span class="linenos">844</span></a>
</span><span id="StepTokenizers.Cardinal.load-845"><a href="#StepTokenizers.Cardinal.load-845"><span class="linenos">845</span></a>                <span class="c1"># if there are any fields that are not valid, raise an error</span>
</span><span id="StepTokenizers.Cardinal.load-846"><a href="#StepTokenizers.Cardinal.load-846"><span class="linenos">846</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">fields_valid</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="StepTokenizers.Cardinal.load-847"><a href="#StepTokenizers.Cardinal.load-847"><span class="linenos">847</span></a>                    <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="StepTokenizers.Cardinal.load-848"><a href="#StepTokenizers.Cardinal.load-848"><span class="linenos">848</span></a>                        <span class="sa">f</span><span class="s2">&quot;Type mismatch in fields of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Cardinal.load-849"><a href="#StepTokenizers.Cardinal.load-849"><span class="linenos">849</span></a>                        <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="StepTokenizers.Cardinal.load-850"><a href="#StepTokenizers.Cardinal.load-850"><span class="linenos">850</span></a>                            <span class="p">[</span>
</span><span id="StepTokenizers.Cardinal.load-851"><a href="#StepTokenizers.Cardinal.load-851"><span class="linenos">851</span></a>                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">:</span><span class="se">\t</span><span class="s2">expected </span><span class="si">{</span><span class="n">cls_type_hints</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="si">= }</span><span class="s2">, but got value </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Cardinal.load-852"><a href="#StepTokenizers.Cardinal.load-852"><span class="linenos">852</span></a>                                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">fields_valid</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="StepTokenizers.Cardinal.load-853"><a href="#StepTokenizers.Cardinal.load-853"><span class="linenos">853</span></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span>
</span><span id="StepTokenizers.Cardinal.load-854"><a href="#StepTokenizers.Cardinal.load-854"><span class="linenos">854</span></a>                            <span class="p">]</span>
</span><span id="StepTokenizers.Cardinal.load-855"><a href="#StepTokenizers.Cardinal.load-855"><span class="linenos">855</span></a>                        <span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.load-856"><a href="#StepTokenizers.Cardinal.load-856"><span class="linenos">856</span></a>                    <span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.load-857"><a href="#StepTokenizers.Cardinal.load-857"><span class="linenos">857</span></a>
</span><span id="StepTokenizers.Cardinal.load-858"><a href="#StepTokenizers.Cardinal.load-858"><span class="linenos">858</span></a>                    <span class="n">on_typecheck_mismatch</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
</span><span id="StepTokenizers.Cardinal.load-859"><a href="#StepTokenizers.Cardinal.load-859"><span class="linenos">859</span></a>                        <span class="n">msg</span><span class="p">,</span> <span class="n">except_cls</span><span class="o">=</span><span class="n">FieldTypeMismatchError</span>
</span><span id="StepTokenizers.Cardinal.load-860"><a href="#StepTokenizers.Cardinal.load-860"><span class="linenos">860</span></a>                    <span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.load-861"><a href="#StepTokenizers.Cardinal.load-861"><span class="linenos">861</span></a>
</span><span id="StepTokenizers.Cardinal.load-862"><a href="#StepTokenizers.Cardinal.load-862"><span class="linenos">862</span></a>            <span class="c1"># return the new instance</span>
</span><span id="StepTokenizers.Cardinal.load-863"><a href="#StepTokenizers.Cardinal.load-863"><span class="linenos">863</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="StepTokenizers.Cardinal.validate_fields_types" class="classattr">
                                        <input id="StepTokenizers.Cardinal.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Cardinal.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L282-L291" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Cardinal.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Cardinal.validate_fields_types-283"><a href="#StepTokenizers.Cardinal.validate_fields_types-283"><span class="linenos">283</span></a><span class="k">def</span><span class="w"> </span><span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="StepTokenizers.Cardinal.validate_fields_types-284"><a href="#StepTokenizers.Cardinal.validate_fields_types-284"><span class="linenos">284</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="StepTokenizers.Cardinal.validate_fields_types-285"><a href="#StepTokenizers.Cardinal.validate_fields_types-285"><span class="linenos">285</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="StepTokenizers.Cardinal.validate_fields_types-286"><a href="#StepTokenizers.Cardinal.validate_fields_types-286"><span class="linenos">286</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="StepTokenizers.Cardinal.validate_fields_types-287"><a href="#StepTokenizers.Cardinal.validate_fields_types-287"><span class="linenos">287</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="StepTokenizers.Cardinal.validate_fields_types-288"><a href="#StepTokenizers.Cardinal.validate_fields_types-288"><span class="linenos">288</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="StepTokenizers.Cardinal.validate_fields_types-289"><a href="#StepTokenizers.Cardinal.validate_fields_types-289"><span class="linenos">289</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="StepTokenizers.Cardinal.validate_fields_types-290"><a href="#StepTokenizers.Cardinal.validate_fields_types-290"><span class="linenos">290</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="StepTokenizers.Cardinal.validate_fields_types-291"><a href="#StepTokenizers.Cardinal.validate_fields_types-291"><span class="linenos">291</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="StepTokenizers.Cardinal.validate_fields_types-292"><a href="#StepTokenizers.Cardinal.validate_fields_types-292"><span class="linenos">292</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#StepTokenizers._StepTokenizer">StepTokenizers._StepTokenizer</a></dt>
                                <dd id="StepTokenizers.Cardinal.attribute_key" class="function"><a href="#StepTokenizers._StepTokenizer.attribute_key">attribute_key</a></dd>
                <dd id="StepTokenizers.Cardinal.is_valid" class="function"><a href="#StepTokenizers._StepTokenizer.is_valid">is_valid</a></dd>

            </div>
            <div><dt><a href="element_base.html#_TokenizerElement">maze_dataset.tokenization.modular.element_base._TokenizerElement</a></dt>
                                <dd id="StepTokenizers.Cardinal.name" class="variable"><a href="element_base.html#_TokenizerElement.name">name</a></dd>
                <dd id="StepTokenizers.Cardinal.tokenizer_elements" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="StepTokenizers.Cardinal.tokenizer_element_tree" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="StepTokenizers.Cardinal.tokenizer_element_dict" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="StepTokenizers.Cardinal.validate_field_type" class="function">validate_field_type</dd>
                <dd id="StepTokenizers.Cardinal.diff" class="function">diff</dd>
                <dd id="StepTokenizers.Cardinal.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="StepTokenizers.Relative">
                            <input id="StepTokenizers.Relative-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">StepTokenizers.Relative</span><wbr>(<span class="base"><a href="#StepTokenizers._StepTokenizer">StepTokenizers._StepTokenizer</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Relative-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L834-L868" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Relative"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Relative-835"><a href="#StepTokenizers.Relative-835"><span class="linenos">835</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepTokenizers.Relative-836"><a href="#StepTokenizers.Relative-836"><span class="linenos">836</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">Relative</span><span class="p">(</span><span class="n">_StepTokenizer</span><span class="p">):</span>
</span><span id="StepTokenizers.Relative-837"><a href="#StepTokenizers.Relative-837"><span class="linenos">837</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Tokenizes a solution step using relative first-person directions (right, left, forward, etc.).</span>
</span><span id="StepTokenizers.Relative-838"><a href="#StepTokenizers.Relative-838"><span class="linenos">838</span></a>
</span><span id="StepTokenizers.Relative-839"><a href="#StepTokenizers.Relative-839"><span class="linenos">839</span></a><span class="sd">		To simplify the indeterminacy, at the start of a solution the &quot;agent&quot; solving the maze is assumed to be facing NORTH.</span>
</span><span id="StepTokenizers.Relative-840"><a href="#StepTokenizers.Relative-840"><span class="linenos">840</span></a><span class="sd">		Similarly to `Cardinal`, the direction is that of the step from the starting position.</span>
</span><span id="StepTokenizers.Relative-841"><a href="#StepTokenizers.Relative-841"><span class="linenos">841</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="StepTokenizers.Relative-842"><a href="#StepTokenizers.Relative-842"><span class="linenos">842</span></a>
</span><span id="StepTokenizers.Relative-843"><a href="#StepTokenizers.Relative-843"><span class="linenos">843</span></a>		<span class="c1"># inherit docstring</span>
</span><span id="StepTokenizers.Relative-844"><a href="#StepTokenizers.Relative-844"><span class="linenos">844</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>  <span class="c1"># noqa: D102</span>
</span><span id="StepTokenizers.Relative-845"><a href="#StepTokenizers.Relative-845"><span class="linenos">845</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="StepTokenizers.Relative-846"><a href="#StepTokenizers.Relative-846"><span class="linenos">846</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="StepTokenizers.Relative-847"><a href="#StepTokenizers.Relative-847"><span class="linenos">847</span></a>			<span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers.Relative-848"><a href="#StepTokenizers.Relative-848"><span class="linenos">848</span></a>			<span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers.Relative-849"><a href="#StepTokenizers.Relative-849"><span class="linenos">849</span></a>			<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="StepTokenizers.Relative-850"><a href="#StepTokenizers.Relative-850"><span class="linenos">850</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="StepTokenizers.Relative-851"><a href="#StepTokenizers.Relative-851"><span class="linenos">851</span></a>			<span class="k">if</span> <span class="n">start_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="StepTokenizers.Relative-852"><a href="#StepTokenizers.Relative-852"><span class="linenos">852</span></a>				<span class="n">start</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="StepTokenizers.Relative-853"><a href="#StepTokenizers.Relative-853"><span class="linenos">853</span></a>				<span class="n">previous</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="StepTokenizers.Relative-854"><a href="#StepTokenizers.Relative-854"><span class="linenos">854</span></a>				<span class="k">return</span> <span class="p">[</span>
</span><span id="StepTokenizers.Relative-855"><a href="#StepTokenizers.Relative-855"><span class="linenos">855</span></a>					<span class="n">get_relative_direction</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative-856"><a href="#StepTokenizers.Relative-856"><span class="linenos">856</span></a>						<span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative-857"><a href="#StepTokenizers.Relative-857"><span class="linenos">857</span></a>							<span class="p">(</span>
</span><span id="StepTokenizers.Relative-858"><a href="#StepTokenizers.Relative-858"><span class="linenos">858</span></a>								<span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">previous</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span><span id="StepTokenizers.Relative-859"><a href="#StepTokenizers.Relative-859"><span class="linenos">859</span></a>								<span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">start_index</span> <span class="p">:</span> <span class="n">start_index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">],</span>
</span><span id="StepTokenizers.Relative-860"><a href="#StepTokenizers.Relative-860"><span class="linenos">860</span></a>							<span class="p">),</span>
</span><span id="StepTokenizers.Relative-861"><a href="#StepTokenizers.Relative-861"><span class="linenos">861</span></a>							<span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="StepTokenizers.Relative-862"><a href="#StepTokenizers.Relative-862"><span class="linenos">862</span></a>						<span class="p">),</span>
</span><span id="StepTokenizers.Relative-863"><a href="#StepTokenizers.Relative-863"><span class="linenos">863</span></a>					<span class="p">),</span>
</span><span id="StepTokenizers.Relative-864"><a href="#StepTokenizers.Relative-864"><span class="linenos">864</span></a>				<span class="p">]</span>
</span><span id="StepTokenizers.Relative-865"><a href="#StepTokenizers.Relative-865"><span class="linenos">865</span></a>			<span class="k">return</span> <span class="p">[</span>
</span><span id="StepTokenizers.Relative-866"><a href="#StepTokenizers.Relative-866"><span class="linenos">866</span></a>				<span class="n">get_relative_direction</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative-867"><a href="#StepTokenizers.Relative-867"><span class="linenos">867</span></a>					<span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">start_index</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">start_index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">],</span>
</span><span id="StepTokenizers.Relative-868"><a href="#StepTokenizers.Relative-868"><span class="linenos">868</span></a>				<span class="p">),</span>
</span><span id="StepTokenizers.Relative-869"><a href="#StepTokenizers.Relative-869"><span class="linenos">869</span></a>			<span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Tokenizes a solution step using relative first-person directions (right, left, forward, etc.).</p>

<p>To simplify the indeterminacy, at the start of a solution the "agent" solving the maze is assumed to be facing NORTH.
Similarly to <code><a href="#StepTokenizers.Cardinal">Cardinal</a></code>, the direction is that of the step from the starting position.</p>
</div>


                            <div id="StepTokenizers.Relative.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">StepTokenizers.Relative</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#StepTokenizers.Relative">StepTokenizers.Relative</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#StepTokenizers.Relative">StepTokenizers.Relative</a>&#39;&gt;&quot;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#StepTokenizers.Relative.__init__"></a>
    
    

                            </div>
                            <div id="StepTokenizers.Relative.to_tokens" class="classattr">
                                        <input id="StepTokenizers.Relative.to_tokens-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_tokens</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">maze</span><span class="p">:</span> <span class="n"><a href="../../../maze_dataset.html#SolvedMaze">maze_dataset.SolvedMaze</a></span>,</span><span class="param">	<span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Relative.to_tokens-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L843-L868" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Relative.to_tokens"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Relative.to_tokens-844"><a href="#StepTokenizers.Relative.to_tokens-844"><span class="linenos">844</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>  <span class="c1"># noqa: D102</span>
</span><span id="StepTokenizers.Relative.to_tokens-845"><a href="#StepTokenizers.Relative.to_tokens-845"><span class="linenos">845</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="StepTokenizers.Relative.to_tokens-846"><a href="#StepTokenizers.Relative.to_tokens-846"><span class="linenos">846</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="StepTokenizers.Relative.to_tokens-847"><a href="#StepTokenizers.Relative.to_tokens-847"><span class="linenos">847</span></a>			<span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers.Relative.to_tokens-848"><a href="#StepTokenizers.Relative.to_tokens-848"><span class="linenos">848</span></a>			<span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers.Relative.to_tokens-849"><a href="#StepTokenizers.Relative.to_tokens-849"><span class="linenos">849</span></a>			<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="StepTokenizers.Relative.to_tokens-850"><a href="#StepTokenizers.Relative.to_tokens-850"><span class="linenos">850</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="StepTokenizers.Relative.to_tokens-851"><a href="#StepTokenizers.Relative.to_tokens-851"><span class="linenos">851</span></a>			<span class="k">if</span> <span class="n">start_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="StepTokenizers.Relative.to_tokens-852"><a href="#StepTokenizers.Relative.to_tokens-852"><span class="linenos">852</span></a>				<span class="n">start</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="StepTokenizers.Relative.to_tokens-853"><a href="#StepTokenizers.Relative.to_tokens-853"><span class="linenos">853</span></a>				<span class="n">previous</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="StepTokenizers.Relative.to_tokens-854"><a href="#StepTokenizers.Relative.to_tokens-854"><span class="linenos">854</span></a>				<span class="k">return</span> <span class="p">[</span>
</span><span id="StepTokenizers.Relative.to_tokens-855"><a href="#StepTokenizers.Relative.to_tokens-855"><span class="linenos">855</span></a>					<span class="n">get_relative_direction</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative.to_tokens-856"><a href="#StepTokenizers.Relative.to_tokens-856"><span class="linenos">856</span></a>						<span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative.to_tokens-857"><a href="#StepTokenizers.Relative.to_tokens-857"><span class="linenos">857</span></a>							<span class="p">(</span>
</span><span id="StepTokenizers.Relative.to_tokens-858"><a href="#StepTokenizers.Relative.to_tokens-858"><span class="linenos">858</span></a>								<span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">previous</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span><span id="StepTokenizers.Relative.to_tokens-859"><a href="#StepTokenizers.Relative.to_tokens-859"><span class="linenos">859</span></a>								<span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">start_index</span> <span class="p">:</span> <span class="n">start_index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">],</span>
</span><span id="StepTokenizers.Relative.to_tokens-860"><a href="#StepTokenizers.Relative.to_tokens-860"><span class="linenos">860</span></a>							<span class="p">),</span>
</span><span id="StepTokenizers.Relative.to_tokens-861"><a href="#StepTokenizers.Relative.to_tokens-861"><span class="linenos">861</span></a>							<span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="StepTokenizers.Relative.to_tokens-862"><a href="#StepTokenizers.Relative.to_tokens-862"><span class="linenos">862</span></a>						<span class="p">),</span>
</span><span id="StepTokenizers.Relative.to_tokens-863"><a href="#StepTokenizers.Relative.to_tokens-863"><span class="linenos">863</span></a>					<span class="p">),</span>
</span><span id="StepTokenizers.Relative.to_tokens-864"><a href="#StepTokenizers.Relative.to_tokens-864"><span class="linenos">864</span></a>				<span class="p">]</span>
</span><span id="StepTokenizers.Relative.to_tokens-865"><a href="#StepTokenizers.Relative.to_tokens-865"><span class="linenos">865</span></a>			<span class="k">return</span> <span class="p">[</span>
</span><span id="StepTokenizers.Relative.to_tokens-866"><a href="#StepTokenizers.Relative.to_tokens-866"><span class="linenos">866</span></a>				<span class="n">get_relative_direction</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative.to_tokens-867"><a href="#StepTokenizers.Relative.to_tokens-867"><span class="linenos">867</span></a>					<span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">start_index</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">start_index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">],</span>
</span><span id="StepTokenizers.Relative.to_tokens-868"><a href="#StepTokenizers.Relative.to_tokens-868"><span class="linenos">868</span></a>				<span class="p">),</span>
</span><span id="StepTokenizers.Relative.to_tokens-869"><a href="#StepTokenizers.Relative.to_tokens-869"><span class="linenos">869</span></a>			<span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Tokenizes a single step in the solution.</p>

<h1 id="parameters">Parameters</h1>

<ul>
<li><code>maze</code>: Maze to be tokenized</li>
<li><code>start_index</code>: The index of the Coord in <code>maze.solution</code> at which the current step starts</li>
<li><code>end_index</code>: The index of the Coord in <code>maze.solution</code> at which the current step ends</li>
</ul>
</div>


                            </div>
                            <div id="StepTokenizers.Relative.serialize" class="classattr">
                                        <input id="StepTokenizers.Relative.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Relative.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L713-L769" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Relative.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Relative.serialize-714"><a href="#StepTokenizers.Relative.serialize-714"><span class="linenos">714</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="StepTokenizers.Relative.serialize-715"><a href="#StepTokenizers.Relative.serialize-715"><span class="linenos">715</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="StepTokenizers.Relative.serialize-716"><a href="#StepTokenizers.Relative.serialize-716"><span class="linenos">716</span></a>                <span class="n">_FORMAT_KEY</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="StepTokenizers.Relative.serialize-717"><a href="#StepTokenizers.Relative.serialize-717"><span class="linenos">717</span></a>            <span class="p">}</span>
</span><span id="StepTokenizers.Relative.serialize-718"><a href="#StepTokenizers.Relative.serialize-718"><span class="linenos">718</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="StepTokenizers.Relative.serialize-719"><a href="#StepTokenizers.Relative.serialize-719"><span class="linenos">719</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="StepTokenizers.Relative.serialize-720"><a href="#StepTokenizers.Relative.serialize-720"><span class="linenos">720</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="StepTokenizers.Relative.serialize-721"><a href="#StepTokenizers.Relative.serialize-721"><span class="linenos">721</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="StepTokenizers.Relative.serialize-722"><a href="#StepTokenizers.Relative.serialize-722"><span class="linenos">722</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative.serialize-723"><a href="#StepTokenizers.Relative.serialize-723"><span class="linenos">723</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="StepTokenizers.Relative.serialize-724"><a href="#StepTokenizers.Relative.serialize-724"><span class="linenos">724</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="StepTokenizers.Relative.serialize-725"><a href="#StepTokenizers.Relative.serialize-725"><span class="linenos">725</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="StepTokenizers.Relative.serialize-726"><a href="#StepTokenizers.Relative.serialize-726"><span class="linenos">726</span></a>                    <span class="p">)</span>
</span><span id="StepTokenizers.Relative.serialize-727"><a href="#StepTokenizers.Relative.serialize-727"><span class="linenos">727</span></a>
</span><span id="StepTokenizers.Relative.serialize-728"><a href="#StepTokenizers.Relative.serialize-728"><span class="linenos">728</span></a>                <span class="c1"># try to save it</span>
</span><span id="StepTokenizers.Relative.serialize-729"><a href="#StepTokenizers.Relative.serialize-729"><span class="linenos">729</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="StepTokenizers.Relative.serialize-730"><a href="#StepTokenizers.Relative.serialize-730"><span class="linenos">730</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="StepTokenizers.Relative.serialize-731"><a href="#StepTokenizers.Relative.serialize-731"><span class="linenos">731</span></a>                        <span class="c1"># get the val</span>
</span><span id="StepTokenizers.Relative.serialize-732"><a href="#StepTokenizers.Relative.serialize-732"><span class="linenos">732</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="StepTokenizers.Relative.serialize-733"><a href="#StepTokenizers.Relative.serialize-733"><span class="linenos">733</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="StepTokenizers.Relative.serialize-734"><a href="#StepTokenizers.Relative.serialize-734"><span class="linenos">734</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="StepTokenizers.Relative.serialize-735"><a href="#StepTokenizers.Relative.serialize-735"><span class="linenos">735</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="StepTokenizers.Relative.serialize-736"><a href="#StepTokenizers.Relative.serialize-736"><span class="linenos">736</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="StepTokenizers.Relative.serialize-737"><a href="#StepTokenizers.Relative.serialize-737"><span class="linenos">737</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="StepTokenizers.Relative.serialize-738"><a href="#StepTokenizers.Relative.serialize-738"><span class="linenos">738</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="StepTokenizers.Relative.serialize-739"><a href="#StepTokenizers.Relative.serialize-739"><span class="linenos">739</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="StepTokenizers.Relative.serialize-740"><a href="#StepTokenizers.Relative.serialize-740"><span class="linenos">740</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="StepTokenizers.Relative.serialize-741"><a href="#StepTokenizers.Relative.serialize-741"><span class="linenos">741</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="StepTokenizers.Relative.serialize-742"><a href="#StepTokenizers.Relative.serialize-742"><span class="linenos">742</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepTokenizers.Relative.serialize-743"><a href="#StepTokenizers.Relative.serialize-743"><span class="linenos">743</span></a>
</span><span id="StepTokenizers.Relative.serialize-744"><a href="#StepTokenizers.Relative.serialize-744"><span class="linenos">744</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="StepTokenizers.Relative.serialize-745"><a href="#StepTokenizers.Relative.serialize-745"><span class="linenos">745</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepTokenizers.Relative.serialize-746"><a href="#StepTokenizers.Relative.serialize-746"><span class="linenos">746</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="StepTokenizers.Relative.serialize-747"><a href="#StepTokenizers.Relative.serialize-747"><span class="linenos">747</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative.serialize-748"><a href="#StepTokenizers.Relative.serialize-748"><span class="linenos">748</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative.serialize-749"><a href="#StepTokenizers.Relative.serialize-749"><span class="linenos">749</span></a>                                <span class="p">[</span>
</span><span id="StepTokenizers.Relative.serialize-750"><a href="#StepTokenizers.Relative.serialize-750"><span class="linenos">750</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers.Relative.serialize-751"><a href="#StepTokenizers.Relative.serialize-751"><span class="linenos">751</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers.Relative.serialize-752"><a href="#StepTokenizers.Relative.serialize-752"><span class="linenos">752</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers.Relative.serialize-753"><a href="#StepTokenizers.Relative.serialize-753"><span class="linenos">753</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers.Relative.serialize-754"><a href="#StepTokenizers.Relative.serialize-754"><span class="linenos">754</span></a>                                <span class="p">]</span>
</span><span id="StepTokenizers.Relative.serialize-755"><a href="#StepTokenizers.Relative.serialize-755"><span class="linenos">755</span></a>                            <span class="p">)</span>
</span><span id="StepTokenizers.Relative.serialize-756"><a href="#StepTokenizers.Relative.serialize-756"><span class="linenos">756</span></a>                        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</span><span id="StepTokenizers.Relative.serialize-757"><a href="#StepTokenizers.Relative.serialize-757"><span class="linenos">757</span></a>
</span><span id="StepTokenizers.Relative.serialize-758"><a href="#StepTokenizers.Relative.serialize-758"><span class="linenos">758</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="StepTokenizers.Relative.serialize-759"><a href="#StepTokenizers.Relative.serialize-759"><span class="linenos">759</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="StepTokenizers.Relative.serialize-760"><a href="#StepTokenizers.Relative.serialize-760"><span class="linenos">760</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="StepTokenizers.Relative.serialize-761"><a href="#StepTokenizers.Relative.serialize-761"><span class="linenos">761</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="StepTokenizers.Relative.serialize-762"><a href="#StepTokenizers.Relative.serialize-762"><span class="linenos">762</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepTokenizers.Relative.serialize-763"><a href="#StepTokenizers.Relative.serialize-763"><span class="linenos">763</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="StepTokenizers.Relative.serialize-764"><a href="#StepTokenizers.Relative.serialize-764"><span class="linenos">764</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative.serialize-765"><a href="#StepTokenizers.Relative.serialize-765"><span class="linenos">765</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Relative.serialize-766"><a href="#StepTokenizers.Relative.serialize-766"><span class="linenos">766</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Relative.serialize-767"><a href="#StepTokenizers.Relative.serialize-767"><span class="linenos">767</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Relative.serialize-768"><a href="#StepTokenizers.Relative.serialize-768"><span class="linenos">768</span></a>                    <span class="p">)</span>
</span><span id="StepTokenizers.Relative.serialize-769"><a href="#StepTokenizers.Relative.serialize-769"><span class="linenos">769</span></a>
</span><span id="StepTokenizers.Relative.serialize-770"><a href="#StepTokenizers.Relative.serialize-770"><span class="linenos">770</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="StepTokenizers.Relative.load" class="classattr">
                                        <input id="StepTokenizers.Relative.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Relative.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L776-L862" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Relative.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Relative.load-777"><a href="#StepTokenizers.Relative.load-777"><span class="linenos">777</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="StepTokenizers.Relative.load-778"><a href="#StepTokenizers.Relative.load-778"><span class="linenos">778</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="StepTokenizers.Relative.load-779"><a href="#StepTokenizers.Relative.load-779"><span class="linenos">779</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="StepTokenizers.Relative.load-780"><a href="#StepTokenizers.Relative.load-780"><span class="linenos">780</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="StepTokenizers.Relative.load-781"><a href="#StepTokenizers.Relative.load-781"><span class="linenos">781</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="StepTokenizers.Relative.load-782"><a href="#StepTokenizers.Relative.load-782"><span class="linenos">782</span></a>
</span><span id="StepTokenizers.Relative.load-783"><a href="#StepTokenizers.Relative.load-783"><span class="linenos">783</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative.load-784"><a href="#StepTokenizers.Relative.load-784"><span class="linenos">784</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="StepTokenizers.Relative.load-785"><a href="#StepTokenizers.Relative.load-785"><span class="linenos">785</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Relative.load-786"><a href="#StepTokenizers.Relative.load-786"><span class="linenos">786</span></a>
</span><span id="StepTokenizers.Relative.load-787"><a href="#StepTokenizers.Relative.load-787"><span class="linenos">787</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="StepTokenizers.Relative.load-788"><a href="#StepTokenizers.Relative.load-788"><span class="linenos">788</span></a>
</span><span id="StepTokenizers.Relative.load-789"><a href="#StepTokenizers.Relative.load-789"><span class="linenos">789</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="StepTokenizers.Relative.load-790"><a href="#StepTokenizers.Relative.load-790"><span class="linenos">790</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="StepTokenizers.Relative.load-791"><a href="#StepTokenizers.Relative.load-791"><span class="linenos">791</span></a>
</span><span id="StepTokenizers.Relative.load-792"><a href="#StepTokenizers.Relative.load-792"><span class="linenos">792</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="StepTokenizers.Relative.load-793"><a href="#StepTokenizers.Relative.load-793"><span class="linenos">793</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="StepTokenizers.Relative.load-794"><a href="#StepTokenizers.Relative.load-794"><span class="linenos">794</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="StepTokenizers.Relative.load-795"><a href="#StepTokenizers.Relative.load-795"><span class="linenos">795</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative.load-796"><a href="#StepTokenizers.Relative.load-796"><span class="linenos">796</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="StepTokenizers.Relative.load-797"><a href="#StepTokenizers.Relative.load-797"><span class="linenos">797</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="StepTokenizers.Relative.load-798"><a href="#StepTokenizers.Relative.load-798"><span class="linenos">798</span></a>
</span><span id="StepTokenizers.Relative.load-799"><a href="#StepTokenizers.Relative.load-799"><span class="linenos">799</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="StepTokenizers.Relative.load-800"><a href="#StepTokenizers.Relative.load-800"><span class="linenos">800</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="StepTokenizers.Relative.load-801"><a href="#StepTokenizers.Relative.load-801"><span class="linenos">801</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="StepTokenizers.Relative.load-802"><a href="#StepTokenizers.Relative.load-802"><span class="linenos">802</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="StepTokenizers.Relative.load-803"><a href="#StepTokenizers.Relative.load-803"><span class="linenos">803</span></a>
</span><span id="StepTokenizers.Relative.load-804"><a href="#StepTokenizers.Relative.load-804"><span class="linenos">804</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="StepTokenizers.Relative.load-805"><a href="#StepTokenizers.Relative.load-805"><span class="linenos">805</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="StepTokenizers.Relative.load-806"><a href="#StepTokenizers.Relative.load-806"><span class="linenos">806</span></a>
</span><span id="StepTokenizers.Relative.load-807"><a href="#StepTokenizers.Relative.load-807"><span class="linenos">807</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="StepTokenizers.Relative.load-808"><a href="#StepTokenizers.Relative.load-808"><span class="linenos">808</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="StepTokenizers.Relative.load-809"><a href="#StepTokenizers.Relative.load-809"><span class="linenos">809</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="StepTokenizers.Relative.load-810"><a href="#StepTokenizers.Relative.load-810"><span class="linenos">810</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepTokenizers.Relative.load-811"><a href="#StepTokenizers.Relative.load-811"><span class="linenos">811</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="StepTokenizers.Relative.load-812"><a href="#StepTokenizers.Relative.load-812"><span class="linenos">812</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="StepTokenizers.Relative.load-813"><a href="#StepTokenizers.Relative.load-813"><span class="linenos">813</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="StepTokenizers.Relative.load-814"><a href="#StepTokenizers.Relative.load-814"><span class="linenos">814</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="StepTokenizers.Relative.load-815"><a href="#StepTokenizers.Relative.load-815"><span class="linenos">815</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="StepTokenizers.Relative.load-816"><a href="#StepTokenizers.Relative.load-816"><span class="linenos">816</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="StepTokenizers.Relative.load-817"><a href="#StepTokenizers.Relative.load-817"><span class="linenos">817</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="StepTokenizers.Relative.load-818"><a href="#StepTokenizers.Relative.load-818"><span class="linenos">818</span></a>                    <span class="p">):</span>
</span><span id="StepTokenizers.Relative.load-819"><a href="#StepTokenizers.Relative.load-819"><span class="linenos">819</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="StepTokenizers.Relative.load-820"><a href="#StepTokenizers.Relative.load-820"><span class="linenos">820</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="StepTokenizers.Relative.load-821"><a href="#StepTokenizers.Relative.load-821"><span class="linenos">821</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepTokenizers.Relative.load-822"><a href="#StepTokenizers.Relative.load-822"><span class="linenos">822</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="StepTokenizers.Relative.load-823"><a href="#StepTokenizers.Relative.load-823"><span class="linenos">823</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative.load-824"><a href="#StepTokenizers.Relative.load-824"><span class="linenos">824</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Relative.load-825"><a href="#StepTokenizers.Relative.load-825"><span class="linenos">825</span></a>                            <span class="p">)</span>
</span><span id="StepTokenizers.Relative.load-826"><a href="#StepTokenizers.Relative.load-826"><span class="linenos">826</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="StepTokenizers.Relative.load-827"><a href="#StepTokenizers.Relative.load-827"><span class="linenos">827</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="StepTokenizers.Relative.load-828"><a href="#StepTokenizers.Relative.load-828"><span class="linenos">828</span></a>                        <span class="k">pass</span>
</span><span id="StepTokenizers.Relative.load-829"><a href="#StepTokenizers.Relative.load-829"><span class="linenos">829</span></a>
</span><span id="StepTokenizers.Relative.load-830"><a href="#StepTokenizers.Relative.load-830"><span class="linenos">830</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="StepTokenizers.Relative.load-831"><a href="#StepTokenizers.Relative.load-831"><span class="linenos">831</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepTokenizers.Relative.load-832"><a href="#StepTokenizers.Relative.load-832"><span class="linenos">832</span></a>
</span><span id="StepTokenizers.Relative.load-833"><a href="#StepTokenizers.Relative.load-833"><span class="linenos">833</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="StepTokenizers.Relative.load-834"><a href="#StepTokenizers.Relative.load-834"><span class="linenos">834</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="StepTokenizers.Relative.load-835"><a href="#StepTokenizers.Relative.load-835"><span class="linenos">835</span></a>
</span><span id="StepTokenizers.Relative.load-836"><a href="#StepTokenizers.Relative.load-836"><span class="linenos">836</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="StepTokenizers.Relative.load-837"><a href="#StepTokenizers.Relative.load-837"><span class="linenos">837</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="StepTokenizers.Relative.load-838"><a href="#StepTokenizers.Relative.load-838"><span class="linenos">838</span></a>                <span class="n">fields_valid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="StepTokenizers.Relative.load-839"><a href="#StepTokenizers.Relative.load-839"><span class="linenos">839</span></a>                    <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative.load-840"><a href="#StepTokenizers.Relative.load-840"><span class="linenos">840</span></a>                        <span class="n">output</span><span class="p">,</span>
</span><span id="StepTokenizers.Relative.load-841"><a href="#StepTokenizers.Relative.load-841"><span class="linenos">841</span></a>                        <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">,</span>
</span><span id="StepTokenizers.Relative.load-842"><a href="#StepTokenizers.Relative.load-842"><span class="linenos">842</span></a>                    <span class="p">)</span>
</span><span id="StepTokenizers.Relative.load-843"><a href="#StepTokenizers.Relative.load-843"><span class="linenos">843</span></a>                <span class="p">)</span>
</span><span id="StepTokenizers.Relative.load-844"><a href="#StepTokenizers.Relative.load-844"><span class="linenos">844</span></a>
</span><span id="StepTokenizers.Relative.load-845"><a href="#StepTokenizers.Relative.load-845"><span class="linenos">845</span></a>                <span class="c1"># if there are any fields that are not valid, raise an error</span>
</span><span id="StepTokenizers.Relative.load-846"><a href="#StepTokenizers.Relative.load-846"><span class="linenos">846</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">fields_valid</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="StepTokenizers.Relative.load-847"><a href="#StepTokenizers.Relative.load-847"><span class="linenos">847</span></a>                    <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="StepTokenizers.Relative.load-848"><a href="#StepTokenizers.Relative.load-848"><span class="linenos">848</span></a>                        <span class="sa">f</span><span class="s2">&quot;Type mismatch in fields of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Relative.load-849"><a href="#StepTokenizers.Relative.load-849"><span class="linenos">849</span></a>                        <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative.load-850"><a href="#StepTokenizers.Relative.load-850"><span class="linenos">850</span></a>                            <span class="p">[</span>
</span><span id="StepTokenizers.Relative.load-851"><a href="#StepTokenizers.Relative.load-851"><span class="linenos">851</span></a>                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">:</span><span class="se">\t</span><span class="s2">expected </span><span class="si">{</span><span class="n">cls_type_hints</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="si">= }</span><span class="s2">, but got value </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Relative.load-852"><a href="#StepTokenizers.Relative.load-852"><span class="linenos">852</span></a>                                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">fields_valid</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="StepTokenizers.Relative.load-853"><a href="#StepTokenizers.Relative.load-853"><span class="linenos">853</span></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span>
</span><span id="StepTokenizers.Relative.load-854"><a href="#StepTokenizers.Relative.load-854"><span class="linenos">854</span></a>                            <span class="p">]</span>
</span><span id="StepTokenizers.Relative.load-855"><a href="#StepTokenizers.Relative.load-855"><span class="linenos">855</span></a>                        <span class="p">)</span>
</span><span id="StepTokenizers.Relative.load-856"><a href="#StepTokenizers.Relative.load-856"><span class="linenos">856</span></a>                    <span class="p">)</span>
</span><span id="StepTokenizers.Relative.load-857"><a href="#StepTokenizers.Relative.load-857"><span class="linenos">857</span></a>
</span><span id="StepTokenizers.Relative.load-858"><a href="#StepTokenizers.Relative.load-858"><span class="linenos">858</span></a>                    <span class="n">on_typecheck_mismatch</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative.load-859"><a href="#StepTokenizers.Relative.load-859"><span class="linenos">859</span></a>                        <span class="n">msg</span><span class="p">,</span> <span class="n">except_cls</span><span class="o">=</span><span class="n">FieldTypeMismatchError</span>
</span><span id="StepTokenizers.Relative.load-860"><a href="#StepTokenizers.Relative.load-860"><span class="linenos">860</span></a>                    <span class="p">)</span>
</span><span id="StepTokenizers.Relative.load-861"><a href="#StepTokenizers.Relative.load-861"><span class="linenos">861</span></a>
</span><span id="StepTokenizers.Relative.load-862"><a href="#StepTokenizers.Relative.load-862"><span class="linenos">862</span></a>            <span class="c1"># return the new instance</span>
</span><span id="StepTokenizers.Relative.load-863"><a href="#StepTokenizers.Relative.load-863"><span class="linenos">863</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="StepTokenizers.Relative.validate_fields_types" class="classattr">
                                        <input id="StepTokenizers.Relative.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Relative.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L282-L291" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Relative.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Relative.validate_fields_types-283"><a href="#StepTokenizers.Relative.validate_fields_types-283"><span class="linenos">283</span></a><span class="k">def</span><span class="w"> </span><span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative.validate_fields_types-284"><a href="#StepTokenizers.Relative.validate_fields_types-284"><span class="linenos">284</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="StepTokenizers.Relative.validate_fields_types-285"><a href="#StepTokenizers.Relative.validate_fields_types-285"><span class="linenos">285</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="StepTokenizers.Relative.validate_fields_types-286"><a href="#StepTokenizers.Relative.validate_fields_types-286"><span class="linenos">286</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="StepTokenizers.Relative.validate_fields_types-287"><a href="#StepTokenizers.Relative.validate_fields_types-287"><span class="linenos">287</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="StepTokenizers.Relative.validate_fields_types-288"><a href="#StepTokenizers.Relative.validate_fields_types-288"><span class="linenos">288</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative.validate_fields_types-289"><a href="#StepTokenizers.Relative.validate_fields_types-289"><span class="linenos">289</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative.validate_fields_types-290"><a href="#StepTokenizers.Relative.validate_fields_types-290"><span class="linenos">290</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="StepTokenizers.Relative.validate_fields_types-291"><a href="#StepTokenizers.Relative.validate_fields_types-291"><span class="linenos">291</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="StepTokenizers.Relative.validate_fields_types-292"><a href="#StepTokenizers.Relative.validate_fields_types-292"><span class="linenos">292</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#StepTokenizers._StepTokenizer">StepTokenizers._StepTokenizer</a></dt>
                                <dd id="StepTokenizers.Relative.attribute_key" class="function"><a href="#StepTokenizers._StepTokenizer.attribute_key">attribute_key</a></dd>
                <dd id="StepTokenizers.Relative.is_valid" class="function"><a href="#StepTokenizers._StepTokenizer.is_valid">is_valid</a></dd>

            </div>
            <div><dt><a href="element_base.html#_TokenizerElement">maze_dataset.tokenization.modular.element_base._TokenizerElement</a></dt>
                                <dd id="StepTokenizers.Relative.name" class="variable"><a href="element_base.html#_TokenizerElement.name">name</a></dd>
                <dd id="StepTokenizers.Relative.tokenizer_elements" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="StepTokenizers.Relative.tokenizer_element_tree" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="StepTokenizers.Relative.tokenizer_element_dict" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="StepTokenizers.Relative.validate_field_type" class="function">validate_field_type</dd>
                <dd id="StepTokenizers.Relative.diff" class="function">diff</dd>
                <dd id="StepTokenizers.Relative.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="StepTokenizers.Distance">
                            <input id="StepTokenizers.Distance-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">StepTokenizers.Distance</span><wbr>(<span class="base"><a href="#StepTokenizers._StepTokenizer">StepTokenizers._StepTokenizer</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Distance-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L870-L888" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Distance"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Distance-871"><a href="#StepTokenizers.Distance-871"><span class="linenos">871</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepTokenizers.Distance-872"><a href="#StepTokenizers.Distance-872"><span class="linenos">872</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">Distance</span><span class="p">(</span><span class="n">_StepTokenizer</span><span class="p">):</span>
</span><span id="StepTokenizers.Distance-873"><a href="#StepTokenizers.Distance-873"><span class="linenos">873</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;A count of the number of individual steps from the starting point to the end point.</span>
</span><span id="StepTokenizers.Distance-874"><a href="#StepTokenizers.Distance-874"><span class="linenos">874</span></a>
</span><span id="StepTokenizers.Distance-875"><a href="#StepTokenizers.Distance-875"><span class="linenos">875</span></a><span class="sd">		Contains no information about directionality, only the distance traveled in the step.</span>
</span><span id="StepTokenizers.Distance-876"><a href="#StepTokenizers.Distance-876"><span class="linenos">876</span></a><span class="sd">		`Distance` must be combined with at least one other `_StepTokenizer` in a `StepTokenizerPermutation`.</span>
</span><span id="StepTokenizers.Distance-877"><a href="#StepTokenizers.Distance-877"><span class="linenos">877</span></a><span class="sd">		This constraint is enforced in `_PathTokenizer.is_valid`.</span>
</span><span id="StepTokenizers.Distance-878"><a href="#StepTokenizers.Distance-878"><span class="linenos">878</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="StepTokenizers.Distance-879"><a href="#StepTokenizers.Distance-879"><span class="linenos">879</span></a>
</span><span id="StepTokenizers.Distance-880"><a href="#StepTokenizers.Distance-880"><span class="linenos">880</span></a>		<span class="c1"># inherit docstring</span>
</span><span id="StepTokenizers.Distance-881"><a href="#StepTokenizers.Distance-881"><span class="linenos">881</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>  <span class="c1"># noqa: D102</span>
</span><span id="StepTokenizers.Distance-882"><a href="#StepTokenizers.Distance-882"><span class="linenos">882</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="StepTokenizers.Distance-883"><a href="#StepTokenizers.Distance-883"><span class="linenos">883</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="StepTokenizers.Distance-884"><a href="#StepTokenizers.Distance-884"><span class="linenos">884</span></a>			<span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers.Distance-885"><a href="#StepTokenizers.Distance-885"><span class="linenos">885</span></a>			<span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers.Distance-886"><a href="#StepTokenizers.Distance-886"><span class="linenos">886</span></a>			<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="StepTokenizers.Distance-887"><a href="#StepTokenizers.Distance-887"><span class="linenos">887</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="StepTokenizers.Distance-888"><a href="#StepTokenizers.Distance-888"><span class="linenos">888</span></a>			<span class="n">d</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">end_index</span> <span class="o">-</span> <span class="n">start_index</span>
</span><span id="StepTokenizers.Distance-889"><a href="#StepTokenizers.Distance-889"><span class="linenos">889</span></a>			<span class="k">return</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">VOCAB</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;I_</span><span class="si">{</span><span class="n">d</span><span class="si">:</span><span class="s2">03</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)]</span>
</span></pre></div>


            <div class="docstring"><p>A count of the number of individual steps from the starting point to the end point.</p>

<p>Contains no information about directionality, only the distance traveled in the step.
<code><a href="#StepTokenizers.Distance">Distance</a></code> must be combined with at least one other <code>_StepTokenizer</code> in a <code><a href="#StepTokenizers.StepTokenizerPermutation">StepTokenizerPermutation</a></code>.
This constraint is enforced in <code>_PathTokenizer.is_valid</code>.</p>
</div>


                            <div id="StepTokenizers.Distance.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">StepTokenizers.Distance</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#StepTokenizers.Distance">StepTokenizers.Distance</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#StepTokenizers.Distance">StepTokenizers.Distance</a>&#39;&gt;&quot;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#StepTokenizers.Distance.__init__"></a>
    
    

                            </div>
                            <div id="StepTokenizers.Distance.to_tokens" class="classattr">
                                        <input id="StepTokenizers.Distance.to_tokens-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_tokens</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">maze</span><span class="p">:</span> <span class="n"><a href="../../../maze_dataset.html#SolvedMaze">maze_dataset.SolvedMaze</a></span>,</span><span class="param">	<span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Distance.to_tokens-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L880-L888" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Distance.to_tokens"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Distance.to_tokens-881"><a href="#StepTokenizers.Distance.to_tokens-881"><span class="linenos">881</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>  <span class="c1"># noqa: D102</span>
</span><span id="StepTokenizers.Distance.to_tokens-882"><a href="#StepTokenizers.Distance.to_tokens-882"><span class="linenos">882</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="StepTokenizers.Distance.to_tokens-883"><a href="#StepTokenizers.Distance.to_tokens-883"><span class="linenos">883</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="StepTokenizers.Distance.to_tokens-884"><a href="#StepTokenizers.Distance.to_tokens-884"><span class="linenos">884</span></a>			<span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers.Distance.to_tokens-885"><a href="#StepTokenizers.Distance.to_tokens-885"><span class="linenos">885</span></a>			<span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers.Distance.to_tokens-886"><a href="#StepTokenizers.Distance.to_tokens-886"><span class="linenos">886</span></a>			<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="StepTokenizers.Distance.to_tokens-887"><a href="#StepTokenizers.Distance.to_tokens-887"><span class="linenos">887</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="StepTokenizers.Distance.to_tokens-888"><a href="#StepTokenizers.Distance.to_tokens-888"><span class="linenos">888</span></a>			<span class="n">d</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">end_index</span> <span class="o">-</span> <span class="n">start_index</span>
</span><span id="StepTokenizers.Distance.to_tokens-889"><a href="#StepTokenizers.Distance.to_tokens-889"><span class="linenos">889</span></a>			<span class="k">return</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">VOCAB</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;I_</span><span class="si">{</span><span class="n">d</span><span class="si">:</span><span class="s2">03</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)]</span>
</span></pre></div>


            <div class="docstring"><p>Tokenizes a single step in the solution.</p>

<h1 id="parameters">Parameters</h1>

<ul>
<li><code>maze</code>: Maze to be tokenized</li>
<li><code>start_index</code>: The index of the Coord in <code>maze.solution</code> at which the current step starts</li>
<li><code>end_index</code>: The index of the Coord in <code>maze.solution</code> at which the current step ends</li>
</ul>
</div>


                            </div>
                            <div id="StepTokenizers.Distance.serialize" class="classattr">
                                        <input id="StepTokenizers.Distance.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Distance.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L713-L769" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Distance.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Distance.serialize-714"><a href="#StepTokenizers.Distance.serialize-714"><span class="linenos">714</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="StepTokenizers.Distance.serialize-715"><a href="#StepTokenizers.Distance.serialize-715"><span class="linenos">715</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="StepTokenizers.Distance.serialize-716"><a href="#StepTokenizers.Distance.serialize-716"><span class="linenos">716</span></a>                <span class="n">_FORMAT_KEY</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="StepTokenizers.Distance.serialize-717"><a href="#StepTokenizers.Distance.serialize-717"><span class="linenos">717</span></a>            <span class="p">}</span>
</span><span id="StepTokenizers.Distance.serialize-718"><a href="#StepTokenizers.Distance.serialize-718"><span class="linenos">718</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="StepTokenizers.Distance.serialize-719"><a href="#StepTokenizers.Distance.serialize-719"><span class="linenos">719</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="StepTokenizers.Distance.serialize-720"><a href="#StepTokenizers.Distance.serialize-720"><span class="linenos">720</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="StepTokenizers.Distance.serialize-721"><a href="#StepTokenizers.Distance.serialize-721"><span class="linenos">721</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="StepTokenizers.Distance.serialize-722"><a href="#StepTokenizers.Distance.serialize-722"><span class="linenos">722</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="StepTokenizers.Distance.serialize-723"><a href="#StepTokenizers.Distance.serialize-723"><span class="linenos">723</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="StepTokenizers.Distance.serialize-724"><a href="#StepTokenizers.Distance.serialize-724"><span class="linenos">724</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="StepTokenizers.Distance.serialize-725"><a href="#StepTokenizers.Distance.serialize-725"><span class="linenos">725</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="StepTokenizers.Distance.serialize-726"><a href="#StepTokenizers.Distance.serialize-726"><span class="linenos">726</span></a>                    <span class="p">)</span>
</span><span id="StepTokenizers.Distance.serialize-727"><a href="#StepTokenizers.Distance.serialize-727"><span class="linenos">727</span></a>
</span><span id="StepTokenizers.Distance.serialize-728"><a href="#StepTokenizers.Distance.serialize-728"><span class="linenos">728</span></a>                <span class="c1"># try to save it</span>
</span><span id="StepTokenizers.Distance.serialize-729"><a href="#StepTokenizers.Distance.serialize-729"><span class="linenos">729</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="StepTokenizers.Distance.serialize-730"><a href="#StepTokenizers.Distance.serialize-730"><span class="linenos">730</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="StepTokenizers.Distance.serialize-731"><a href="#StepTokenizers.Distance.serialize-731"><span class="linenos">731</span></a>                        <span class="c1"># get the val</span>
</span><span id="StepTokenizers.Distance.serialize-732"><a href="#StepTokenizers.Distance.serialize-732"><span class="linenos">732</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="StepTokenizers.Distance.serialize-733"><a href="#StepTokenizers.Distance.serialize-733"><span class="linenos">733</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="StepTokenizers.Distance.serialize-734"><a href="#StepTokenizers.Distance.serialize-734"><span class="linenos">734</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="StepTokenizers.Distance.serialize-735"><a href="#StepTokenizers.Distance.serialize-735"><span class="linenos">735</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="StepTokenizers.Distance.serialize-736"><a href="#StepTokenizers.Distance.serialize-736"><span class="linenos">736</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="StepTokenizers.Distance.serialize-737"><a href="#StepTokenizers.Distance.serialize-737"><span class="linenos">737</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="StepTokenizers.Distance.serialize-738"><a href="#StepTokenizers.Distance.serialize-738"><span class="linenos">738</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="StepTokenizers.Distance.serialize-739"><a href="#StepTokenizers.Distance.serialize-739"><span class="linenos">739</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="StepTokenizers.Distance.serialize-740"><a href="#StepTokenizers.Distance.serialize-740"><span class="linenos">740</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="StepTokenizers.Distance.serialize-741"><a href="#StepTokenizers.Distance.serialize-741"><span class="linenos">741</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="StepTokenizers.Distance.serialize-742"><a href="#StepTokenizers.Distance.serialize-742"><span class="linenos">742</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepTokenizers.Distance.serialize-743"><a href="#StepTokenizers.Distance.serialize-743"><span class="linenos">743</span></a>
</span><span id="StepTokenizers.Distance.serialize-744"><a href="#StepTokenizers.Distance.serialize-744"><span class="linenos">744</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="StepTokenizers.Distance.serialize-745"><a href="#StepTokenizers.Distance.serialize-745"><span class="linenos">745</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepTokenizers.Distance.serialize-746"><a href="#StepTokenizers.Distance.serialize-746"><span class="linenos">746</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="StepTokenizers.Distance.serialize-747"><a href="#StepTokenizers.Distance.serialize-747"><span class="linenos">747</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="StepTokenizers.Distance.serialize-748"><a href="#StepTokenizers.Distance.serialize-748"><span class="linenos">748</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="StepTokenizers.Distance.serialize-749"><a href="#StepTokenizers.Distance.serialize-749"><span class="linenos">749</span></a>                                <span class="p">[</span>
</span><span id="StepTokenizers.Distance.serialize-750"><a href="#StepTokenizers.Distance.serialize-750"><span class="linenos">750</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers.Distance.serialize-751"><a href="#StepTokenizers.Distance.serialize-751"><span class="linenos">751</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers.Distance.serialize-752"><a href="#StepTokenizers.Distance.serialize-752"><span class="linenos">752</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers.Distance.serialize-753"><a href="#StepTokenizers.Distance.serialize-753"><span class="linenos">753</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers.Distance.serialize-754"><a href="#StepTokenizers.Distance.serialize-754"><span class="linenos">754</span></a>                                <span class="p">]</span>
</span><span id="StepTokenizers.Distance.serialize-755"><a href="#StepTokenizers.Distance.serialize-755"><span class="linenos">755</span></a>                            <span class="p">)</span>
</span><span id="StepTokenizers.Distance.serialize-756"><a href="#StepTokenizers.Distance.serialize-756"><span class="linenos">756</span></a>                        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</span><span id="StepTokenizers.Distance.serialize-757"><a href="#StepTokenizers.Distance.serialize-757"><span class="linenos">757</span></a>
</span><span id="StepTokenizers.Distance.serialize-758"><a href="#StepTokenizers.Distance.serialize-758"><span class="linenos">758</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="StepTokenizers.Distance.serialize-759"><a href="#StepTokenizers.Distance.serialize-759"><span class="linenos">759</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="StepTokenizers.Distance.serialize-760"><a href="#StepTokenizers.Distance.serialize-760"><span class="linenos">760</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="StepTokenizers.Distance.serialize-761"><a href="#StepTokenizers.Distance.serialize-761"><span class="linenos">761</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="StepTokenizers.Distance.serialize-762"><a href="#StepTokenizers.Distance.serialize-762"><span class="linenos">762</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepTokenizers.Distance.serialize-763"><a href="#StepTokenizers.Distance.serialize-763"><span class="linenos">763</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="StepTokenizers.Distance.serialize-764"><a href="#StepTokenizers.Distance.serialize-764"><span class="linenos">764</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="StepTokenizers.Distance.serialize-765"><a href="#StepTokenizers.Distance.serialize-765"><span class="linenos">765</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Distance.serialize-766"><a href="#StepTokenizers.Distance.serialize-766"><span class="linenos">766</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Distance.serialize-767"><a href="#StepTokenizers.Distance.serialize-767"><span class="linenos">767</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Distance.serialize-768"><a href="#StepTokenizers.Distance.serialize-768"><span class="linenos">768</span></a>                    <span class="p">)</span>
</span><span id="StepTokenizers.Distance.serialize-769"><a href="#StepTokenizers.Distance.serialize-769"><span class="linenos">769</span></a>
</span><span id="StepTokenizers.Distance.serialize-770"><a href="#StepTokenizers.Distance.serialize-770"><span class="linenos">770</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="StepTokenizers.Distance.load" class="classattr">
                                        <input id="StepTokenizers.Distance.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Distance.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L776-L862" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Distance.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Distance.load-777"><a href="#StepTokenizers.Distance.load-777"><span class="linenos">777</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="StepTokenizers.Distance.load-778"><a href="#StepTokenizers.Distance.load-778"><span class="linenos">778</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="StepTokenizers.Distance.load-779"><a href="#StepTokenizers.Distance.load-779"><span class="linenos">779</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="StepTokenizers.Distance.load-780"><a href="#StepTokenizers.Distance.load-780"><span class="linenos">780</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="StepTokenizers.Distance.load-781"><a href="#StepTokenizers.Distance.load-781"><span class="linenos">781</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="StepTokenizers.Distance.load-782"><a href="#StepTokenizers.Distance.load-782"><span class="linenos">782</span></a>
</span><span id="StepTokenizers.Distance.load-783"><a href="#StepTokenizers.Distance.load-783"><span class="linenos">783</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="StepTokenizers.Distance.load-784"><a href="#StepTokenizers.Distance.load-784"><span class="linenos">784</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="StepTokenizers.Distance.load-785"><a href="#StepTokenizers.Distance.load-785"><span class="linenos">785</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Distance.load-786"><a href="#StepTokenizers.Distance.load-786"><span class="linenos">786</span></a>
</span><span id="StepTokenizers.Distance.load-787"><a href="#StepTokenizers.Distance.load-787"><span class="linenos">787</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="StepTokenizers.Distance.load-788"><a href="#StepTokenizers.Distance.load-788"><span class="linenos">788</span></a>
</span><span id="StepTokenizers.Distance.load-789"><a href="#StepTokenizers.Distance.load-789"><span class="linenos">789</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="StepTokenizers.Distance.load-790"><a href="#StepTokenizers.Distance.load-790"><span class="linenos">790</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="StepTokenizers.Distance.load-791"><a href="#StepTokenizers.Distance.load-791"><span class="linenos">791</span></a>
</span><span id="StepTokenizers.Distance.load-792"><a href="#StepTokenizers.Distance.load-792"><span class="linenos">792</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="StepTokenizers.Distance.load-793"><a href="#StepTokenizers.Distance.load-793"><span class="linenos">793</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="StepTokenizers.Distance.load-794"><a href="#StepTokenizers.Distance.load-794"><span class="linenos">794</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="StepTokenizers.Distance.load-795"><a href="#StepTokenizers.Distance.load-795"><span class="linenos">795</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="StepTokenizers.Distance.load-796"><a href="#StepTokenizers.Distance.load-796"><span class="linenos">796</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="StepTokenizers.Distance.load-797"><a href="#StepTokenizers.Distance.load-797"><span class="linenos">797</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="StepTokenizers.Distance.load-798"><a href="#StepTokenizers.Distance.load-798"><span class="linenos">798</span></a>
</span><span id="StepTokenizers.Distance.load-799"><a href="#StepTokenizers.Distance.load-799"><span class="linenos">799</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="StepTokenizers.Distance.load-800"><a href="#StepTokenizers.Distance.load-800"><span class="linenos">800</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="StepTokenizers.Distance.load-801"><a href="#StepTokenizers.Distance.load-801"><span class="linenos">801</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="StepTokenizers.Distance.load-802"><a href="#StepTokenizers.Distance.load-802"><span class="linenos">802</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="StepTokenizers.Distance.load-803"><a href="#StepTokenizers.Distance.load-803"><span class="linenos">803</span></a>
</span><span id="StepTokenizers.Distance.load-804"><a href="#StepTokenizers.Distance.load-804"><span class="linenos">804</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="StepTokenizers.Distance.load-805"><a href="#StepTokenizers.Distance.load-805"><span class="linenos">805</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="StepTokenizers.Distance.load-806"><a href="#StepTokenizers.Distance.load-806"><span class="linenos">806</span></a>
</span><span id="StepTokenizers.Distance.load-807"><a href="#StepTokenizers.Distance.load-807"><span class="linenos">807</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="StepTokenizers.Distance.load-808"><a href="#StepTokenizers.Distance.load-808"><span class="linenos">808</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="StepTokenizers.Distance.load-809"><a href="#StepTokenizers.Distance.load-809"><span class="linenos">809</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="StepTokenizers.Distance.load-810"><a href="#StepTokenizers.Distance.load-810"><span class="linenos">810</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepTokenizers.Distance.load-811"><a href="#StepTokenizers.Distance.load-811"><span class="linenos">811</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="StepTokenizers.Distance.load-812"><a href="#StepTokenizers.Distance.load-812"><span class="linenos">812</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="StepTokenizers.Distance.load-813"><a href="#StepTokenizers.Distance.load-813"><span class="linenos">813</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="StepTokenizers.Distance.load-814"><a href="#StepTokenizers.Distance.load-814"><span class="linenos">814</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="StepTokenizers.Distance.load-815"><a href="#StepTokenizers.Distance.load-815"><span class="linenos">815</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="StepTokenizers.Distance.load-816"><a href="#StepTokenizers.Distance.load-816"><span class="linenos">816</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="StepTokenizers.Distance.load-817"><a href="#StepTokenizers.Distance.load-817"><span class="linenos">817</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="StepTokenizers.Distance.load-818"><a href="#StepTokenizers.Distance.load-818"><span class="linenos">818</span></a>                    <span class="p">):</span>
</span><span id="StepTokenizers.Distance.load-819"><a href="#StepTokenizers.Distance.load-819"><span class="linenos">819</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="StepTokenizers.Distance.load-820"><a href="#StepTokenizers.Distance.load-820"><span class="linenos">820</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="StepTokenizers.Distance.load-821"><a href="#StepTokenizers.Distance.load-821"><span class="linenos">821</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepTokenizers.Distance.load-822"><a href="#StepTokenizers.Distance.load-822"><span class="linenos">822</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="StepTokenizers.Distance.load-823"><a href="#StepTokenizers.Distance.load-823"><span class="linenos">823</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="StepTokenizers.Distance.load-824"><a href="#StepTokenizers.Distance.load-824"><span class="linenos">824</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Distance.load-825"><a href="#StepTokenizers.Distance.load-825"><span class="linenos">825</span></a>                            <span class="p">)</span>
</span><span id="StepTokenizers.Distance.load-826"><a href="#StepTokenizers.Distance.load-826"><span class="linenos">826</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="StepTokenizers.Distance.load-827"><a href="#StepTokenizers.Distance.load-827"><span class="linenos">827</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="StepTokenizers.Distance.load-828"><a href="#StepTokenizers.Distance.load-828"><span class="linenos">828</span></a>                        <span class="k">pass</span>
</span><span id="StepTokenizers.Distance.load-829"><a href="#StepTokenizers.Distance.load-829"><span class="linenos">829</span></a>
</span><span id="StepTokenizers.Distance.load-830"><a href="#StepTokenizers.Distance.load-830"><span class="linenos">830</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="StepTokenizers.Distance.load-831"><a href="#StepTokenizers.Distance.load-831"><span class="linenos">831</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepTokenizers.Distance.load-832"><a href="#StepTokenizers.Distance.load-832"><span class="linenos">832</span></a>
</span><span id="StepTokenizers.Distance.load-833"><a href="#StepTokenizers.Distance.load-833"><span class="linenos">833</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="StepTokenizers.Distance.load-834"><a href="#StepTokenizers.Distance.load-834"><span class="linenos">834</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="StepTokenizers.Distance.load-835"><a href="#StepTokenizers.Distance.load-835"><span class="linenos">835</span></a>
</span><span id="StepTokenizers.Distance.load-836"><a href="#StepTokenizers.Distance.load-836"><span class="linenos">836</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="StepTokenizers.Distance.load-837"><a href="#StepTokenizers.Distance.load-837"><span class="linenos">837</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="StepTokenizers.Distance.load-838"><a href="#StepTokenizers.Distance.load-838"><span class="linenos">838</span></a>                <span class="n">fields_valid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="StepTokenizers.Distance.load-839"><a href="#StepTokenizers.Distance.load-839"><span class="linenos">839</span></a>                    <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="StepTokenizers.Distance.load-840"><a href="#StepTokenizers.Distance.load-840"><span class="linenos">840</span></a>                        <span class="n">output</span><span class="p">,</span>
</span><span id="StepTokenizers.Distance.load-841"><a href="#StepTokenizers.Distance.load-841"><span class="linenos">841</span></a>                        <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">,</span>
</span><span id="StepTokenizers.Distance.load-842"><a href="#StepTokenizers.Distance.load-842"><span class="linenos">842</span></a>                    <span class="p">)</span>
</span><span id="StepTokenizers.Distance.load-843"><a href="#StepTokenizers.Distance.load-843"><span class="linenos">843</span></a>                <span class="p">)</span>
</span><span id="StepTokenizers.Distance.load-844"><a href="#StepTokenizers.Distance.load-844"><span class="linenos">844</span></a>
</span><span id="StepTokenizers.Distance.load-845"><a href="#StepTokenizers.Distance.load-845"><span class="linenos">845</span></a>                <span class="c1"># if there are any fields that are not valid, raise an error</span>
</span><span id="StepTokenizers.Distance.load-846"><a href="#StepTokenizers.Distance.load-846"><span class="linenos">846</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">fields_valid</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="StepTokenizers.Distance.load-847"><a href="#StepTokenizers.Distance.load-847"><span class="linenos">847</span></a>                    <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="StepTokenizers.Distance.load-848"><a href="#StepTokenizers.Distance.load-848"><span class="linenos">848</span></a>                        <span class="sa">f</span><span class="s2">&quot;Type mismatch in fields of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Distance.load-849"><a href="#StepTokenizers.Distance.load-849"><span class="linenos">849</span></a>                        <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="StepTokenizers.Distance.load-850"><a href="#StepTokenizers.Distance.load-850"><span class="linenos">850</span></a>                            <span class="p">[</span>
</span><span id="StepTokenizers.Distance.load-851"><a href="#StepTokenizers.Distance.load-851"><span class="linenos">851</span></a>                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">:</span><span class="se">\t</span><span class="s2">expected </span><span class="si">{</span><span class="n">cls_type_hints</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="si">= }</span><span class="s2">, but got value </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Distance.load-852"><a href="#StepTokenizers.Distance.load-852"><span class="linenos">852</span></a>                                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">fields_valid</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="StepTokenizers.Distance.load-853"><a href="#StepTokenizers.Distance.load-853"><span class="linenos">853</span></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span>
</span><span id="StepTokenizers.Distance.load-854"><a href="#StepTokenizers.Distance.load-854"><span class="linenos">854</span></a>                            <span class="p">]</span>
</span><span id="StepTokenizers.Distance.load-855"><a href="#StepTokenizers.Distance.load-855"><span class="linenos">855</span></a>                        <span class="p">)</span>
</span><span id="StepTokenizers.Distance.load-856"><a href="#StepTokenizers.Distance.load-856"><span class="linenos">856</span></a>                    <span class="p">)</span>
</span><span id="StepTokenizers.Distance.load-857"><a href="#StepTokenizers.Distance.load-857"><span class="linenos">857</span></a>
</span><span id="StepTokenizers.Distance.load-858"><a href="#StepTokenizers.Distance.load-858"><span class="linenos">858</span></a>                    <span class="n">on_typecheck_mismatch</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
</span><span id="StepTokenizers.Distance.load-859"><a href="#StepTokenizers.Distance.load-859"><span class="linenos">859</span></a>                        <span class="n">msg</span><span class="p">,</span> <span class="n">except_cls</span><span class="o">=</span><span class="n">FieldTypeMismatchError</span>
</span><span id="StepTokenizers.Distance.load-860"><a href="#StepTokenizers.Distance.load-860"><span class="linenos">860</span></a>                    <span class="p">)</span>
</span><span id="StepTokenizers.Distance.load-861"><a href="#StepTokenizers.Distance.load-861"><span class="linenos">861</span></a>
</span><span id="StepTokenizers.Distance.load-862"><a href="#StepTokenizers.Distance.load-862"><span class="linenos">862</span></a>            <span class="c1"># return the new instance</span>
</span><span id="StepTokenizers.Distance.load-863"><a href="#StepTokenizers.Distance.load-863"><span class="linenos">863</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="StepTokenizers.Distance.validate_fields_types" class="classattr">
                                        <input id="StepTokenizers.Distance.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Distance.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L282-L291" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Distance.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Distance.validate_fields_types-283"><a href="#StepTokenizers.Distance.validate_fields_types-283"><span class="linenos">283</span></a><span class="k">def</span><span class="w"> </span><span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="StepTokenizers.Distance.validate_fields_types-284"><a href="#StepTokenizers.Distance.validate_fields_types-284"><span class="linenos">284</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="StepTokenizers.Distance.validate_fields_types-285"><a href="#StepTokenizers.Distance.validate_fields_types-285"><span class="linenos">285</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="StepTokenizers.Distance.validate_fields_types-286"><a href="#StepTokenizers.Distance.validate_fields_types-286"><span class="linenos">286</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="StepTokenizers.Distance.validate_fields_types-287"><a href="#StepTokenizers.Distance.validate_fields_types-287"><span class="linenos">287</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="StepTokenizers.Distance.validate_fields_types-288"><a href="#StepTokenizers.Distance.validate_fields_types-288"><span class="linenos">288</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="StepTokenizers.Distance.validate_fields_types-289"><a href="#StepTokenizers.Distance.validate_fields_types-289"><span class="linenos">289</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="StepTokenizers.Distance.validate_fields_types-290"><a href="#StepTokenizers.Distance.validate_fields_types-290"><span class="linenos">290</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="StepTokenizers.Distance.validate_fields_types-291"><a href="#StepTokenizers.Distance.validate_fields_types-291"><span class="linenos">291</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="StepTokenizers.Distance.validate_fields_types-292"><a href="#StepTokenizers.Distance.validate_fields_types-292"><span class="linenos">292</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#StepTokenizers._StepTokenizer">StepTokenizers._StepTokenizer</a></dt>
                                <dd id="StepTokenizers.Distance.attribute_key" class="function"><a href="#StepTokenizers._StepTokenizer.attribute_key">attribute_key</a></dd>
                <dd id="StepTokenizers.Distance.is_valid" class="function"><a href="#StepTokenizers._StepTokenizer.is_valid">is_valid</a></dd>

            </div>
            <div><dt><a href="element_base.html#_TokenizerElement">maze_dataset.tokenization.modular.element_base._TokenizerElement</a></dt>
                                <dd id="StepTokenizers.Distance.name" class="variable"><a href="element_base.html#_TokenizerElement.name">name</a></dd>
                <dd id="StepTokenizers.Distance.tokenizer_elements" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="StepTokenizers.Distance.tokenizer_element_tree" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="StepTokenizers.Distance.tokenizer_element_dict" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="StepTokenizers.Distance.validate_field_type" class="function">validate_field_type</dd>
                <dd id="StepTokenizers.Distance.diff" class="function">diff</dd>
                <dd id="StepTokenizers.Distance.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="PathTokenizers">
                            <input id="PathTokenizers-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">PathTokenizers</span><wbr>(<span class="base"><a href="element_base.html#__TokenizerElementNamespace">maze_dataset.tokenization.modular.element_base.__TokenizerElementNamespace</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="PathTokenizers-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L903-L1049" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#PathTokenizers"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PathTokenizers-904"><a href="#PathTokenizers-904"><span class="linenos"> 904</span></a><span class="k">class</span><span class="w"> </span><span class="nc">PathTokenizers</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="PathTokenizers-905"><a href="#PathTokenizers-905"><span class="linenos"> 905</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Namespace for `_PathTokenizer` subclass hierarchy used by `MazeTokenizerModular`.&quot;&quot;&quot;</span>
</span><span id="PathTokenizers-906"><a href="#PathTokenizers-906"><span class="linenos"> 906</span></a>
</span><span id="PathTokenizers-907"><a href="#PathTokenizers-907"><span class="linenos"> 907</span></a>	<span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;path_tokenizer&quot;</span>
</span><span id="PathTokenizers-908"><a href="#PathTokenizers-908"><span class="linenos"> 908</span></a>
</span><span id="PathTokenizers-909"><a href="#PathTokenizers-909"><span class="linenos"> 909</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PathTokenizers-910"><a href="#PathTokenizers-910"><span class="linenos"> 910</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">_PathTokenizer</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="PathTokenizers-911"><a href="#PathTokenizers-911"><span class="linenos"> 911</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Superclass of tokenizers for maze solution paths.&quot;&quot;&quot;</span>
</span><span id="PathTokenizers-912"><a href="#PathTokenizers-912"><span class="linenos"> 912</span></a>
</span><span id="PathTokenizers-913"><a href="#PathTokenizers-913"><span class="linenos"> 913</span></a>		<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="PathTokenizers-914"><a href="#PathTokenizers-914"><span class="linenos"> 914</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="PathTokenizers-915"><a href="#PathTokenizers-915"><span class="linenos"> 915</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="PathTokenizers-916"><a href="#PathTokenizers-916"><span class="linenos"> 916</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="PathTokenizers-917"><a href="#PathTokenizers-917"><span class="linenos"> 917</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="PathTokenizers-918"><a href="#PathTokenizers-918"><span class="linenos"> 918</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PathTokenizers-919"><a href="#PathTokenizers-919"><span class="linenos"> 919</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns tokens representing the solution path.&quot;&quot;&quot;</span>
</span><span id="PathTokenizers-920"><a href="#PathTokenizers-920"><span class="linenos"> 920</span></a>			<span class="k">pass</span>
</span><span id="PathTokenizers-921"><a href="#PathTokenizers-921"><span class="linenos"> 921</span></a>
</span><span id="PathTokenizers-922"><a href="#PathTokenizers-922"><span class="linenos"> 922</span></a>		<span class="nd">@classmethod</span>
</span><span id="PathTokenizers-923"><a href="#PathTokenizers-923"><span class="linenos"> 923</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="PathTokenizers-924"><a href="#PathTokenizers-924"><span class="linenos"> 924</span></a>			<span class="k">return</span> <span class="n">PathTokenizers</span><span class="o">.</span><span class="n">key</span>
</span><span id="PathTokenizers-925"><a href="#PathTokenizers-925"><span class="linenos"> 925</span></a>
</span><span id="PathTokenizers-926"><a href="#PathTokenizers-926"><span class="linenos"> 926</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PathTokenizers-927"><a href="#PathTokenizers-927"><span class="linenos"> 927</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">StepSequence</span><span class="p">(</span><span class="n">_PathTokenizer</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="PathTokenizers-928"><a href="#PathTokenizers-928"><span class="linenos"> 928</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Any `PathTokenizer` where the tokenization may be assembled from token subsequences, each of which represents a step along the path.</span>
</span><span id="PathTokenizers-929"><a href="#PathTokenizers-929"><span class="linenos"> 929</span></a>
</span><span id="PathTokenizers-930"><a href="#PathTokenizers-930"><span class="linenos"> 930</span></a><span class="sd">		Allows for a sequence of leading and trailing tokens which don&#39;t fit the step pattern.</span>
</span><span id="PathTokenizers-931"><a href="#PathTokenizers-931"><span class="linenos"> 931</span></a>
</span><span id="PathTokenizers-932"><a href="#PathTokenizers-932"><span class="linenos"> 932</span></a><span class="sd">		# Parameters</span>
</span><span id="PathTokenizers-933"><a href="#PathTokenizers-933"><span class="linenos"> 933</span></a><span class="sd">		- `step_size`: Selects the size of a single step in the sequence</span>
</span><span id="PathTokenizers-934"><a href="#PathTokenizers-934"><span class="linenos"> 934</span></a><span class="sd">		- `step_tokenizers`: Selects the combination and permutation of tokens</span>
</span><span id="PathTokenizers-935"><a href="#PathTokenizers-935"><span class="linenos"> 935</span></a><span class="sd">		- `pre`: Whether all steps include an integral preceding delimiter token</span>
</span><span id="PathTokenizers-936"><a href="#PathTokenizers-936"><span class="linenos"> 936</span></a><span class="sd">		- `intra`: Whether all steps include a delimiter token after each individual `_StepTokenizer` tokenization.</span>
</span><span id="PathTokenizers-937"><a href="#PathTokenizers-937"><span class="linenos"> 937</span></a><span class="sd">		- `post`: Whether all steps include an integral following delimiter token</span>
</span><span id="PathTokenizers-938"><a href="#PathTokenizers-938"><span class="linenos"> 938</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="PathTokenizers-939"><a href="#PathTokenizers-939"><span class="linenos"> 939</span></a>
</span><span id="PathTokenizers-940"><a href="#PathTokenizers-940"><span class="linenos"> 940</span></a>		<span class="n">step_size</span><span class="p">:</span> <span class="n">StepSizes</span><span class="o">.</span><span class="n">_StepSize</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="PathTokenizers-941"><a href="#PathTokenizers-941"><span class="linenos"> 941</span></a>			<span class="n">default</span><span class="o">=</span><span class="n">StepSizes</span><span class="o">.</span><span class="n">Singles</span><span class="p">(),</span>
</span><span id="PathTokenizers-942"><a href="#PathTokenizers-942"><span class="linenos"> 942</span></a>			<span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">StepSizes</span><span class="p">),</span>
</span><span id="PathTokenizers-943"><a href="#PathTokenizers-943"><span class="linenos"> 943</span></a>		<span class="p">)</span>
</span><span id="PathTokenizers-944"><a href="#PathTokenizers-944"><span class="linenos"> 944</span></a>		<span class="n">step_tokenizers</span><span class="p">:</span> <span class="n">StepTokenizers</span><span class="o">.</span><span class="n">StepTokenizerPermutation</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="PathTokenizers-945"><a href="#PathTokenizers-945"><span class="linenos"> 945</span></a>			<span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="n">StepTokenizers</span><span class="o">.</span><span class="n">Coord</span><span class="p">(),),</span>
</span><span id="PathTokenizers-946"><a href="#PathTokenizers-946"><span class="linenos"> 946</span></a>			<span class="n">serialization_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">y</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="p">],</span>
</span><span id="PathTokenizers-947"><a href="#PathTokenizers-947"><span class="linenos"> 947</span></a>			<span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">StepTokenizers</span><span class="o">.</span><span class="n">key</span><span class="p">]),</span>
</span><span id="PathTokenizers-948"><a href="#PathTokenizers-948"><span class="linenos"> 948</span></a>		<span class="p">)</span>
</span><span id="PathTokenizers-949"><a href="#PathTokenizers-949"><span class="linenos"> 949</span></a>		<span class="n">pre</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="PathTokenizers-950"><a href="#PathTokenizers-950"><span class="linenos"> 950</span></a>		<span class="n">intra</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="PathTokenizers-951"><a href="#PathTokenizers-951"><span class="linenos"> 951</span></a>		<span class="n">post</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="PathTokenizers-952"><a href="#PathTokenizers-952"><span class="linenos"> 952</span></a>
</span><span id="PathTokenizers-953"><a href="#PathTokenizers-953"><span class="linenos"> 953</span></a>		<span class="c1"># inherit docstring</span>
</span><span id="PathTokenizers-954"><a href="#PathTokenizers-954"><span class="linenos"> 954</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>  <span class="c1"># noqa: D102</span>
</span><span id="PathTokenizers-955"><a href="#PathTokenizers-955"><span class="linenos"> 955</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="PathTokenizers-956"><a href="#PathTokenizers-956"><span class="linenos"> 956</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="PathTokenizers-957"><a href="#PathTokenizers-957"><span class="linenos"> 957</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="PathTokenizers-958"><a href="#PathTokenizers-958"><span class="linenos"> 958</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PathTokenizers-959"><a href="#PathTokenizers-959"><span class="linenos"> 959</span></a>			<span class="k">return</span> <span class="p">[</span>
</span><span id="PathTokenizers-960"><a href="#PathTokenizers-960"><span class="linenos"> 960</span></a>				<span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_leading_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">),</span>
</span><span id="PathTokenizers-961"><a href="#PathTokenizers-961"><span class="linenos"> 961</span></a>				<span class="o">*</span><span class="n">flatten</span><span class="p">(</span>
</span><span id="PathTokenizers-962"><a href="#PathTokenizers-962"><span class="linenos"> 962</span></a>					<span class="p">[</span>
</span><span id="PathTokenizers-963"><a href="#PathTokenizers-963"><span class="linenos"> 963</span></a>						<span class="bp">self</span><span class="o">.</span><span class="n">_single_step_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">)</span>
</span><span id="PathTokenizers-964"><a href="#PathTokenizers-964"><span class="linenos"> 964</span></a>						<span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_size</span><span class="o">.</span><span class="n">step_start_end_indices</span><span class="p">(</span><span class="n">maze</span><span class="p">)</span>
</span><span id="PathTokenizers-965"><a href="#PathTokenizers-965"><span class="linenos"> 965</span></a>					<span class="p">],</span>
</span><span id="PathTokenizers-966"><a href="#PathTokenizers-966"><span class="linenos"> 966</span></a>				<span class="p">),</span>
</span><span id="PathTokenizers-967"><a href="#PathTokenizers-967"><span class="linenos"> 967</span></a>				<span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_trailing_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">),</span>
</span><span id="PathTokenizers-968"><a href="#PathTokenizers-968"><span class="linenos"> 968</span></a>			<span class="p">]</span>
</span><span id="PathTokenizers-969"><a href="#PathTokenizers-969"><span class="linenos"> 969</span></a>
</span><span id="PathTokenizers-970"><a href="#PathTokenizers-970"><span class="linenos"> 970</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_single_step_tokens</span><span class="p">(</span>
</span><span id="PathTokenizers-971"><a href="#PathTokenizers-971"><span class="linenos"> 971</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="PathTokenizers-972"><a href="#PathTokenizers-972"><span class="linenos"> 972</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="PathTokenizers-973"><a href="#PathTokenizers-973"><span class="linenos"> 973</span></a>			<span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="PathTokenizers-974"><a href="#PathTokenizers-974"><span class="linenos"> 974</span></a>			<span class="n">j</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="PathTokenizers-975"><a href="#PathTokenizers-975"><span class="linenos"> 975</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="PathTokenizers-976"><a href="#PathTokenizers-976"><span class="linenos"> 976</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PathTokenizers-977"><a href="#PathTokenizers-977"><span class="linenos"> 977</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns the token sequence representing a single step along the path.&quot;&quot;&quot;</span>
</span><span id="PathTokenizers-978"><a href="#PathTokenizers-978"><span class="linenos"> 978</span></a>			<span class="n">step_rep_tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PathTokenizers-979"><a href="#PathTokenizers-979"><span class="linenos"> 979</span></a>				<span class="n">step_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="o">=</span><span class="n">coord_tokenizer</span><span class="p">)</span>
</span><span id="PathTokenizers-980"><a href="#PathTokenizers-980"><span class="linenos"> 980</span></a>				<span class="k">for</span> <span class="n">step_tokenizer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span>
</span><span id="PathTokenizers-981"><a href="#PathTokenizers-981"><span class="linenos"> 981</span></a>			<span class="p">]</span>
</span><span id="PathTokenizers-982"><a href="#PathTokenizers-982"><span class="linenos"> 982</span></a>			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">intra</span><span class="p">:</span>
</span><span id="PathTokenizers-983"><a href="#PathTokenizers-983"><span class="linenos"> 983</span></a>				<span class="n">step_rep_tokens_and_intra</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
</span><span id="PathTokenizers-984"><a href="#PathTokenizers-984"><span class="linenos"> 984</span></a>					<span class="nb">len</span><span class="p">(</span><span class="n">step_rep_tokens</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
</span><span id="PathTokenizers-985"><a href="#PathTokenizers-985"><span class="linenos"> 985</span></a>				<span class="p">)</span>
</span><span id="PathTokenizers-986"><a href="#PathTokenizers-986"><span class="linenos"> 986</span></a>				<span class="n">step_rep_tokens_and_intra</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">step_rep_tokens</span>
</span><span id="PathTokenizers-987"><a href="#PathTokenizers-987"><span class="linenos"> 987</span></a>				<span class="n">step_rep_tokens_and_intra</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_INTRA</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span>
</span><span id="PathTokenizers-988"><a href="#PathTokenizers-988"><span class="linenos"> 988</span></a>					<span class="n">step_rep_tokens</span><span class="p">,</span>
</span><span id="PathTokenizers-989"><a href="#PathTokenizers-989"><span class="linenos"> 989</span></a>				<span class="p">)</span>
</span><span id="PathTokenizers-990"><a href="#PathTokenizers-990"><span class="linenos"> 990</span></a>				<span class="n">step_rep_tokens</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="n">step_rep_tokens_and_intra</span><span class="p">))</span>
</span><span id="PathTokenizers-991"><a href="#PathTokenizers-991"><span class="linenos"> 991</span></a>			<span class="n">all_tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PathTokenizers-992"><a href="#PathTokenizers-992"><span class="linenos"> 992</span></a>				<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">((</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_PRE</span><span class="p">,),</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;pre&quot;</span><span class="p">),</span>
</span><span id="PathTokenizers-993"><a href="#PathTokenizers-993"><span class="linenos"> 993</span></a>				<span class="o">*</span><span class="n">flatten</span><span class="p">(</span><span class="n">step_rep_tokens</span><span class="p">),</span>
</span><span id="PathTokenizers-994"><a href="#PathTokenizers-994"><span class="linenos"> 994</span></a>				<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">((</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_POST</span><span class="p">,),</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;post&quot;</span><span class="p">),</span>
</span><span id="PathTokenizers-995"><a href="#PathTokenizers-995"><span class="linenos"> 995</span></a>			<span class="p">]</span>
</span><span id="PathTokenizers-996"><a href="#PathTokenizers-996"><span class="linenos"> 996</span></a>			<span class="k">return</span> <span class="n">all_tokens</span>
</span><span id="PathTokenizers-997"><a href="#PathTokenizers-997"><span class="linenos"> 997</span></a>
</span><span id="PathTokenizers-998"><a href="#PathTokenizers-998"><span class="linenos"> 998</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_leading_tokens</span><span class="p">(</span>
</span><span id="PathTokenizers-999"><a href="#PathTokenizers-999"><span class="linenos"> 999</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="PathTokenizers-1000"><a href="#PathTokenizers-1000"><span class="linenos">1000</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="PathTokenizers-1001"><a href="#PathTokenizers-1001"><span class="linenos">1001</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="PathTokenizers-1002"><a href="#PathTokenizers-1002"><span class="linenos">1002</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PathTokenizers-1003"><a href="#PathTokenizers-1003"><span class="linenos">1003</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns tokens preceding those from the sequence from `_single_step_tokens`.</span>
</span><span id="PathTokenizers-1004"><a href="#PathTokenizers-1004"><span class="linenos">1004</span></a>
</span><span id="PathTokenizers-1005"><a href="#PathTokenizers-1005"><span class="linenos">1005</span></a><span class="sd">			Since the for loop in `to_tokens` iterates `len(path)-1` times, a fencepost problem exists with `StepTokenizers.Coord`.</span>
</span><span id="PathTokenizers-1006"><a href="#PathTokenizers-1006"><span class="linenos">1006</span></a><span class="sd">			&lt;PATH_START&gt; should NOT be included.</span>
</span><span id="PathTokenizers-1007"><a href="#PathTokenizers-1007"><span class="linenos">1007</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="PathTokenizers-1008"><a href="#PathTokenizers-1008"><span class="linenos">1008</span></a>			<span class="k">if</span> <span class="n">StepTokenizers</span><span class="o">.</span><span class="n">Coord</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">:</span>
</span><span id="PathTokenizers-1009"><a href="#PathTokenizers-1009"><span class="linenos">1009</span></a>				<span class="k">return</span> <span class="p">[</span>
</span><span id="PathTokenizers-1010"><a href="#PathTokenizers-1010"><span class="linenos">1010</span></a>					<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">((</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_PRE</span><span class="p">,),</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;pre&quot;</span><span class="p">),</span>
</span><span id="PathTokenizers-1011"><a href="#PathTokenizers-1011"><span class="linenos">1011</span></a>					<span class="o">*</span><span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">...</span><span class="p">]),</span>
</span><span id="PathTokenizers-1012"><a href="#PathTokenizers-1012"><span class="linenos">1012</span></a>					<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">((</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_INTRA</span><span class="p">,),</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;intra&quot;</span><span class="p">),</span>
</span><span id="PathTokenizers-1013"><a href="#PathTokenizers-1013"><span class="linenos">1013</span></a>				<span class="p">]</span>
</span><span id="PathTokenizers-1014"><a href="#PathTokenizers-1014"><span class="linenos">1014</span></a>			<span class="k">return</span> <span class="p">[]</span>
</span><span id="PathTokenizers-1015"><a href="#PathTokenizers-1015"><span class="linenos">1015</span></a>
</span><span id="PathTokenizers-1016"><a href="#PathTokenizers-1016"><span class="linenos">1016</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_trailing_tokens</span><span class="p">(</span>
</span><span id="PathTokenizers-1017"><a href="#PathTokenizers-1017"><span class="linenos">1017</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="PathTokenizers-1018"><a href="#PathTokenizers-1018"><span class="linenos">1018</span></a>			<span class="n">c</span><span class="p">:</span> <span class="n">Coord</span><span class="p">,</span>
</span><span id="PathTokenizers-1019"><a href="#PathTokenizers-1019"><span class="linenos">1019</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="PathTokenizers-1020"><a href="#PathTokenizers-1020"><span class="linenos">1020</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PathTokenizers-1021"><a href="#PathTokenizers-1021"><span class="linenos">1021</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns tokens following those from the sequence from `_single_step_tokens`.</span>
</span><span id="PathTokenizers-1022"><a href="#PathTokenizers-1022"><span class="linenos">1022</span></a>
</span><span id="PathTokenizers-1023"><a href="#PathTokenizers-1023"><span class="linenos">1023</span></a><span class="sd">			&lt;PATH_END&gt; should NOT be included.</span>
</span><span id="PathTokenizers-1024"><a href="#PathTokenizers-1024"><span class="linenos">1024</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="PathTokenizers-1025"><a href="#PathTokenizers-1025"><span class="linenos">1025</span></a>			<span class="k">return</span> <span class="p">[]</span>
</span><span id="PathTokenizers-1026"><a href="#PathTokenizers-1026"><span class="linenos">1026</span></a>
</span><span id="PathTokenizers-1027"><a href="#PathTokenizers-1027"><span class="linenos">1027</span></a>		<span class="c1"># inherits docstring</span>
</span><span id="PathTokenizers-1028"><a href="#PathTokenizers-1028"><span class="linenos">1028</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># noqa: D102</span>
</span><span id="PathTokenizers-1029"><a href="#PathTokenizers-1029"><span class="linenos">1029</span></a>			<span class="n">output</span><span class="p">:</span> <span class="nb">bool</span>
</span><span id="PathTokenizers-1030"><a href="#PathTokenizers-1030"><span class="linenos">1030</span></a>
</span><span id="PathTokenizers-1031"><a href="#PathTokenizers-1031"><span class="linenos">1031</span></a>			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">):</span>
</span><span id="PathTokenizers-1032"><a href="#PathTokenizers-1032"><span class="linenos">1032</span></a>				<span class="c1"># Uninteresting: repeated elements are not useful</span>
</span><span id="PathTokenizers-1033"><a href="#PathTokenizers-1033"><span class="linenos">1033</span></a>				<span class="n">output</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="PathTokenizers-1034"><a href="#PathTokenizers-1034"><span class="linenos">1034</span></a>			<span class="k">else</span><span class="p">:</span>
</span><span id="PathTokenizers-1035"><a href="#PathTokenizers-1035"><span class="linenos">1035</span></a>				<span class="c1"># we do noqa for the comment if false</span>
</span><span id="PathTokenizers-1036"><a href="#PathTokenizers-1036"><span class="linenos">1036</span></a>				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="PathTokenizers-1037"><a href="#PathTokenizers-1037"><span class="linenos">1037</span></a>					<span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="PathTokenizers-1038"><a href="#PathTokenizers-1038"><span class="linenos">1038</span></a>					<span class="n">StepTokenizers</span><span class="o">.</span><span class="n">Distance</span><span class="p">,</span>
</span><span id="PathTokenizers-1039"><a href="#PathTokenizers-1039"><span class="linenos">1039</span></a>				<span class="p">):</span>
</span><span id="PathTokenizers-1040"><a href="#PathTokenizers-1040"><span class="linenos">1040</span></a>					<span class="c1"># Untrainable: `Distance` alone cannot encode a path. &gt;=1 `StepTokenizer` which indicates direction/location is required.</span>
</span><span id="PathTokenizers-1041"><a href="#PathTokenizers-1041"><span class="linenos">1041</span></a>					<span class="n">output</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="PathTokenizers-1042"><a href="#PathTokenizers-1042"><span class="linenos">1042</span></a>				<span class="k">else</span><span class="p">:</span>
</span><span id="PathTokenizers-1043"><a href="#PathTokenizers-1043"><span class="linenos">1043</span></a>					<span class="n">output</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="PathTokenizers-1044"><a href="#PathTokenizers-1044"><span class="linenos">1044</span></a>
</span><span id="PathTokenizers-1045"><a href="#PathTokenizers-1045"><span class="linenos">1045</span></a>			<span class="k">if</span> <span class="ow">not</span> <span class="n">output</span> <span class="ow">and</span> <span class="n">do_except</span><span class="p">:</span>
</span><span id="PathTokenizers-1046"><a href="#PathTokenizers-1046"><span class="linenos">1046</span></a>				<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="PathTokenizers-1047"><a href="#PathTokenizers-1047"><span class="linenos">1047</span></a>					<span class="s2">&quot;PathTokenizer must contain at least one `StepTokenizer` which indicates direction/location, or it will be untrainable.&quot;</span><span class="p">,</span>
</span><span id="PathTokenizers-1048"><a href="#PathTokenizers-1048"><span class="linenos">1048</span></a>				<span class="p">)</span>
</span><span id="PathTokenizers-1049"><a href="#PathTokenizers-1049"><span class="linenos">1049</span></a>
</span><span id="PathTokenizers-1050"><a href="#PathTokenizers-1050"><span class="linenos">1050</span></a>			<span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>Namespace for <code>_PathTokenizer</code> subclass hierarchy used by <code>MazeTokenizerModular</code>.</p>
</div>


                            <div id="PathTokenizers.key" class="classattr">
                                <div class="attr variable">
            <span class="name">key</span>        =
<span class="default_value">&#39;path_tokenizer&#39;</span>

        
    </div>
    <a class="headerlink" href="#PathTokenizers.key"></a>
    
    

                            </div>
                </section>
                <section id="PathTokenizers.StepSequence">
                            <input id="PathTokenizers.StepSequence-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">PathTokenizers.StepSequence</span><wbr>(<span class="base"><a href="#PathTokenizers._PathTokenizer">PathTokenizers._PathTokenizer</a></span>, <span class="base">abc.ABC</span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="PathTokenizers.StepSequence-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L925-L1049" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#PathTokenizers.StepSequence"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PathTokenizers.StepSequence-926"><a href="#PathTokenizers.StepSequence-926"><span class="linenos"> 926</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence-927"><a href="#PathTokenizers.StepSequence-927"><span class="linenos"> 927</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">StepSequence</span><span class="p">(</span><span class="n">_PathTokenizer</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="PathTokenizers.StepSequence-928"><a href="#PathTokenizers.StepSequence-928"><span class="linenos"> 928</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Any `PathTokenizer` where the tokenization may be assembled from token subsequences, each of which represents a step along the path.</span>
</span><span id="PathTokenizers.StepSequence-929"><a href="#PathTokenizers.StepSequence-929"><span class="linenos"> 929</span></a>
</span><span id="PathTokenizers.StepSequence-930"><a href="#PathTokenizers.StepSequence-930"><span class="linenos"> 930</span></a><span class="sd">		Allows for a sequence of leading and trailing tokens which don&#39;t fit the step pattern.</span>
</span><span id="PathTokenizers.StepSequence-931"><a href="#PathTokenizers.StepSequence-931"><span class="linenos"> 931</span></a>
</span><span id="PathTokenizers.StepSequence-932"><a href="#PathTokenizers.StepSequence-932"><span class="linenos"> 932</span></a><span class="sd">		# Parameters</span>
</span><span id="PathTokenizers.StepSequence-933"><a href="#PathTokenizers.StepSequence-933"><span class="linenos"> 933</span></a><span class="sd">		- `step_size`: Selects the size of a single step in the sequence</span>
</span><span id="PathTokenizers.StepSequence-934"><a href="#PathTokenizers.StepSequence-934"><span class="linenos"> 934</span></a><span class="sd">		- `step_tokenizers`: Selects the combination and permutation of tokens</span>
</span><span id="PathTokenizers.StepSequence-935"><a href="#PathTokenizers.StepSequence-935"><span class="linenos"> 935</span></a><span class="sd">		- `pre`: Whether all steps include an integral preceding delimiter token</span>
</span><span id="PathTokenizers.StepSequence-936"><a href="#PathTokenizers.StepSequence-936"><span class="linenos"> 936</span></a><span class="sd">		- `intra`: Whether all steps include a delimiter token after each individual `_StepTokenizer` tokenization.</span>
</span><span id="PathTokenizers.StepSequence-937"><a href="#PathTokenizers.StepSequence-937"><span class="linenos"> 937</span></a><span class="sd">		- `post`: Whether all steps include an integral following delimiter token</span>
</span><span id="PathTokenizers.StepSequence-938"><a href="#PathTokenizers.StepSequence-938"><span class="linenos"> 938</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="PathTokenizers.StepSequence-939"><a href="#PathTokenizers.StepSequence-939"><span class="linenos"> 939</span></a>
</span><span id="PathTokenizers.StepSequence-940"><a href="#PathTokenizers.StepSequence-940"><span class="linenos"> 940</span></a>		<span class="n">step_size</span><span class="p">:</span> <span class="n">StepSizes</span><span class="o">.</span><span class="n">_StepSize</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence-941"><a href="#PathTokenizers.StepSequence-941"><span class="linenos"> 941</span></a>			<span class="n">default</span><span class="o">=</span><span class="n">StepSizes</span><span class="o">.</span><span class="n">Singles</span><span class="p">(),</span>
</span><span id="PathTokenizers.StepSequence-942"><a href="#PathTokenizers.StepSequence-942"><span class="linenos"> 942</span></a>			<span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">StepSizes</span><span class="p">),</span>
</span><span id="PathTokenizers.StepSequence-943"><a href="#PathTokenizers.StepSequence-943"><span class="linenos"> 943</span></a>		<span class="p">)</span>
</span><span id="PathTokenizers.StepSequence-944"><a href="#PathTokenizers.StepSequence-944"><span class="linenos"> 944</span></a>		<span class="n">step_tokenizers</span><span class="p">:</span> <span class="n">StepTokenizers</span><span class="o">.</span><span class="n">StepTokenizerPermutation</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence-945"><a href="#PathTokenizers.StepSequence-945"><span class="linenos"> 945</span></a>			<span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="n">StepTokenizers</span><span class="o">.</span><span class="n">Coord</span><span class="p">(),),</span>
</span><span id="PathTokenizers.StepSequence-946"><a href="#PathTokenizers.StepSequence-946"><span class="linenos"> 946</span></a>			<span class="n">serialization_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">y</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="p">],</span>
</span><span id="PathTokenizers.StepSequence-947"><a href="#PathTokenizers.StepSequence-947"><span class="linenos"> 947</span></a>			<span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">StepTokenizers</span><span class="o">.</span><span class="n">key</span><span class="p">]),</span>
</span><span id="PathTokenizers.StepSequence-948"><a href="#PathTokenizers.StepSequence-948"><span class="linenos"> 948</span></a>		<span class="p">)</span>
</span><span id="PathTokenizers.StepSequence-949"><a href="#PathTokenizers.StepSequence-949"><span class="linenos"> 949</span></a>		<span class="n">pre</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence-950"><a href="#PathTokenizers.StepSequence-950"><span class="linenos"> 950</span></a>		<span class="n">intra</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence-951"><a href="#PathTokenizers.StepSequence-951"><span class="linenos"> 951</span></a>		<span class="n">post</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence-952"><a href="#PathTokenizers.StepSequence-952"><span class="linenos"> 952</span></a>
</span><span id="PathTokenizers.StepSequence-953"><a href="#PathTokenizers.StepSequence-953"><span class="linenos"> 953</span></a>		<span class="c1"># inherit docstring</span>
</span><span id="PathTokenizers.StepSequence-954"><a href="#PathTokenizers.StepSequence-954"><span class="linenos"> 954</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>  <span class="c1"># noqa: D102</span>
</span><span id="PathTokenizers.StepSequence-955"><a href="#PathTokenizers.StepSequence-955"><span class="linenos"> 955</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence-956"><a href="#PathTokenizers.StepSequence-956"><span class="linenos"> 956</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence-957"><a href="#PathTokenizers.StepSequence-957"><span class="linenos"> 957</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence-958"><a href="#PathTokenizers.StepSequence-958"><span class="linenos"> 958</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PathTokenizers.StepSequence-959"><a href="#PathTokenizers.StepSequence-959"><span class="linenos"> 959</span></a>			<span class="k">return</span> <span class="p">[</span>
</span><span id="PathTokenizers.StepSequence-960"><a href="#PathTokenizers.StepSequence-960"><span class="linenos"> 960</span></a>				<span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_leading_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">),</span>
</span><span id="PathTokenizers.StepSequence-961"><a href="#PathTokenizers.StepSequence-961"><span class="linenos"> 961</span></a>				<span class="o">*</span><span class="n">flatten</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence-962"><a href="#PathTokenizers.StepSequence-962"><span class="linenos"> 962</span></a>					<span class="p">[</span>
</span><span id="PathTokenizers.StepSequence-963"><a href="#PathTokenizers.StepSequence-963"><span class="linenos"> 963</span></a>						<span class="bp">self</span><span class="o">.</span><span class="n">_single_step_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence-964"><a href="#PathTokenizers.StepSequence-964"><span class="linenos"> 964</span></a>						<span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_size</span><span class="o">.</span><span class="n">step_start_end_indices</span><span class="p">(</span><span class="n">maze</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence-965"><a href="#PathTokenizers.StepSequence-965"><span class="linenos"> 965</span></a>					<span class="p">],</span>
</span><span id="PathTokenizers.StepSequence-966"><a href="#PathTokenizers.StepSequence-966"><span class="linenos"> 966</span></a>				<span class="p">),</span>
</span><span id="PathTokenizers.StepSequence-967"><a href="#PathTokenizers.StepSequence-967"><span class="linenos"> 967</span></a>				<span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_trailing_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">),</span>
</span><span id="PathTokenizers.StepSequence-968"><a href="#PathTokenizers.StepSequence-968"><span class="linenos"> 968</span></a>			<span class="p">]</span>
</span><span id="PathTokenizers.StepSequence-969"><a href="#PathTokenizers.StepSequence-969"><span class="linenos"> 969</span></a>
</span><span id="PathTokenizers.StepSequence-970"><a href="#PathTokenizers.StepSequence-970"><span class="linenos"> 970</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_single_step_tokens</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence-971"><a href="#PathTokenizers.StepSequence-971"><span class="linenos"> 971</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence-972"><a href="#PathTokenizers.StepSequence-972"><span class="linenos"> 972</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence-973"><a href="#PathTokenizers.StepSequence-973"><span class="linenos"> 973</span></a>			<span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence-974"><a href="#PathTokenizers.StepSequence-974"><span class="linenos"> 974</span></a>			<span class="n">j</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence-975"><a href="#PathTokenizers.StepSequence-975"><span class="linenos"> 975</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence-976"><a href="#PathTokenizers.StepSequence-976"><span class="linenos"> 976</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PathTokenizers.StepSequence-977"><a href="#PathTokenizers.StepSequence-977"><span class="linenos"> 977</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns the token sequence representing a single step along the path.&quot;&quot;&quot;</span>
</span><span id="PathTokenizers.StepSequence-978"><a href="#PathTokenizers.StepSequence-978"><span class="linenos"> 978</span></a>			<span class="n">step_rep_tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PathTokenizers.StepSequence-979"><a href="#PathTokenizers.StepSequence-979"><span class="linenos"> 979</span></a>				<span class="n">step_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="o">=</span><span class="n">coord_tokenizer</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence-980"><a href="#PathTokenizers.StepSequence-980"><span class="linenos"> 980</span></a>				<span class="k">for</span> <span class="n">step_tokenizer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span>
</span><span id="PathTokenizers.StepSequence-981"><a href="#PathTokenizers.StepSequence-981"><span class="linenos"> 981</span></a>			<span class="p">]</span>
</span><span id="PathTokenizers.StepSequence-982"><a href="#PathTokenizers.StepSequence-982"><span class="linenos"> 982</span></a>			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">intra</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence-983"><a href="#PathTokenizers.StepSequence-983"><span class="linenos"> 983</span></a>				<span class="n">step_rep_tokens_and_intra</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
</span><span id="PathTokenizers.StepSequence-984"><a href="#PathTokenizers.StepSequence-984"><span class="linenos"> 984</span></a>					<span class="nb">len</span><span class="p">(</span><span class="n">step_rep_tokens</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
</span><span id="PathTokenizers.StepSequence-985"><a href="#PathTokenizers.StepSequence-985"><span class="linenos"> 985</span></a>				<span class="p">)</span>
</span><span id="PathTokenizers.StepSequence-986"><a href="#PathTokenizers.StepSequence-986"><span class="linenos"> 986</span></a>				<span class="n">step_rep_tokens_and_intra</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">step_rep_tokens</span>
</span><span id="PathTokenizers.StepSequence-987"><a href="#PathTokenizers.StepSequence-987"><span class="linenos"> 987</span></a>				<span class="n">step_rep_tokens_and_intra</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_INTRA</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence-988"><a href="#PathTokenizers.StepSequence-988"><span class="linenos"> 988</span></a>					<span class="n">step_rep_tokens</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence-989"><a href="#PathTokenizers.StepSequence-989"><span class="linenos"> 989</span></a>				<span class="p">)</span>
</span><span id="PathTokenizers.StepSequence-990"><a href="#PathTokenizers.StepSequence-990"><span class="linenos"> 990</span></a>				<span class="n">step_rep_tokens</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="n">step_rep_tokens_and_intra</span><span class="p">))</span>
</span><span id="PathTokenizers.StepSequence-991"><a href="#PathTokenizers.StepSequence-991"><span class="linenos"> 991</span></a>			<span class="n">all_tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PathTokenizers.StepSequence-992"><a href="#PathTokenizers.StepSequence-992"><span class="linenos"> 992</span></a>				<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">((</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_PRE</span><span class="p">,),</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;pre&quot;</span><span class="p">),</span>
</span><span id="PathTokenizers.StepSequence-993"><a href="#PathTokenizers.StepSequence-993"><span class="linenos"> 993</span></a>				<span class="o">*</span><span class="n">flatten</span><span class="p">(</span><span class="n">step_rep_tokens</span><span class="p">),</span>
</span><span id="PathTokenizers.StepSequence-994"><a href="#PathTokenizers.StepSequence-994"><span class="linenos"> 994</span></a>				<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">((</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_POST</span><span class="p">,),</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;post&quot;</span><span class="p">),</span>
</span><span id="PathTokenizers.StepSequence-995"><a href="#PathTokenizers.StepSequence-995"><span class="linenos"> 995</span></a>			<span class="p">]</span>
</span><span id="PathTokenizers.StepSequence-996"><a href="#PathTokenizers.StepSequence-996"><span class="linenos"> 996</span></a>			<span class="k">return</span> <span class="n">all_tokens</span>
</span><span id="PathTokenizers.StepSequence-997"><a href="#PathTokenizers.StepSequence-997"><span class="linenos"> 997</span></a>
</span><span id="PathTokenizers.StepSequence-998"><a href="#PathTokenizers.StepSequence-998"><span class="linenos"> 998</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_leading_tokens</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence-999"><a href="#PathTokenizers.StepSequence-999"><span class="linenos"> 999</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence-1000"><a href="#PathTokenizers.StepSequence-1000"><span class="linenos">1000</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence-1001"><a href="#PathTokenizers.StepSequence-1001"><span class="linenos">1001</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence-1002"><a href="#PathTokenizers.StepSequence-1002"><span class="linenos">1002</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PathTokenizers.StepSequence-1003"><a href="#PathTokenizers.StepSequence-1003"><span class="linenos">1003</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns tokens preceding those from the sequence from `_single_step_tokens`.</span>
</span><span id="PathTokenizers.StepSequence-1004"><a href="#PathTokenizers.StepSequence-1004"><span class="linenos">1004</span></a>
</span><span id="PathTokenizers.StepSequence-1005"><a href="#PathTokenizers.StepSequence-1005"><span class="linenos">1005</span></a><span class="sd">			Since the for loop in `to_tokens` iterates `len(path)-1` times, a fencepost problem exists with `StepTokenizers.Coord`.</span>
</span><span id="PathTokenizers.StepSequence-1006"><a href="#PathTokenizers.StepSequence-1006"><span class="linenos">1006</span></a><span class="sd">			&lt;PATH_START&gt; should NOT be included.</span>
</span><span id="PathTokenizers.StepSequence-1007"><a href="#PathTokenizers.StepSequence-1007"><span class="linenos">1007</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="PathTokenizers.StepSequence-1008"><a href="#PathTokenizers.StepSequence-1008"><span class="linenos">1008</span></a>			<span class="k">if</span> <span class="n">StepTokenizers</span><span class="o">.</span><span class="n">Coord</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence-1009"><a href="#PathTokenizers.StepSequence-1009"><span class="linenos">1009</span></a>				<span class="k">return</span> <span class="p">[</span>
</span><span id="PathTokenizers.StepSequence-1010"><a href="#PathTokenizers.StepSequence-1010"><span class="linenos">1010</span></a>					<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">((</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_PRE</span><span class="p">,),</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;pre&quot;</span><span class="p">),</span>
</span><span id="PathTokenizers.StepSequence-1011"><a href="#PathTokenizers.StepSequence-1011"><span class="linenos">1011</span></a>					<span class="o">*</span><span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">...</span><span class="p">]),</span>
</span><span id="PathTokenizers.StepSequence-1012"><a href="#PathTokenizers.StepSequence-1012"><span class="linenos">1012</span></a>					<span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">((</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_INTRA</span><span class="p">,),</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;intra&quot;</span><span class="p">),</span>
</span><span id="PathTokenizers.StepSequence-1013"><a href="#PathTokenizers.StepSequence-1013"><span class="linenos">1013</span></a>				<span class="p">]</span>
</span><span id="PathTokenizers.StepSequence-1014"><a href="#PathTokenizers.StepSequence-1014"><span class="linenos">1014</span></a>			<span class="k">return</span> <span class="p">[]</span>
</span><span id="PathTokenizers.StepSequence-1015"><a href="#PathTokenizers.StepSequence-1015"><span class="linenos">1015</span></a>
</span><span id="PathTokenizers.StepSequence-1016"><a href="#PathTokenizers.StepSequence-1016"><span class="linenos">1016</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_trailing_tokens</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence-1017"><a href="#PathTokenizers.StepSequence-1017"><span class="linenos">1017</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence-1018"><a href="#PathTokenizers.StepSequence-1018"><span class="linenos">1018</span></a>			<span class="n">c</span><span class="p">:</span> <span class="n">Coord</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence-1019"><a href="#PathTokenizers.StepSequence-1019"><span class="linenos">1019</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence-1020"><a href="#PathTokenizers.StepSequence-1020"><span class="linenos">1020</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PathTokenizers.StepSequence-1021"><a href="#PathTokenizers.StepSequence-1021"><span class="linenos">1021</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns tokens following those from the sequence from `_single_step_tokens`.</span>
</span><span id="PathTokenizers.StepSequence-1022"><a href="#PathTokenizers.StepSequence-1022"><span class="linenos">1022</span></a>
</span><span id="PathTokenizers.StepSequence-1023"><a href="#PathTokenizers.StepSequence-1023"><span class="linenos">1023</span></a><span class="sd">			&lt;PATH_END&gt; should NOT be included.</span>
</span><span id="PathTokenizers.StepSequence-1024"><a href="#PathTokenizers.StepSequence-1024"><span class="linenos">1024</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="PathTokenizers.StepSequence-1025"><a href="#PathTokenizers.StepSequence-1025"><span class="linenos">1025</span></a>			<span class="k">return</span> <span class="p">[]</span>
</span><span id="PathTokenizers.StepSequence-1026"><a href="#PathTokenizers.StepSequence-1026"><span class="linenos">1026</span></a>
</span><span id="PathTokenizers.StepSequence-1027"><a href="#PathTokenizers.StepSequence-1027"><span class="linenos">1027</span></a>		<span class="c1"># inherits docstring</span>
</span><span id="PathTokenizers.StepSequence-1028"><a href="#PathTokenizers.StepSequence-1028"><span class="linenos">1028</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># noqa: D102</span>
</span><span id="PathTokenizers.StepSequence-1029"><a href="#PathTokenizers.StepSequence-1029"><span class="linenos">1029</span></a>			<span class="n">output</span><span class="p">:</span> <span class="nb">bool</span>
</span><span id="PathTokenizers.StepSequence-1030"><a href="#PathTokenizers.StepSequence-1030"><span class="linenos">1030</span></a>
</span><span id="PathTokenizers.StepSequence-1031"><a href="#PathTokenizers.StepSequence-1031"><span class="linenos">1031</span></a>			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">):</span>
</span><span id="PathTokenizers.StepSequence-1032"><a href="#PathTokenizers.StepSequence-1032"><span class="linenos">1032</span></a>				<span class="c1"># Uninteresting: repeated elements are not useful</span>
</span><span id="PathTokenizers.StepSequence-1033"><a href="#PathTokenizers.StepSequence-1033"><span class="linenos">1033</span></a>				<span class="n">output</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="PathTokenizers.StepSequence-1034"><a href="#PathTokenizers.StepSequence-1034"><span class="linenos">1034</span></a>			<span class="k">else</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence-1035"><a href="#PathTokenizers.StepSequence-1035"><span class="linenos">1035</span></a>				<span class="c1"># we do noqa for the comment if false</span>
</span><span id="PathTokenizers.StepSequence-1036"><a href="#PathTokenizers.StepSequence-1036"><span class="linenos">1036</span></a>				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence-1037"><a href="#PathTokenizers.StepSequence-1037"><span class="linenos">1037</span></a>					<span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="PathTokenizers.StepSequence-1038"><a href="#PathTokenizers.StepSequence-1038"><span class="linenos">1038</span></a>					<span class="n">StepTokenizers</span><span class="o">.</span><span class="n">Distance</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence-1039"><a href="#PathTokenizers.StepSequence-1039"><span class="linenos">1039</span></a>				<span class="p">):</span>
</span><span id="PathTokenizers.StepSequence-1040"><a href="#PathTokenizers.StepSequence-1040"><span class="linenos">1040</span></a>					<span class="c1"># Untrainable: `Distance` alone cannot encode a path. &gt;=1 `StepTokenizer` which indicates direction/location is required.</span>
</span><span id="PathTokenizers.StepSequence-1041"><a href="#PathTokenizers.StepSequence-1041"><span class="linenos">1041</span></a>					<span class="n">output</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="PathTokenizers.StepSequence-1042"><a href="#PathTokenizers.StepSequence-1042"><span class="linenos">1042</span></a>				<span class="k">else</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence-1043"><a href="#PathTokenizers.StepSequence-1043"><span class="linenos">1043</span></a>					<span class="n">output</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="PathTokenizers.StepSequence-1044"><a href="#PathTokenizers.StepSequence-1044"><span class="linenos">1044</span></a>
</span><span id="PathTokenizers.StepSequence-1045"><a href="#PathTokenizers.StepSequence-1045"><span class="linenos">1045</span></a>			<span class="k">if</span> <span class="ow">not</span> <span class="n">output</span> <span class="ow">and</span> <span class="n">do_except</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence-1046"><a href="#PathTokenizers.StepSequence-1046"><span class="linenos">1046</span></a>				<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence-1047"><a href="#PathTokenizers.StepSequence-1047"><span class="linenos">1047</span></a>					<span class="s2">&quot;PathTokenizer must contain at least one `StepTokenizer` which indicates direction/location, or it will be untrainable.&quot;</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence-1048"><a href="#PathTokenizers.StepSequence-1048"><span class="linenos">1048</span></a>				<span class="p">)</span>
</span><span id="PathTokenizers.StepSequence-1049"><a href="#PathTokenizers.StepSequence-1049"><span class="linenos">1049</span></a>
</span><span id="PathTokenizers.StepSequence-1050"><a href="#PathTokenizers.StepSequence-1050"><span class="linenos">1050</span></a>			<span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>Any <code>PathTokenizer</code> where the tokenization may be assembled from token subsequences, each of which represents a step along the path.</p>

<p>Allows for a sequence of leading and trailing tokens which don't fit the step pattern.</p>

<h1 id="parameters">Parameters</h1>

<ul>
<li><code><a href="#PathTokenizers.StepSequence.step_size">step_size</a></code>: Selects the size of a single step in the sequence</li>
<li><code><a href="#PathTokenizers.StepSequence.step_tokenizers">step_tokenizers</a></code>: Selects the combination and permutation of tokens</li>
<li><code><a href="#PathTokenizers.StepSequence.pre">pre</a></code>: Whether all steps include an integral preceding delimiter token</li>
<li><code><a href="#PathTokenizers.StepSequence.intra">intra</a></code>: Whether all steps include a delimiter token after each individual <code>_StepTokenizer</code> tokenization.</li>
<li><code><a href="#PathTokenizers.StepSequence.post">post</a></code>: Whether all steps include an integral following delimiter token</li>
</ul>
</div>


                            <div id="PathTokenizers.StepSequence.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">PathTokenizers.StepSequence</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#PathTokenizers.StepSequence">PathTokenizers.StepSequence</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#PathTokenizers.StepSequence">PathTokenizers.StepSequence</a>&#39;&gt;&quot;</span>,</span><span class="param">	<span class="n">step_size</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">StepSizes</span><span class="o">.</span><span class="n">_StepSize</span> <span class="o">=</span> <span class="n"><a href="#StepSizes.Singles">StepSizes.Singles</a></span><span class="p">()</span>,</span><span class="param">	<span class="n">step_tokenizers</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">StepTokenizers</span><span class="o">.</span><span class="n">_StepTokenizer</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">StepTokenizers</span><span class="o">.</span><span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">StepTokenizers</span><span class="o">.</span><span class="n">_StepTokenizer</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">StepTokenizers</span><span class="o">.</span><span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">StepTokenizers</span><span class="o">.</span><span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">StepTokenizers</span><span class="o">.</span><span class="n">_StepTokenizer</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">StepTokenizers</span><span class="o">.</span><span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">StepTokenizers</span><span class="o">.</span><span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">StepTokenizers</span><span class="o">.</span><span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">StepTokenizers</span><span class="o">.</span><span class="n">_StepTokenizer</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n"><a href="#StepTokenizers.Coord">StepTokenizers.Coord</a></span><span class="p">(),)</span>,</span><span class="param">	<span class="n">pre</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">intra</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">post</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#PathTokenizers.StepSequence.__init__"></a>
    
    

                            </div>
                            <div id="PathTokenizers.StepSequence.step_size" class="classattr">
                                <div class="attr variable">
            <span class="name">step_size</span><span class="annotation">: maze_dataset.tokenization.modular.elements.StepSizes._StepSize</span>        =
<span class="default_value"><a href="#StepSizes.Singles">StepSizes.Singles()</a></span>

        
    </div>
    <a class="headerlink" href="#PathTokenizers.StepSequence.step_size"></a>
    
    

                            </div>
                            <div id="PathTokenizers.StepSequence.step_tokenizers" class="classattr">
                                <div class="attr variable">
            <span class="name">step_tokenizers</span><span class="annotation">: tuple[maze_dataset.tokenization.modular.elements.StepTokenizers._StepTokenizer] | tuple[maze_dataset.tokenization.modular.elements.StepTokenizers._StepTokenizer, maze_dataset.tokenization.modular.elements.StepTokenizers._StepTokenizer] | tuple[maze_dataset.tokenization.modular.elements.StepTokenizers._StepTokenizer, maze_dataset.tokenization.modular.elements.StepTokenizers._StepTokenizer, maze_dataset.tokenization.modular.elements.StepTokenizers._StepTokenizer] | tuple[maze_dataset.tokenization.modular.elements.StepTokenizers._StepTokenizer, maze_dataset.tokenization.modular.elements.StepTokenizers._StepTokenizer, maze_dataset.tokenization.modular.elements.StepTokenizers._StepTokenizer, maze_dataset.tokenization.modular.elements.StepTokenizers._StepTokenizer]</span>        =
<span class="default_value">(<a href="#StepTokenizers.Coord">StepTokenizers.Coord()</a>,)</span>

        
    </div>
    <a class="headerlink" href="#PathTokenizers.StepSequence.step_tokenizers"></a>
    
    

                            </div>
                            <div id="PathTokenizers.StepSequence.pre" class="classattr">
                                <div class="attr variable">
            <span class="name">pre</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#PathTokenizers.StepSequence.pre"></a>
    
    

                            </div>
                            <div id="PathTokenizers.StepSequence.intra" class="classattr">
                                <div class="attr variable">
            <span class="name">intra</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#PathTokenizers.StepSequence.intra"></a>
    
    

                            </div>
                            <div id="PathTokenizers.StepSequence.post" class="classattr">
                                <div class="attr variable">
            <span class="name">post</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#PathTokenizers.StepSequence.post"></a>
    
    

                            </div>
                            <div id="PathTokenizers.StepSequence.to_tokens" class="classattr">
                                        <input id="PathTokenizers.StepSequence.to_tokens-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_tokens</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">maze</span><span class="p">:</span> <span class="n"><a href="../../../maze_dataset.html#SolvedMaze">maze_dataset.SolvedMaze</a></span>,</span><span class="param">	<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="PathTokenizers.StepSequence.to_tokens-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L953-L967" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#PathTokenizers.StepSequence.to_tokens"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PathTokenizers.StepSequence.to_tokens-954"><a href="#PathTokenizers.StepSequence.to_tokens-954"><span class="linenos">954</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>  <span class="c1"># noqa: D102</span>
</span><span id="PathTokenizers.StepSequence.to_tokens-955"><a href="#PathTokenizers.StepSequence.to_tokens-955"><span class="linenos">955</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence.to_tokens-956"><a href="#PathTokenizers.StepSequence.to_tokens-956"><span class="linenos">956</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence.to_tokens-957"><a href="#PathTokenizers.StepSequence.to_tokens-957"><span class="linenos">957</span></a>			<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence.to_tokens-958"><a href="#PathTokenizers.StepSequence.to_tokens-958"><span class="linenos">958</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PathTokenizers.StepSequence.to_tokens-959"><a href="#PathTokenizers.StepSequence.to_tokens-959"><span class="linenos">959</span></a>			<span class="k">return</span> <span class="p">[</span>
</span><span id="PathTokenizers.StepSequence.to_tokens-960"><a href="#PathTokenizers.StepSequence.to_tokens-960"><span class="linenos">960</span></a>				<span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_leading_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">),</span>
</span><span id="PathTokenizers.StepSequence.to_tokens-961"><a href="#PathTokenizers.StepSequence.to_tokens-961"><span class="linenos">961</span></a>				<span class="o">*</span><span class="n">flatten</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.to_tokens-962"><a href="#PathTokenizers.StepSequence.to_tokens-962"><span class="linenos">962</span></a>					<span class="p">[</span>
</span><span id="PathTokenizers.StepSequence.to_tokens-963"><a href="#PathTokenizers.StepSequence.to_tokens-963"><span class="linenos">963</span></a>						<span class="bp">self</span><span class="o">.</span><span class="n">_single_step_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.to_tokens-964"><a href="#PathTokenizers.StepSequence.to_tokens-964"><span class="linenos">964</span></a>						<span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_size</span><span class="o">.</span><span class="n">step_start_end_indices</span><span class="p">(</span><span class="n">maze</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.to_tokens-965"><a href="#PathTokenizers.StepSequence.to_tokens-965"><span class="linenos">965</span></a>					<span class="p">],</span>
</span><span id="PathTokenizers.StepSequence.to_tokens-966"><a href="#PathTokenizers.StepSequence.to_tokens-966"><span class="linenos">966</span></a>				<span class="p">),</span>
</span><span id="PathTokenizers.StepSequence.to_tokens-967"><a href="#PathTokenizers.StepSequence.to_tokens-967"><span class="linenos">967</span></a>				<span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_trailing_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">),</span>
</span><span id="PathTokenizers.StepSequence.to_tokens-968"><a href="#PathTokenizers.StepSequence.to_tokens-968"><span class="linenos">968</span></a>			<span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Returns tokens representing the solution path.</p>
</div>


                            </div>
                            <div id="PathTokenizers.StepSequence.is_valid" class="classattr">
                                        <input id="PathTokenizers.StepSequence.is_valid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_valid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="PathTokenizers.StepSequence.is_valid-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L1027-L1049" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#PathTokenizers.StepSequence.is_valid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PathTokenizers.StepSequence.is_valid-1028"><a href="#PathTokenizers.StepSequence.is_valid-1028"><span class="linenos">1028</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># noqa: D102</span>
</span><span id="PathTokenizers.StepSequence.is_valid-1029"><a href="#PathTokenizers.StepSequence.is_valid-1029"><span class="linenos">1029</span></a>			<span class="n">output</span><span class="p">:</span> <span class="nb">bool</span>
</span><span id="PathTokenizers.StepSequence.is_valid-1030"><a href="#PathTokenizers.StepSequence.is_valid-1030"><span class="linenos">1030</span></a>
</span><span id="PathTokenizers.StepSequence.is_valid-1031"><a href="#PathTokenizers.StepSequence.is_valid-1031"><span class="linenos">1031</span></a>			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">):</span>
</span><span id="PathTokenizers.StepSequence.is_valid-1032"><a href="#PathTokenizers.StepSequence.is_valid-1032"><span class="linenos">1032</span></a>				<span class="c1"># Uninteresting: repeated elements are not useful</span>
</span><span id="PathTokenizers.StepSequence.is_valid-1033"><a href="#PathTokenizers.StepSequence.is_valid-1033"><span class="linenos">1033</span></a>				<span class="n">output</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="PathTokenizers.StepSequence.is_valid-1034"><a href="#PathTokenizers.StepSequence.is_valid-1034"><span class="linenos">1034</span></a>			<span class="k">else</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence.is_valid-1035"><a href="#PathTokenizers.StepSequence.is_valid-1035"><span class="linenos">1035</span></a>				<span class="c1"># we do noqa for the comment if false</span>
</span><span id="PathTokenizers.StepSequence.is_valid-1036"><a href="#PathTokenizers.StepSequence.is_valid-1036"><span class="linenos">1036</span></a>				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.is_valid-1037"><a href="#PathTokenizers.StepSequence.is_valid-1037"><span class="linenos">1037</span></a>					<span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="PathTokenizers.StepSequence.is_valid-1038"><a href="#PathTokenizers.StepSequence.is_valid-1038"><span class="linenos">1038</span></a>					<span class="n">StepTokenizers</span><span class="o">.</span><span class="n">Distance</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence.is_valid-1039"><a href="#PathTokenizers.StepSequence.is_valid-1039"><span class="linenos">1039</span></a>				<span class="p">):</span>
</span><span id="PathTokenizers.StepSequence.is_valid-1040"><a href="#PathTokenizers.StepSequence.is_valid-1040"><span class="linenos">1040</span></a>					<span class="c1"># Untrainable: `Distance` alone cannot encode a path. &gt;=1 `StepTokenizer` which indicates direction/location is required.</span>
</span><span id="PathTokenizers.StepSequence.is_valid-1041"><a href="#PathTokenizers.StepSequence.is_valid-1041"><span class="linenos">1041</span></a>					<span class="n">output</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="PathTokenizers.StepSequence.is_valid-1042"><a href="#PathTokenizers.StepSequence.is_valid-1042"><span class="linenos">1042</span></a>				<span class="k">else</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence.is_valid-1043"><a href="#PathTokenizers.StepSequence.is_valid-1043"><span class="linenos">1043</span></a>					<span class="n">output</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="PathTokenizers.StepSequence.is_valid-1044"><a href="#PathTokenizers.StepSequence.is_valid-1044"><span class="linenos">1044</span></a>
</span><span id="PathTokenizers.StepSequence.is_valid-1045"><a href="#PathTokenizers.StepSequence.is_valid-1045"><span class="linenos">1045</span></a>			<span class="k">if</span> <span class="ow">not</span> <span class="n">output</span> <span class="ow">and</span> <span class="n">do_except</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence.is_valid-1046"><a href="#PathTokenizers.StepSequence.is_valid-1046"><span class="linenos">1046</span></a>				<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.is_valid-1047"><a href="#PathTokenizers.StepSequence.is_valid-1047"><span class="linenos">1047</span></a>					<span class="s2">&quot;PathTokenizer must contain at least one `StepTokenizer` which indicates direction/location, or it will be untrainable.&quot;</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence.is_valid-1048"><a href="#PathTokenizers.StepSequence.is_valid-1048"><span class="linenos">1048</span></a>				<span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.is_valid-1049"><a href="#PathTokenizers.StepSequence.is_valid-1049"><span class="linenos">1049</span></a>
</span><span id="PathTokenizers.StepSequence.is_valid-1050"><a href="#PathTokenizers.StepSequence.is_valid-1050"><span class="linenos">1050</span></a>			<span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>Returns if <code>self</code> contains data members capable of producing an overall valid <code>MazeTokenizerModular</code>.</p>

<p>Some <code>_TokenizerElement</code> instances may be created which are not useful despite obeying data member type hints.
<code><a href="#PathTokenizers.StepSequence.is_valid">is_valid</a></code> allows for more precise detection of invalid <code>_TokenizerElement</code>s beyond type hinting alone.
If type hints are sufficient to constrain the possible instances of some subclass, then this method may simply <code>return True</code> for that subclass.</p>

<h1 id="types-of-invalidity">Types of Invalidity</h1>

<p>In nontrivial implementations of this method, each conditional clause should contain a comment classifying the reason for invalidity and one of the types below.
Invalidity types, in ascending order of invalidity:</p>

<ul>
<li>Uninteresting: These tokenizers might be used to train functional models, but the schemes are not interesting to study.
E.g., <code>_TokenizerElement</code>s which are strictly worse than some alternative.</li>
<li>Duplicate: These tokenizers have identical tokenization behavior as some other valid tokenizers.</li>
<li>Untrainable: Training functional models using these tokenizers would be (nearly) impossible.</li>
<li>Erroneous: These tokenizers might raise exceptions during use.</li>
</ul>

<h1 id="development">Development</h1>

<p><code>is_invalid</code> is implemented to always return <code>True</code> in some abstract classes where all currently possible subclass instances are valid.
When adding new subclasses or data members, the developer should check if any such blanket statement of validity still holds and update it as neccesary.</p>

<h2 id="nesting">Nesting</h2>

<p>In general, when implementing this method, there is no need to recursively call <code><a href="#PathTokenizers.StepSequence.is_valid">is_valid</a></code> on nested <code>_TokenizerElement</code>s contained in the class.
In other words, failures of <code><a href="#PathTokenizers.StepSequence.is_valid">is_valid</a></code> need not bubble up to the top of the nested <code>_TokenizerElement</code> tree.
<code>MazeTokenizerModular.is_valid</code> calls <code><a href="#PathTokenizers.StepSequence.is_valid">is_valid</a></code> on each of its <code>_TokenizerElement</code>s individually, so failure at any level will be detected.</p>

<h2 id="types-of-invalidity-2">Types of Invalidity</h2>

<p>If it's judged to be useful, the types of invalidity could be implemented with an Enum or similar rather than only living in comments.
This could be used to create more or less stringent filters on the valid <code>_TokenizerElement</code> instances.</p>
</div>


                            </div>
                            <div id="PathTokenizers.StepSequence.serialize" class="classattr">
                                        <input id="PathTokenizers.StepSequence.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="PathTokenizers.StepSequence.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L713-L769" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#PathTokenizers.StepSequence.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PathTokenizers.StepSequence.serialize-714"><a href="#PathTokenizers.StepSequence.serialize-714"><span class="linenos">714</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="PathTokenizers.StepSequence.serialize-715"><a href="#PathTokenizers.StepSequence.serialize-715"><span class="linenos">715</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PathTokenizers.StepSequence.serialize-716"><a href="#PathTokenizers.StepSequence.serialize-716"><span class="linenos">716</span></a>                <span class="n">_FORMAT_KEY</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="PathTokenizers.StepSequence.serialize-717"><a href="#PathTokenizers.StepSequence.serialize-717"><span class="linenos">717</span></a>            <span class="p">}</span>
</span><span id="PathTokenizers.StepSequence.serialize-718"><a href="#PathTokenizers.StepSequence.serialize-718"><span class="linenos">718</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="PathTokenizers.StepSequence.serialize-719"><a href="#PathTokenizers.StepSequence.serialize-719"><span class="linenos">719</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="PathTokenizers.StepSequence.serialize-720"><a href="#PathTokenizers.StepSequence.serialize-720"><span class="linenos">720</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="PathTokenizers.StepSequence.serialize-721"><a href="#PathTokenizers.StepSequence.serialize-721"><span class="linenos">721</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="PathTokenizers.StepSequence.serialize-722"><a href="#PathTokenizers.StepSequence.serialize-722"><span class="linenos">722</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.serialize-723"><a href="#PathTokenizers.StepSequence.serialize-723"><span class="linenos">723</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="PathTokenizers.StepSequence.serialize-724"><a href="#PathTokenizers.StepSequence.serialize-724"><span class="linenos">724</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="PathTokenizers.StepSequence.serialize-725"><a href="#PathTokenizers.StepSequence.serialize-725"><span class="linenos">725</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="PathTokenizers.StepSequence.serialize-726"><a href="#PathTokenizers.StepSequence.serialize-726"><span class="linenos">726</span></a>                    <span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.serialize-727"><a href="#PathTokenizers.StepSequence.serialize-727"><span class="linenos">727</span></a>
</span><span id="PathTokenizers.StepSequence.serialize-728"><a href="#PathTokenizers.StepSequence.serialize-728"><span class="linenos">728</span></a>                <span class="c1"># try to save it</span>
</span><span id="PathTokenizers.StepSequence.serialize-729"><a href="#PathTokenizers.StepSequence.serialize-729"><span class="linenos">729</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence.serialize-730"><a href="#PathTokenizers.StepSequence.serialize-730"><span class="linenos">730</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence.serialize-731"><a href="#PathTokenizers.StepSequence.serialize-731"><span class="linenos">731</span></a>                        <span class="c1"># get the val</span>
</span><span id="PathTokenizers.StepSequence.serialize-732"><a href="#PathTokenizers.StepSequence.serialize-732"><span class="linenos">732</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.serialize-733"><a href="#PathTokenizers.StepSequence.serialize-733"><span class="linenos">733</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="PathTokenizers.StepSequence.serialize-734"><a href="#PathTokenizers.StepSequence.serialize-734"><span class="linenos">734</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="PathTokenizers.StepSequence.serialize-735"><a href="#PathTokenizers.StepSequence.serialize-735"><span class="linenos">735</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="PathTokenizers.StepSequence.serialize-736"><a href="#PathTokenizers.StepSequence.serialize-736"><span class="linenos">736</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="PathTokenizers.StepSequence.serialize-737"><a href="#PathTokenizers.StepSequence.serialize-737"><span class="linenos">737</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="PathTokenizers.StepSequence.serialize-738"><a href="#PathTokenizers.StepSequence.serialize-738"><span class="linenos">738</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="PathTokenizers.StepSequence.serialize-739"><a href="#PathTokenizers.StepSequence.serialize-739"><span class="linenos">739</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="PathTokenizers.StepSequence.serialize-740"><a href="#PathTokenizers.StepSequence.serialize-740"><span class="linenos">740</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="PathTokenizers.StepSequence.serialize-741"><a href="#PathTokenizers.StepSequence.serialize-741"><span class="linenos">741</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence.serialize-742"><a href="#PathTokenizers.StepSequence.serialize-742"><span class="linenos">742</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.serialize-743"><a href="#PathTokenizers.StepSequence.serialize-743"><span class="linenos">743</span></a>
</span><span id="PathTokenizers.StepSequence.serialize-744"><a href="#PathTokenizers.StepSequence.serialize-744"><span class="linenos">744</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="PathTokenizers.StepSequence.serialize-745"><a href="#PathTokenizers.StepSequence.serialize-745"><span class="linenos">745</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="PathTokenizers.StepSequence.serialize-746"><a href="#PathTokenizers.StepSequence.serialize-746"><span class="linenos">746</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence.serialize-747"><a href="#PathTokenizers.StepSequence.serialize-747"><span class="linenos">747</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.serialize-748"><a href="#PathTokenizers.StepSequence.serialize-748"><span class="linenos">748</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.serialize-749"><a href="#PathTokenizers.StepSequence.serialize-749"><span class="linenos">749</span></a>                                <span class="p">[</span>
</span><span id="PathTokenizers.StepSequence.serialize-750"><a href="#PathTokenizers.StepSequence.serialize-750"><span class="linenos">750</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence.serialize-751"><a href="#PathTokenizers.StepSequence.serialize-751"><span class="linenos">751</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence.serialize-752"><a href="#PathTokenizers.StepSequence.serialize-752"><span class="linenos">752</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence.serialize-753"><a href="#PathTokenizers.StepSequence.serialize-753"><span class="linenos">753</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence.serialize-754"><a href="#PathTokenizers.StepSequence.serialize-754"><span class="linenos">754</span></a>                                <span class="p">]</span>
</span><span id="PathTokenizers.StepSequence.serialize-755"><a href="#PathTokenizers.StepSequence.serialize-755"><span class="linenos">755</span></a>                            <span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.serialize-756"><a href="#PathTokenizers.StepSequence.serialize-756"><span class="linenos">756</span></a>                        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</span><span id="PathTokenizers.StepSequence.serialize-757"><a href="#PathTokenizers.StepSequence.serialize-757"><span class="linenos">757</span></a>
</span><span id="PathTokenizers.StepSequence.serialize-758"><a href="#PathTokenizers.StepSequence.serialize-758"><span class="linenos">758</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="PathTokenizers.StepSequence.serialize-759"><a href="#PathTokenizers.StepSequence.serialize-759"><span class="linenos">759</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence.serialize-760"><a href="#PathTokenizers.StepSequence.serialize-760"><span class="linenos">760</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="PathTokenizers.StepSequence.serialize-761"><a href="#PathTokenizers.StepSequence.serialize-761"><span class="linenos">761</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.serialize-762"><a href="#PathTokenizers.StepSequence.serialize-762"><span class="linenos">762</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="PathTokenizers.StepSequence.serialize-763"><a href="#PathTokenizers.StepSequence.serialize-763"><span class="linenos">763</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence.serialize-764"><a href="#PathTokenizers.StepSequence.serialize-764"><span class="linenos">764</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.serialize-765"><a href="#PathTokenizers.StepSequence.serialize-765"><span class="linenos">765</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="PathTokenizers.StepSequence.serialize-766"><a href="#PathTokenizers.StepSequence.serialize-766"><span class="linenos">766</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="PathTokenizers.StepSequence.serialize-767"><a href="#PathTokenizers.StepSequence.serialize-767"><span class="linenos">767</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="PathTokenizers.StepSequence.serialize-768"><a href="#PathTokenizers.StepSequence.serialize-768"><span class="linenos">768</span></a>                    <span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.serialize-769"><a href="#PathTokenizers.StepSequence.serialize-769"><span class="linenos">769</span></a>
</span><span id="PathTokenizers.StepSequence.serialize-770"><a href="#PathTokenizers.StepSequence.serialize-770"><span class="linenos">770</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="PathTokenizers.StepSequence.load" class="classattr">
                                        <input id="PathTokenizers.StepSequence.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="PathTokenizers.StepSequence.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L776-L862" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#PathTokenizers.StepSequence.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PathTokenizers.StepSequence.load-777"><a href="#PathTokenizers.StepSequence.load-777"><span class="linenos">777</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="PathTokenizers.StepSequence.load-778"><a href="#PathTokenizers.StepSequence.load-778"><span class="linenos">778</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="PathTokenizers.StepSequence.load-779"><a href="#PathTokenizers.StepSequence.load-779"><span class="linenos">779</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="PathTokenizers.StepSequence.load-780"><a href="#PathTokenizers.StepSequence.load-780"><span class="linenos">780</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="PathTokenizers.StepSequence.load-781"><a href="#PathTokenizers.StepSequence.load-781"><span class="linenos">781</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="PathTokenizers.StepSequence.load-782"><a href="#PathTokenizers.StepSequence.load-782"><span class="linenos">782</span></a>
</span><span id="PathTokenizers.StepSequence.load-783"><a href="#PathTokenizers.StepSequence.load-783"><span class="linenos">783</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.load-784"><a href="#PathTokenizers.StepSequence.load-784"><span class="linenos">784</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="PathTokenizers.StepSequence.load-785"><a href="#PathTokenizers.StepSequence.load-785"><span class="linenos">785</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="PathTokenizers.StepSequence.load-786"><a href="#PathTokenizers.StepSequence.load-786"><span class="linenos">786</span></a>
</span><span id="PathTokenizers.StepSequence.load-787"><a href="#PathTokenizers.StepSequence.load-787"><span class="linenos">787</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.load-788"><a href="#PathTokenizers.StepSequence.load-788"><span class="linenos">788</span></a>
</span><span id="PathTokenizers.StepSequence.load-789"><a href="#PathTokenizers.StepSequence.load-789"><span class="linenos">789</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="PathTokenizers.StepSequence.load-790"><a href="#PathTokenizers.StepSequence.load-790"><span class="linenos">790</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="PathTokenizers.StepSequence.load-791"><a href="#PathTokenizers.StepSequence.load-791"><span class="linenos">791</span></a>
</span><span id="PathTokenizers.StepSequence.load-792"><a href="#PathTokenizers.StepSequence.load-792"><span class="linenos">792</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="PathTokenizers.StepSequence.load-793"><a href="#PathTokenizers.StepSequence.load-793"><span class="linenos">793</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="PathTokenizers.StepSequence.load-794"><a href="#PathTokenizers.StepSequence.load-794"><span class="linenos">794</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="PathTokenizers.StepSequence.load-795"><a href="#PathTokenizers.StepSequence.load-795"><span class="linenos">795</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.load-796"><a href="#PathTokenizers.StepSequence.load-796"><span class="linenos">796</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="PathTokenizers.StepSequence.load-797"><a href="#PathTokenizers.StepSequence.load-797"><span class="linenos">797</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="PathTokenizers.StepSequence.load-798"><a href="#PathTokenizers.StepSequence.load-798"><span class="linenos">798</span></a>
</span><span id="PathTokenizers.StepSequence.load-799"><a href="#PathTokenizers.StepSequence.load-799"><span class="linenos">799</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="PathTokenizers.StepSequence.load-800"><a href="#PathTokenizers.StepSequence.load-800"><span class="linenos">800</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence.load-801"><a href="#PathTokenizers.StepSequence.load-801"><span class="linenos">801</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="PathTokenizers.StepSequence.load-802"><a href="#PathTokenizers.StepSequence.load-802"><span class="linenos">802</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="PathTokenizers.StepSequence.load-803"><a href="#PathTokenizers.StepSequence.load-803"><span class="linenos">803</span></a>
</span><span id="PathTokenizers.StepSequence.load-804"><a href="#PathTokenizers.StepSequence.load-804"><span class="linenos">804</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="PathTokenizers.StepSequence.load-805"><a href="#PathTokenizers.StepSequence.load-805"><span class="linenos">805</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.load-806"><a href="#PathTokenizers.StepSequence.load-806"><span class="linenos">806</span></a>
</span><span id="PathTokenizers.StepSequence.load-807"><a href="#PathTokenizers.StepSequence.load-807"><span class="linenos">807</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="PathTokenizers.StepSequence.load-808"><a href="#PathTokenizers.StepSequence.load-808"><span class="linenos">808</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence.load-809"><a href="#PathTokenizers.StepSequence.load-809"><span class="linenos">809</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="PathTokenizers.StepSequence.load-810"><a href="#PathTokenizers.StepSequence.load-810"><span class="linenos">810</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.load-811"><a href="#PathTokenizers.StepSequence.load-811"><span class="linenos">811</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence.load-812"><a href="#PathTokenizers.StepSequence.load-812"><span class="linenos">812</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="PathTokenizers.StepSequence.load-813"><a href="#PathTokenizers.StepSequence.load-813"><span class="linenos">813</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.load-814"><a href="#PathTokenizers.StepSequence.load-814"><span class="linenos">814</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.load-815"><a href="#PathTokenizers.StepSequence.load-815"><span class="linenos">815</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="PathTokenizers.StepSequence.load-816"><a href="#PathTokenizers.StepSequence.load-816"><span class="linenos">816</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.load-817"><a href="#PathTokenizers.StepSequence.load-817"><span class="linenos">817</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.load-818"><a href="#PathTokenizers.StepSequence.load-818"><span class="linenos">818</span></a>                    <span class="p">):</span>
</span><span id="PathTokenizers.StepSequence.load-819"><a href="#PathTokenizers.StepSequence.load-819"><span class="linenos">819</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="PathTokenizers.StepSequence.load-820"><a href="#PathTokenizers.StepSequence.load-820"><span class="linenos">820</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="PathTokenizers.StepSequence.load-821"><a href="#PathTokenizers.StepSequence.load-821"><span class="linenos">821</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.load-822"><a href="#PathTokenizers.StepSequence.load-822"><span class="linenos">822</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence.load-823"><a href="#PathTokenizers.StepSequence.load-823"><span class="linenos">823</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.load-824"><a href="#PathTokenizers.StepSequence.load-824"><span class="linenos">824</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="PathTokenizers.StepSequence.load-825"><a href="#PathTokenizers.StepSequence.load-825"><span class="linenos">825</span></a>                            <span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.load-826"><a href="#PathTokenizers.StepSequence.load-826"><span class="linenos">826</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence.load-827"><a href="#PathTokenizers.StepSequence.load-827"><span class="linenos">827</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="PathTokenizers.StepSequence.load-828"><a href="#PathTokenizers.StepSequence.load-828"><span class="linenos">828</span></a>                        <span class="k">pass</span>
</span><span id="PathTokenizers.StepSequence.load-829"><a href="#PathTokenizers.StepSequence.load-829"><span class="linenos">829</span></a>
</span><span id="PathTokenizers.StepSequence.load-830"><a href="#PathTokenizers.StepSequence.load-830"><span class="linenos">830</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="PathTokenizers.StepSequence.load-831"><a href="#PathTokenizers.StepSequence.load-831"><span class="linenos">831</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="PathTokenizers.StepSequence.load-832"><a href="#PathTokenizers.StepSequence.load-832"><span class="linenos">832</span></a>
</span><span id="PathTokenizers.StepSequence.load-833"><a href="#PathTokenizers.StepSequence.load-833"><span class="linenos">833</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="PathTokenizers.StepSequence.load-834"><a href="#PathTokenizers.StepSequence.load-834"><span class="linenos">834</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.load-835"><a href="#PathTokenizers.StepSequence.load-835"><span class="linenos">835</span></a>
</span><span id="PathTokenizers.StepSequence.load-836"><a href="#PathTokenizers.StepSequence.load-836"><span class="linenos">836</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="PathTokenizers.StepSequence.load-837"><a href="#PathTokenizers.StepSequence.load-837"><span class="linenos">837</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence.load-838"><a href="#PathTokenizers.StepSequence.load-838"><span class="linenos">838</span></a>                <span class="n">fields_valid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.load-839"><a href="#PathTokenizers.StepSequence.load-839"><span class="linenos">839</span></a>                    <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.load-840"><a href="#PathTokenizers.StepSequence.load-840"><span class="linenos">840</span></a>                        <span class="n">output</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence.load-841"><a href="#PathTokenizers.StepSequence.load-841"><span class="linenos">841</span></a>                        <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence.load-842"><a href="#PathTokenizers.StepSequence.load-842"><span class="linenos">842</span></a>                    <span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.load-843"><a href="#PathTokenizers.StepSequence.load-843"><span class="linenos">843</span></a>                <span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.load-844"><a href="#PathTokenizers.StepSequence.load-844"><span class="linenos">844</span></a>
</span><span id="PathTokenizers.StepSequence.load-845"><a href="#PathTokenizers.StepSequence.load-845"><span class="linenos">845</span></a>                <span class="c1"># if there are any fields that are not valid, raise an error</span>
</span><span id="PathTokenizers.StepSequence.load-846"><a href="#PathTokenizers.StepSequence.load-846"><span class="linenos">846</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">fields_valid</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="PathTokenizers.StepSequence.load-847"><a href="#PathTokenizers.StepSequence.load-847"><span class="linenos">847</span></a>                    <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.load-848"><a href="#PathTokenizers.StepSequence.load-848"><span class="linenos">848</span></a>                        <span class="sa">f</span><span class="s2">&quot;Type mismatch in fields of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="PathTokenizers.StepSequence.load-849"><a href="#PathTokenizers.StepSequence.load-849"><span class="linenos">849</span></a>                        <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.load-850"><a href="#PathTokenizers.StepSequence.load-850"><span class="linenos">850</span></a>                            <span class="p">[</span>
</span><span id="PathTokenizers.StepSequence.load-851"><a href="#PathTokenizers.StepSequence.load-851"><span class="linenos">851</span></a>                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">:</span><span class="se">\t</span><span class="s2">expected </span><span class="si">{</span><span class="n">cls_type_hints</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="si">= }</span><span class="s2">, but got value </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="PathTokenizers.StepSequence.load-852"><a href="#PathTokenizers.StepSequence.load-852"><span class="linenos">852</span></a>                                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">fields_valid</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="PathTokenizers.StepSequence.load-853"><a href="#PathTokenizers.StepSequence.load-853"><span class="linenos">853</span></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span>
</span><span id="PathTokenizers.StepSequence.load-854"><a href="#PathTokenizers.StepSequence.load-854"><span class="linenos">854</span></a>                            <span class="p">]</span>
</span><span id="PathTokenizers.StepSequence.load-855"><a href="#PathTokenizers.StepSequence.load-855"><span class="linenos">855</span></a>                        <span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.load-856"><a href="#PathTokenizers.StepSequence.load-856"><span class="linenos">856</span></a>                    <span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.load-857"><a href="#PathTokenizers.StepSequence.load-857"><span class="linenos">857</span></a>
</span><span id="PathTokenizers.StepSequence.load-858"><a href="#PathTokenizers.StepSequence.load-858"><span class="linenos">858</span></a>                    <span class="n">on_typecheck_mismatch</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.load-859"><a href="#PathTokenizers.StepSequence.load-859"><span class="linenos">859</span></a>                        <span class="n">msg</span><span class="p">,</span> <span class="n">except_cls</span><span class="o">=</span><span class="n">FieldTypeMismatchError</span>
</span><span id="PathTokenizers.StepSequence.load-860"><a href="#PathTokenizers.StepSequence.load-860"><span class="linenos">860</span></a>                    <span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.load-861"><a href="#PathTokenizers.StepSequence.load-861"><span class="linenos">861</span></a>
</span><span id="PathTokenizers.StepSequence.load-862"><a href="#PathTokenizers.StepSequence.load-862"><span class="linenos">862</span></a>            <span class="c1"># return the new instance</span>
</span><span id="PathTokenizers.StepSequence.load-863"><a href="#PathTokenizers.StepSequence.load-863"><span class="linenos">863</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="PathTokenizers.StepSequence.validate_fields_types" class="classattr">
                                        <input id="PathTokenizers.StepSequence.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="PathTokenizers.StepSequence.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L282-L291" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#PathTokenizers.StepSequence.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PathTokenizers.StepSequence.validate_fields_types-283"><a href="#PathTokenizers.StepSequence.validate_fields_types-283"><span class="linenos">283</span></a><span class="k">def</span><span class="w"> </span><span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.validate_fields_types-284"><a href="#PathTokenizers.StepSequence.validate_fields_types-284"><span class="linenos">284</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence.validate_fields_types-285"><a href="#PathTokenizers.StepSequence.validate_fields_types-285"><span class="linenos">285</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence.validate_fields_types-286"><a href="#PathTokenizers.StepSequence.validate_fields_types-286"><span class="linenos">286</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence.validate_fields_types-287"><a href="#PathTokenizers.StepSequence.validate_fields_types-287"><span class="linenos">287</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="PathTokenizers.StepSequence.validate_fields_types-288"><a href="#PathTokenizers.StepSequence.validate_fields_types-288"><span class="linenos">288</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.validate_fields_types-289"><a href="#PathTokenizers.StepSequence.validate_fields_types-289"><span class="linenos">289</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.validate_fields_types-290"><a href="#PathTokenizers.StepSequence.validate_fields_types-290"><span class="linenos">290</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="PathTokenizers.StepSequence.validate_fields_types-291"><a href="#PathTokenizers.StepSequence.validate_fields_types-291"><span class="linenos">291</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="PathTokenizers.StepSequence.validate_fields_types-292"><a href="#PathTokenizers.StepSequence.validate_fields_types-292"><span class="linenos">292</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#PathTokenizers._PathTokenizer">PathTokenizers._PathTokenizer</a></dt>
                                <dd id="PathTokenizers.StepSequence.attribute_key" class="function"><a href="#PathTokenizers._PathTokenizer.attribute_key">attribute_key</a></dd>

            </div>
            <div><dt><a href="element_base.html#_TokenizerElement">maze_dataset.tokenization.modular.element_base._TokenizerElement</a></dt>
                                <dd id="PathTokenizers.StepSequence.name" class="variable"><a href="element_base.html#_TokenizerElement.name">name</a></dd>
                <dd id="PathTokenizers.StepSequence.tokenizer_elements" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="PathTokenizers.StepSequence.tokenizer_element_tree" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="PathTokenizers.StepSequence.tokenizer_element_dict" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="PathTokenizers.StepSequence.validate_field_type" class="function">validate_field_type</dd>
                <dd id="PathTokenizers.StepSequence.diff" class="function">diff</dd>
                <dd id="PathTokenizers.StepSequence.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="PromptSequencers">
                            <input id="PromptSequencers-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">PromptSequencers</span><wbr>(<span class="base"><a href="element_base.html#__TokenizerElementNamespace">maze_dataset.tokenization.modular.element_base.__TokenizerElementNamespace</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="PromptSequencers-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L1052-L1294" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#PromptSequencers"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PromptSequencers-1053"><a href="#PromptSequencers-1053"><span class="linenos">1053</span></a><span class="k">class</span><span class="w"> </span><span class="nc">PromptSequencers</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="PromptSequencers-1054"><a href="#PromptSequencers-1054"><span class="linenos">1054</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Namespace for `_PromptSequencer` subclass hierarchy used by `MazeTokenizerModular`.&quot;&quot;&quot;</span>
</span><span id="PromptSequencers-1055"><a href="#PromptSequencers-1055"><span class="linenos">1055</span></a>
</span><span id="PromptSequencers-1056"><a href="#PromptSequencers-1056"><span class="linenos">1056</span></a>	<span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;prompt_sequencer&quot;</span>
</span><span id="PromptSequencers-1057"><a href="#PromptSequencers-1057"><span class="linenos">1057</span></a>
</span><span id="PromptSequencers-1058"><a href="#PromptSequencers-1058"><span class="linenos">1058</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PromptSequencers-1059"><a href="#PromptSequencers-1059"><span class="linenos">1059</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">_PromptSequencer</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="PromptSequencers-1060"><a href="#PromptSequencers-1060"><span class="linenos">1060</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Sequences token regions into a complete maze tokenization.</span>
</span><span id="PromptSequencers-1061"><a href="#PromptSequencers-1061"><span class="linenos">1061</span></a>
</span><span id="PromptSequencers-1062"><a href="#PromptSequencers-1062"><span class="linenos">1062</span></a><span class="sd">		# Parameters</span>
</span><span id="PromptSequencers-1063"><a href="#PromptSequencers-1063"><span class="linenos">1063</span></a><span class="sd">		- `coord_tokenizer`: Tokenizer element which tokenizes a single `Coord` aka maze position.</span>
</span><span id="PromptSequencers-1064"><a href="#PromptSequencers-1064"><span class="linenos">1064</span></a><span class="sd">		- `adj_list_tokenizer`: Tokenizer element which tokenizes the adjacency list of a `LatticeMaze`.</span>
</span><span id="PromptSequencers-1065"><a href="#PromptSequencers-1065"><span class="linenos">1065</span></a><span class="sd">		Uses `coord_tokenizer` to tokenize coords if needed in other `TokenizerElement`s.</span>
</span><span id="PromptSequencers-1066"><a href="#PromptSequencers-1066"><span class="linenos">1066</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="PromptSequencers-1067"><a href="#PromptSequencers-1067"><span class="linenos">1067</span></a>
</span><span id="PromptSequencers-1068"><a href="#PromptSequencers-1068"><span class="linenos">1068</span></a>		<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="PromptSequencers-1069"><a href="#PromptSequencers-1069"><span class="linenos">1069</span></a>			<span class="n">default</span><span class="o">=</span><span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">UT</span><span class="p">(),</span>
</span><span id="PromptSequencers-1070"><a href="#PromptSequencers-1070"><span class="linenos">1070</span></a>			<span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">CoordTokenizers</span><span class="p">),</span>
</span><span id="PromptSequencers-1071"><a href="#PromptSequencers-1071"><span class="linenos">1071</span></a>		<span class="p">)</span>
</span><span id="PromptSequencers-1072"><a href="#PromptSequencers-1072"><span class="linenos">1072</span></a>		<span class="n">adj_list_tokenizer</span><span class="p">:</span> <span class="n">AdjListTokenizers</span><span class="o">.</span><span class="n">_AdjListTokenizer</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="PromptSequencers-1073"><a href="#PromptSequencers-1073"><span class="linenos">1073</span></a>			<span class="n">default</span><span class="o">=</span><span class="n">AdjListTokenizers</span><span class="o">.</span><span class="n">AdjListCoord</span><span class="p">(),</span>
</span><span id="PromptSequencers-1074"><a href="#PromptSequencers-1074"><span class="linenos">1074</span></a>			<span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">AdjListTokenizers</span><span class="p">),</span>
</span><span id="PromptSequencers-1075"><a href="#PromptSequencers-1075"><span class="linenos">1075</span></a>		<span class="p">)</span>
</span><span id="PromptSequencers-1076"><a href="#PromptSequencers-1076"><span class="linenos">1076</span></a>
</span><span id="PromptSequencers-1077"><a href="#PromptSequencers-1077"><span class="linenos">1077</span></a>		<span class="nd">@classmethod</span>
</span><span id="PromptSequencers-1078"><a href="#PromptSequencers-1078"><span class="linenos">1078</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="PromptSequencers-1079"><a href="#PromptSequencers-1079"><span class="linenos">1079</span></a>			<span class="k">return</span> <span class="n">PromptSequencers</span><span class="o">.</span><span class="n">key</span>
</span><span id="PromptSequencers-1080"><a href="#PromptSequencers-1080"><span class="linenos">1080</span></a>
</span><span id="PromptSequencers-1081"><a href="#PromptSequencers-1081"><span class="linenos">1081</span></a>		<span class="nd">@staticmethod</span>
</span><span id="PromptSequencers-1082"><a href="#PromptSequencers-1082"><span class="linenos">1082</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_trim_if_unsolved_maze</span><span class="p">(</span>
</span><span id="PromptSequencers-1083"><a href="#PromptSequencers-1083"><span class="linenos">1083</span></a>			<span class="n">untrimmed</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers-1084"><a href="#PromptSequencers-1084"><span class="linenos">1084</span></a>			<span class="n">is_untargeted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PromptSequencers-1085"><a href="#PromptSequencers-1085"><span class="linenos">1085</span></a>			<span class="n">is_unsolved</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PromptSequencers-1086"><a href="#PromptSequencers-1086"><span class="linenos">1086</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PromptSequencers-1087"><a href="#PromptSequencers-1087"><span class="linenos">1087</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Trims a full `SolvedMaze` prompt if the maze data reflects an unsolved or untargeted maze.</span>
</span><span id="PromptSequencers-1088"><a href="#PromptSequencers-1088"><span class="linenos">1088</span></a>
</span><span id="PromptSequencers-1089"><a href="#PromptSequencers-1089"><span class="linenos">1089</span></a><span class="sd">			# Development</span>
</span><span id="PromptSequencers-1090"><a href="#PromptSequencers-1090"><span class="linenos">1090</span></a><span class="sd">			This implementation should function for `AOTP`, `AOP`, and other concrete classes using any subsequence of AOTP.</span>
</span><span id="PromptSequencers-1091"><a href="#PromptSequencers-1091"><span class="linenos">1091</span></a><span class="sd">			It is not located in `token_utils.py` because it may need to be overridden in more exotic `PromptSequencer` subclasses.</span>
</span><span id="PromptSequencers-1092"><a href="#PromptSequencers-1092"><span class="linenos">1092</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="PromptSequencers-1093"><a href="#PromptSequencers-1093"><span class="linenos">1093</span></a>			<span class="k">if</span> <span class="n">is_untargeted</span><span class="p">:</span>
</span><span id="PromptSequencers-1094"><a href="#PromptSequencers-1094"><span class="linenos">1094</span></a>				<span class="k">return</span> <span class="n">tokens_between</span><span class="p">(</span>
</span><span id="PromptSequencers-1095"><a href="#PromptSequencers-1095"><span class="linenos">1095</span></a>					<span class="n">untrimmed</span><span class="p">,</span>
</span><span id="PromptSequencers-1096"><a href="#PromptSequencers-1096"><span class="linenos">1096</span></a>					<span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_START</span><span class="p">,</span>
</span><span id="PromptSequencers-1097"><a href="#PromptSequencers-1097"><span class="linenos">1097</span></a>					<span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_END</span><span class="p">,</span>
</span><span id="PromptSequencers-1098"><a href="#PromptSequencers-1098"><span class="linenos">1098</span></a>					<span class="n">include_start</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="PromptSequencers-1099"><a href="#PromptSequencers-1099"><span class="linenos">1099</span></a>					<span class="n">include_end</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="PromptSequencers-1100"><a href="#PromptSequencers-1100"><span class="linenos">1100</span></a>				<span class="p">)</span>
</span><span id="PromptSequencers-1101"><a href="#PromptSequencers-1101"><span class="linenos">1101</span></a>			<span class="k">if</span> <span class="n">is_unsolved</span><span class="p">:</span>
</span><span id="PromptSequencers-1102"><a href="#PromptSequencers-1102"><span class="linenos">1102</span></a>				<span class="k">if</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_END</span> <span class="ow">in</span> <span class="n">untrimmed</span><span class="p">:</span>
</span><span id="PromptSequencers-1103"><a href="#PromptSequencers-1103"><span class="linenos">1103</span></a>					<span class="k">return</span> <span class="n">tokens_between</span><span class="p">(</span>
</span><span id="PromptSequencers-1104"><a href="#PromptSequencers-1104"><span class="linenos">1104</span></a>						<span class="n">untrimmed</span><span class="p">,</span>
</span><span id="PromptSequencers-1105"><a href="#PromptSequencers-1105"><span class="linenos">1105</span></a>						<span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_START</span><span class="p">,</span>
</span><span id="PromptSequencers-1106"><a href="#PromptSequencers-1106"><span class="linenos">1106</span></a>						<span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_END</span><span class="p">,</span>
</span><span id="PromptSequencers-1107"><a href="#PromptSequencers-1107"><span class="linenos">1107</span></a>						<span class="n">include_start</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="PromptSequencers-1108"><a href="#PromptSequencers-1108"><span class="linenos">1108</span></a>						<span class="n">include_end</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="PromptSequencers-1109"><a href="#PromptSequencers-1109"><span class="linenos">1109</span></a>					<span class="p">)</span>
</span><span id="PromptSequencers-1110"><a href="#PromptSequencers-1110"><span class="linenos">1110</span></a>				<span class="k">else</span><span class="p">:</span>
</span><span id="PromptSequencers-1111"><a href="#PromptSequencers-1111"><span class="linenos">1111</span></a>					<span class="k">return</span> <span class="n">tokens_between</span><span class="p">(</span>
</span><span id="PromptSequencers-1112"><a href="#PromptSequencers-1112"><span class="linenos">1112</span></a>						<span class="n">untrimmed</span><span class="p">,</span>
</span><span id="PromptSequencers-1113"><a href="#PromptSequencers-1113"><span class="linenos">1113</span></a>						<span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_START</span><span class="p">,</span>
</span><span id="PromptSequencers-1114"><a href="#PromptSequencers-1114"><span class="linenos">1114</span></a>						<span class="n">VOCAB</span><span class="o">.</span><span class="n">ORIGIN_END</span><span class="p">,</span>
</span><span id="PromptSequencers-1115"><a href="#PromptSequencers-1115"><span class="linenos">1115</span></a>						<span class="n">include_start</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="PromptSequencers-1116"><a href="#PromptSequencers-1116"><span class="linenos">1116</span></a>						<span class="n">include_end</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="PromptSequencers-1117"><a href="#PromptSequencers-1117"><span class="linenos">1117</span></a>					<span class="p">)</span>
</span><span id="PromptSequencers-1118"><a href="#PromptSequencers-1118"><span class="linenos">1118</span></a>			<span class="k">return</span> <span class="n">untrimmed</span>
</span><span id="PromptSequencers-1119"><a href="#PromptSequencers-1119"><span class="linenos">1119</span></a>
</span><span id="PromptSequencers-1120"><a href="#PromptSequencers-1120"><span class="linenos">1120</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="PromptSequencers-1121"><a href="#PromptSequencers-1121"><span class="linenos">1121</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="PromptSequencers-1122"><a href="#PromptSequencers-1122"><span class="linenos">1122</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">,</span>
</span><span id="PromptSequencers-1123"><a href="#PromptSequencers-1123"><span class="linenos">1123</span></a>			<span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="PromptSequencers-1124"><a href="#PromptSequencers-1124"><span class="linenos">1124</span></a>			<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="PromptSequencers-1125"><a href="#PromptSequencers-1125"><span class="linenos">1125</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PromptSequencers-1126"><a href="#PromptSequencers-1126"><span class="linenos">1126</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Returns a complete list of tokens for a given set of maze elements.&quot;&quot;&quot;</span>
</span><span id="PromptSequencers-1127"><a href="#PromptSequencers-1127"><span class="linenos">1127</span></a>			<span class="n">untrimmed</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sequence_tokens</span><span class="p">(</span>
</span><span id="PromptSequencers-1128"><a href="#PromptSequencers-1128"><span class="linenos">1128</span></a>				<span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_prompt_regions</span><span class="p">(</span><span class="n">maze</span><span class="p">),</span>
</span><span id="PromptSequencers-1129"><a href="#PromptSequencers-1129"><span class="linenos">1129</span></a>			<span class="p">)</span>
</span><span id="PromptSequencers-1130"><a href="#PromptSequencers-1130"><span class="linenos">1130</span></a>			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trim_if_unsolved_maze</span><span class="p">(</span>
</span><span id="PromptSequencers-1131"><a href="#PromptSequencers-1131"><span class="linenos">1131</span></a>				<span class="n">untrimmed</span><span class="p">,</span>
</span><span id="PromptSequencers-1132"><a href="#PromptSequencers-1132"><span class="linenos">1132</span></a>				<span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="s2">&quot;start_pos&quot;</span><span class="p">),</span>
</span><span id="PromptSequencers-1133"><a href="#PromptSequencers-1133"><span class="linenos">1133</span></a>				<span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="s2">&quot;solution&quot;</span><span class="p">),</span>
</span><span id="PromptSequencers-1134"><a href="#PromptSequencers-1134"><span class="linenos">1134</span></a>			<span class="p">)</span>
</span><span id="PromptSequencers-1135"><a href="#PromptSequencers-1135"><span class="linenos">1135</span></a>
</span><span id="PromptSequencers-1136"><a href="#PromptSequencers-1136"><span class="linenos">1136</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_get_prompt_regions</span><span class="p">(</span>
</span><span id="PromptSequencers-1137"><a href="#PromptSequencers-1137"><span class="linenos">1137</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="PromptSequencers-1138"><a href="#PromptSequencers-1138"><span class="linenos">1138</span></a>			<span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">,</span>
</span><span id="PromptSequencers-1139"><a href="#PromptSequencers-1139"><span class="linenos">1139</span></a>			<span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="PromptSequencers-1140"><a href="#PromptSequencers-1140"><span class="linenos">1140</span></a>			<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="PromptSequencers-1141"><a href="#PromptSequencers-1141"><span class="linenos">1141</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="PromptSequencers-1142"><a href="#PromptSequencers-1142"><span class="linenos">1142</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Gets the prompt regions of a maze in a fixed sequence.</span>
</span><span id="PromptSequencers-1143"><a href="#PromptSequencers-1143"><span class="linenos">1143</span></a>
</span><span id="PromptSequencers-1144"><a href="#PromptSequencers-1144"><span class="linenos">1144</span></a><span class="sd">			This method is NOT responsible for including/excluding any prompt regions.</span>
</span><span id="PromptSequencers-1145"><a href="#PromptSequencers-1145"><span class="linenos">1145</span></a><span class="sd">			Always return according to the API described under Returns.</span>
</span><span id="PromptSequencers-1146"><a href="#PromptSequencers-1146"><span class="linenos">1146</span></a><span class="sd">			This implementation is expected to be suitable for most `PromptSequencer` subclasses.</span>
</span><span id="PromptSequencers-1147"><a href="#PromptSequencers-1147"><span class="linenos">1147</span></a><span class="sd">			Subclasses may override this method if needed for special behavior.</span>
</span><span id="PromptSequencers-1148"><a href="#PromptSequencers-1148"><span class="linenos">1148</span></a>
</span><span id="PromptSequencers-1149"><a href="#PromptSequencers-1149"><span class="linenos">1149</span></a><span class="sd">			# Returns</span>
</span><span id="PromptSequencers-1150"><a href="#PromptSequencers-1150"><span class="linenos">1150</span></a><span class="sd">			- [0]: list[str] Adjacency list tokens</span>
</span><span id="PromptSequencers-1151"><a href="#PromptSequencers-1151"><span class="linenos">1151</span></a><span class="sd">			- [1]: list[str] Origin tokens</span>
</span><span id="PromptSequencers-1152"><a href="#PromptSequencers-1152"><span class="linenos">1152</span></a><span class="sd">			- [2]: list[str] Target tokens</span>
</span><span id="PromptSequencers-1153"><a href="#PromptSequencers-1153"><span class="linenos">1153</span></a><span class="sd">			- [3]: list[str] Path tokens</span>
</span><span id="PromptSequencers-1154"><a href="#PromptSequencers-1154"><span class="linenos">1154</span></a>
</span><span id="PromptSequencers-1155"><a href="#PromptSequencers-1155"><span class="linenos">1155</span></a><span class="sd">			# `None`-valued Args</span>
</span><span id="PromptSequencers-1156"><a href="#PromptSequencers-1156"><span class="linenos">1156</span></a><span class="sd">			If one or more of `origin`, `target`, or `path` are `None`, that indicates that an unsolved or untargeted maze is being tokenized.</span>
</span><span id="PromptSequencers-1157"><a href="#PromptSequencers-1157"><span class="linenos">1157</span></a><span class="sd">			To ensure unpackability in `_sequence_tokens`, these `None` values are substituted for empty iterables.</span>
</span><span id="PromptSequencers-1158"><a href="#PromptSequencers-1158"><span class="linenos">1158</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="PromptSequencers-1159"><a href="#PromptSequencers-1159"><span class="linenos">1159</span></a>			<span class="n">origin</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="s2">&quot;start_pos&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="PromptSequencers-1160"><a href="#PromptSequencers-1160"><span class="linenos">1160</span></a>			<span class="n">target</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Coord</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PromptSequencers-1161"><a href="#PromptSequencers-1161"><span class="linenos">1161</span></a>				<span class="nb">getattr</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="s2">&quot;end_pos&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="PromptSequencers-1162"><a href="#PromptSequencers-1162"><span class="linenos">1162</span></a>			<span class="p">]</span>  <span class="c1"># TargetTokenizer requires target: Sequence[Coord]</span>
</span><span id="PromptSequencers-1163"><a href="#PromptSequencers-1163"><span class="linenos">1163</span></a>
</span><span id="PromptSequencers-1164"><a href="#PromptSequencers-1164"><span class="linenos">1164</span></a>			<span class="k">return</span> <span class="p">[</span>
</span><span id="PromptSequencers-1165"><a href="#PromptSequencers-1165"><span class="linenos">1165</span></a>				<span class="p">(</span>
</span><span id="PromptSequencers-1166"><a href="#PromptSequencers-1166"><span class="linenos">1166</span></a>					<span class="bp">self</span><span class="o">.</span><span class="n">adj_list_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span>
</span><span id="PromptSequencers-1167"><a href="#PromptSequencers-1167"><span class="linenos">1167</span></a>						<span class="n">maze</span><span class="p">,</span>
</span><span id="PromptSequencers-1168"><a href="#PromptSequencers-1168"><span class="linenos">1168</span></a>						<span class="n">coord_tokenizer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">coord_tokenizer</span><span class="p">,</span>
</span><span id="PromptSequencers-1169"><a href="#PromptSequencers-1169"><span class="linenos">1169</span></a>					<span class="p">)</span>
</span><span id="PromptSequencers-1170"><a href="#PromptSequencers-1170"><span class="linenos">1170</span></a>					<span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;adj_list_tokenizer&quot;</span><span class="p">)</span>
</span><span id="PromptSequencers-1171"><a href="#PromptSequencers-1171"><span class="linenos">1171</span></a>					<span class="k">else</span> <span class="p">[]</span>
</span><span id="PromptSequencers-1172"><a href="#PromptSequencers-1172"><span class="linenos">1172</span></a>				<span class="p">),</span>
</span><span id="PromptSequencers-1173"><a href="#PromptSequencers-1173"><span class="linenos">1173</span></a>				<span class="bp">self</span><span class="o">.</span><span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">origin</span><span class="p">)</span> <span class="k">if</span> <span class="n">origin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[],</span>
</span><span id="PromptSequencers-1174"><a href="#PromptSequencers-1174"><span class="linenos">1174</span></a>				<span class="p">(</span>
</span><span id="PromptSequencers-1175"><a href="#PromptSequencers-1175"><span class="linenos">1175</span></a>					<span class="bp">self</span><span class="o">.</span><span class="n">target_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span>
</span><span id="PromptSequencers-1176"><a href="#PromptSequencers-1176"><span class="linenos">1176</span></a>						<span class="n">target</span><span class="p">,</span>
</span><span id="PromptSequencers-1177"><a href="#PromptSequencers-1177"><span class="linenos">1177</span></a>						<span class="n">coord_tokenizer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">coord_tokenizer</span><span class="p">,</span>
</span><span id="PromptSequencers-1178"><a href="#PromptSequencers-1178"><span class="linenos">1178</span></a>					<span class="p">)</span>
</span><span id="PromptSequencers-1179"><a href="#PromptSequencers-1179"><span class="linenos">1179</span></a>					<span class="k">if</span> <span class="n">target</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;target_tokenizer&quot;</span><span class="p">)</span>
</span><span id="PromptSequencers-1180"><a href="#PromptSequencers-1180"><span class="linenos">1180</span></a>					<span class="k">else</span> <span class="p">[]</span>
</span><span id="PromptSequencers-1181"><a href="#PromptSequencers-1181"><span class="linenos">1181</span></a>				<span class="p">),</span>
</span><span id="PromptSequencers-1182"><a href="#PromptSequencers-1182"><span class="linenos">1182</span></a>				<span class="p">(</span>
</span><span id="PromptSequencers-1183"><a href="#PromptSequencers-1183"><span class="linenos">1183</span></a>					<span class="bp">self</span><span class="o">.</span><span class="n">path_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span>
</span><span id="PromptSequencers-1184"><a href="#PromptSequencers-1184"><span class="linenos">1184</span></a>						<span class="n">maze</span><span class="p">,</span>
</span><span id="PromptSequencers-1185"><a href="#PromptSequencers-1185"><span class="linenos">1185</span></a>						<span class="n">coord_tokenizer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">coord_tokenizer</span><span class="p">,</span>
</span><span id="PromptSequencers-1186"><a href="#PromptSequencers-1186"><span class="linenos">1186</span></a>					<span class="p">)</span>
</span><span id="PromptSequencers-1187"><a href="#PromptSequencers-1187"><span class="linenos">1187</span></a>					<span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="s2">&quot;solution&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;path_tokenizer&quot;</span><span class="p">)</span>
</span><span id="PromptSequencers-1188"><a href="#PromptSequencers-1188"><span class="linenos">1188</span></a>					<span class="k">else</span> <span class="p">[]</span>
</span><span id="PromptSequencers-1189"><a href="#PromptSequencers-1189"><span class="linenos">1189</span></a>				<span class="p">),</span>
</span><span id="PromptSequencers-1190"><a href="#PromptSequencers-1190"><span class="linenos">1190</span></a>			<span class="p">]</span>
</span><span id="PromptSequencers-1191"><a href="#PromptSequencers-1191"><span class="linenos">1191</span></a>
</span><span id="PromptSequencers-1192"><a href="#PromptSequencers-1192"><span class="linenos">1192</span></a>		<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="PromptSequencers-1193"><a href="#PromptSequencers-1193"><span class="linenos">1193</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_sequence_tokens</span><span class="p">(</span>
</span><span id="PromptSequencers-1194"><a href="#PromptSequencers-1194"><span class="linenos">1194</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="PromptSequencers-1195"><a href="#PromptSequencers-1195"><span class="linenos">1195</span></a>			<span class="n">adj_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers-1196"><a href="#PromptSequencers-1196"><span class="linenos">1196</span></a>			<span class="n">origin</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PromptSequencers-1197"><a href="#PromptSequencers-1197"><span class="linenos">1197</span></a>			<span class="n">target</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PromptSequencers-1198"><a href="#PromptSequencers-1198"><span class="linenos">1198</span></a>			<span class="n">path</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PromptSequencers-1199"><a href="#PromptSequencers-1199"><span class="linenos">1199</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PromptSequencers-1200"><a href="#PromptSequencers-1200"><span class="linenos">1200</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Sequences token regions into a complete prompt.</span>
</span><span id="PromptSequencers-1201"><a href="#PromptSequencers-1201"><span class="linenos">1201</span></a>
</span><span id="PromptSequencers-1202"><a href="#PromptSequencers-1202"><span class="linenos">1202</span></a><span class="sd">			Includes any boundary tokens in `constants.SPECIAL_TOKENS` such as &lt;ADJLIST_START&gt;, &lt;ORIGIN_END&gt;, etc.</span>
</span><span id="PromptSequencers-1203"><a href="#PromptSequencers-1203"><span class="linenos">1203</span></a>
</span><span id="PromptSequencers-1204"><a href="#PromptSequencers-1204"><span class="linenos">1204</span></a><span class="sd">			# Parameters</span>
</span><span id="PromptSequencers-1205"><a href="#PromptSequencers-1205"><span class="linenos">1205</span></a><span class="sd">			- `adj_list`: Tokens representing the adjacency list</span>
</span><span id="PromptSequencers-1206"><a href="#PromptSequencers-1206"><span class="linenos">1206</span></a><span class="sd">			- `origin`: Tokens representing the origin</span>
</span><span id="PromptSequencers-1207"><a href="#PromptSequencers-1207"><span class="linenos">1207</span></a><span class="sd">			- `target`: Tokens representing the target</span>
</span><span id="PromptSequencers-1208"><a href="#PromptSequencers-1208"><span class="linenos">1208</span></a><span class="sd">			- `path`: Tokens representing the path</span>
</span><span id="PromptSequencers-1209"><a href="#PromptSequencers-1209"><span class="linenos">1209</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="PromptSequencers-1210"><a href="#PromptSequencers-1210"><span class="linenos">1210</span></a>			<span class="k">pass</span>
</span><span id="PromptSequencers-1211"><a href="#PromptSequencers-1211"><span class="linenos">1211</span></a>
</span><span id="PromptSequencers-1212"><a href="#PromptSequencers-1212"><span class="linenos">1212</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="PromptSequencers-1213"><a href="#PromptSequencers-1213"><span class="linenos">1213</span></a>			<span class="c1"># No invalid instances possible within data member type hint bounds</span>
</span><span id="PromptSequencers-1214"><a href="#PromptSequencers-1214"><span class="linenos">1214</span></a>			<span class="k">return</span> <span class="kc">True</span>
</span><span id="PromptSequencers-1215"><a href="#PromptSequencers-1215"><span class="linenos">1215</span></a>
</span><span id="PromptSequencers-1216"><a href="#PromptSequencers-1216"><span class="linenos">1216</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PromptSequencers-1217"><a href="#PromptSequencers-1217"><span class="linenos">1217</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">AOTP</span><span class="p">(</span><span class="n">_PromptSequencer</span><span class="p">):</span>
</span><span id="PromptSequencers-1218"><a href="#PromptSequencers-1218"><span class="linenos">1218</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Sequences a prompt as [adjacency list, origin, target, path].</span>
</span><span id="PromptSequencers-1219"><a href="#PromptSequencers-1219"><span class="linenos">1219</span></a>
</span><span id="PromptSequencers-1220"><a href="#PromptSequencers-1220"><span class="linenos">1220</span></a><span class="sd">		# Parameters</span>
</span><span id="PromptSequencers-1221"><a href="#PromptSequencers-1221"><span class="linenos">1221</span></a><span class="sd">		- `target_tokenizer`: Tokenizer element which tokenizes the target(s) of a `TargetedLatticeMaze`.</span>
</span><span id="PromptSequencers-1222"><a href="#PromptSequencers-1222"><span class="linenos">1222</span></a><span class="sd">		Uses `coord_tokenizer` to tokenize coords if that is part of the design of that `TargetTokenizer`.</span>
</span><span id="PromptSequencers-1223"><a href="#PromptSequencers-1223"><span class="linenos">1223</span></a><span class="sd">		- `path_tokenizer`: Tokenizer element which tokenizes the solution path of a `SolvedMaze`.</span>
</span><span id="PromptSequencers-1224"><a href="#PromptSequencers-1224"><span class="linenos">1224</span></a><span class="sd">		Uses `coord_tokenizer` to tokenize coords if that is part of the design of that `PathTokenizer`.</span>
</span><span id="PromptSequencers-1225"><a href="#PromptSequencers-1225"><span class="linenos">1225</span></a>
</span><span id="PromptSequencers-1226"><a href="#PromptSequencers-1226"><span class="linenos">1226</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="PromptSequencers-1227"><a href="#PromptSequencers-1227"><span class="linenos">1227</span></a>
</span><span id="PromptSequencers-1228"><a href="#PromptSequencers-1228"><span class="linenos">1228</span></a>		<span class="n">target_tokenizer</span><span class="p">:</span> <span class="n">TargetTokenizers</span><span class="o">.</span><span class="n">_TargetTokenizer</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="PromptSequencers-1229"><a href="#PromptSequencers-1229"><span class="linenos">1229</span></a>			<span class="n">default</span><span class="o">=</span><span class="n">TargetTokenizers</span><span class="o">.</span><span class="n">Unlabeled</span><span class="p">(),</span>
</span><span id="PromptSequencers-1230"><a href="#PromptSequencers-1230"><span class="linenos">1230</span></a>			<span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">TargetTokenizers</span><span class="p">),</span>
</span><span id="PromptSequencers-1231"><a href="#PromptSequencers-1231"><span class="linenos">1231</span></a>		<span class="p">)</span>
</span><span id="PromptSequencers-1232"><a href="#PromptSequencers-1232"><span class="linenos">1232</span></a>		<span class="n">path_tokenizer</span><span class="p">:</span> <span class="n">PathTokenizers</span><span class="o">.</span><span class="n">_PathTokenizer</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="PromptSequencers-1233"><a href="#PromptSequencers-1233"><span class="linenos">1233</span></a>			<span class="n">default</span><span class="o">=</span><span class="n">PathTokenizers</span><span class="o">.</span><span class="n">StepSequence</span><span class="p">(),</span>
</span><span id="PromptSequencers-1234"><a href="#PromptSequencers-1234"><span class="linenos">1234</span></a>			<span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">PathTokenizers</span><span class="p">),</span>
</span><span id="PromptSequencers-1235"><a href="#PromptSequencers-1235"><span class="linenos">1235</span></a>		<span class="p">)</span>
</span><span id="PromptSequencers-1236"><a href="#PromptSequencers-1236"><span class="linenos">1236</span></a>
</span><span id="PromptSequencers-1237"><a href="#PromptSequencers-1237"><span class="linenos">1237</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_sequence_tokens</span><span class="p">(</span>
</span><span id="PromptSequencers-1238"><a href="#PromptSequencers-1238"><span class="linenos">1238</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="PromptSequencers-1239"><a href="#PromptSequencers-1239"><span class="linenos">1239</span></a>			<span class="n">adj_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers-1240"><a href="#PromptSequencers-1240"><span class="linenos">1240</span></a>			<span class="n">origin</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers-1241"><a href="#PromptSequencers-1241"><span class="linenos">1241</span></a>			<span class="n">target</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers-1242"><a href="#PromptSequencers-1242"><span class="linenos">1242</span></a>			<span class="n">path</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers-1243"><a href="#PromptSequencers-1243"><span class="linenos">1243</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PromptSequencers-1244"><a href="#PromptSequencers-1244"><span class="linenos">1244</span></a>			<span class="k">return</span> <span class="p">[</span>
</span><span id="PromptSequencers-1245"><a href="#PromptSequencers-1245"><span class="linenos">1245</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_START</span><span class="p">,</span>
</span><span id="PromptSequencers-1246"><a href="#PromptSequencers-1246"><span class="linenos">1246</span></a>				<span class="o">*</span><span class="n">adj_list</span><span class="p">,</span>
</span><span id="PromptSequencers-1247"><a href="#PromptSequencers-1247"><span class="linenos">1247</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_END</span><span class="p">,</span>
</span><span id="PromptSequencers-1248"><a href="#PromptSequencers-1248"><span class="linenos">1248</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">ORIGIN_START</span><span class="p">,</span>
</span><span id="PromptSequencers-1249"><a href="#PromptSequencers-1249"><span class="linenos">1249</span></a>				<span class="o">*</span><span class="n">origin</span><span class="p">,</span>
</span><span id="PromptSequencers-1250"><a href="#PromptSequencers-1250"><span class="linenos">1250</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">ORIGIN_END</span><span class="p">,</span>
</span><span id="PromptSequencers-1251"><a href="#PromptSequencers-1251"><span class="linenos">1251</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_START</span><span class="p">,</span>
</span><span id="PromptSequencers-1252"><a href="#PromptSequencers-1252"><span class="linenos">1252</span></a>				<span class="o">*</span><span class="n">target</span><span class="p">,</span>
</span><span id="PromptSequencers-1253"><a href="#PromptSequencers-1253"><span class="linenos">1253</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_END</span><span class="p">,</span>
</span><span id="PromptSequencers-1254"><a href="#PromptSequencers-1254"><span class="linenos">1254</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_START</span><span class="p">,</span>
</span><span id="PromptSequencers-1255"><a href="#PromptSequencers-1255"><span class="linenos">1255</span></a>				<span class="o">*</span><span class="n">path</span><span class="p">,</span>
</span><span id="PromptSequencers-1256"><a href="#PromptSequencers-1256"><span class="linenos">1256</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_END</span><span class="p">,</span>
</span><span id="PromptSequencers-1257"><a href="#PromptSequencers-1257"><span class="linenos">1257</span></a>			<span class="p">]</span>
</span><span id="PromptSequencers-1258"><a href="#PromptSequencers-1258"><span class="linenos">1258</span></a>
</span><span id="PromptSequencers-1259"><a href="#PromptSequencers-1259"><span class="linenos">1259</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PromptSequencers-1260"><a href="#PromptSequencers-1260"><span class="linenos">1260</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">AOP</span><span class="p">(</span><span class="n">_PromptSequencer</span><span class="p">):</span>
</span><span id="PromptSequencers-1261"><a href="#PromptSequencers-1261"><span class="linenos">1261</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Sequences a prompt as [adjacency list, origin, path].</span>
</span><span id="PromptSequencers-1262"><a href="#PromptSequencers-1262"><span class="linenos">1262</span></a>
</span><span id="PromptSequencers-1263"><a href="#PromptSequencers-1263"><span class="linenos">1263</span></a><span class="sd">		Still includes &quot;&lt;TARGET_START&gt;&quot; and &quot;&lt;TARGET_END&gt;&quot; tokens, but no representation of the target itself.</span>
</span><span id="PromptSequencers-1264"><a href="#PromptSequencers-1264"><span class="linenos">1264</span></a>
</span><span id="PromptSequencers-1265"><a href="#PromptSequencers-1265"><span class="linenos">1265</span></a><span class="sd">		# Parameters</span>
</span><span id="PromptSequencers-1266"><a href="#PromptSequencers-1266"><span class="linenos">1266</span></a><span class="sd">		- `path_tokenizer`: Tokenizer element which tokenizes the solution path of a `SolvedMaze`.</span>
</span><span id="PromptSequencers-1267"><a href="#PromptSequencers-1267"><span class="linenos">1267</span></a><span class="sd">		Uses `coord_tokenizer` to tokenize coords if that is part of the design of that `PathTokenizer`.</span>
</span><span id="PromptSequencers-1268"><a href="#PromptSequencers-1268"><span class="linenos">1268</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="PromptSequencers-1269"><a href="#PromptSequencers-1269"><span class="linenos">1269</span></a>
</span><span id="PromptSequencers-1270"><a href="#PromptSequencers-1270"><span class="linenos">1270</span></a>		<span class="n">path_tokenizer</span><span class="p">:</span> <span class="n">PathTokenizers</span><span class="o">.</span><span class="n">_PathTokenizer</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="PromptSequencers-1271"><a href="#PromptSequencers-1271"><span class="linenos">1271</span></a>			<span class="n">default</span><span class="o">=</span><span class="n">PathTokenizers</span><span class="o">.</span><span class="n">StepSequence</span><span class="p">(),</span>
</span><span id="PromptSequencers-1272"><a href="#PromptSequencers-1272"><span class="linenos">1272</span></a>			<span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">PathTokenizers</span><span class="p">),</span>
</span><span id="PromptSequencers-1273"><a href="#PromptSequencers-1273"><span class="linenos">1273</span></a>		<span class="p">)</span>
</span><span id="PromptSequencers-1274"><a href="#PromptSequencers-1274"><span class="linenos">1274</span></a>
</span><span id="PromptSequencers-1275"><a href="#PromptSequencers-1275"><span class="linenos">1275</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_sequence_tokens</span><span class="p">(</span>
</span><span id="PromptSequencers-1276"><a href="#PromptSequencers-1276"><span class="linenos">1276</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="PromptSequencers-1277"><a href="#PromptSequencers-1277"><span class="linenos">1277</span></a>			<span class="n">adj_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers-1278"><a href="#PromptSequencers-1278"><span class="linenos">1278</span></a>			<span class="n">origin</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers-1279"><a href="#PromptSequencers-1279"><span class="linenos">1279</span></a>			<span class="c1"># explicitly no target in this tokenizer</span>
</span><span id="PromptSequencers-1280"><a href="#PromptSequencers-1280"><span class="linenos">1280</span></a>			<span class="n">target</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers-1281"><a href="#PromptSequencers-1281"><span class="linenos">1281</span></a>			<span class="n">path</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers-1282"><a href="#PromptSequencers-1282"><span class="linenos">1282</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PromptSequencers-1283"><a href="#PromptSequencers-1283"><span class="linenos">1283</span></a>			<span class="k">return</span> <span class="p">[</span>
</span><span id="PromptSequencers-1284"><a href="#PromptSequencers-1284"><span class="linenos">1284</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_START</span><span class="p">,</span>
</span><span id="PromptSequencers-1285"><a href="#PromptSequencers-1285"><span class="linenos">1285</span></a>				<span class="o">*</span><span class="n">adj_list</span><span class="p">,</span>
</span><span id="PromptSequencers-1286"><a href="#PromptSequencers-1286"><span class="linenos">1286</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_END</span><span class="p">,</span>
</span><span id="PromptSequencers-1287"><a href="#PromptSequencers-1287"><span class="linenos">1287</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">ORIGIN_START</span><span class="p">,</span>
</span><span id="PromptSequencers-1288"><a href="#PromptSequencers-1288"><span class="linenos">1288</span></a>				<span class="o">*</span><span class="n">origin</span><span class="p">,</span>
</span><span id="PromptSequencers-1289"><a href="#PromptSequencers-1289"><span class="linenos">1289</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">ORIGIN_END</span><span class="p">,</span>
</span><span id="PromptSequencers-1290"><a href="#PromptSequencers-1290"><span class="linenos">1290</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_START</span><span class="p">,</span>
</span><span id="PromptSequencers-1291"><a href="#PromptSequencers-1291"><span class="linenos">1291</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_END</span><span class="p">,</span>
</span><span id="PromptSequencers-1292"><a href="#PromptSequencers-1292"><span class="linenos">1292</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_START</span><span class="p">,</span>
</span><span id="PromptSequencers-1293"><a href="#PromptSequencers-1293"><span class="linenos">1293</span></a>				<span class="o">*</span><span class="n">path</span><span class="p">,</span>
</span><span id="PromptSequencers-1294"><a href="#PromptSequencers-1294"><span class="linenos">1294</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_END</span><span class="p">,</span>
</span><span id="PromptSequencers-1295"><a href="#PromptSequencers-1295"><span class="linenos">1295</span></a>			<span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Namespace for <code>_PromptSequencer</code> subclass hierarchy used by <code>MazeTokenizerModular</code>.</p>
</div>


                            <div id="PromptSequencers.key" class="classattr">
                                <div class="attr variable">
            <span class="name">key</span>        =
<span class="default_value">&#39;prompt_sequencer&#39;</span>

        
    </div>
    <a class="headerlink" href="#PromptSequencers.key"></a>
    
    

                            </div>
                </section>
                <section id="PromptSequencers.AOTP">
                            <input id="PromptSequencers.AOTP-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">PromptSequencers.AOTP</span><wbr>(<span class="base"><a href="#PromptSequencers._PromptSequencer">PromptSequencers._PromptSequencer</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="PromptSequencers.AOTP-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L1215-L1256" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#PromptSequencers.AOTP"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PromptSequencers.AOTP-1216"><a href="#PromptSequencers.AOTP-1216"><span class="linenos">1216</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PromptSequencers.AOTP-1217"><a href="#PromptSequencers.AOTP-1217"><span class="linenos">1217</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">AOTP</span><span class="p">(</span><span class="n">_PromptSequencer</span><span class="p">):</span>
</span><span id="PromptSequencers.AOTP-1218"><a href="#PromptSequencers.AOTP-1218"><span class="linenos">1218</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Sequences a prompt as [adjacency list, origin, target, path].</span>
</span><span id="PromptSequencers.AOTP-1219"><a href="#PromptSequencers.AOTP-1219"><span class="linenos">1219</span></a>
</span><span id="PromptSequencers.AOTP-1220"><a href="#PromptSequencers.AOTP-1220"><span class="linenos">1220</span></a><span class="sd">		# Parameters</span>
</span><span id="PromptSequencers.AOTP-1221"><a href="#PromptSequencers.AOTP-1221"><span class="linenos">1221</span></a><span class="sd">		- `target_tokenizer`: Tokenizer element which tokenizes the target(s) of a `TargetedLatticeMaze`.</span>
</span><span id="PromptSequencers.AOTP-1222"><a href="#PromptSequencers.AOTP-1222"><span class="linenos">1222</span></a><span class="sd">		Uses `coord_tokenizer` to tokenize coords if that is part of the design of that `TargetTokenizer`.</span>
</span><span id="PromptSequencers.AOTP-1223"><a href="#PromptSequencers.AOTP-1223"><span class="linenos">1223</span></a><span class="sd">		- `path_tokenizer`: Tokenizer element which tokenizes the solution path of a `SolvedMaze`.</span>
</span><span id="PromptSequencers.AOTP-1224"><a href="#PromptSequencers.AOTP-1224"><span class="linenos">1224</span></a><span class="sd">		Uses `coord_tokenizer` to tokenize coords if that is part of the design of that `PathTokenizer`.</span>
</span><span id="PromptSequencers.AOTP-1225"><a href="#PromptSequencers.AOTP-1225"><span class="linenos">1225</span></a>
</span><span id="PromptSequencers.AOTP-1226"><a href="#PromptSequencers.AOTP-1226"><span class="linenos">1226</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="PromptSequencers.AOTP-1227"><a href="#PromptSequencers.AOTP-1227"><span class="linenos">1227</span></a>
</span><span id="PromptSequencers.AOTP-1228"><a href="#PromptSequencers.AOTP-1228"><span class="linenos">1228</span></a>		<span class="n">target_tokenizer</span><span class="p">:</span> <span class="n">TargetTokenizers</span><span class="o">.</span><span class="n">_TargetTokenizer</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="PromptSequencers.AOTP-1229"><a href="#PromptSequencers.AOTP-1229"><span class="linenos">1229</span></a>			<span class="n">default</span><span class="o">=</span><span class="n">TargetTokenizers</span><span class="o">.</span><span class="n">Unlabeled</span><span class="p">(),</span>
</span><span id="PromptSequencers.AOTP-1230"><a href="#PromptSequencers.AOTP-1230"><span class="linenos">1230</span></a>			<span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">TargetTokenizers</span><span class="p">),</span>
</span><span id="PromptSequencers.AOTP-1231"><a href="#PromptSequencers.AOTP-1231"><span class="linenos">1231</span></a>		<span class="p">)</span>
</span><span id="PromptSequencers.AOTP-1232"><a href="#PromptSequencers.AOTP-1232"><span class="linenos">1232</span></a>		<span class="n">path_tokenizer</span><span class="p">:</span> <span class="n">PathTokenizers</span><span class="o">.</span><span class="n">_PathTokenizer</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="PromptSequencers.AOTP-1233"><a href="#PromptSequencers.AOTP-1233"><span class="linenos">1233</span></a>			<span class="n">default</span><span class="o">=</span><span class="n">PathTokenizers</span><span class="o">.</span><span class="n">StepSequence</span><span class="p">(),</span>
</span><span id="PromptSequencers.AOTP-1234"><a href="#PromptSequencers.AOTP-1234"><span class="linenos">1234</span></a>			<span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">PathTokenizers</span><span class="p">),</span>
</span><span id="PromptSequencers.AOTP-1235"><a href="#PromptSequencers.AOTP-1235"><span class="linenos">1235</span></a>		<span class="p">)</span>
</span><span id="PromptSequencers.AOTP-1236"><a href="#PromptSequencers.AOTP-1236"><span class="linenos">1236</span></a>
</span><span id="PromptSequencers.AOTP-1237"><a href="#PromptSequencers.AOTP-1237"><span class="linenos">1237</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_sequence_tokens</span><span class="p">(</span>
</span><span id="PromptSequencers.AOTP-1238"><a href="#PromptSequencers.AOTP-1238"><span class="linenos">1238</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP-1239"><a href="#PromptSequencers.AOTP-1239"><span class="linenos">1239</span></a>			<span class="n">adj_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers.AOTP-1240"><a href="#PromptSequencers.AOTP-1240"><span class="linenos">1240</span></a>			<span class="n">origin</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers.AOTP-1241"><a href="#PromptSequencers.AOTP-1241"><span class="linenos">1241</span></a>			<span class="n">target</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers.AOTP-1242"><a href="#PromptSequencers.AOTP-1242"><span class="linenos">1242</span></a>			<span class="n">path</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers.AOTP-1243"><a href="#PromptSequencers.AOTP-1243"><span class="linenos">1243</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PromptSequencers.AOTP-1244"><a href="#PromptSequencers.AOTP-1244"><span class="linenos">1244</span></a>			<span class="k">return</span> <span class="p">[</span>
</span><span id="PromptSequencers.AOTP-1245"><a href="#PromptSequencers.AOTP-1245"><span class="linenos">1245</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_START</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP-1246"><a href="#PromptSequencers.AOTP-1246"><span class="linenos">1246</span></a>				<span class="o">*</span><span class="n">adj_list</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP-1247"><a href="#PromptSequencers.AOTP-1247"><span class="linenos">1247</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_END</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP-1248"><a href="#PromptSequencers.AOTP-1248"><span class="linenos">1248</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">ORIGIN_START</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP-1249"><a href="#PromptSequencers.AOTP-1249"><span class="linenos">1249</span></a>				<span class="o">*</span><span class="n">origin</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP-1250"><a href="#PromptSequencers.AOTP-1250"><span class="linenos">1250</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">ORIGIN_END</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP-1251"><a href="#PromptSequencers.AOTP-1251"><span class="linenos">1251</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_START</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP-1252"><a href="#PromptSequencers.AOTP-1252"><span class="linenos">1252</span></a>				<span class="o">*</span><span class="n">target</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP-1253"><a href="#PromptSequencers.AOTP-1253"><span class="linenos">1253</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_END</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP-1254"><a href="#PromptSequencers.AOTP-1254"><span class="linenos">1254</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_START</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP-1255"><a href="#PromptSequencers.AOTP-1255"><span class="linenos">1255</span></a>				<span class="o">*</span><span class="n">path</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP-1256"><a href="#PromptSequencers.AOTP-1256"><span class="linenos">1256</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_END</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP-1257"><a href="#PromptSequencers.AOTP-1257"><span class="linenos">1257</span></a>			<span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Sequences a prompt as [adjacency list, origin, target, path].</p>

<h1 id="parameters">Parameters</h1>

<ul>
<li><code><a href="#PromptSequencers.AOTP.target_tokenizer">target_tokenizer</a></code>: Tokenizer element which tokenizes the target(s) of a <code>TargetedLatticeMaze</code>.
Uses <code><a href="#PromptSequencers.AOTP.coord_tokenizer">coord_tokenizer</a></code> to tokenize coords if that is part of the design of that <code>TargetTokenizer</code>.</li>
<li><code><a href="#PromptSequencers.AOTP.path_tokenizer">path_tokenizer</a></code>: Tokenizer element which tokenizes the solution path of a <code>SolvedMaze</code>.
Uses <code><a href="#PromptSequencers.AOTP.coord_tokenizer">coord_tokenizer</a></code> to tokenize coords if that is part of the design of that <code>PathTokenizer</code>.</li>
</ul>
</div>


                            <div id="PromptSequencers.AOTP.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">PromptSequencers.AOTP</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span> <span class="o">=</span> <span class="n"><a href="#CoordTokenizers.UT">CoordTokenizers.UT</a></span><span class="p">()</span>,</span><span class="param">	<span class="n">adj_list_tokenizer</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">AdjListTokenizers</span><span class="o">.</span><span class="n">_AdjListTokenizer</span> <span class="o">=</span> <span class="n"><a href="#AdjListTokenizers.AdjListCoord">AdjListTokenizers.AdjListCoord</a></span><span class="p">(</span><span class="n">pre</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">post</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shuffle_d0</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">edge_grouping</span><span class="o">=</span><span class="n"><a href="#EdgeGroupings.Ungrouped">EdgeGroupings.Ungrouped</a></span><span class="p">(</span><span class="n">connection_token_ordinal</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">edge_subset</span><span class="o">=</span><span class="n"><a href="#EdgeSubsets.ConnectionEdges">EdgeSubsets.ConnectionEdges</a></span><span class="p">(</span><span class="n">walls</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">edge_permuter</span><span class="o">=</span><span class="n"><a href="#EdgePermuters.RandomCoords">EdgePermuters.RandomCoords</a></span><span class="p">())</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#PromptSequencers.AOTP">PromptSequencers.AOTP</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#PromptSequencers.AOTP">PromptSequencers.AOTP</a>&#39;&gt;&quot;</span>,</span><span class="param">	<span class="n">target_tokenizer</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">TargetTokenizers</span><span class="o">.</span><span class="n">_TargetTokenizer</span> <span class="o">=</span> <span class="n"><a href="#TargetTokenizers.Unlabeled">TargetTokenizers.Unlabeled</a></span><span class="p">(</span><span class="n">post</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>,</span><span class="param">	<span class="n">path_tokenizer</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">PathTokenizers</span><span class="o">.</span><span class="n">_PathTokenizer</span> <span class="o">=</span> <span class="n"><a href="#PathTokenizers.StepSequence">PathTokenizers.StepSequence</a></span><span class="p">(</span><span class="n">step_size</span><span class="o">=</span><span class="n"><a href="#StepSizes.Singles">StepSizes.Singles</a></span><span class="p">(),</span> <span class="n">step_tokenizers</span><span class="o">=</span><span class="p">(</span><span class="n"><a href="#StepTokenizers.Coord">StepTokenizers.Coord</a></span><span class="p">(),),</span> <span class="n">pre</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">intra</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">post</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#PromptSequencers.AOTP.__init__"></a>
    
    

                            </div>
                            <div id="PromptSequencers.AOTP.target_tokenizer" class="classattr">
                                <div class="attr variable">
            <span class="name">target_tokenizer</span><span class="annotation">: maze_dataset.tokenization.modular.elements.TargetTokenizers._TargetTokenizer</span>        =
<span class="default_value"><a href="#TargetTokenizers.Unlabeled">TargetTokenizers.Unlabeled</a>(post=False)</span>

        
    </div>
    <a class="headerlink" href="#PromptSequencers.AOTP.target_tokenizer"></a>
    
    

                            </div>
                            <div id="PromptSequencers.AOTP.path_tokenizer" class="classattr">
                                <div class="attr variable">
            <span class="name">path_tokenizer</span><span class="annotation">: maze_dataset.tokenization.modular.elements.PathTokenizers._PathTokenizer</span>        =
<input id="PromptSequencers.AOTP.path_tokenizer-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="PromptSequencers.AOTP.path_tokenizer-view-value"></label><span class="default_value"><a href="#PathTokenizers.StepSequence">PathTokenizers.StepSequence</a>(step_size=StepSizes.Singles(), step_tokenizers=(<a href="#StepTokenizers.Coord">StepTokenizers.Coord()</a>,), pre=False, intra=False, post=False)</span>

        
    </div>
    <a class="headerlink" href="#PromptSequencers.AOTP.path_tokenizer"></a>
    
    

                            </div>
                            <div id="PromptSequencers.AOTP.serialize" class="classattr">
                                        <input id="PromptSequencers.AOTP.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="PromptSequencers.AOTP.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L713-L769" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#PromptSequencers.AOTP.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PromptSequencers.AOTP.serialize-714"><a href="#PromptSequencers.AOTP.serialize-714"><span class="linenos">714</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="PromptSequencers.AOTP.serialize-715"><a href="#PromptSequencers.AOTP.serialize-715"><span class="linenos">715</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PromptSequencers.AOTP.serialize-716"><a href="#PromptSequencers.AOTP.serialize-716"><span class="linenos">716</span></a>                <span class="n">_FORMAT_KEY</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="PromptSequencers.AOTP.serialize-717"><a href="#PromptSequencers.AOTP.serialize-717"><span class="linenos">717</span></a>            <span class="p">}</span>
</span><span id="PromptSequencers.AOTP.serialize-718"><a href="#PromptSequencers.AOTP.serialize-718"><span class="linenos">718</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="PromptSequencers.AOTP.serialize-719"><a href="#PromptSequencers.AOTP.serialize-719"><span class="linenos">719</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="PromptSequencers.AOTP.serialize-720"><a href="#PromptSequencers.AOTP.serialize-720"><span class="linenos">720</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="PromptSequencers.AOTP.serialize-721"><a href="#PromptSequencers.AOTP.serialize-721"><span class="linenos">721</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="PromptSequencers.AOTP.serialize-722"><a href="#PromptSequencers.AOTP.serialize-722"><span class="linenos">722</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="PromptSequencers.AOTP.serialize-723"><a href="#PromptSequencers.AOTP.serialize-723"><span class="linenos">723</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="PromptSequencers.AOTP.serialize-724"><a href="#PromptSequencers.AOTP.serialize-724"><span class="linenos">724</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="PromptSequencers.AOTP.serialize-725"><a href="#PromptSequencers.AOTP.serialize-725"><span class="linenos">725</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="PromptSequencers.AOTP.serialize-726"><a href="#PromptSequencers.AOTP.serialize-726"><span class="linenos">726</span></a>                    <span class="p">)</span>
</span><span id="PromptSequencers.AOTP.serialize-727"><a href="#PromptSequencers.AOTP.serialize-727"><span class="linenos">727</span></a>
</span><span id="PromptSequencers.AOTP.serialize-728"><a href="#PromptSequencers.AOTP.serialize-728"><span class="linenos">728</span></a>                <span class="c1"># try to save it</span>
</span><span id="PromptSequencers.AOTP.serialize-729"><a href="#PromptSequencers.AOTP.serialize-729"><span class="linenos">729</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="PromptSequencers.AOTP.serialize-730"><a href="#PromptSequencers.AOTP.serialize-730"><span class="linenos">730</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="PromptSequencers.AOTP.serialize-731"><a href="#PromptSequencers.AOTP.serialize-731"><span class="linenos">731</span></a>                        <span class="c1"># get the val</span>
</span><span id="PromptSequencers.AOTP.serialize-732"><a href="#PromptSequencers.AOTP.serialize-732"><span class="linenos">732</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="PromptSequencers.AOTP.serialize-733"><a href="#PromptSequencers.AOTP.serialize-733"><span class="linenos">733</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="PromptSequencers.AOTP.serialize-734"><a href="#PromptSequencers.AOTP.serialize-734"><span class="linenos">734</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="PromptSequencers.AOTP.serialize-735"><a href="#PromptSequencers.AOTP.serialize-735"><span class="linenos">735</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="PromptSequencers.AOTP.serialize-736"><a href="#PromptSequencers.AOTP.serialize-736"><span class="linenos">736</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="PromptSequencers.AOTP.serialize-737"><a href="#PromptSequencers.AOTP.serialize-737"><span class="linenos">737</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="PromptSequencers.AOTP.serialize-738"><a href="#PromptSequencers.AOTP.serialize-738"><span class="linenos">738</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="PromptSequencers.AOTP.serialize-739"><a href="#PromptSequencers.AOTP.serialize-739"><span class="linenos">739</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="PromptSequencers.AOTP.serialize-740"><a href="#PromptSequencers.AOTP.serialize-740"><span class="linenos">740</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="PromptSequencers.AOTP.serialize-741"><a href="#PromptSequencers.AOTP.serialize-741"><span class="linenos">741</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="PromptSequencers.AOTP.serialize-742"><a href="#PromptSequencers.AOTP.serialize-742"><span class="linenos">742</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="PromptSequencers.AOTP.serialize-743"><a href="#PromptSequencers.AOTP.serialize-743"><span class="linenos">743</span></a>
</span><span id="PromptSequencers.AOTP.serialize-744"><a href="#PromptSequencers.AOTP.serialize-744"><span class="linenos">744</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="PromptSequencers.AOTP.serialize-745"><a href="#PromptSequencers.AOTP.serialize-745"><span class="linenos">745</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="PromptSequencers.AOTP.serialize-746"><a href="#PromptSequencers.AOTP.serialize-746"><span class="linenos">746</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PromptSequencers.AOTP.serialize-747"><a href="#PromptSequencers.AOTP.serialize-747"><span class="linenos">747</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="PromptSequencers.AOTP.serialize-748"><a href="#PromptSequencers.AOTP.serialize-748"><span class="linenos">748</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="PromptSequencers.AOTP.serialize-749"><a href="#PromptSequencers.AOTP.serialize-749"><span class="linenos">749</span></a>                                <span class="p">[</span>
</span><span id="PromptSequencers.AOTP.serialize-750"><a href="#PromptSequencers.AOTP.serialize-750"><span class="linenos">750</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP.serialize-751"><a href="#PromptSequencers.AOTP.serialize-751"><span class="linenos">751</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP.serialize-752"><a href="#PromptSequencers.AOTP.serialize-752"><span class="linenos">752</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP.serialize-753"><a href="#PromptSequencers.AOTP.serialize-753"><span class="linenos">753</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP.serialize-754"><a href="#PromptSequencers.AOTP.serialize-754"><span class="linenos">754</span></a>                                <span class="p">]</span>
</span><span id="PromptSequencers.AOTP.serialize-755"><a href="#PromptSequencers.AOTP.serialize-755"><span class="linenos">755</span></a>                            <span class="p">)</span>
</span><span id="PromptSequencers.AOTP.serialize-756"><a href="#PromptSequencers.AOTP.serialize-756"><span class="linenos">756</span></a>                        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</span><span id="PromptSequencers.AOTP.serialize-757"><a href="#PromptSequencers.AOTP.serialize-757"><span class="linenos">757</span></a>
</span><span id="PromptSequencers.AOTP.serialize-758"><a href="#PromptSequencers.AOTP.serialize-758"><span class="linenos">758</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="PromptSequencers.AOTP.serialize-759"><a href="#PromptSequencers.AOTP.serialize-759"><span class="linenos">759</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="PromptSequencers.AOTP.serialize-760"><a href="#PromptSequencers.AOTP.serialize-760"><span class="linenos">760</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="PromptSequencers.AOTP.serialize-761"><a href="#PromptSequencers.AOTP.serialize-761"><span class="linenos">761</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="PromptSequencers.AOTP.serialize-762"><a href="#PromptSequencers.AOTP.serialize-762"><span class="linenos">762</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="PromptSequencers.AOTP.serialize-763"><a href="#PromptSequencers.AOTP.serialize-763"><span class="linenos">763</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="PromptSequencers.AOTP.serialize-764"><a href="#PromptSequencers.AOTP.serialize-764"><span class="linenos">764</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="PromptSequencers.AOTP.serialize-765"><a href="#PromptSequencers.AOTP.serialize-765"><span class="linenos">765</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="PromptSequencers.AOTP.serialize-766"><a href="#PromptSequencers.AOTP.serialize-766"><span class="linenos">766</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="PromptSequencers.AOTP.serialize-767"><a href="#PromptSequencers.AOTP.serialize-767"><span class="linenos">767</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="PromptSequencers.AOTP.serialize-768"><a href="#PromptSequencers.AOTP.serialize-768"><span class="linenos">768</span></a>                    <span class="p">)</span>
</span><span id="PromptSequencers.AOTP.serialize-769"><a href="#PromptSequencers.AOTP.serialize-769"><span class="linenos">769</span></a>
</span><span id="PromptSequencers.AOTP.serialize-770"><a href="#PromptSequencers.AOTP.serialize-770"><span class="linenos">770</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="PromptSequencers.AOTP.load" class="classattr">
                                        <input id="PromptSequencers.AOTP.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="PromptSequencers.AOTP.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L776-L862" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#PromptSequencers.AOTP.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PromptSequencers.AOTP.load-777"><a href="#PromptSequencers.AOTP.load-777"><span class="linenos">777</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="PromptSequencers.AOTP.load-778"><a href="#PromptSequencers.AOTP.load-778"><span class="linenos">778</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="PromptSequencers.AOTP.load-779"><a href="#PromptSequencers.AOTP.load-779"><span class="linenos">779</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="PromptSequencers.AOTP.load-780"><a href="#PromptSequencers.AOTP.load-780"><span class="linenos">780</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="PromptSequencers.AOTP.load-781"><a href="#PromptSequencers.AOTP.load-781"><span class="linenos">781</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="PromptSequencers.AOTP.load-782"><a href="#PromptSequencers.AOTP.load-782"><span class="linenos">782</span></a>
</span><span id="PromptSequencers.AOTP.load-783"><a href="#PromptSequencers.AOTP.load-783"><span class="linenos">783</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="PromptSequencers.AOTP.load-784"><a href="#PromptSequencers.AOTP.load-784"><span class="linenos">784</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="PromptSequencers.AOTP.load-785"><a href="#PromptSequencers.AOTP.load-785"><span class="linenos">785</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="PromptSequencers.AOTP.load-786"><a href="#PromptSequencers.AOTP.load-786"><span class="linenos">786</span></a>
</span><span id="PromptSequencers.AOTP.load-787"><a href="#PromptSequencers.AOTP.load-787"><span class="linenos">787</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="PromptSequencers.AOTP.load-788"><a href="#PromptSequencers.AOTP.load-788"><span class="linenos">788</span></a>
</span><span id="PromptSequencers.AOTP.load-789"><a href="#PromptSequencers.AOTP.load-789"><span class="linenos">789</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="PromptSequencers.AOTP.load-790"><a href="#PromptSequencers.AOTP.load-790"><span class="linenos">790</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="PromptSequencers.AOTP.load-791"><a href="#PromptSequencers.AOTP.load-791"><span class="linenos">791</span></a>
</span><span id="PromptSequencers.AOTP.load-792"><a href="#PromptSequencers.AOTP.load-792"><span class="linenos">792</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="PromptSequencers.AOTP.load-793"><a href="#PromptSequencers.AOTP.load-793"><span class="linenos">793</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="PromptSequencers.AOTP.load-794"><a href="#PromptSequencers.AOTP.load-794"><span class="linenos">794</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="PromptSequencers.AOTP.load-795"><a href="#PromptSequencers.AOTP.load-795"><span class="linenos">795</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="PromptSequencers.AOTP.load-796"><a href="#PromptSequencers.AOTP.load-796"><span class="linenos">796</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="PromptSequencers.AOTP.load-797"><a href="#PromptSequencers.AOTP.load-797"><span class="linenos">797</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="PromptSequencers.AOTP.load-798"><a href="#PromptSequencers.AOTP.load-798"><span class="linenos">798</span></a>
</span><span id="PromptSequencers.AOTP.load-799"><a href="#PromptSequencers.AOTP.load-799"><span class="linenos">799</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="PromptSequencers.AOTP.load-800"><a href="#PromptSequencers.AOTP.load-800"><span class="linenos">800</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="PromptSequencers.AOTP.load-801"><a href="#PromptSequencers.AOTP.load-801"><span class="linenos">801</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="PromptSequencers.AOTP.load-802"><a href="#PromptSequencers.AOTP.load-802"><span class="linenos">802</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="PromptSequencers.AOTP.load-803"><a href="#PromptSequencers.AOTP.load-803"><span class="linenos">803</span></a>
</span><span id="PromptSequencers.AOTP.load-804"><a href="#PromptSequencers.AOTP.load-804"><span class="linenos">804</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="PromptSequencers.AOTP.load-805"><a href="#PromptSequencers.AOTP.load-805"><span class="linenos">805</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="PromptSequencers.AOTP.load-806"><a href="#PromptSequencers.AOTP.load-806"><span class="linenos">806</span></a>
</span><span id="PromptSequencers.AOTP.load-807"><a href="#PromptSequencers.AOTP.load-807"><span class="linenos">807</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="PromptSequencers.AOTP.load-808"><a href="#PromptSequencers.AOTP.load-808"><span class="linenos">808</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="PromptSequencers.AOTP.load-809"><a href="#PromptSequencers.AOTP.load-809"><span class="linenos">809</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="PromptSequencers.AOTP.load-810"><a href="#PromptSequencers.AOTP.load-810"><span class="linenos">810</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="PromptSequencers.AOTP.load-811"><a href="#PromptSequencers.AOTP.load-811"><span class="linenos">811</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="PromptSequencers.AOTP.load-812"><a href="#PromptSequencers.AOTP.load-812"><span class="linenos">812</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="PromptSequencers.AOTP.load-813"><a href="#PromptSequencers.AOTP.load-813"><span class="linenos">813</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="PromptSequencers.AOTP.load-814"><a href="#PromptSequencers.AOTP.load-814"><span class="linenos">814</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="PromptSequencers.AOTP.load-815"><a href="#PromptSequencers.AOTP.load-815"><span class="linenos">815</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="PromptSequencers.AOTP.load-816"><a href="#PromptSequencers.AOTP.load-816"><span class="linenos">816</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="PromptSequencers.AOTP.load-817"><a href="#PromptSequencers.AOTP.load-817"><span class="linenos">817</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="PromptSequencers.AOTP.load-818"><a href="#PromptSequencers.AOTP.load-818"><span class="linenos">818</span></a>                    <span class="p">):</span>
</span><span id="PromptSequencers.AOTP.load-819"><a href="#PromptSequencers.AOTP.load-819"><span class="linenos">819</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="PromptSequencers.AOTP.load-820"><a href="#PromptSequencers.AOTP.load-820"><span class="linenos">820</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="PromptSequencers.AOTP.load-821"><a href="#PromptSequencers.AOTP.load-821"><span class="linenos">821</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="PromptSequencers.AOTP.load-822"><a href="#PromptSequencers.AOTP.load-822"><span class="linenos">822</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="PromptSequencers.AOTP.load-823"><a href="#PromptSequencers.AOTP.load-823"><span class="linenos">823</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="PromptSequencers.AOTP.load-824"><a href="#PromptSequencers.AOTP.load-824"><span class="linenos">824</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="PromptSequencers.AOTP.load-825"><a href="#PromptSequencers.AOTP.load-825"><span class="linenos">825</span></a>                            <span class="p">)</span>
</span><span id="PromptSequencers.AOTP.load-826"><a href="#PromptSequencers.AOTP.load-826"><span class="linenos">826</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="PromptSequencers.AOTP.load-827"><a href="#PromptSequencers.AOTP.load-827"><span class="linenos">827</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="PromptSequencers.AOTP.load-828"><a href="#PromptSequencers.AOTP.load-828"><span class="linenos">828</span></a>                        <span class="k">pass</span>
</span><span id="PromptSequencers.AOTP.load-829"><a href="#PromptSequencers.AOTP.load-829"><span class="linenos">829</span></a>
</span><span id="PromptSequencers.AOTP.load-830"><a href="#PromptSequencers.AOTP.load-830"><span class="linenos">830</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="PromptSequencers.AOTP.load-831"><a href="#PromptSequencers.AOTP.load-831"><span class="linenos">831</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="PromptSequencers.AOTP.load-832"><a href="#PromptSequencers.AOTP.load-832"><span class="linenos">832</span></a>
</span><span id="PromptSequencers.AOTP.load-833"><a href="#PromptSequencers.AOTP.load-833"><span class="linenos">833</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="PromptSequencers.AOTP.load-834"><a href="#PromptSequencers.AOTP.load-834"><span class="linenos">834</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="PromptSequencers.AOTP.load-835"><a href="#PromptSequencers.AOTP.load-835"><span class="linenos">835</span></a>
</span><span id="PromptSequencers.AOTP.load-836"><a href="#PromptSequencers.AOTP.load-836"><span class="linenos">836</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="PromptSequencers.AOTP.load-837"><a href="#PromptSequencers.AOTP.load-837"><span class="linenos">837</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="PromptSequencers.AOTP.load-838"><a href="#PromptSequencers.AOTP.load-838"><span class="linenos">838</span></a>                <span class="n">fields_valid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PromptSequencers.AOTP.load-839"><a href="#PromptSequencers.AOTP.load-839"><span class="linenos">839</span></a>                    <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="PromptSequencers.AOTP.load-840"><a href="#PromptSequencers.AOTP.load-840"><span class="linenos">840</span></a>                        <span class="n">output</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP.load-841"><a href="#PromptSequencers.AOTP.load-841"><span class="linenos">841</span></a>                        <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP.load-842"><a href="#PromptSequencers.AOTP.load-842"><span class="linenos">842</span></a>                    <span class="p">)</span>
</span><span id="PromptSequencers.AOTP.load-843"><a href="#PromptSequencers.AOTP.load-843"><span class="linenos">843</span></a>                <span class="p">)</span>
</span><span id="PromptSequencers.AOTP.load-844"><a href="#PromptSequencers.AOTP.load-844"><span class="linenos">844</span></a>
</span><span id="PromptSequencers.AOTP.load-845"><a href="#PromptSequencers.AOTP.load-845"><span class="linenos">845</span></a>                <span class="c1"># if there are any fields that are not valid, raise an error</span>
</span><span id="PromptSequencers.AOTP.load-846"><a href="#PromptSequencers.AOTP.load-846"><span class="linenos">846</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">fields_valid</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="PromptSequencers.AOTP.load-847"><a href="#PromptSequencers.AOTP.load-847"><span class="linenos">847</span></a>                    <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PromptSequencers.AOTP.load-848"><a href="#PromptSequencers.AOTP.load-848"><span class="linenos">848</span></a>                        <span class="sa">f</span><span class="s2">&quot;Type mismatch in fields of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="PromptSequencers.AOTP.load-849"><a href="#PromptSequencers.AOTP.load-849"><span class="linenos">849</span></a>                        <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="PromptSequencers.AOTP.load-850"><a href="#PromptSequencers.AOTP.load-850"><span class="linenos">850</span></a>                            <span class="p">[</span>
</span><span id="PromptSequencers.AOTP.load-851"><a href="#PromptSequencers.AOTP.load-851"><span class="linenos">851</span></a>                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">:</span><span class="se">\t</span><span class="s2">expected </span><span class="si">{</span><span class="n">cls_type_hints</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="si">= }</span><span class="s2">, but got value </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="PromptSequencers.AOTP.load-852"><a href="#PromptSequencers.AOTP.load-852"><span class="linenos">852</span></a>                                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">fields_valid</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="PromptSequencers.AOTP.load-853"><a href="#PromptSequencers.AOTP.load-853"><span class="linenos">853</span></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span>
</span><span id="PromptSequencers.AOTP.load-854"><a href="#PromptSequencers.AOTP.load-854"><span class="linenos">854</span></a>                            <span class="p">]</span>
</span><span id="PromptSequencers.AOTP.load-855"><a href="#PromptSequencers.AOTP.load-855"><span class="linenos">855</span></a>                        <span class="p">)</span>
</span><span id="PromptSequencers.AOTP.load-856"><a href="#PromptSequencers.AOTP.load-856"><span class="linenos">856</span></a>                    <span class="p">)</span>
</span><span id="PromptSequencers.AOTP.load-857"><a href="#PromptSequencers.AOTP.load-857"><span class="linenos">857</span></a>
</span><span id="PromptSequencers.AOTP.load-858"><a href="#PromptSequencers.AOTP.load-858"><span class="linenos">858</span></a>                    <span class="n">on_typecheck_mismatch</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
</span><span id="PromptSequencers.AOTP.load-859"><a href="#PromptSequencers.AOTP.load-859"><span class="linenos">859</span></a>                        <span class="n">msg</span><span class="p">,</span> <span class="n">except_cls</span><span class="o">=</span><span class="n">FieldTypeMismatchError</span>
</span><span id="PromptSequencers.AOTP.load-860"><a href="#PromptSequencers.AOTP.load-860"><span class="linenos">860</span></a>                    <span class="p">)</span>
</span><span id="PromptSequencers.AOTP.load-861"><a href="#PromptSequencers.AOTP.load-861"><span class="linenos">861</span></a>
</span><span id="PromptSequencers.AOTP.load-862"><a href="#PromptSequencers.AOTP.load-862"><span class="linenos">862</span></a>            <span class="c1"># return the new instance</span>
</span><span id="PromptSequencers.AOTP.load-863"><a href="#PromptSequencers.AOTP.load-863"><span class="linenos">863</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="PromptSequencers.AOTP.validate_fields_types" class="classattr">
                                        <input id="PromptSequencers.AOTP.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="PromptSequencers.AOTP.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L282-L291" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#PromptSequencers.AOTP.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PromptSequencers.AOTP.validate_fields_types-283"><a href="#PromptSequencers.AOTP.validate_fields_types-283"><span class="linenos">283</span></a><span class="k">def</span><span class="w"> </span><span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="PromptSequencers.AOTP.validate_fields_types-284"><a href="#PromptSequencers.AOTP.validate_fields_types-284"><span class="linenos">284</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP.validate_fields_types-285"><a href="#PromptSequencers.AOTP.validate_fields_types-285"><span class="linenos">285</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP.validate_fields_types-286"><a href="#PromptSequencers.AOTP.validate_fields_types-286"><span class="linenos">286</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="PromptSequencers.AOTP.validate_fields_types-287"><a href="#PromptSequencers.AOTP.validate_fields_types-287"><span class="linenos">287</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="PromptSequencers.AOTP.validate_fields_types-288"><a href="#PromptSequencers.AOTP.validate_fields_types-288"><span class="linenos">288</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="PromptSequencers.AOTP.validate_fields_types-289"><a href="#PromptSequencers.AOTP.validate_fields_types-289"><span class="linenos">289</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="PromptSequencers.AOTP.validate_fields_types-290"><a href="#PromptSequencers.AOTP.validate_fields_types-290"><span class="linenos">290</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="PromptSequencers.AOTP.validate_fields_types-291"><a href="#PromptSequencers.AOTP.validate_fields_types-291"><span class="linenos">291</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="PromptSequencers.AOTP.validate_fields_types-292"><a href="#PromptSequencers.AOTP.validate_fields_types-292"><span class="linenos">292</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#PromptSequencers._PromptSequencer">PromptSequencers._PromptSequencer</a></dt>
                                <dd id="PromptSequencers.AOTP.coord_tokenizer" class="variable"><a href="#PromptSequencers._PromptSequencer.coord_tokenizer">coord_tokenizer</a></dd>
                <dd id="PromptSequencers.AOTP.adj_list_tokenizer" class="variable"><a href="#PromptSequencers._PromptSequencer.adj_list_tokenizer">adj_list_tokenizer</a></dd>
                <dd id="PromptSequencers.AOTP.attribute_key" class="function"><a href="#PromptSequencers._PromptSequencer.attribute_key">attribute_key</a></dd>
                <dd id="PromptSequencers.AOTP.to_tokens" class="function"><a href="#PromptSequencers._PromptSequencer.to_tokens">to_tokens</a></dd>
                <dd id="PromptSequencers.AOTP.is_valid" class="function"><a href="#PromptSequencers._PromptSequencer.is_valid">is_valid</a></dd>

            </div>
            <div><dt><a href="element_base.html#_TokenizerElement">maze_dataset.tokenization.modular.element_base._TokenizerElement</a></dt>
                                <dd id="PromptSequencers.AOTP.name" class="variable"><a href="element_base.html#_TokenizerElement.name">name</a></dd>
                <dd id="PromptSequencers.AOTP.tokenizer_elements" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="PromptSequencers.AOTP.tokenizer_element_tree" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="PromptSequencers.AOTP.tokenizer_element_dict" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="PromptSequencers.AOTP.validate_field_type" class="function">validate_field_type</dd>
                <dd id="PromptSequencers.AOTP.diff" class="function">diff</dd>
                <dd id="PromptSequencers.AOTP.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="PromptSequencers.AOP">
                            <input id="PromptSequencers.AOP-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">PromptSequencers.AOP</span><wbr>(<span class="base"><a href="#PromptSequencers._PromptSequencer">PromptSequencers._PromptSequencer</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="PromptSequencers.AOP-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L1258-L1294" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#PromptSequencers.AOP"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PromptSequencers.AOP-1259"><a href="#PromptSequencers.AOP-1259"><span class="linenos">1259</span></a>	<span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PromptSequencers.AOP-1260"><a href="#PromptSequencers.AOP-1260"><span class="linenos">1260</span></a>	<span class="k">class</span><span class="w"> </span><span class="nc">AOP</span><span class="p">(</span><span class="n">_PromptSequencer</span><span class="p">):</span>
</span><span id="PromptSequencers.AOP-1261"><a href="#PromptSequencers.AOP-1261"><span class="linenos">1261</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Sequences a prompt as [adjacency list, origin, path].</span>
</span><span id="PromptSequencers.AOP-1262"><a href="#PromptSequencers.AOP-1262"><span class="linenos">1262</span></a>
</span><span id="PromptSequencers.AOP-1263"><a href="#PromptSequencers.AOP-1263"><span class="linenos">1263</span></a><span class="sd">		Still includes &quot;&lt;TARGET_START&gt;&quot; and &quot;&lt;TARGET_END&gt;&quot; tokens, but no representation of the target itself.</span>
</span><span id="PromptSequencers.AOP-1264"><a href="#PromptSequencers.AOP-1264"><span class="linenos">1264</span></a>
</span><span id="PromptSequencers.AOP-1265"><a href="#PromptSequencers.AOP-1265"><span class="linenos">1265</span></a><span class="sd">		# Parameters</span>
</span><span id="PromptSequencers.AOP-1266"><a href="#PromptSequencers.AOP-1266"><span class="linenos">1266</span></a><span class="sd">		- `path_tokenizer`: Tokenizer element which tokenizes the solution path of a `SolvedMaze`.</span>
</span><span id="PromptSequencers.AOP-1267"><a href="#PromptSequencers.AOP-1267"><span class="linenos">1267</span></a><span class="sd">		Uses `coord_tokenizer` to tokenize coords if that is part of the design of that `PathTokenizer`.</span>
</span><span id="PromptSequencers.AOP-1268"><a href="#PromptSequencers.AOP-1268"><span class="linenos">1268</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="PromptSequencers.AOP-1269"><a href="#PromptSequencers.AOP-1269"><span class="linenos">1269</span></a>
</span><span id="PromptSequencers.AOP-1270"><a href="#PromptSequencers.AOP-1270"><span class="linenos">1270</span></a>		<span class="n">path_tokenizer</span><span class="p">:</span> <span class="n">PathTokenizers</span><span class="o">.</span><span class="n">_PathTokenizer</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="PromptSequencers.AOP-1271"><a href="#PromptSequencers.AOP-1271"><span class="linenos">1271</span></a>			<span class="n">default</span><span class="o">=</span><span class="n">PathTokenizers</span><span class="o">.</span><span class="n">StepSequence</span><span class="p">(),</span>
</span><span id="PromptSequencers.AOP-1272"><a href="#PromptSequencers.AOP-1272"><span class="linenos">1272</span></a>			<span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">PathTokenizers</span><span class="p">),</span>
</span><span id="PromptSequencers.AOP-1273"><a href="#PromptSequencers.AOP-1273"><span class="linenos">1273</span></a>		<span class="p">)</span>
</span><span id="PromptSequencers.AOP-1274"><a href="#PromptSequencers.AOP-1274"><span class="linenos">1274</span></a>
</span><span id="PromptSequencers.AOP-1275"><a href="#PromptSequencers.AOP-1275"><span class="linenos">1275</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">_sequence_tokens</span><span class="p">(</span>
</span><span id="PromptSequencers.AOP-1276"><a href="#PromptSequencers.AOP-1276"><span class="linenos">1276</span></a>			<span class="bp">self</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP-1277"><a href="#PromptSequencers.AOP-1277"><span class="linenos">1277</span></a>			<span class="n">adj_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers.AOP-1278"><a href="#PromptSequencers.AOP-1278"><span class="linenos">1278</span></a>			<span class="n">origin</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers.AOP-1279"><a href="#PromptSequencers.AOP-1279"><span class="linenos">1279</span></a>			<span class="c1"># explicitly no target in this tokenizer</span>
</span><span id="PromptSequencers.AOP-1280"><a href="#PromptSequencers.AOP-1280"><span class="linenos">1280</span></a>			<span class="n">target</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers.AOP-1281"><a href="#PromptSequencers.AOP-1281"><span class="linenos">1281</span></a>			<span class="n">path</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers.AOP-1282"><a href="#PromptSequencers.AOP-1282"><span class="linenos">1282</span></a>		<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PromptSequencers.AOP-1283"><a href="#PromptSequencers.AOP-1283"><span class="linenos">1283</span></a>			<span class="k">return</span> <span class="p">[</span>
</span><span id="PromptSequencers.AOP-1284"><a href="#PromptSequencers.AOP-1284"><span class="linenos">1284</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_START</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP-1285"><a href="#PromptSequencers.AOP-1285"><span class="linenos">1285</span></a>				<span class="o">*</span><span class="n">adj_list</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP-1286"><a href="#PromptSequencers.AOP-1286"><span class="linenos">1286</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_END</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP-1287"><a href="#PromptSequencers.AOP-1287"><span class="linenos">1287</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">ORIGIN_START</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP-1288"><a href="#PromptSequencers.AOP-1288"><span class="linenos">1288</span></a>				<span class="o">*</span><span class="n">origin</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP-1289"><a href="#PromptSequencers.AOP-1289"><span class="linenos">1289</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">ORIGIN_END</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP-1290"><a href="#PromptSequencers.AOP-1290"><span class="linenos">1290</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_START</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP-1291"><a href="#PromptSequencers.AOP-1291"><span class="linenos">1291</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_END</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP-1292"><a href="#PromptSequencers.AOP-1292"><span class="linenos">1292</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_START</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP-1293"><a href="#PromptSequencers.AOP-1293"><span class="linenos">1293</span></a>				<span class="o">*</span><span class="n">path</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP-1294"><a href="#PromptSequencers.AOP-1294"><span class="linenos">1294</span></a>				<span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_END</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP-1295"><a href="#PromptSequencers.AOP-1295"><span class="linenos">1295</span></a>			<span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Sequences a prompt as [adjacency list, origin, path].</p>

<p>Still includes "<TARGET_START>" and "<TARGET_END>" tokens, but no representation of the target itself.</p>

<h1 id="parameters">Parameters</h1>

<ul>
<li><code><a href="#PromptSequencers.AOP.path_tokenizer">path_tokenizer</a></code>: Tokenizer element which tokenizes the solution path of a <code>SolvedMaze</code>.
Uses <code><a href="#PromptSequencers.AOP.coord_tokenizer">coord_tokenizer</a></code> to tokenize coords if that is part of the design of that <code>PathTokenizer</code>.</li>
</ul>
</div>


                            <div id="PromptSequencers.AOP.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">PromptSequencers.AOP</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span> <span class="o">=</span> <span class="n"><a href="#CoordTokenizers.UT">CoordTokenizers.UT</a></span><span class="p">()</span>,</span><span class="param">	<span class="n">adj_list_tokenizer</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">AdjListTokenizers</span><span class="o">.</span><span class="n">_AdjListTokenizer</span> <span class="o">=</span> <span class="n"><a href="#AdjListTokenizers.AdjListCoord">AdjListTokenizers.AdjListCoord</a></span><span class="p">(</span><span class="n">pre</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">post</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shuffle_d0</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">edge_grouping</span><span class="o">=</span><span class="n"><a href="#EdgeGroupings.Ungrouped">EdgeGroupings.Ungrouped</a></span><span class="p">(</span><span class="n">connection_token_ordinal</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">edge_subset</span><span class="o">=</span><span class="n"><a href="#EdgeSubsets.ConnectionEdges">EdgeSubsets.ConnectionEdges</a></span><span class="p">(</span><span class="n">walls</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">edge_permuter</span><span class="o">=</span><span class="n"><a href="#EdgePermuters.RandomCoords">EdgePermuters.RandomCoords</a></span><span class="p">())</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#PromptSequencers.AOP">PromptSequencers.AOP</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#PromptSequencers.AOP">PromptSequencers.AOP</a>&#39;&gt;&quot;</span>,</span><span class="param">	<span class="n">path_tokenizer</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">PathTokenizers</span><span class="o">.</span><span class="n">_PathTokenizer</span> <span class="o">=</span> <span class="n"><a href="#PathTokenizers.StepSequence">PathTokenizers.StepSequence</a></span><span class="p">(</span><span class="n">step_size</span><span class="o">=</span><span class="n"><a href="#StepSizes.Singles">StepSizes.Singles</a></span><span class="p">(),</span> <span class="n">step_tokenizers</span><span class="o">=</span><span class="p">(</span><span class="n"><a href="#StepTokenizers.Coord">StepTokenizers.Coord</a></span><span class="p">(),),</span> <span class="n">pre</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">intra</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">post</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#PromptSequencers.AOP.__init__"></a>
    
    

                            </div>
                            <div id="PromptSequencers.AOP.path_tokenizer" class="classattr">
                                <div class="attr variable">
            <span class="name">path_tokenizer</span><span class="annotation">: maze_dataset.tokenization.modular.elements.PathTokenizers._PathTokenizer</span>        =
<input id="PromptSequencers.AOP.path_tokenizer-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="PromptSequencers.AOP.path_tokenizer-view-value"></label><span class="default_value"><a href="#PathTokenizers.StepSequence">PathTokenizers.StepSequence</a>(step_size=StepSizes.Singles(), step_tokenizers=(<a href="#StepTokenizers.Coord">StepTokenizers.Coord()</a>,), pre=False, intra=False, post=False)</span>

        
    </div>
    <a class="headerlink" href="#PromptSequencers.AOP.path_tokenizer"></a>
    
    

                            </div>
                            <div id="PromptSequencers.AOP.serialize" class="classattr">
                                        <input id="PromptSequencers.AOP.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="PromptSequencers.AOP.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L713-L769" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#PromptSequencers.AOP.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PromptSequencers.AOP.serialize-714"><a href="#PromptSequencers.AOP.serialize-714"><span class="linenos">714</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="PromptSequencers.AOP.serialize-715"><a href="#PromptSequencers.AOP.serialize-715"><span class="linenos">715</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PromptSequencers.AOP.serialize-716"><a href="#PromptSequencers.AOP.serialize-716"><span class="linenos">716</span></a>                <span class="n">_FORMAT_KEY</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="PromptSequencers.AOP.serialize-717"><a href="#PromptSequencers.AOP.serialize-717"><span class="linenos">717</span></a>            <span class="p">}</span>
</span><span id="PromptSequencers.AOP.serialize-718"><a href="#PromptSequencers.AOP.serialize-718"><span class="linenos">718</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="PromptSequencers.AOP.serialize-719"><a href="#PromptSequencers.AOP.serialize-719"><span class="linenos">719</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="PromptSequencers.AOP.serialize-720"><a href="#PromptSequencers.AOP.serialize-720"><span class="linenos">720</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="PromptSequencers.AOP.serialize-721"><a href="#PromptSequencers.AOP.serialize-721"><span class="linenos">721</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="PromptSequencers.AOP.serialize-722"><a href="#PromptSequencers.AOP.serialize-722"><span class="linenos">722</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="PromptSequencers.AOP.serialize-723"><a href="#PromptSequencers.AOP.serialize-723"><span class="linenos">723</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="PromptSequencers.AOP.serialize-724"><a href="#PromptSequencers.AOP.serialize-724"><span class="linenos">724</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="PromptSequencers.AOP.serialize-725"><a href="#PromptSequencers.AOP.serialize-725"><span class="linenos">725</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="PromptSequencers.AOP.serialize-726"><a href="#PromptSequencers.AOP.serialize-726"><span class="linenos">726</span></a>                    <span class="p">)</span>
</span><span id="PromptSequencers.AOP.serialize-727"><a href="#PromptSequencers.AOP.serialize-727"><span class="linenos">727</span></a>
</span><span id="PromptSequencers.AOP.serialize-728"><a href="#PromptSequencers.AOP.serialize-728"><span class="linenos">728</span></a>                <span class="c1"># try to save it</span>
</span><span id="PromptSequencers.AOP.serialize-729"><a href="#PromptSequencers.AOP.serialize-729"><span class="linenos">729</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="PromptSequencers.AOP.serialize-730"><a href="#PromptSequencers.AOP.serialize-730"><span class="linenos">730</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="PromptSequencers.AOP.serialize-731"><a href="#PromptSequencers.AOP.serialize-731"><span class="linenos">731</span></a>                        <span class="c1"># get the val</span>
</span><span id="PromptSequencers.AOP.serialize-732"><a href="#PromptSequencers.AOP.serialize-732"><span class="linenos">732</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="PromptSequencers.AOP.serialize-733"><a href="#PromptSequencers.AOP.serialize-733"><span class="linenos">733</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="PromptSequencers.AOP.serialize-734"><a href="#PromptSequencers.AOP.serialize-734"><span class="linenos">734</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="PromptSequencers.AOP.serialize-735"><a href="#PromptSequencers.AOP.serialize-735"><span class="linenos">735</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="PromptSequencers.AOP.serialize-736"><a href="#PromptSequencers.AOP.serialize-736"><span class="linenos">736</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="PromptSequencers.AOP.serialize-737"><a href="#PromptSequencers.AOP.serialize-737"><span class="linenos">737</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="PromptSequencers.AOP.serialize-738"><a href="#PromptSequencers.AOP.serialize-738"><span class="linenos">738</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="PromptSequencers.AOP.serialize-739"><a href="#PromptSequencers.AOP.serialize-739"><span class="linenos">739</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="PromptSequencers.AOP.serialize-740"><a href="#PromptSequencers.AOP.serialize-740"><span class="linenos">740</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="PromptSequencers.AOP.serialize-741"><a href="#PromptSequencers.AOP.serialize-741"><span class="linenos">741</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="PromptSequencers.AOP.serialize-742"><a href="#PromptSequencers.AOP.serialize-742"><span class="linenos">742</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="PromptSequencers.AOP.serialize-743"><a href="#PromptSequencers.AOP.serialize-743"><span class="linenos">743</span></a>
</span><span id="PromptSequencers.AOP.serialize-744"><a href="#PromptSequencers.AOP.serialize-744"><span class="linenos">744</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="PromptSequencers.AOP.serialize-745"><a href="#PromptSequencers.AOP.serialize-745"><span class="linenos">745</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="PromptSequencers.AOP.serialize-746"><a href="#PromptSequencers.AOP.serialize-746"><span class="linenos">746</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PromptSequencers.AOP.serialize-747"><a href="#PromptSequencers.AOP.serialize-747"><span class="linenos">747</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="PromptSequencers.AOP.serialize-748"><a href="#PromptSequencers.AOP.serialize-748"><span class="linenos">748</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="PromptSequencers.AOP.serialize-749"><a href="#PromptSequencers.AOP.serialize-749"><span class="linenos">749</span></a>                                <span class="p">[</span>
</span><span id="PromptSequencers.AOP.serialize-750"><a href="#PromptSequencers.AOP.serialize-750"><span class="linenos">750</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP.serialize-751"><a href="#PromptSequencers.AOP.serialize-751"><span class="linenos">751</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP.serialize-752"><a href="#PromptSequencers.AOP.serialize-752"><span class="linenos">752</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP.serialize-753"><a href="#PromptSequencers.AOP.serialize-753"><span class="linenos">753</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP.serialize-754"><a href="#PromptSequencers.AOP.serialize-754"><span class="linenos">754</span></a>                                <span class="p">]</span>
</span><span id="PromptSequencers.AOP.serialize-755"><a href="#PromptSequencers.AOP.serialize-755"><span class="linenos">755</span></a>                            <span class="p">)</span>
</span><span id="PromptSequencers.AOP.serialize-756"><a href="#PromptSequencers.AOP.serialize-756"><span class="linenos">756</span></a>                        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</span><span id="PromptSequencers.AOP.serialize-757"><a href="#PromptSequencers.AOP.serialize-757"><span class="linenos">757</span></a>
</span><span id="PromptSequencers.AOP.serialize-758"><a href="#PromptSequencers.AOP.serialize-758"><span class="linenos">758</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="PromptSequencers.AOP.serialize-759"><a href="#PromptSequencers.AOP.serialize-759"><span class="linenos">759</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="PromptSequencers.AOP.serialize-760"><a href="#PromptSequencers.AOP.serialize-760"><span class="linenos">760</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="PromptSequencers.AOP.serialize-761"><a href="#PromptSequencers.AOP.serialize-761"><span class="linenos">761</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="PromptSequencers.AOP.serialize-762"><a href="#PromptSequencers.AOP.serialize-762"><span class="linenos">762</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="PromptSequencers.AOP.serialize-763"><a href="#PromptSequencers.AOP.serialize-763"><span class="linenos">763</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="PromptSequencers.AOP.serialize-764"><a href="#PromptSequencers.AOP.serialize-764"><span class="linenos">764</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="PromptSequencers.AOP.serialize-765"><a href="#PromptSequencers.AOP.serialize-765"><span class="linenos">765</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="PromptSequencers.AOP.serialize-766"><a href="#PromptSequencers.AOP.serialize-766"><span class="linenos">766</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="PromptSequencers.AOP.serialize-767"><a href="#PromptSequencers.AOP.serialize-767"><span class="linenos">767</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="PromptSequencers.AOP.serialize-768"><a href="#PromptSequencers.AOP.serialize-768"><span class="linenos">768</span></a>                    <span class="p">)</span>
</span><span id="PromptSequencers.AOP.serialize-769"><a href="#PromptSequencers.AOP.serialize-769"><span class="linenos">769</span></a>
</span><span id="PromptSequencers.AOP.serialize-770"><a href="#PromptSequencers.AOP.serialize-770"><span class="linenos">770</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="PromptSequencers.AOP.load" class="classattr">
                                        <input id="PromptSequencers.AOP.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="PromptSequencers.AOP.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L776-L862" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#PromptSequencers.AOP.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PromptSequencers.AOP.load-777"><a href="#PromptSequencers.AOP.load-777"><span class="linenos">777</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="PromptSequencers.AOP.load-778"><a href="#PromptSequencers.AOP.load-778"><span class="linenos">778</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="PromptSequencers.AOP.load-779"><a href="#PromptSequencers.AOP.load-779"><span class="linenos">779</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="PromptSequencers.AOP.load-780"><a href="#PromptSequencers.AOP.load-780"><span class="linenos">780</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="PromptSequencers.AOP.load-781"><a href="#PromptSequencers.AOP.load-781"><span class="linenos">781</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="PromptSequencers.AOP.load-782"><a href="#PromptSequencers.AOP.load-782"><span class="linenos">782</span></a>
</span><span id="PromptSequencers.AOP.load-783"><a href="#PromptSequencers.AOP.load-783"><span class="linenos">783</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="PromptSequencers.AOP.load-784"><a href="#PromptSequencers.AOP.load-784"><span class="linenos">784</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="PromptSequencers.AOP.load-785"><a href="#PromptSequencers.AOP.load-785"><span class="linenos">785</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="PromptSequencers.AOP.load-786"><a href="#PromptSequencers.AOP.load-786"><span class="linenos">786</span></a>
</span><span id="PromptSequencers.AOP.load-787"><a href="#PromptSequencers.AOP.load-787"><span class="linenos">787</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="PromptSequencers.AOP.load-788"><a href="#PromptSequencers.AOP.load-788"><span class="linenos">788</span></a>
</span><span id="PromptSequencers.AOP.load-789"><a href="#PromptSequencers.AOP.load-789"><span class="linenos">789</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="PromptSequencers.AOP.load-790"><a href="#PromptSequencers.AOP.load-790"><span class="linenos">790</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="PromptSequencers.AOP.load-791"><a href="#PromptSequencers.AOP.load-791"><span class="linenos">791</span></a>
</span><span id="PromptSequencers.AOP.load-792"><a href="#PromptSequencers.AOP.load-792"><span class="linenos">792</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="PromptSequencers.AOP.load-793"><a href="#PromptSequencers.AOP.load-793"><span class="linenos">793</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="PromptSequencers.AOP.load-794"><a href="#PromptSequencers.AOP.load-794"><span class="linenos">794</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="PromptSequencers.AOP.load-795"><a href="#PromptSequencers.AOP.load-795"><span class="linenos">795</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="PromptSequencers.AOP.load-796"><a href="#PromptSequencers.AOP.load-796"><span class="linenos">796</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="PromptSequencers.AOP.load-797"><a href="#PromptSequencers.AOP.load-797"><span class="linenos">797</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="PromptSequencers.AOP.load-798"><a href="#PromptSequencers.AOP.load-798"><span class="linenos">798</span></a>
</span><span id="PromptSequencers.AOP.load-799"><a href="#PromptSequencers.AOP.load-799"><span class="linenos">799</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="PromptSequencers.AOP.load-800"><a href="#PromptSequencers.AOP.load-800"><span class="linenos">800</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="PromptSequencers.AOP.load-801"><a href="#PromptSequencers.AOP.load-801"><span class="linenos">801</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="PromptSequencers.AOP.load-802"><a href="#PromptSequencers.AOP.load-802"><span class="linenos">802</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="PromptSequencers.AOP.load-803"><a href="#PromptSequencers.AOP.load-803"><span class="linenos">803</span></a>
</span><span id="PromptSequencers.AOP.load-804"><a href="#PromptSequencers.AOP.load-804"><span class="linenos">804</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="PromptSequencers.AOP.load-805"><a href="#PromptSequencers.AOP.load-805"><span class="linenos">805</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="PromptSequencers.AOP.load-806"><a href="#PromptSequencers.AOP.load-806"><span class="linenos">806</span></a>
</span><span id="PromptSequencers.AOP.load-807"><a href="#PromptSequencers.AOP.load-807"><span class="linenos">807</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="PromptSequencers.AOP.load-808"><a href="#PromptSequencers.AOP.load-808"><span class="linenos">808</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="PromptSequencers.AOP.load-809"><a href="#PromptSequencers.AOP.load-809"><span class="linenos">809</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="PromptSequencers.AOP.load-810"><a href="#PromptSequencers.AOP.load-810"><span class="linenos">810</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="PromptSequencers.AOP.load-811"><a href="#PromptSequencers.AOP.load-811"><span class="linenos">811</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="PromptSequencers.AOP.load-812"><a href="#PromptSequencers.AOP.load-812"><span class="linenos">812</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="PromptSequencers.AOP.load-813"><a href="#PromptSequencers.AOP.load-813"><span class="linenos">813</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="PromptSequencers.AOP.load-814"><a href="#PromptSequencers.AOP.load-814"><span class="linenos">814</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="PromptSequencers.AOP.load-815"><a href="#PromptSequencers.AOP.load-815"><span class="linenos">815</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="PromptSequencers.AOP.load-816"><a href="#PromptSequencers.AOP.load-816"><span class="linenos">816</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="PromptSequencers.AOP.load-817"><a href="#PromptSequencers.AOP.load-817"><span class="linenos">817</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="PromptSequencers.AOP.load-818"><a href="#PromptSequencers.AOP.load-818"><span class="linenos">818</span></a>                    <span class="p">):</span>
</span><span id="PromptSequencers.AOP.load-819"><a href="#PromptSequencers.AOP.load-819"><span class="linenos">819</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="PromptSequencers.AOP.load-820"><a href="#PromptSequencers.AOP.load-820"><span class="linenos">820</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="PromptSequencers.AOP.load-821"><a href="#PromptSequencers.AOP.load-821"><span class="linenos">821</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="PromptSequencers.AOP.load-822"><a href="#PromptSequencers.AOP.load-822"><span class="linenos">822</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="PromptSequencers.AOP.load-823"><a href="#PromptSequencers.AOP.load-823"><span class="linenos">823</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="PromptSequencers.AOP.load-824"><a href="#PromptSequencers.AOP.load-824"><span class="linenos">824</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="PromptSequencers.AOP.load-825"><a href="#PromptSequencers.AOP.load-825"><span class="linenos">825</span></a>                            <span class="p">)</span>
</span><span id="PromptSequencers.AOP.load-826"><a href="#PromptSequencers.AOP.load-826"><span class="linenos">826</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="PromptSequencers.AOP.load-827"><a href="#PromptSequencers.AOP.load-827"><span class="linenos">827</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="PromptSequencers.AOP.load-828"><a href="#PromptSequencers.AOP.load-828"><span class="linenos">828</span></a>                        <span class="k">pass</span>
</span><span id="PromptSequencers.AOP.load-829"><a href="#PromptSequencers.AOP.load-829"><span class="linenos">829</span></a>
</span><span id="PromptSequencers.AOP.load-830"><a href="#PromptSequencers.AOP.load-830"><span class="linenos">830</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="PromptSequencers.AOP.load-831"><a href="#PromptSequencers.AOP.load-831"><span class="linenos">831</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="PromptSequencers.AOP.load-832"><a href="#PromptSequencers.AOP.load-832"><span class="linenos">832</span></a>
</span><span id="PromptSequencers.AOP.load-833"><a href="#PromptSequencers.AOP.load-833"><span class="linenos">833</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="PromptSequencers.AOP.load-834"><a href="#PromptSequencers.AOP.load-834"><span class="linenos">834</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="PromptSequencers.AOP.load-835"><a href="#PromptSequencers.AOP.load-835"><span class="linenos">835</span></a>
</span><span id="PromptSequencers.AOP.load-836"><a href="#PromptSequencers.AOP.load-836"><span class="linenos">836</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="PromptSequencers.AOP.load-837"><a href="#PromptSequencers.AOP.load-837"><span class="linenos">837</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="PromptSequencers.AOP.load-838"><a href="#PromptSequencers.AOP.load-838"><span class="linenos">838</span></a>                <span class="n">fields_valid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PromptSequencers.AOP.load-839"><a href="#PromptSequencers.AOP.load-839"><span class="linenos">839</span></a>                    <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="PromptSequencers.AOP.load-840"><a href="#PromptSequencers.AOP.load-840"><span class="linenos">840</span></a>                        <span class="n">output</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP.load-841"><a href="#PromptSequencers.AOP.load-841"><span class="linenos">841</span></a>                        <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP.load-842"><a href="#PromptSequencers.AOP.load-842"><span class="linenos">842</span></a>                    <span class="p">)</span>
</span><span id="PromptSequencers.AOP.load-843"><a href="#PromptSequencers.AOP.load-843"><span class="linenos">843</span></a>                <span class="p">)</span>
</span><span id="PromptSequencers.AOP.load-844"><a href="#PromptSequencers.AOP.load-844"><span class="linenos">844</span></a>
</span><span id="PromptSequencers.AOP.load-845"><a href="#PromptSequencers.AOP.load-845"><span class="linenos">845</span></a>                <span class="c1"># if there are any fields that are not valid, raise an error</span>
</span><span id="PromptSequencers.AOP.load-846"><a href="#PromptSequencers.AOP.load-846"><span class="linenos">846</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">fields_valid</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="PromptSequencers.AOP.load-847"><a href="#PromptSequencers.AOP.load-847"><span class="linenos">847</span></a>                    <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PromptSequencers.AOP.load-848"><a href="#PromptSequencers.AOP.load-848"><span class="linenos">848</span></a>                        <span class="sa">f</span><span class="s2">&quot;Type mismatch in fields of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="PromptSequencers.AOP.load-849"><a href="#PromptSequencers.AOP.load-849"><span class="linenos">849</span></a>                        <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="PromptSequencers.AOP.load-850"><a href="#PromptSequencers.AOP.load-850"><span class="linenos">850</span></a>                            <span class="p">[</span>
</span><span id="PromptSequencers.AOP.load-851"><a href="#PromptSequencers.AOP.load-851"><span class="linenos">851</span></a>                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">:</span><span class="se">\t</span><span class="s2">expected </span><span class="si">{</span><span class="n">cls_type_hints</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="si">= }</span><span class="s2">, but got value </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="PromptSequencers.AOP.load-852"><a href="#PromptSequencers.AOP.load-852"><span class="linenos">852</span></a>                                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">fields_valid</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="PromptSequencers.AOP.load-853"><a href="#PromptSequencers.AOP.load-853"><span class="linenos">853</span></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span>
</span><span id="PromptSequencers.AOP.load-854"><a href="#PromptSequencers.AOP.load-854"><span class="linenos">854</span></a>                            <span class="p">]</span>
</span><span id="PromptSequencers.AOP.load-855"><a href="#PromptSequencers.AOP.load-855"><span class="linenos">855</span></a>                        <span class="p">)</span>
</span><span id="PromptSequencers.AOP.load-856"><a href="#PromptSequencers.AOP.load-856"><span class="linenos">856</span></a>                    <span class="p">)</span>
</span><span id="PromptSequencers.AOP.load-857"><a href="#PromptSequencers.AOP.load-857"><span class="linenos">857</span></a>
</span><span id="PromptSequencers.AOP.load-858"><a href="#PromptSequencers.AOP.load-858"><span class="linenos">858</span></a>                    <span class="n">on_typecheck_mismatch</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
</span><span id="PromptSequencers.AOP.load-859"><a href="#PromptSequencers.AOP.load-859"><span class="linenos">859</span></a>                        <span class="n">msg</span><span class="p">,</span> <span class="n">except_cls</span><span class="o">=</span><span class="n">FieldTypeMismatchError</span>
</span><span id="PromptSequencers.AOP.load-860"><a href="#PromptSequencers.AOP.load-860"><span class="linenos">860</span></a>                    <span class="p">)</span>
</span><span id="PromptSequencers.AOP.load-861"><a href="#PromptSequencers.AOP.load-861"><span class="linenos">861</span></a>
</span><span id="PromptSequencers.AOP.load-862"><a href="#PromptSequencers.AOP.load-862"><span class="linenos">862</span></a>            <span class="c1"># return the new instance</span>
</span><span id="PromptSequencers.AOP.load-863"><a href="#PromptSequencers.AOP.load-863"><span class="linenos">863</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="PromptSequencers.AOP.validate_fields_types" class="classattr">
                                        <input id="PromptSequencers.AOP.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="PromptSequencers.AOP.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/tokenization/modular/elements.py#L282-L291" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#PromptSequencers.AOP.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PromptSequencers.AOP.validate_fields_types-283"><a href="#PromptSequencers.AOP.validate_fields_types-283"><span class="linenos">283</span></a><span class="k">def</span><span class="w"> </span><span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="PromptSequencers.AOP.validate_fields_types-284"><a href="#PromptSequencers.AOP.validate_fields_types-284"><span class="linenos">284</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP.validate_fields_types-285"><a href="#PromptSequencers.AOP.validate_fields_types-285"><span class="linenos">285</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP.validate_fields_types-286"><a href="#PromptSequencers.AOP.validate_fields_types-286"><span class="linenos">286</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="PromptSequencers.AOP.validate_fields_types-287"><a href="#PromptSequencers.AOP.validate_fields_types-287"><span class="linenos">287</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="PromptSequencers.AOP.validate_fields_types-288"><a href="#PromptSequencers.AOP.validate_fields_types-288"><span class="linenos">288</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="PromptSequencers.AOP.validate_fields_types-289"><a href="#PromptSequencers.AOP.validate_fields_types-289"><span class="linenos">289</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="PromptSequencers.AOP.validate_fields_types-290"><a href="#PromptSequencers.AOP.validate_fields_types-290"><span class="linenos">290</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="PromptSequencers.AOP.validate_fields_types-291"><a href="#PromptSequencers.AOP.validate_fields_types-291"><span class="linenos">291</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="PromptSequencers.AOP.validate_fields_types-292"><a href="#PromptSequencers.AOP.validate_fields_types-292"><span class="linenos">292</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#PromptSequencers._PromptSequencer">PromptSequencers._PromptSequencer</a></dt>
                                <dd id="PromptSequencers.AOP.coord_tokenizer" class="variable"><a href="#PromptSequencers._PromptSequencer.coord_tokenizer">coord_tokenizer</a></dd>
                <dd id="PromptSequencers.AOP.adj_list_tokenizer" class="variable"><a href="#PromptSequencers._PromptSequencer.adj_list_tokenizer">adj_list_tokenizer</a></dd>
                <dd id="PromptSequencers.AOP.attribute_key" class="function"><a href="#PromptSequencers._PromptSequencer.attribute_key">attribute_key</a></dd>
                <dd id="PromptSequencers.AOP.to_tokens" class="function"><a href="#PromptSequencers._PromptSequencer.to_tokens">to_tokens</a></dd>
                <dd id="PromptSequencers.AOP.is_valid" class="function"><a href="#PromptSequencers._PromptSequencer.is_valid">is_valid</a></dd>

            </div>
            <div><dt><a href="element_base.html#_TokenizerElement">maze_dataset.tokenization.modular.element_base._TokenizerElement</a></dt>
                                <dd id="PromptSequencers.AOP.name" class="variable"><a href="element_base.html#_TokenizerElement.name">name</a></dd>
                <dd id="PromptSequencers.AOP.tokenizer_elements" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="PromptSequencers.AOP.tokenizer_element_tree" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="PromptSequencers.AOP.tokenizer_element_dict" class="function"><a href="element_base.html#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="PromptSequencers.AOP.validate_field_type" class="function">validate_field_type</dd>
                <dd id="PromptSequencers.AOP.diff" class="function">diff</dd>
                <dd id="PromptSequencers.AOP.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>