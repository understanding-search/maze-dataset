<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.4"/>
    <title>maze_dataset.generation.generators API documentation</title>
    <link rel="icon" href="../../resources/favicon.png"/>
<link rel="stylesheet" href="../../resources/css/bootstrap-reboot.min.css"><link rel="stylesheet" href="../../resources/css/syntax-highlighting.css"><link rel="stylesheet" href="../../resources/css/theme.css"><link rel="stylesheet" href="../../resources/css/layout.css"><link rel="stylesheet" href="../../resources/css/content.css"><link rel="stylesheet" href="../../resources/css/custom.css"><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
        overflow-y: hidden;
    }
</style><style>
    .pdoc .mermaid-pre {
        border: none;
        background: none;
    }
</style>
<script type="module" defer>
    import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs";

    /* Re-invoke Mermaid when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => mermaid.run()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script></head>
<body>
<div class="package-version">
    docs for <a href="https://github.com/understanding-search/maze-dataset">maze-dataset</a> v1.4.0<br>
</div>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button">
            <img src="../../resources/svg/navtoggle.svg" alt="Toggle navigation"> 
        </label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../generation.html">
                <img src="../../resources/svg/box-arrow-in-left.svg" alt="Back to parent module"/>
                &nbsp;maze_dataset.generation</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="function" href="#get_neighbors_in_bounds">get_neighbors_in_bounds</a>
            </li>
            <li>
                    <a class="class" href="#LatticeMazeGenerators">LatticeMazeGenerators</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#LatticeMazeGenerators.gen_dfs">gen_dfs</a>
                        </li>
                        <li>
                                <a class="function" href="#LatticeMazeGenerators.gen_prim">gen_prim</a>
                        </li>
                        <li>
                                <a class="function" href="#LatticeMazeGenerators.gen_wilson">gen_wilson</a>
                        </li>
                        <li>
                                <a class="function" href="#LatticeMazeGenerators.gen_percolation">gen_percolation</a>
                        </li>
                        <li>
                                <a class="function" href="#LatticeMazeGenerators.gen_dfs_percolation">gen_dfs_percolation</a>
                        </li>
                        <li>
                                <a class="function" href="#LatticeMazeGenerators.gen_kruskal">gen_kruskal</a>
                        </li>
                        <li>
                                <a class="function" href="#LatticeMazeGenerators.gen_recursive_division">gen_recursive_division</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="variable" href="#P_GeneratorKwargs">P_GeneratorKwargs</a>
            </li>
            <li>
                    <a class="variable" href="#MazeGeneratorFunc">MazeGeneratorFunc</a>
            </li>
            <li>
                    <a class="variable" href="#GENERATORS_MAP">GENERATORS_MAP</a>
            </li>
            <li>
                    <a class="function" href="#get_maze_with_solution">get_maze_with_solution</a>
            </li>
    </ul>


    <hr/>
    
    <div>
        <a href="../../coverage/html/index.html" class="pdoc-button" title="View test coverage report">
            Coverage
        </a>
        <a href="../../other/todo-inline.html" class="pdoc-button" title="Table of TODOs scraped from source code, with links to create issues from them">
            TODOs
        </a>
        <a href="../../other/lmcat.txt" class="pdoc-button" title="a view of the repo contents made for LLMs, using https://miv.name/lmcat">
            lmcat
        </a>
    </div>


        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span>
            <img src="../../resources/svg/pdoc-logo.svg" alt="pdoc logo"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                        <a class="pdoc-button git-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/generation/generators.py">View Source on GitHub</a>
                    <h1 class="modulename">
<a href="./../../maze_dataset.html">maze_dataset</a><wbr>.<a href="./../generation.html">generation</a><wbr>.generators    </h1>

                        <div class="docstring"><p>generation functions have signature <code>(grid_shape: Coord, **kwargs) -&gt; LatticeMaze</code> and are methods in <code><a href="#LatticeMazeGenerators">LatticeMazeGenerators</a></code></p>
</div>

                        <input id="mod-generators-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="mod-generators-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/generation/generators.py#L0-L659" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

                <br/>
                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sd">&quot;&quot;&quot;generation functions have signature `(grid_shape: Coord, **kwargs) -&gt; LatticeMaze` and are methods in `LatticeMazeGenerators`&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Concatenate</span><span class="p">,</span> <span class="n">ParamSpec</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">jaxtyping</span><span class="w"> </span><span class="kn">import</span> <span class="n">Bool</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">maze_dataset.constants</span><span class="w"> </span><span class="kn">import</span> <span class="n">CoordArray</span><span class="p">,</span> <span class="n">CoordTup</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">maze_dataset.generation.seed</span><span class="w"> </span><span class="kn">import</span> <span class="n">GLOBAL_SEED</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">maze_dataset.maze</span><span class="w"> </span><span class="kn">import</span> <span class="n">ConnectionList</span><span class="p">,</span> <span class="n">Coord</span><span class="p">,</span> <span class="n">LatticeMaze</span><span class="p">,</span> <span class="n">SolvedMaze</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">maze_dataset.maze.lattice_maze</span><span class="w"> </span><span class="kn">import</span> <span class="n">NEIGHBORS_MASK</span><span class="p">,</span> <span class="n">_fill_edges_with_walls</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="n">_NUMPY_RNG</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">Generator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">GLOBAL_SEED</span><span class="p">)</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">GLOBAL_SEED</span><span class="p">)</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="k">def</span><span class="w"> </span><span class="nf">_random_start_coord</span><span class="p">(</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>	<span class="n">grid_shape</span><span class="p">:</span> <span class="n">Coord</span><span class="p">,</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a>	<span class="n">start_coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Coord</span><span class="p">:</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a>	<span class="s2">&quot;picking a random start coord within the bounds of `grid_shape` if none is provided&quot;</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>	<span class="n">start_coord_</span><span class="p">:</span> <span class="n">Coord</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>	<span class="k">if</span> <span class="n">start_coord</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a>		<span class="n">start_coord_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>			<span class="mi">0</span><span class="p">,</span>  <span class="c1"># lower bound</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>			<span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">grid_shape</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>  <span class="c1"># upper bound (at least 1)</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>			<span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">grid_shape</span><span class="p">),</span>  <span class="c1"># dimensionality</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a>		<span class="p">)</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a>	<span class="k">else</span><span class="p">:</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a>		<span class="n">start_coord_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">start_coord</span><span class="p">)</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a>	<span class="k">return</span> <span class="n">start_coord_</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_neighbors_in_bounds</span><span class="p">(</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>	<span class="n">coord</span><span class="p">:</span> <span class="n">Coord</span><span class="p">,</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a>	<span class="n">grid_shape</span><span class="p">:</span> <span class="n">Coord</span><span class="p">,</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CoordArray</span><span class="p">:</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>	<span class="s2">&quot;get all neighbors of a coordinate that are within the bounds of the grid&quot;</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>	<span class="c1"># get all neighbors</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>	<span class="n">neighbors</span><span class="p">:</span> <span class="n">CoordArray</span> <span class="o">=</span> <span class="n">coord</span> <span class="o">+</span> <span class="n">NEIGHBORS_MASK</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>	<span class="c1"># filter neighbors by being within grid bounds</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>	<span class="n">neighbors_in_bounds</span><span class="p">:</span> <span class="n">CoordArray</span> <span class="o">=</span> <span class="n">neighbors</span><span class="p">[</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>		<span class="p">(</span><span class="n">neighbors</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">neighbors</span> <span class="o">&lt;</span> <span class="n">grid_shape</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>	<span class="p">]</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>	<span class="k">return</span> <span class="n">neighbors_in_bounds</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="k">class</span><span class="w"> </span><span class="nc">LatticeMazeGenerators</span><span class="p">:</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;namespace for lattice maze generation algorithms</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="sd">	examples of generated mazes can be found here:</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a><span class="sd">	https://understanding-search.github.io/maze-dataset/examples/maze_examples.html</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>	<span class="nd">@staticmethod</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">gen_dfs</span><span class="p">(</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>		<span class="n">grid_shape</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">,</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>		<span class="o">*</span><span class="p">,</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>		<span class="n">lattice_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>		<span class="n">accessible_cells</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>		<span class="n">max_tree_depth</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>		<span class="n">do_forks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>		<span class="n">randomized_stack</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>		<span class="n">start_coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LatticeMaze</span><span class="p">:</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;generate a lattice maze using depth first search, iterative</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="sd">		# Arguments</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="sd">		- `grid_shape: Coord`: the shape of the grid</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a><span class="sd">		- `lattice_dim: int`: the dimension of the lattice</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="sd">			(default: `2`)</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a><span class="sd">		- `accessible_cells: int | float |None`: the number of accessible cells in the maze. If `None`, defaults to the total number of cells in the grid. if a float, asserts it is &lt;= 1 and treats it as a proportion of **total cells**</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a><span class="sd">			(default: `None`)</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a><span class="sd">		- `max_tree_depth: int | float | None`: the maximum depth of the tree. If `None`, defaults to `2 * accessible_cells`. if a float, asserts it is &lt;= 1 and treats it as a proportion of the **sum of the grid shape**</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a><span class="sd">			(default: `None`)</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a><span class="sd">		- `do_forks: bool`: whether to allow forks in the maze. If `False`, the maze will be have no forks and will be a simple hallway.</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="sd">		- `start_coord: Coord | None`: the starting coordinate of the generation algorithm. If `None`, defaults to a random coordinate.</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a><span class="sd">		# algorithm</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="sd">		1. Choose the initial cell, mark it as visited and push it to the stack</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a><span class="sd">		2. While the stack is not empty</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a><span class="sd">			1. Pop a cell from the stack and make it a current cell</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a><span class="sd">			2. If the current cell has any neighbours which have not been visited</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a><span class="sd">				1. Push the current cell to the stack</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a><span class="sd">				2. Choose one of the unvisited neighbours</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a><span class="sd">				3. Remove the wall between the current cell and the chosen cell</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a><span class="sd">				4. Mark the chosen cell as visited and push it to the stack</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>		<span class="c1"># Default values if no constraints have been passed</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>		<span class="n">grid_shape_</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grid_shape</span><span class="p">)</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>		<span class="n">n_total_cells</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">grid_shape_</span><span class="p">))</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>		<span class="n">n_accessible_cells</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>		<span class="k">if</span> <span class="n">accessible_cells</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>			<span class="n">n_accessible_cells</span> <span class="o">=</span> <span class="n">n_total_cells</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">accessible_cells</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>			<span class="k">assert</span> <span class="n">accessible_cells</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>				<span class="sa">f</span><span class="s2">&quot;accessible_cells must be an int (count) or a float in the range [0, 1] (proportion), got </span><span class="si">{</span><span class="n">accessible_cells</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>			<span class="p">)</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>			<span class="n">n_accessible_cells</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">accessible_cells</span> <span class="o">*</span> <span class="n">n_total_cells</span><span class="p">)</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>		<span class="k">else</span><span class="p">:</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>			<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">accessible_cells</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>			<span class="n">n_accessible_cells</span> <span class="o">=</span> <span class="n">accessible_cells</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>		<span class="k">if</span> <span class="n">max_tree_depth</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>			<span class="n">max_tree_depth</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>				<span class="mi">2</span> <span class="o">*</span> <span class="n">n_total_cells</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>			<span class="p">)</span>  <span class="c1"># We define max tree depth counting from the start coord in two directions. Therefore we divide by two in the if clause for neighboring sites later and multiply by two here.</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">max_tree_depth</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>			<span class="k">assert</span> <span class="n">max_tree_depth</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>				<span class="sa">f</span><span class="s2">&quot;max_tree_depth must be an int (count) or a float in the range [0, 1] (proportion), got </span><span class="si">{</span><span class="n">max_tree_depth</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>			<span class="p">)</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>			<span class="n">max_tree_depth</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">max_tree_depth</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">grid_shape_</span><span class="p">))</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>		<span class="c1"># choose a random start coord</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>		<span class="n">start_coord</span> <span class="o">=</span> <span class="n">_random_start_coord</span><span class="p">(</span><span class="n">grid_shape_</span><span class="p">,</span> <span class="n">start_coord</span><span class="p">)</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>		<span class="c1"># initialize the maze with no connections</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>		<span class="n">connection_list</span><span class="p">:</span> <span class="n">ConnectionList</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>			<span class="p">(</span><span class="n">lattice_dim</span><span class="p">,</span> <span class="n">grid_shape_</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">grid_shape_</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>			<span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>		<span class="p">)</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>		<span class="c1"># initialize the stack with the target coord</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>		<span class="n">visited_cells</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>		<span class="n">visited_cells</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">start_coord</span><span class="p">))</span>  <span class="c1"># this wasnt a bug after all lol</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>		<span class="n">stack</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Coord</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">start_coord</span><span class="p">]</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>		<span class="c1"># initialize tree_depth_counter</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>		<span class="n">current_tree_depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>		<span class="c1"># loop until the stack is empty or n_connected_cells is reached</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>		<span class="k">while</span> <span class="n">stack</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">visited_cells</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">n_accessible_cells</span><span class="p">):</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>			<span class="c1"># get the current coord from the stack</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>			<span class="n">current_coord</span><span class="p">:</span> <span class="n">Coord</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>			<span class="k">if</span> <span class="n">randomized_stack</span><span class="p">:</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>				<span class="n">current_coord</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">stack</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>			<span class="k">else</span><span class="p">:</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>				<span class="n">current_coord</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>			<span class="c1"># filter neighbors by being within grid bounds and being unvisited</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>			<span class="n">unvisited_neighbors_deltas</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Coord</span><span class="p">,</span> <span class="n">Coord</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>				<span class="p">(</span><span class="n">neighbor</span><span class="p">,</span> <span class="n">delta</span><span class="p">)</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>				<span class="k">for</span> <span class="n">neighbor</span><span class="p">,</span> <span class="n">delta</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>					<span class="n">current_coord</span> <span class="o">+</span> <span class="n">NEIGHBORS_MASK</span><span class="p">,</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>					<span class="n">NEIGHBORS_MASK</span><span class="p">,</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>					<span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>				<span class="p">)</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>				<span class="k">if</span> <span class="p">(</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>					<span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">neighbor</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited_cells</span><span class="p">)</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>					<span class="ow">and</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">neighbor</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">grid_shape_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>					<span class="ow">and</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">neighbor</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">grid_shape_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>				<span class="p">)</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>			<span class="p">]</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>			<span class="c1"># don&#39;t continue if max_tree_depth/2 is already reached (divide by 2 because we can branch to multiple directions)</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>			<span class="k">if</span> <span class="n">unvisited_neighbors_deltas</span> <span class="ow">and</span> <span class="p">(</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>				<span class="n">current_tree_depth</span> <span class="o">&lt;=</span> <span class="n">max_tree_depth</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>			<span class="p">):</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>				<span class="c1"># if we want a maze without forks, simply don&#39;t add the current coord back to the stack</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>				<span class="k">if</span> <span class="n">do_forks</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">unvisited_neighbors_deltas</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>					<span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_coord</span><span class="p">)</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>				<span class="c1"># choose one of the unvisited neighbors</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>				<span class="n">chosen_neighbor</span><span class="p">,</span> <span class="n">delta</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">unvisited_neighbors_deltas</span><span class="p">)</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>				<span class="c1"># add connection</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>				<span class="n">dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">delta</span><span class="p">)))</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>				<span class="c1"># if positive, down/right from current coord</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>				<span class="c1"># if negative, up/left from current coord (down/right from neighbor)</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>				<span class="n">clist_node</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>					<span class="n">current_coord</span> <span class="k">if</span> <span class="p">(</span><span class="n">delta</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="n">chosen_neighbor</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>				<span class="p">)</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>				<span class="n">connection_list</span><span class="p">[</span><span class="n">dim</span><span class="p">,</span> <span class="n">clist_node</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">clist_node</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>				<span class="c1"># add to visited cells and stack</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>				<span class="n">visited_cells</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">chosen_neighbor</span><span class="p">))</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>				<span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chosen_neighbor</span><span class="p">)</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>				<span class="c1"># Update current tree depth</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>				<span class="n">current_tree_depth</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>			<span class="k">else</span><span class="p">:</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>				<span class="n">current_tree_depth</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>		<span class="k">return</span> <span class="n">LatticeMaze</span><span class="p">(</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>			<span class="n">connection_list</span><span class="o">=</span><span class="n">connection_list</span><span class="p">,</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>			<span class="n">generation_meta</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>				<span class="n">func_name</span><span class="o">=</span><span class="s2">&quot;gen_dfs&quot;</span><span class="p">,</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>				<span class="n">grid_shape</span><span class="o">=</span><span class="n">grid_shape_</span><span class="p">,</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>				<span class="n">start_coord</span><span class="o">=</span><span class="n">start_coord</span><span class="p">,</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>				<span class="n">n_accessible_cells</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">n_accessible_cells</span><span class="p">),</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>				<span class="n">max_tree_depth</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">max_tree_depth</span><span class="p">),</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>				<span class="c1"># oh my god this took so long to track down. its almost 5am and I&#39;ve spent like 2 hours on this bug</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>				<span class="c1"># it was checking that len(visited_cells) == n_accessible_cells, but this means that the maze is</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>				<span class="c1"># treated as fully connected even when it is most certainly not, causing solving the maze to break</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>				<span class="n">fully_connected</span><span class="o">=</span><span class="nb">bool</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">visited_cells</span><span class="p">)</span> <span class="o">==</span> <span class="n">n_total_cells</span><span class="p">),</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>				<span class="n">visited_cells</span><span class="o">=</span><span class="p">{</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">coord</span><span class="p">)</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">visited_cells</span><span class="p">},</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>			<span class="p">),</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>		<span class="p">)</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>	<span class="nd">@staticmethod</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">gen_prim</span><span class="p">(</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>		<span class="n">grid_shape</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">,</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>		<span class="n">lattice_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>		<span class="n">accessible_cells</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>		<span class="n">max_tree_depth</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>		<span class="n">do_forks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>		<span class="n">start_coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LatticeMaze</span><span class="p">:</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>		<span class="s2">&quot;(broken!) generate a lattice maze using Prim&#39;s algorithm&quot;</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>		<span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>			<span class="s2">&quot;gen_prim does not correctly implement prim&#39;s algorithm, see issue: https://github.com/understanding-search/maze-dataset/issues/12&quot;</span><span class="p">,</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>		<span class="p">)</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>		<span class="k">return</span> <span class="n">LatticeMazeGenerators</span><span class="o">.</span><span class="n">gen_dfs</span><span class="p">(</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>			<span class="n">grid_shape</span><span class="o">=</span><span class="n">grid_shape</span><span class="p">,</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>			<span class="n">lattice_dim</span><span class="o">=</span><span class="n">lattice_dim</span><span class="p">,</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>			<span class="n">accessible_cells</span><span class="o">=</span><span class="n">accessible_cells</span><span class="p">,</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>			<span class="n">max_tree_depth</span><span class="o">=</span><span class="n">max_tree_depth</span><span class="p">,</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>			<span class="n">do_forks</span><span class="o">=</span><span class="n">do_forks</span><span class="p">,</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>			<span class="n">start_coord</span><span class="o">=</span><span class="n">start_coord</span><span class="p">,</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>			<span class="n">randomized_stack</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>		<span class="p">)</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>	<span class="nd">@staticmethod</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">gen_wilson</span><span class="p">(</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>		<span class="n">grid_shape</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">,</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>		<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LatticeMaze</span><span class="p">:</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Generate a lattice maze using Wilson&#39;s algorithm.</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a><span class="sd">		# Algorithm</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a><span class="sd">		Wilson&#39;s algorithm generates an unbiased (random) maze</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a><span class="sd">		sampled from the uniform distribution over all mazes, using loop-erased random walks. The generated maze is</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a><span class="sd">		acyclic and all cells are part of a unique connected space.</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a><span class="sd">		https://en.wikipedia.org/wiki/Maze_generation_algorithm#Wilson&#39;s_algorithm</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>		<span class="k">assert</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="p">,</span> <span class="p">(</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>			<span class="sa">f</span><span class="s2">&quot;gen_wilson does not take any additional arguments, got </span><span class="si">{</span><span class="n">kwargs</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>		<span class="p">)</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>		<span class="n">grid_shape_</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grid_shape</span><span class="p">)</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>		<span class="c1"># Initialize grid and visited cells</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>		<span class="n">connection_list</span><span class="p">:</span> <span class="n">ConnectionList</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="o">*</span><span class="n">grid_shape_</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">)</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>		<span class="n">visited</span><span class="p">:</span> <span class="n">Bool</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;x y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">grid_shape_</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">)</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>		<span class="c1"># Choose a random cell and mark it as visited</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>		<span class="n">start_coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">_random_start_coord</span><span class="p">(</span><span class="n">grid_shape_</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>		<span class="n">visited</span><span class="p">[</span><span class="n">start_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">start_coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>		<span class="k">del</span> <span class="n">start_coord</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>		<span class="k">while</span> <span class="ow">not</span> <span class="n">visited</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>			<span class="c1"># Perform loop-erased random walk from another random cell</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>			<span class="c1"># Choose walk_start only from unvisited cells</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>			<span class="n">unvisited_coords</span><span class="p">:</span> <span class="n">CoordArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">visited</span><span class="p">))</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>			<span class="n">walk_start</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">unvisited_coords</span><span class="p">[</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>				<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">unvisited_coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>			<span class="p">]</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>			<span class="c1"># Perform the random walk</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>			<span class="n">path</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Coord</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">walk_start</span><span class="p">]</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>			<span class="n">current</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">walk_start</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>			<span class="c1"># exit the loop once the current path hits a visited cell</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>			<span class="k">while</span> <span class="ow">not</span> <span class="n">visited</span><span class="p">[</span><span class="n">current</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">current</span><span class="p">[</span><span class="mi">1</span><span class="p">]]:</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>				<span class="c1"># find a valid neighbor (one always exists on a lattice)</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>				<span class="n">neighbors</span><span class="p">:</span> <span class="n">CoordArray</span> <span class="o">=</span> <span class="n">get_neighbors_in_bounds</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">grid_shape_</span><span class="p">)</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>				<span class="n">next_cell</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">neighbors</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">neighbors</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>				<span class="c1"># Check for loop</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>				<span class="n">loop_exit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>				<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>					<span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">next_cell</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>						<span class="n">loop_exit</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>						<span class="k">break</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>				<span class="c1"># erase the loop, or continue the walk</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>				<span class="k">if</span> <span class="n">loop_exit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>					<span class="c1"># this removes everything after and including the loop start</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>					<span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="p">[:</span> <span class="n">loop_exit</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>					<span class="c1"># reset current cell to end of path</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>					<span class="n">current</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>				<span class="k">else</span><span class="p">:</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>					<span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">next_cell</span><span class="p">)</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>					<span class="n">current</span> <span class="o">=</span> <span class="n">next_cell</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a>			<span class="c1"># Add the path to the maze</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a>				<span class="n">c_1</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>				<span class="n">c_2</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>				<span class="c1"># find the dimension of the connection</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>				<span class="n">delta</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">c_2</span> <span class="o">-</span> <span class="n">c_1</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>				<span class="n">dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">delta</span><span class="p">)))</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>				<span class="c1"># if positive, down/right from current coord</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>				<span class="c1"># if negative, up/left from current coord (down/right from neighbor)</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>				<span class="n">clist_node</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">c_1</span> <span class="k">if</span> <span class="p">(</span><span class="n">delta</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="n">c_2</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>				<span class="n">connection_list</span><span class="p">[</span><span class="n">dim</span><span class="p">,</span> <span class="n">clist_node</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">clist_node</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>				<span class="n">visited</span><span class="p">[</span><span class="n">c_1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>				<span class="c1"># we dont add c_2 because the last c_2 will have already been visited</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>		<span class="k">return</span> <span class="n">LatticeMaze</span><span class="p">(</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>			<span class="n">connection_list</span><span class="o">=</span><span class="n">connection_list</span><span class="p">,</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>			<span class="n">generation_meta</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>				<span class="n">func_name</span><span class="o">=</span><span class="s2">&quot;gen_wilson&quot;</span><span class="p">,</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>				<span class="n">grid_shape</span><span class="o">=</span><span class="n">grid_shape_</span><span class="p">,</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>				<span class="n">fully_connected</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>			<span class="p">),</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>		<span class="p">)</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>	<span class="nd">@staticmethod</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">gen_percolation</span><span class="p">(</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>		<span class="n">grid_shape</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">,</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>		<span class="n">p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">,</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>		<span class="n">lattice_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>		<span class="n">start_coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LatticeMaze</span><span class="p">:</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;generate a lattice maze using simple percolation</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a><span class="sd">		note that p in the range (0.4, 0.7) gives the most interesting mazes</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a><span class="sd">		# Arguments</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a><span class="sd">		- `grid_shape: Coord`: the shape of the grid</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a><span class="sd">		- `lattice_dim: int`: the dimension of the lattice (default: `2`)</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a><span class="sd">		- `p: float`: the probability of a cell being accessible (default: `0.5`)</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a><span class="sd">		- `start_coord: Coord | None`: the starting coordinate for the connected component (default: `None` will give a random start)</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>		<span class="k">assert</span> <span class="n">p</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">p</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;p must be between 0 and 1, got </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">&quot;</span>  <span class="c1"># noqa: PT018</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>		<span class="n">grid_shape_</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grid_shape</span><span class="p">)</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>		<span class="n">start_coord</span> <span class="o">=</span> <span class="n">_random_start_coord</span><span class="p">(</span><span class="n">grid_shape_</span><span class="p">,</span> <span class="n">start_coord</span><span class="p">)</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>		<span class="n">connection_list</span><span class="p">:</span> <span class="n">ConnectionList</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">lattice_dim</span><span class="p">,</span> <span class="o">*</span><span class="n">grid_shape_</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">p</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>		<span class="n">connection_list</span> <span class="o">=</span> <span class="n">_fill_edges_with_walls</span><span class="p">(</span><span class="n">connection_list</span><span class="p">)</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>		<span class="n">output</span><span class="p">:</span> <span class="n">LatticeMaze</span> <span class="o">=</span> <span class="n">LatticeMaze</span><span class="p">(</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>			<span class="n">connection_list</span><span class="o">=</span><span class="n">connection_list</span><span class="p">,</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>			<span class="n">generation_meta</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>				<span class="n">func_name</span><span class="o">=</span><span class="s2">&quot;gen_percolation&quot;</span><span class="p">,</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>				<span class="n">grid_shape</span><span class="o">=</span><span class="n">grid_shape_</span><span class="p">,</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>				<span class="n">percolation_p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>				<span class="n">start_coord</span><span class="o">=</span><span class="n">start_coord</span><span class="p">,</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>			<span class="p">),</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>		<span class="p">)</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>		<span class="c1"># generation_meta is sometimes None, but not here since we just made it a dict above</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>		<span class="n">output</span><span class="o">.</span><span class="n">generation_meta</span><span class="p">[</span><span class="s2">&quot;visited_cells&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">gen_connected_component_from</span><span class="p">(</span>  <span class="c1"># type: ignore[index]</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>			<span class="n">start_coord</span><span class="p">,</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>		<span class="p">)</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>		<span class="k">return</span> <span class="n">output</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>	<span class="nd">@staticmethod</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">gen_dfs_percolation</span><span class="p">(</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>		<span class="n">grid_shape</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">,</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>		<span class="n">p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">,</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>		<span class="n">lattice_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>		<span class="n">accessible_cells</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a>		<span class="n">max_tree_depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>		<span class="n">start_coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LatticeMaze</span><span class="p">:</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;dfs and then percolation (adds cycles)&quot;&quot;&quot;</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>		<span class="n">grid_shape_</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grid_shape</span><span class="p">)</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a>		<span class="n">start_coord</span> <span class="o">=</span> <span class="n">_random_start_coord</span><span class="p">(</span><span class="n">grid_shape_</span><span class="p">,</span> <span class="n">start_coord</span><span class="p">)</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a>		<span class="c1"># generate initial maze via dfs</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>		<span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span> <span class="o">=</span> <span class="n">LatticeMazeGenerators</span><span class="o">.</span><span class="n">gen_dfs</span><span class="p">(</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>			<span class="n">grid_shape</span><span class="o">=</span><span class="n">grid_shape_</span><span class="p">,</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>			<span class="n">lattice_dim</span><span class="o">=</span><span class="n">lattice_dim</span><span class="p">,</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a>			<span class="n">accessible_cells</span><span class="o">=</span><span class="n">accessible_cells</span><span class="p">,</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a>			<span class="n">max_tree_depth</span><span class="o">=</span><span class="n">max_tree_depth</span><span class="p">,</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a>			<span class="n">start_coord</span><span class="o">=</span><span class="n">start_coord</span><span class="p">,</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a>		<span class="p">)</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a>		<span class="c1"># percolate</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a>		<span class="n">connection_list_perc</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a>			<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="o">*</span><span class="n">maze</span><span class="o">.</span><span class="n">connection_list</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">p</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a>		<span class="p">)</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a>		<span class="n">connection_list_perc</span> <span class="o">=</span> <span class="n">_fill_edges_with_walls</span><span class="p">(</span><span class="n">connection_list_perc</span><span class="p">)</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a>		<span class="n">maze</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s2">&quot;connection_list&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a>			<span class="n">maze</span><span class="o">.</span><span class="n">connection_list</span><span class="p">,</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a>			<span class="n">connection_list_perc</span><span class="p">,</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a>		<span class="p">)</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a>		<span class="c1"># generation_meta is sometimes None, but not here since we just made it a dict above</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a>		<span class="n">maze</span><span class="o">.</span><span class="n">generation_meta</span><span class="p">[</span><span class="s2">&quot;func_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;gen_dfs_percolation&quot;</span>  <span class="c1"># type: ignore[index]</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a>		<span class="n">maze</span><span class="o">.</span><span class="n">generation_meta</span><span class="p">[</span><span class="s2">&quot;percolation_p&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span>  <span class="c1"># type: ignore[index]</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>		<span class="n">maze</span><span class="o">.</span><span class="n">generation_meta</span><span class="p">[</span><span class="s2">&quot;visited_cells&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">gen_connected_component_from</span><span class="p">(</span>  <span class="c1"># type: ignore[index]</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a>			<span class="n">start_coord</span><span class="p">,</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>		<span class="p">)</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a>		<span class="k">return</span> <span class="n">maze</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a>	<span class="nd">@staticmethod</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">gen_kruskal</span><span class="p">(</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a>		<span class="n">grid_shape</span><span class="p">:</span> <span class="s2">&quot;Coord | CoordTup&quot;</span><span class="p">,</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a>		<span class="n">lattice_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a>		<span class="n">start_coord</span><span class="p">:</span> <span class="s2">&quot;Coord | None&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;LatticeMaze&quot;</span><span class="p">:</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Generate a maze using Kruskal&#39;s algorithm.</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a><span class="sd">		This function generates a random spanning tree over a grid using Kruskal&#39;s algorithm.</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a><span class="sd">		Each cell is treated as a node, and all valid adjacent edges are listed and processed</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a><span class="sd">		in random order. An edge is added (i.e. its passage carved) only if it connects two cells</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a><span class="sd">		that are not already connected. The resulting maze is a perfect maze (i.e. a spanning tree)</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a><span class="sd">		without cycles.</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a><span class="sd">		https://en.wikipedia.org/wiki/Kruskal&#39;s_algorithm</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a><span class="sd">		# Parameters:</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a><span class="sd">		- `grid_shape : Coord | CoordTup`</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a><span class="sd">			The shape of the maze grid (for example, `(n_rows, n_cols)`).</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a><span class="sd">		- `lattice_dim : int`</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a><span class="sd">			The lattice dimension (default is `2`).</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a><span class="sd">		- `start_coord : Coord | None`</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a><span class="sd">			Optionally, specify a starting coordinate. If `None`, a random coordinate will be chosen.</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a><span class="sd">		- `**kwargs`</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a><span class="sd">			Additional keyword arguments (currently unused).</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a><span class="sd">		# Returns:</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a><span class="sd">		- `LatticeMaze`</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a><span class="sd">			A maze represented by a connection list, generated as a spanning tree using Kruskal&#39;s algorithm.</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a><span class="sd">		# Usage:</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a><span class="sd">		```python</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a><span class="sd">		maze = gen_kruskal((10, 10))</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a><span class="sd">		```</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a>		<span class="k">assert</span> <span class="n">lattice_dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span>  <span class="c1"># noqa: PLR2004</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>			<span class="s2">&quot;Kruskal&#39;s algorithm is only implemented for 2D lattices.&quot;</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>		<span class="p">)</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a>		<span class="c1"># Convert grid_shape to a tuple of ints</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a>		<span class="n">grid_shape_</span><span class="p">:</span> <span class="n">CoordTup</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">grid_shape</span><span class="p">)</span>  <span class="c1"># type: ignore[assignment]</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a>		<span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">grid_shape_</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a>		<span class="c1"># Initialize union-find data structure.</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a>		<span class="n">parent</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">find</span><span class="p">(</span><span class="n">cell</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a>			<span class="k">while</span> <span class="n">parent</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">!=</span> <span class="n">cell</span><span class="p">:</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a>				<span class="n">parent</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">=</span> <span class="n">parent</span><span class="p">[</span><span class="n">parent</span><span class="p">[</span><span class="n">cell</span><span class="p">]]</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a>				<span class="n">cell</span> <span class="o">=</span> <span class="n">parent</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>			<span class="k">return</span> <span class="n">cell</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">union</span><span class="p">(</span><span class="n">cell1</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">cell2</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a>			<span class="n">root1</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">cell1</span><span class="p">)</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a>			<span class="n">root2</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">cell2</span><span class="p">)</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a>			<span class="n">parent</span><span class="p">[</span><span class="n">root2</span><span class="p">]</span> <span class="o">=</span> <span class="n">root1</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a>		<span class="c1"># Initialize each cell as its own set.</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a>		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_rows</span><span class="p">):</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a>			<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_cols</span><span class="p">):</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a>				<span class="n">parent</span><span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a>		<span class="c1"># List all possible edges.</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>		<span class="c1"># For vertical edges (i.e. connecting a cell to its right neighbor):</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>		<span class="n">edges</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a>		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_rows</span><span class="p">):</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a>			<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a>				<span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">(((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a>		<span class="c1"># For horizontal edges (i.e. connecting a cell to its bottom neighbor):</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a>		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_rows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a>			<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_cols</span><span class="p">):</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>				<span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">(((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a>		<span class="c1"># Shuffle the list of edges.</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a>		<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a>		<span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a>		<span class="c1"># Initialize connection_list with no connections.</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a>		<span class="c1"># connection_list[0] stores downward connections (from cell (i,j) to (i+1,j)).</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a>		<span class="c1"># connection_list[1] stores rightward connections (from cell (i,j) to (i,j+1)).</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a>		<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a>		<span class="n">connection_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a>		<span class="c1"># Process each edge; if it connects two different trees, union them and carve the passage.</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a>		<span class="k">for</span> <span class="n">cell1</span><span class="p">,</span> <span class="n">cell2</span><span class="p">,</span> <span class="n">direction</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a>			<span class="k">if</span> <span class="n">find</span><span class="p">(</span><span class="n">cell1</span><span class="p">)</span> <span class="o">!=</span> <span class="n">find</span><span class="p">(</span><span class="n">cell2</span><span class="p">):</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a>				<span class="n">union</span><span class="p">(</span><span class="n">cell1</span><span class="p">,</span> <span class="n">cell2</span><span class="p">)</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a>				<span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a>					<span class="c1"># Horizontal edge: connection is stored in connection_list[0] at cell1.</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a>					<span class="n">connection_list</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">cell1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cell1</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a>				<span class="k">else</span><span class="p">:</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a>					<span class="c1"># Vertical edge: connection is stored in connection_list[1] at cell1.</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a>					<span class="n">connection_list</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">cell1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cell1</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a>		<span class="k">if</span> <span class="n">start_coord</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a>			<span class="n">start_coord</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">grid_shape_</span><span class="p">)</span>  <span class="c1"># type: ignore[assignment]</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a>		<span class="n">generation_meta</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a>			<span class="n">func_name</span><span class="o">=</span><span class="s2">&quot;gen_kruskal&quot;</span><span class="p">,</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a>			<span class="n">grid_shape</span><span class="o">=</span><span class="n">grid_shape_</span><span class="p">,</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a>			<span class="n">start_coord</span><span class="o">=</span><span class="n">start_coord</span><span class="p">,</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a>			<span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;kruskal&quot;</span><span class="p">,</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a>			<span class="n">fully_connected</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a>		<span class="p">)</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a>		<span class="k">return</span> <span class="n">LatticeMaze</span><span class="p">(</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a>			<span class="n">connection_list</span><span class="o">=</span><span class="n">connection_list</span><span class="p">,</span> <span class="n">generation_meta</span><span class="o">=</span><span class="n">generation_meta</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a>		<span class="p">)</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a>	<span class="nd">@staticmethod</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">gen_recursive_division</span><span class="p">(</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a>		<span class="n">grid_shape</span><span class="p">:</span> <span class="s2">&quot;Coord | CoordTup&quot;</span><span class="p">,</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a>		<span class="n">lattice_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a>		<span class="n">start_coord</span><span class="p">:</span> <span class="s2">&quot;Coord | None&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;LatticeMaze&quot;</span><span class="p">:</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Generate a maze using the recursive division algorithm.</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a><span class="sd">		This function generates a maze by recursively dividing the grid with walls and carving a single</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a><span class="sd">		passage through each wall. The algorithm begins with a fully connected grid (i.e. every pair of adjacent</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a><span class="sd">		cells is connected) and then removes connections along a chosen division line—leaving one gap as a passage.</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a><span class="sd">		The resulting maze is a perfect maze, meaning there is exactly one path between any two cells.</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a><span class="sd">		# Parameters:</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a><span class="sd">		- `grid_shape : Coord | CoordTup`</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a><span class="sd">			The shape of the maze grid (e.g., `(n_rows, n_cols)`).</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a><span class="sd">		- `lattice_dim : int`</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a><span class="sd">			The lattice dimension (default is `2`).</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a><span class="sd">		- `start_coord : Coord | None`</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a><span class="sd">			Optionally, specify a starting coordinate. If `None`, a random coordinate is chosen.</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a><span class="sd">		- `**kwargs`</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a><span class="sd">			Additional keyword arguments (currently unused).</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a>
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a><span class="sd">		# Returns:</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a><span class="sd">		- `LatticeMaze`</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a><span class="sd">			A maze represented by a connection list, generated using recursive division.</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a>
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a><span class="sd">		# Usage:</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a><span class="sd">		```python</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a><span class="sd">		maze = gen_recursive_division((10, 10))</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a><span class="sd">		```</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a>		<span class="k">assert</span> <span class="n">lattice_dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span>  <span class="c1"># noqa: PLR2004</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a>			<span class="s2">&quot;Recursive division algorithm is only implemented for 2D lattices.&quot;</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a>		<span class="p">)</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a>		<span class="c1"># Convert grid_shape to a tuple of ints.</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a>		<span class="n">grid_shape_</span><span class="p">:</span> <span class="n">CoordTup</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">grid_shape</span><span class="p">)</span>  <span class="c1"># type: ignore[assignment]</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a>		<span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">grid_shape_</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a>
</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a>		<span class="c1"># Initialize connection_list as a fully connected grid.</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a>		<span class="c1"># For horizontal connections: for each cell (i,j) with i in [0, n_rows-2], set connection to True.</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a>		<span class="c1"># For vertical connections: for each cell (i,j) with j in [0, n_cols-2], set connection to True.</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a>		<span class="n">connection_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a>		<span class="n">connection_list</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span> <span class="n">n_rows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a>		<span class="n">connection_list</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:</span> <span class="n">n_cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a>
</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">divide</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">width</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">height</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Recursively divide the region starting at (x, y) with the given width and height.</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a>
</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a><span class="sd">			Removes connections along the chosen division line except for one randomly chosen gap.</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a>			<span class="k">if</span> <span class="n">width</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">height</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># noqa: PLR2004</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a>				<span class="k">return</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a>
</span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a>			<span class="k">if</span> <span class="n">width</span> <span class="o">&gt;</span> <span class="n">height</span><span class="p">:</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a>				<span class="c1"># Vertical division.</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos">570</span></a>				<span class="n">wall_col</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos">571</span></a>				<span class="n">gap_row</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos">572</span></a>				<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">height</span><span class="p">):</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos">573</span></a>					<span class="k">if</span> <span class="n">row</span> <span class="o">==</span> <span class="n">gap_row</span><span class="p">:</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos">574</span></a>						<span class="k">continue</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos">575</span></a>					<span class="c1"># Remove the vertical connection between (row, wall_col-1) and (row, wall_col).</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos">576</span></a>					<span class="k">if</span> <span class="n">wall_col</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">n_cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos">577</span></a>						<span class="n">connection_list</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">wall_col</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos">578</span></a>				<span class="c1"># Recurse on the left and right subregions.</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos">579</span></a>				<span class="n">divide</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">wall_col</span> <span class="o">-</span> <span class="n">x</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos">580</span></a>				<span class="n">divide</span><span class="p">(</span><span class="n">wall_col</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">width</span> <span class="o">-</span> <span class="n">wall_col</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos">581</span></a>			<span class="k">else</span><span class="p">:</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos">582</span></a>				<span class="c1"># Horizontal division.</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos">583</span></a>				<span class="n">wall_row</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos">584</span></a>				<span class="n">gap_col</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos">585</span></a>				<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">width</span><span class="p">):</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos">586</span></a>					<span class="k">if</span> <span class="n">col</span> <span class="o">==</span> <span class="n">gap_col</span><span class="p">:</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos">587</span></a>						<span class="k">continue</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos">588</span></a>					<span class="c1"># Remove the horizontal connection between (wall_row-1, col) and (wall_row, col).</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos">589</span></a>					<span class="k">if</span> <span class="n">wall_row</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">n_rows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos">590</span></a>						<span class="n">connection_list</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">wall_row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos">591</span></a>				<span class="c1"># Recurse on the top and bottom subregions.</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos">592</span></a>				<span class="n">divide</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">wall_row</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos">593</span></a>				<span class="n">divide</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">wall_row</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">height</span> <span class="o">-</span> <span class="n">wall_row</span><span class="p">)</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos">594</span></a>
</span><span id="L-595"><a href="#L-595"><span class="linenos">595</span></a>		<span class="c1"># Begin the division on the full grid.</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos">596</span></a>		<span class="n">divide</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">)</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos">597</span></a>
</span><span id="L-598"><a href="#L-598"><span class="linenos">598</span></a>		<span class="k">if</span> <span class="n">start_coord</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos">599</span></a>			<span class="n">start_coord</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">grid_shape_</span><span class="p">)</span>  <span class="c1"># type: ignore[assignment]</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos">600</span></a>
</span><span id="L-601"><a href="#L-601"><span class="linenos">601</span></a>		<span class="n">generation_meta</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos">602</span></a>			<span class="n">func_name</span><span class="o">=</span><span class="s2">&quot;gen_recursive_division&quot;</span><span class="p">,</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos">603</span></a>			<span class="n">grid_shape</span><span class="o">=</span><span class="n">grid_shape_</span><span class="p">,</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos">604</span></a>			<span class="n">start_coord</span><span class="o">=</span><span class="n">start_coord</span><span class="p">,</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos">605</span></a>			<span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;recursive_division&quot;</span><span class="p">,</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos">606</span></a>			<span class="n">fully_connected</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos">607</span></a>		<span class="p">)</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos">608</span></a>		<span class="k">return</span> <span class="n">LatticeMaze</span><span class="p">(</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos">609</span></a>			<span class="n">connection_list</span><span class="o">=</span><span class="n">connection_list</span><span class="p">,</span> <span class="n">generation_meta</span><span class="o">=</span><span class="n">generation_meta</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos">610</span></a>		<span class="p">)</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos">611</span></a>
</span><span id="L-612"><a href="#L-612"><span class="linenos">612</span></a>
</span><span id="L-613"><a href="#L-613"><span class="linenos">613</span></a><span class="n">P_GeneratorKwargs</span> <span class="o">=</span> <span class="n">ParamSpec</span><span class="p">(</span><span class="s2">&quot;P_GeneratorKwargs&quot;</span><span class="p">)</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos">614</span></a><span class="n">MazeGeneratorFunc</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos">615</span></a>	<span class="n">Concatenate</span><span class="p">[</span><span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">,</span> <span class="n">P_GeneratorKwargs</span><span class="p">],</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos">616</span></a>	<span class="n">LatticeMaze</span><span class="p">,</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos">617</span></a><span class="p">]</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos">618</span></a>
</span><span id="L-619"><a href="#L-619"><span class="linenos">619</span></a>
</span><span id="L-620"><a href="#L-620"><span class="linenos">620</span></a><span class="c1"># cant automatically populate this because it messes with pickling :(</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos">621</span></a><span class="n">GENERATORS_MAP</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">MazeGeneratorFunc</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos">622</span></a>	<span class="s2">&quot;gen_dfs&quot;</span><span class="p">:</span> <span class="n">LatticeMazeGenerators</span><span class="o">.</span><span class="n">gen_dfs</span><span class="p">,</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos">623</span></a>	<span class="c1"># TYPING: error: Dict entry 1 has incompatible type</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos">624</span></a>	<span class="c1"># &quot;str&quot;: &quot;Callable[[ndarray[Any, Any] | tuple[int, int], KwArg(Any)], LatticeMaze]&quot;;</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos">625</span></a>	<span class="c1"># expected &quot;str&quot;: &quot;Callable[[ndarray[Any, Any] | tuple[int, int], Any], LatticeMaze]&quot;  [dict-item]</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos">626</span></a>	<span class="c1"># gen_wilson takes no kwargs and we check that the kwargs are empty</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos">627</span></a>	<span class="c1"># but mypy doesnt like this, `Any` != `KwArg(Any)`</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos">628</span></a>	<span class="s2">&quot;gen_wilson&quot;</span><span class="p">:</span> <span class="n">LatticeMazeGenerators</span><span class="o">.</span><span class="n">gen_wilson</span><span class="p">,</span>  <span class="c1"># type: ignore[dict-item]</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos">629</span></a>	<span class="s2">&quot;gen_percolation&quot;</span><span class="p">:</span> <span class="n">LatticeMazeGenerators</span><span class="o">.</span><span class="n">gen_percolation</span><span class="p">,</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos">630</span></a>	<span class="s2">&quot;gen_dfs_percolation&quot;</span><span class="p">:</span> <span class="n">LatticeMazeGenerators</span><span class="o">.</span><span class="n">gen_dfs_percolation</span><span class="p">,</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos">631</span></a>	<span class="s2">&quot;gen_prim&quot;</span><span class="p">:</span> <span class="n">LatticeMazeGenerators</span><span class="o">.</span><span class="n">gen_prim</span><span class="p">,</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos">632</span></a>	<span class="s2">&quot;gen_kruskal&quot;</span><span class="p">:</span> <span class="n">LatticeMazeGenerators</span><span class="o">.</span><span class="n">gen_kruskal</span><span class="p">,</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos">633</span></a>	<span class="s2">&quot;gen_recursive_division&quot;</span><span class="p">:</span> <span class="n">LatticeMazeGenerators</span><span class="o">.</span><span class="n">gen_recursive_division</span><span class="p">,</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos">634</span></a><span class="p">}</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos">635</span></a><span class="s2">&quot;mapping of generator names to generator functions, useful for loading `MazeDatasetConfig`&quot;</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos">636</span></a>
</span><span id="L-637"><a href="#L-637"><span class="linenos">637</span></a><span class="n">_GENERATORS_PERCOLATED</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos">638</span></a>	<span class="s2">&quot;gen_percolation&quot;</span><span class="p">,</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos">639</span></a>	<span class="s2">&quot;gen_dfs_percolation&quot;</span><span class="p">,</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos">640</span></a><span class="p">]</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos">641</span></a><span class="sd">&quot;&quot;&quot;list of generator names that generate percolated mazes</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos">642</span></a><span class="sd">we use this to figure out the expected success rate, since depending on the endpoint kwargs this might fail</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos">643</span></a><span class="sd">this variable is primarily used in `MazeDatasetConfig._to_ps_array` and `MazeDatasetConfig._from_ps_array`</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos">644</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos">645</span></a>
</span><span id="L-646"><a href="#L-646"><span class="linenos">646</span></a>
</span><span id="L-647"><a href="#L-647"><span class="linenos">647</span></a><span class="c1"># TODO: we should deprecate this, always get a dataset when you want a maze with a solution</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos">648</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_maze_with_solution</span><span class="p">(</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos">649</span></a>	<span class="n">gen_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos">650</span></a>	<span class="n">grid_shape</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">,</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos">651</span></a>	<span class="n">maze_ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos">652</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SolvedMaze</span><span class="p">:</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos">653</span></a>	<span class="s2">&quot;helper function to get a maze already with a solution&quot;</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos">654</span></a>	<span class="k">if</span> <span class="n">maze_ctor_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos">655</span></a>		<span class="n">maze_ctor_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos">656</span></a>	<span class="c1"># TYPING: error: Too few arguments  [call-arg]</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos">657</span></a>	<span class="c1"># not sure why this is happening -- doesnt recognize the kwargs?</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos">658</span></a>	<span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span> <span class="o">=</span> <span class="n">GENERATORS_MAP</span><span class="p">[</span><span class="n">gen_name</span><span class="p">](</span><span class="n">grid_shape</span><span class="p">,</span> <span class="o">**</span><span class="n">maze_ctor_kwargs</span><span class="p">)</span>  <span class="c1"># type: ignore[call-arg]</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos">659</span></a>	<span class="n">solution</span><span class="p">:</span> <span class="n">CoordArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">generate_random_path</span><span class="p">())</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos">660</span></a>	<span class="k">return</span> <span class="n">SolvedMaze</span><span class="o">.</span><span class="n">from_lattice_maze</span><span class="p">(</span><span class="n">lattice_maze</span><span class="o">=</span><span class="n">maze</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
</span></pre></div>


                <br/>
            </section>
                <section id="get_neighbors_in_bounds">
                            <input id="get_neighbors_in_bounds-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_neighbors_in_bounds</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">coord</span><span class="p">:</span> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">Int8</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="s1">&#39;row_col=2&#39;</span><span class="p">]</span>,</span><span class="param">	<span class="n">grid_shape</span><span class="p">:</span> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">Int8</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="s1">&#39;row_col=2&#39;</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">Int8</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="s1">&#39;coord row_col=2&#39;</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="get_neighbors_in_bounds-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/generation/generators.py#L37-L50" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#get_neighbors_in_bounds"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_neighbors_in_bounds-38"><a href="#get_neighbors_in_bounds-38"><span class="linenos">38</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_neighbors_in_bounds</span><span class="p">(</span>
</span><span id="get_neighbors_in_bounds-39"><a href="#get_neighbors_in_bounds-39"><span class="linenos">39</span></a>	<span class="n">coord</span><span class="p">:</span> <span class="n">Coord</span><span class="p">,</span>
</span><span id="get_neighbors_in_bounds-40"><a href="#get_neighbors_in_bounds-40"><span class="linenos">40</span></a>	<span class="n">grid_shape</span><span class="p">:</span> <span class="n">Coord</span><span class="p">,</span>
</span><span id="get_neighbors_in_bounds-41"><a href="#get_neighbors_in_bounds-41"><span class="linenos">41</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CoordArray</span><span class="p">:</span>
</span><span id="get_neighbors_in_bounds-42"><a href="#get_neighbors_in_bounds-42"><span class="linenos">42</span></a>	<span class="s2">&quot;get all neighbors of a coordinate that are within the bounds of the grid&quot;</span>
</span><span id="get_neighbors_in_bounds-43"><a href="#get_neighbors_in_bounds-43"><span class="linenos">43</span></a>	<span class="c1"># get all neighbors</span>
</span><span id="get_neighbors_in_bounds-44"><a href="#get_neighbors_in_bounds-44"><span class="linenos">44</span></a>	<span class="n">neighbors</span><span class="p">:</span> <span class="n">CoordArray</span> <span class="o">=</span> <span class="n">coord</span> <span class="o">+</span> <span class="n">NEIGHBORS_MASK</span>
</span><span id="get_neighbors_in_bounds-45"><a href="#get_neighbors_in_bounds-45"><span class="linenos">45</span></a>
</span><span id="get_neighbors_in_bounds-46"><a href="#get_neighbors_in_bounds-46"><span class="linenos">46</span></a>	<span class="c1"># filter neighbors by being within grid bounds</span>
</span><span id="get_neighbors_in_bounds-47"><a href="#get_neighbors_in_bounds-47"><span class="linenos">47</span></a>	<span class="n">neighbors_in_bounds</span><span class="p">:</span> <span class="n">CoordArray</span> <span class="o">=</span> <span class="n">neighbors</span><span class="p">[</span>
</span><span id="get_neighbors_in_bounds-48"><a href="#get_neighbors_in_bounds-48"><span class="linenos">48</span></a>		<span class="p">(</span><span class="n">neighbors</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">neighbors</span> <span class="o">&lt;</span> <span class="n">grid_shape</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="get_neighbors_in_bounds-49"><a href="#get_neighbors_in_bounds-49"><span class="linenos">49</span></a>	<span class="p">]</span>
</span><span id="get_neighbors_in_bounds-50"><a href="#get_neighbors_in_bounds-50"><span class="linenos">50</span></a>
</span><span id="get_neighbors_in_bounds-51"><a href="#get_neighbors_in_bounds-51"><span class="linenos">51</span></a>	<span class="k">return</span> <span class="n">neighbors_in_bounds</span>
</span></pre></div>


            <div class="docstring"><p>get all neighbors of a coordinate that are within the bounds of the grid</p>
</div>


                </section>
                <section id="LatticeMazeGenerators">
                            <input id="LatticeMazeGenerators-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">LatticeMazeGenerators</span>:

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="LatticeMazeGenerators-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/generation/generators.py#L53-L610" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#LatticeMazeGenerators"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LatticeMazeGenerators-54"><a href="#LatticeMazeGenerators-54"><span class="linenos"> 54</span></a><span class="k">class</span><span class="w"> </span><span class="nc">LatticeMazeGenerators</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators-55"><a href="#LatticeMazeGenerators-55"><span class="linenos"> 55</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;namespace for lattice maze generation algorithms</span>
</span><span id="LatticeMazeGenerators-56"><a href="#LatticeMazeGenerators-56"><span class="linenos"> 56</span></a>
</span><span id="LatticeMazeGenerators-57"><a href="#LatticeMazeGenerators-57"><span class="linenos"> 57</span></a><span class="sd">	examples of generated mazes can be found here:</span>
</span><span id="LatticeMazeGenerators-58"><a href="#LatticeMazeGenerators-58"><span class="linenos"> 58</span></a><span class="sd">	https://understanding-search.github.io/maze-dataset/examples/maze_examples.html</span>
</span><span id="LatticeMazeGenerators-59"><a href="#LatticeMazeGenerators-59"><span class="linenos"> 59</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="LatticeMazeGenerators-60"><a href="#LatticeMazeGenerators-60"><span class="linenos"> 60</span></a>
</span><span id="LatticeMazeGenerators-61"><a href="#LatticeMazeGenerators-61"><span class="linenos"> 61</span></a>	<span class="nd">@staticmethod</span>
</span><span id="LatticeMazeGenerators-62"><a href="#LatticeMazeGenerators-62"><span class="linenos"> 62</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">gen_dfs</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators-63"><a href="#LatticeMazeGenerators-63"><span class="linenos"> 63</span></a>		<span class="n">grid_shape</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-64"><a href="#LatticeMazeGenerators-64"><span class="linenos"> 64</span></a>		<span class="o">*</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-65"><a href="#LatticeMazeGenerators-65"><span class="linenos"> 65</span></a>		<span class="n">lattice_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-66"><a href="#LatticeMazeGenerators-66"><span class="linenos"> 66</span></a>		<span class="n">accessible_cells</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-67"><a href="#LatticeMazeGenerators-67"><span class="linenos"> 67</span></a>		<span class="n">max_tree_depth</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-68"><a href="#LatticeMazeGenerators-68"><span class="linenos"> 68</span></a>		<span class="n">do_forks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-69"><a href="#LatticeMazeGenerators-69"><span class="linenos"> 69</span></a>		<span class="n">randomized_stack</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-70"><a href="#LatticeMazeGenerators-70"><span class="linenos"> 70</span></a>		<span class="n">start_coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-71"><a href="#LatticeMazeGenerators-71"><span class="linenos"> 71</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LatticeMaze</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators-72"><a href="#LatticeMazeGenerators-72"><span class="linenos"> 72</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;generate a lattice maze using depth first search, iterative</span>
</span><span id="LatticeMazeGenerators-73"><a href="#LatticeMazeGenerators-73"><span class="linenos"> 73</span></a>
</span><span id="LatticeMazeGenerators-74"><a href="#LatticeMazeGenerators-74"><span class="linenos"> 74</span></a><span class="sd">		# Arguments</span>
</span><span id="LatticeMazeGenerators-75"><a href="#LatticeMazeGenerators-75"><span class="linenos"> 75</span></a><span class="sd">		- `grid_shape: Coord`: the shape of the grid</span>
</span><span id="LatticeMazeGenerators-76"><a href="#LatticeMazeGenerators-76"><span class="linenos"> 76</span></a><span class="sd">		- `lattice_dim: int`: the dimension of the lattice</span>
</span><span id="LatticeMazeGenerators-77"><a href="#LatticeMazeGenerators-77"><span class="linenos"> 77</span></a><span class="sd">			(default: `2`)</span>
</span><span id="LatticeMazeGenerators-78"><a href="#LatticeMazeGenerators-78"><span class="linenos"> 78</span></a><span class="sd">		- `accessible_cells: int | float |None`: the number of accessible cells in the maze. If `None`, defaults to the total number of cells in the grid. if a float, asserts it is &lt;= 1 and treats it as a proportion of **total cells**</span>
</span><span id="LatticeMazeGenerators-79"><a href="#LatticeMazeGenerators-79"><span class="linenos"> 79</span></a><span class="sd">			(default: `None`)</span>
</span><span id="LatticeMazeGenerators-80"><a href="#LatticeMazeGenerators-80"><span class="linenos"> 80</span></a><span class="sd">		- `max_tree_depth: int | float | None`: the maximum depth of the tree. If `None`, defaults to `2 * accessible_cells`. if a float, asserts it is &lt;= 1 and treats it as a proportion of the **sum of the grid shape**</span>
</span><span id="LatticeMazeGenerators-81"><a href="#LatticeMazeGenerators-81"><span class="linenos"> 81</span></a><span class="sd">			(default: `None`)</span>
</span><span id="LatticeMazeGenerators-82"><a href="#LatticeMazeGenerators-82"><span class="linenos"> 82</span></a><span class="sd">		- `do_forks: bool`: whether to allow forks in the maze. If `False`, the maze will be have no forks and will be a simple hallway.</span>
</span><span id="LatticeMazeGenerators-83"><a href="#LatticeMazeGenerators-83"><span class="linenos"> 83</span></a><span class="sd">		- `start_coord: Coord | None`: the starting coordinate of the generation algorithm. If `None`, defaults to a random coordinate.</span>
</span><span id="LatticeMazeGenerators-84"><a href="#LatticeMazeGenerators-84"><span class="linenos"> 84</span></a>
</span><span id="LatticeMazeGenerators-85"><a href="#LatticeMazeGenerators-85"><span class="linenos"> 85</span></a><span class="sd">		# algorithm</span>
</span><span id="LatticeMazeGenerators-86"><a href="#LatticeMazeGenerators-86"><span class="linenos"> 86</span></a><span class="sd">		1. Choose the initial cell, mark it as visited and push it to the stack</span>
</span><span id="LatticeMazeGenerators-87"><a href="#LatticeMazeGenerators-87"><span class="linenos"> 87</span></a><span class="sd">		2. While the stack is not empty</span>
</span><span id="LatticeMazeGenerators-88"><a href="#LatticeMazeGenerators-88"><span class="linenos"> 88</span></a><span class="sd">			1. Pop a cell from the stack and make it a current cell</span>
</span><span id="LatticeMazeGenerators-89"><a href="#LatticeMazeGenerators-89"><span class="linenos"> 89</span></a><span class="sd">			2. If the current cell has any neighbours which have not been visited</span>
</span><span id="LatticeMazeGenerators-90"><a href="#LatticeMazeGenerators-90"><span class="linenos"> 90</span></a><span class="sd">				1. Push the current cell to the stack</span>
</span><span id="LatticeMazeGenerators-91"><a href="#LatticeMazeGenerators-91"><span class="linenos"> 91</span></a><span class="sd">				2. Choose one of the unvisited neighbours</span>
</span><span id="LatticeMazeGenerators-92"><a href="#LatticeMazeGenerators-92"><span class="linenos"> 92</span></a><span class="sd">				3. Remove the wall between the current cell and the chosen cell</span>
</span><span id="LatticeMazeGenerators-93"><a href="#LatticeMazeGenerators-93"><span class="linenos"> 93</span></a><span class="sd">				4. Mark the chosen cell as visited and push it to the stack</span>
</span><span id="LatticeMazeGenerators-94"><a href="#LatticeMazeGenerators-94"><span class="linenos"> 94</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="LatticeMazeGenerators-95"><a href="#LatticeMazeGenerators-95"><span class="linenos"> 95</span></a>		<span class="c1"># Default values if no constraints have been passed</span>
</span><span id="LatticeMazeGenerators-96"><a href="#LatticeMazeGenerators-96"><span class="linenos"> 96</span></a>		<span class="n">grid_shape_</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grid_shape</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-97"><a href="#LatticeMazeGenerators-97"><span class="linenos"> 97</span></a>		<span class="n">n_total_cells</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">grid_shape_</span><span class="p">))</span>
</span><span id="LatticeMazeGenerators-98"><a href="#LatticeMazeGenerators-98"><span class="linenos"> 98</span></a>
</span><span id="LatticeMazeGenerators-99"><a href="#LatticeMazeGenerators-99"><span class="linenos"> 99</span></a>		<span class="n">n_accessible_cells</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="LatticeMazeGenerators-100"><a href="#LatticeMazeGenerators-100"><span class="linenos">100</span></a>		<span class="k">if</span> <span class="n">accessible_cells</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators-101"><a href="#LatticeMazeGenerators-101"><span class="linenos">101</span></a>			<span class="n">n_accessible_cells</span> <span class="o">=</span> <span class="n">n_total_cells</span>
</span><span id="LatticeMazeGenerators-102"><a href="#LatticeMazeGenerators-102"><span class="linenos">102</span></a>		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">accessible_cells</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="LatticeMazeGenerators-103"><a href="#LatticeMazeGenerators-103"><span class="linenos">103</span></a>			<span class="k">assert</span> <span class="n">accessible_cells</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span>
</span><span id="LatticeMazeGenerators-104"><a href="#LatticeMazeGenerators-104"><span class="linenos">104</span></a>				<span class="sa">f</span><span class="s2">&quot;accessible_cells must be an int (count) or a float in the range [0, 1] (proportion), got </span><span class="si">{</span><span class="n">accessible_cells</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="LatticeMazeGenerators-105"><a href="#LatticeMazeGenerators-105"><span class="linenos">105</span></a>			<span class="p">)</span>
</span><span id="LatticeMazeGenerators-106"><a href="#LatticeMazeGenerators-106"><span class="linenos">106</span></a>
</span><span id="LatticeMazeGenerators-107"><a href="#LatticeMazeGenerators-107"><span class="linenos">107</span></a>			<span class="n">n_accessible_cells</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">accessible_cells</span> <span class="o">*</span> <span class="n">n_total_cells</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-108"><a href="#LatticeMazeGenerators-108"><span class="linenos">108</span></a>		<span class="k">else</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators-109"><a href="#LatticeMazeGenerators-109"><span class="linenos">109</span></a>			<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">accessible_cells</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-110"><a href="#LatticeMazeGenerators-110"><span class="linenos">110</span></a>			<span class="n">n_accessible_cells</span> <span class="o">=</span> <span class="n">accessible_cells</span>
</span><span id="LatticeMazeGenerators-111"><a href="#LatticeMazeGenerators-111"><span class="linenos">111</span></a>
</span><span id="LatticeMazeGenerators-112"><a href="#LatticeMazeGenerators-112"><span class="linenos">112</span></a>		<span class="k">if</span> <span class="n">max_tree_depth</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators-113"><a href="#LatticeMazeGenerators-113"><span class="linenos">113</span></a>			<span class="n">max_tree_depth</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LatticeMazeGenerators-114"><a href="#LatticeMazeGenerators-114"><span class="linenos">114</span></a>				<span class="mi">2</span> <span class="o">*</span> <span class="n">n_total_cells</span>
</span><span id="LatticeMazeGenerators-115"><a href="#LatticeMazeGenerators-115"><span class="linenos">115</span></a>			<span class="p">)</span>  <span class="c1"># We define max tree depth counting from the start coord in two directions. Therefore we divide by two in the if clause for neighboring sites later and multiply by two here.</span>
</span><span id="LatticeMazeGenerators-116"><a href="#LatticeMazeGenerators-116"><span class="linenos">116</span></a>		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">max_tree_depth</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="LatticeMazeGenerators-117"><a href="#LatticeMazeGenerators-117"><span class="linenos">117</span></a>			<span class="k">assert</span> <span class="n">max_tree_depth</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span>
</span><span id="LatticeMazeGenerators-118"><a href="#LatticeMazeGenerators-118"><span class="linenos">118</span></a>				<span class="sa">f</span><span class="s2">&quot;max_tree_depth must be an int (count) or a float in the range [0, 1] (proportion), got </span><span class="si">{</span><span class="n">max_tree_depth</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="LatticeMazeGenerators-119"><a href="#LatticeMazeGenerators-119"><span class="linenos">119</span></a>			<span class="p">)</span>
</span><span id="LatticeMazeGenerators-120"><a href="#LatticeMazeGenerators-120"><span class="linenos">120</span></a>
</span><span id="LatticeMazeGenerators-121"><a href="#LatticeMazeGenerators-121"><span class="linenos">121</span></a>			<span class="n">max_tree_depth</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">max_tree_depth</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">grid_shape_</span><span class="p">))</span>
</span><span id="LatticeMazeGenerators-122"><a href="#LatticeMazeGenerators-122"><span class="linenos">122</span></a>
</span><span id="LatticeMazeGenerators-123"><a href="#LatticeMazeGenerators-123"><span class="linenos">123</span></a>		<span class="c1"># choose a random start coord</span>
</span><span id="LatticeMazeGenerators-124"><a href="#LatticeMazeGenerators-124"><span class="linenos">124</span></a>		<span class="n">start_coord</span> <span class="o">=</span> <span class="n">_random_start_coord</span><span class="p">(</span><span class="n">grid_shape_</span><span class="p">,</span> <span class="n">start_coord</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-125"><a href="#LatticeMazeGenerators-125"><span class="linenos">125</span></a>
</span><span id="LatticeMazeGenerators-126"><a href="#LatticeMazeGenerators-126"><span class="linenos">126</span></a>		<span class="c1"># initialize the maze with no connections</span>
</span><span id="LatticeMazeGenerators-127"><a href="#LatticeMazeGenerators-127"><span class="linenos">127</span></a>		<span class="n">connection_list</span><span class="p">:</span> <span class="n">ConnectionList</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators-128"><a href="#LatticeMazeGenerators-128"><span class="linenos">128</span></a>			<span class="p">(</span><span class="n">lattice_dim</span><span class="p">,</span> <span class="n">grid_shape_</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">grid_shape_</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
</span><span id="LatticeMazeGenerators-129"><a href="#LatticeMazeGenerators-129"><span class="linenos">129</span></a>			<span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-130"><a href="#LatticeMazeGenerators-130"><span class="linenos">130</span></a>		<span class="p">)</span>
</span><span id="LatticeMazeGenerators-131"><a href="#LatticeMazeGenerators-131"><span class="linenos">131</span></a>
</span><span id="LatticeMazeGenerators-132"><a href="#LatticeMazeGenerators-132"><span class="linenos">132</span></a>		<span class="c1"># initialize the stack with the target coord</span>
</span><span id="LatticeMazeGenerators-133"><a href="#LatticeMazeGenerators-133"><span class="linenos">133</span></a>		<span class="n">visited_cells</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="LatticeMazeGenerators-134"><a href="#LatticeMazeGenerators-134"><span class="linenos">134</span></a>		<span class="n">visited_cells</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">start_coord</span><span class="p">))</span>  <span class="c1"># this wasnt a bug after all lol</span>
</span><span id="LatticeMazeGenerators-135"><a href="#LatticeMazeGenerators-135"><span class="linenos">135</span></a>		<span class="n">stack</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Coord</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">start_coord</span><span class="p">]</span>
</span><span id="LatticeMazeGenerators-136"><a href="#LatticeMazeGenerators-136"><span class="linenos">136</span></a>
</span><span id="LatticeMazeGenerators-137"><a href="#LatticeMazeGenerators-137"><span class="linenos">137</span></a>		<span class="c1"># initialize tree_depth_counter</span>
</span><span id="LatticeMazeGenerators-138"><a href="#LatticeMazeGenerators-138"><span class="linenos">138</span></a>		<span class="n">current_tree_depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="LatticeMazeGenerators-139"><a href="#LatticeMazeGenerators-139"><span class="linenos">139</span></a>
</span><span id="LatticeMazeGenerators-140"><a href="#LatticeMazeGenerators-140"><span class="linenos">140</span></a>		<span class="c1"># loop until the stack is empty or n_connected_cells is reached</span>
</span><span id="LatticeMazeGenerators-141"><a href="#LatticeMazeGenerators-141"><span class="linenos">141</span></a>		<span class="k">while</span> <span class="n">stack</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">visited_cells</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">n_accessible_cells</span><span class="p">):</span>
</span><span id="LatticeMazeGenerators-142"><a href="#LatticeMazeGenerators-142"><span class="linenos">142</span></a>			<span class="c1"># get the current coord from the stack</span>
</span><span id="LatticeMazeGenerators-143"><a href="#LatticeMazeGenerators-143"><span class="linenos">143</span></a>			<span class="n">current_coord</span><span class="p">:</span> <span class="n">Coord</span>
</span><span id="LatticeMazeGenerators-144"><a href="#LatticeMazeGenerators-144"><span class="linenos">144</span></a>			<span class="k">if</span> <span class="n">randomized_stack</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators-145"><a href="#LatticeMazeGenerators-145"><span class="linenos">145</span></a>				<span class="n">current_coord</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">stack</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="LatticeMazeGenerators-146"><a href="#LatticeMazeGenerators-146"><span class="linenos">146</span></a>			<span class="k">else</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators-147"><a href="#LatticeMazeGenerators-147"><span class="linenos">147</span></a>				<span class="n">current_coord</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</span><span id="LatticeMazeGenerators-148"><a href="#LatticeMazeGenerators-148"><span class="linenos">148</span></a>
</span><span id="LatticeMazeGenerators-149"><a href="#LatticeMazeGenerators-149"><span class="linenos">149</span></a>			<span class="c1"># filter neighbors by being within grid bounds and being unvisited</span>
</span><span id="LatticeMazeGenerators-150"><a href="#LatticeMazeGenerators-150"><span class="linenos">150</span></a>			<span class="n">unvisited_neighbors_deltas</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Coord</span><span class="p">,</span> <span class="n">Coord</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="LatticeMazeGenerators-151"><a href="#LatticeMazeGenerators-151"><span class="linenos">151</span></a>				<span class="p">(</span><span class="n">neighbor</span><span class="p">,</span> <span class="n">delta</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-152"><a href="#LatticeMazeGenerators-152"><span class="linenos">152</span></a>				<span class="k">for</span> <span class="n">neighbor</span><span class="p">,</span> <span class="n">delta</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators-153"><a href="#LatticeMazeGenerators-153"><span class="linenos">153</span></a>					<span class="n">current_coord</span> <span class="o">+</span> <span class="n">NEIGHBORS_MASK</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-154"><a href="#LatticeMazeGenerators-154"><span class="linenos">154</span></a>					<span class="n">NEIGHBORS_MASK</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-155"><a href="#LatticeMazeGenerators-155"><span class="linenos">155</span></a>					<span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-156"><a href="#LatticeMazeGenerators-156"><span class="linenos">156</span></a>				<span class="p">)</span>
</span><span id="LatticeMazeGenerators-157"><a href="#LatticeMazeGenerators-157"><span class="linenos">157</span></a>				<span class="k">if</span> <span class="p">(</span>
</span><span id="LatticeMazeGenerators-158"><a href="#LatticeMazeGenerators-158"><span class="linenos">158</span></a>					<span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">neighbor</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited_cells</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-159"><a href="#LatticeMazeGenerators-159"><span class="linenos">159</span></a>					<span class="ow">and</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">neighbor</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">grid_shape_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="LatticeMazeGenerators-160"><a href="#LatticeMazeGenerators-160"><span class="linenos">160</span></a>					<span class="ow">and</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">neighbor</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">grid_shape_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="LatticeMazeGenerators-161"><a href="#LatticeMazeGenerators-161"><span class="linenos">161</span></a>				<span class="p">)</span>
</span><span id="LatticeMazeGenerators-162"><a href="#LatticeMazeGenerators-162"><span class="linenos">162</span></a>			<span class="p">]</span>
</span><span id="LatticeMazeGenerators-163"><a href="#LatticeMazeGenerators-163"><span class="linenos">163</span></a>
</span><span id="LatticeMazeGenerators-164"><a href="#LatticeMazeGenerators-164"><span class="linenos">164</span></a>			<span class="c1"># don&#39;t continue if max_tree_depth/2 is already reached (divide by 2 because we can branch to multiple directions)</span>
</span><span id="LatticeMazeGenerators-165"><a href="#LatticeMazeGenerators-165"><span class="linenos">165</span></a>			<span class="k">if</span> <span class="n">unvisited_neighbors_deltas</span> <span class="ow">and</span> <span class="p">(</span>
</span><span id="LatticeMazeGenerators-166"><a href="#LatticeMazeGenerators-166"><span class="linenos">166</span></a>				<span class="n">current_tree_depth</span> <span class="o">&lt;=</span> <span class="n">max_tree_depth</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="LatticeMazeGenerators-167"><a href="#LatticeMazeGenerators-167"><span class="linenos">167</span></a>			<span class="p">):</span>
</span><span id="LatticeMazeGenerators-168"><a href="#LatticeMazeGenerators-168"><span class="linenos">168</span></a>				<span class="c1"># if we want a maze without forks, simply don&#39;t add the current coord back to the stack</span>
</span><span id="LatticeMazeGenerators-169"><a href="#LatticeMazeGenerators-169"><span class="linenos">169</span></a>				<span class="k">if</span> <span class="n">do_forks</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">unvisited_neighbors_deltas</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="LatticeMazeGenerators-170"><a href="#LatticeMazeGenerators-170"><span class="linenos">170</span></a>					<span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_coord</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-171"><a href="#LatticeMazeGenerators-171"><span class="linenos">171</span></a>
</span><span id="LatticeMazeGenerators-172"><a href="#LatticeMazeGenerators-172"><span class="linenos">172</span></a>				<span class="c1"># choose one of the unvisited neighbors</span>
</span><span id="LatticeMazeGenerators-173"><a href="#LatticeMazeGenerators-173"><span class="linenos">173</span></a>				<span class="n">chosen_neighbor</span><span class="p">,</span> <span class="n">delta</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">unvisited_neighbors_deltas</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-174"><a href="#LatticeMazeGenerators-174"><span class="linenos">174</span></a>
</span><span id="LatticeMazeGenerators-175"><a href="#LatticeMazeGenerators-175"><span class="linenos">175</span></a>				<span class="c1"># add connection</span>
</span><span id="LatticeMazeGenerators-176"><a href="#LatticeMazeGenerators-176"><span class="linenos">176</span></a>				<span class="n">dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">delta</span><span class="p">)))</span>
</span><span id="LatticeMazeGenerators-177"><a href="#LatticeMazeGenerators-177"><span class="linenos">177</span></a>				<span class="c1"># if positive, down/right from current coord</span>
</span><span id="LatticeMazeGenerators-178"><a href="#LatticeMazeGenerators-178"><span class="linenos">178</span></a>				<span class="c1"># if negative, up/left from current coord (down/right from neighbor)</span>
</span><span id="LatticeMazeGenerators-179"><a href="#LatticeMazeGenerators-179"><span class="linenos">179</span></a>				<span class="n">clist_node</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LatticeMazeGenerators-180"><a href="#LatticeMazeGenerators-180"><span class="linenos">180</span></a>					<span class="n">current_coord</span> <span class="k">if</span> <span class="p">(</span><span class="n">delta</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="n">chosen_neighbor</span>
</span><span id="LatticeMazeGenerators-181"><a href="#LatticeMazeGenerators-181"><span class="linenos">181</span></a>				<span class="p">)</span>
</span><span id="LatticeMazeGenerators-182"><a href="#LatticeMazeGenerators-182"><span class="linenos">182</span></a>				<span class="n">connection_list</span><span class="p">[</span><span class="n">dim</span><span class="p">,</span> <span class="n">clist_node</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">clist_node</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="LatticeMazeGenerators-183"><a href="#LatticeMazeGenerators-183"><span class="linenos">183</span></a>
</span><span id="LatticeMazeGenerators-184"><a href="#LatticeMazeGenerators-184"><span class="linenos">184</span></a>				<span class="c1"># add to visited cells and stack</span>
</span><span id="LatticeMazeGenerators-185"><a href="#LatticeMazeGenerators-185"><span class="linenos">185</span></a>				<span class="n">visited_cells</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">chosen_neighbor</span><span class="p">))</span>
</span><span id="LatticeMazeGenerators-186"><a href="#LatticeMazeGenerators-186"><span class="linenos">186</span></a>				<span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chosen_neighbor</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-187"><a href="#LatticeMazeGenerators-187"><span class="linenos">187</span></a>
</span><span id="LatticeMazeGenerators-188"><a href="#LatticeMazeGenerators-188"><span class="linenos">188</span></a>				<span class="c1"># Update current tree depth</span>
</span><span id="LatticeMazeGenerators-189"><a href="#LatticeMazeGenerators-189"><span class="linenos">189</span></a>				<span class="n">current_tree_depth</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="LatticeMazeGenerators-190"><a href="#LatticeMazeGenerators-190"><span class="linenos">190</span></a>			<span class="k">else</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators-191"><a href="#LatticeMazeGenerators-191"><span class="linenos">191</span></a>				<span class="n">current_tree_depth</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="LatticeMazeGenerators-192"><a href="#LatticeMazeGenerators-192"><span class="linenos">192</span></a>
</span><span id="LatticeMazeGenerators-193"><a href="#LatticeMazeGenerators-193"><span class="linenos">193</span></a>		<span class="k">return</span> <span class="n">LatticeMaze</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators-194"><a href="#LatticeMazeGenerators-194"><span class="linenos">194</span></a>			<span class="n">connection_list</span><span class="o">=</span><span class="n">connection_list</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-195"><a href="#LatticeMazeGenerators-195"><span class="linenos">195</span></a>			<span class="n">generation_meta</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators-196"><a href="#LatticeMazeGenerators-196"><span class="linenos">196</span></a>				<span class="n">func_name</span><span class="o">=</span><span class="s2">&quot;gen_dfs&quot;</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-197"><a href="#LatticeMazeGenerators-197"><span class="linenos">197</span></a>				<span class="n">grid_shape</span><span class="o">=</span><span class="n">grid_shape_</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-198"><a href="#LatticeMazeGenerators-198"><span class="linenos">198</span></a>				<span class="n">start_coord</span><span class="o">=</span><span class="n">start_coord</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-199"><a href="#LatticeMazeGenerators-199"><span class="linenos">199</span></a>				<span class="n">n_accessible_cells</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">n_accessible_cells</span><span class="p">),</span>
</span><span id="LatticeMazeGenerators-200"><a href="#LatticeMazeGenerators-200"><span class="linenos">200</span></a>				<span class="n">max_tree_depth</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">max_tree_depth</span><span class="p">),</span>
</span><span id="LatticeMazeGenerators-201"><a href="#LatticeMazeGenerators-201"><span class="linenos">201</span></a>				<span class="c1"># oh my god this took so long to track down. its almost 5am and I&#39;ve spent like 2 hours on this bug</span>
</span><span id="LatticeMazeGenerators-202"><a href="#LatticeMazeGenerators-202"><span class="linenos">202</span></a>				<span class="c1"># it was checking that len(visited_cells) == n_accessible_cells, but this means that the maze is</span>
</span><span id="LatticeMazeGenerators-203"><a href="#LatticeMazeGenerators-203"><span class="linenos">203</span></a>				<span class="c1"># treated as fully connected even when it is most certainly not, causing solving the maze to break</span>
</span><span id="LatticeMazeGenerators-204"><a href="#LatticeMazeGenerators-204"><span class="linenos">204</span></a>				<span class="n">fully_connected</span><span class="o">=</span><span class="nb">bool</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">visited_cells</span><span class="p">)</span> <span class="o">==</span> <span class="n">n_total_cells</span><span class="p">),</span>
</span><span id="LatticeMazeGenerators-205"><a href="#LatticeMazeGenerators-205"><span class="linenos">205</span></a>				<span class="n">visited_cells</span><span class="o">=</span><span class="p">{</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">coord</span><span class="p">)</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">visited_cells</span><span class="p">},</span>
</span><span id="LatticeMazeGenerators-206"><a href="#LatticeMazeGenerators-206"><span class="linenos">206</span></a>			<span class="p">),</span>
</span><span id="LatticeMazeGenerators-207"><a href="#LatticeMazeGenerators-207"><span class="linenos">207</span></a>		<span class="p">)</span>
</span><span id="LatticeMazeGenerators-208"><a href="#LatticeMazeGenerators-208"><span class="linenos">208</span></a>
</span><span id="LatticeMazeGenerators-209"><a href="#LatticeMazeGenerators-209"><span class="linenos">209</span></a>	<span class="nd">@staticmethod</span>
</span><span id="LatticeMazeGenerators-210"><a href="#LatticeMazeGenerators-210"><span class="linenos">210</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">gen_prim</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators-211"><a href="#LatticeMazeGenerators-211"><span class="linenos">211</span></a>		<span class="n">grid_shape</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-212"><a href="#LatticeMazeGenerators-212"><span class="linenos">212</span></a>		<span class="n">lattice_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-213"><a href="#LatticeMazeGenerators-213"><span class="linenos">213</span></a>		<span class="n">accessible_cells</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-214"><a href="#LatticeMazeGenerators-214"><span class="linenos">214</span></a>		<span class="n">max_tree_depth</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-215"><a href="#LatticeMazeGenerators-215"><span class="linenos">215</span></a>		<span class="n">do_forks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-216"><a href="#LatticeMazeGenerators-216"><span class="linenos">216</span></a>		<span class="n">start_coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-217"><a href="#LatticeMazeGenerators-217"><span class="linenos">217</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LatticeMaze</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators-218"><a href="#LatticeMazeGenerators-218"><span class="linenos">218</span></a>		<span class="s2">&quot;(broken!) generate a lattice maze using Prim&#39;s algorithm&quot;</span>
</span><span id="LatticeMazeGenerators-219"><a href="#LatticeMazeGenerators-219"><span class="linenos">219</span></a>		<span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators-220"><a href="#LatticeMazeGenerators-220"><span class="linenos">220</span></a>			<span class="s2">&quot;gen_prim does not correctly implement prim&#39;s algorithm, see issue: https://github.com/understanding-search/maze-dataset/issues/12&quot;</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-221"><a href="#LatticeMazeGenerators-221"><span class="linenos">221</span></a>		<span class="p">)</span>
</span><span id="LatticeMazeGenerators-222"><a href="#LatticeMazeGenerators-222"><span class="linenos">222</span></a>		<span class="k">return</span> <span class="n">LatticeMazeGenerators</span><span class="o">.</span><span class="n">gen_dfs</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators-223"><a href="#LatticeMazeGenerators-223"><span class="linenos">223</span></a>			<span class="n">grid_shape</span><span class="o">=</span><span class="n">grid_shape</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-224"><a href="#LatticeMazeGenerators-224"><span class="linenos">224</span></a>			<span class="n">lattice_dim</span><span class="o">=</span><span class="n">lattice_dim</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-225"><a href="#LatticeMazeGenerators-225"><span class="linenos">225</span></a>			<span class="n">accessible_cells</span><span class="o">=</span><span class="n">accessible_cells</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-226"><a href="#LatticeMazeGenerators-226"><span class="linenos">226</span></a>			<span class="n">max_tree_depth</span><span class="o">=</span><span class="n">max_tree_depth</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-227"><a href="#LatticeMazeGenerators-227"><span class="linenos">227</span></a>			<span class="n">do_forks</span><span class="o">=</span><span class="n">do_forks</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-228"><a href="#LatticeMazeGenerators-228"><span class="linenos">228</span></a>			<span class="n">start_coord</span><span class="o">=</span><span class="n">start_coord</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-229"><a href="#LatticeMazeGenerators-229"><span class="linenos">229</span></a>			<span class="n">randomized_stack</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-230"><a href="#LatticeMazeGenerators-230"><span class="linenos">230</span></a>		<span class="p">)</span>
</span><span id="LatticeMazeGenerators-231"><a href="#LatticeMazeGenerators-231"><span class="linenos">231</span></a>
</span><span id="LatticeMazeGenerators-232"><a href="#LatticeMazeGenerators-232"><span class="linenos">232</span></a>	<span class="nd">@staticmethod</span>
</span><span id="LatticeMazeGenerators-233"><a href="#LatticeMazeGenerators-233"><span class="linenos">233</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">gen_wilson</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators-234"><a href="#LatticeMazeGenerators-234"><span class="linenos">234</span></a>		<span class="n">grid_shape</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-235"><a href="#LatticeMazeGenerators-235"><span class="linenos">235</span></a>		<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-236"><a href="#LatticeMazeGenerators-236"><span class="linenos">236</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LatticeMaze</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators-237"><a href="#LatticeMazeGenerators-237"><span class="linenos">237</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Generate a lattice maze using Wilson&#39;s algorithm.</span>
</span><span id="LatticeMazeGenerators-238"><a href="#LatticeMazeGenerators-238"><span class="linenos">238</span></a>
</span><span id="LatticeMazeGenerators-239"><a href="#LatticeMazeGenerators-239"><span class="linenos">239</span></a><span class="sd">		# Algorithm</span>
</span><span id="LatticeMazeGenerators-240"><a href="#LatticeMazeGenerators-240"><span class="linenos">240</span></a><span class="sd">		Wilson&#39;s algorithm generates an unbiased (random) maze</span>
</span><span id="LatticeMazeGenerators-241"><a href="#LatticeMazeGenerators-241"><span class="linenos">241</span></a><span class="sd">		sampled from the uniform distribution over all mazes, using loop-erased random walks. The generated maze is</span>
</span><span id="LatticeMazeGenerators-242"><a href="#LatticeMazeGenerators-242"><span class="linenos">242</span></a><span class="sd">		acyclic and all cells are part of a unique connected space.</span>
</span><span id="LatticeMazeGenerators-243"><a href="#LatticeMazeGenerators-243"><span class="linenos">243</span></a><span class="sd">		https://en.wikipedia.org/wiki/Maze_generation_algorithm#Wilson&#39;s_algorithm</span>
</span><span id="LatticeMazeGenerators-244"><a href="#LatticeMazeGenerators-244"><span class="linenos">244</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="LatticeMazeGenerators-245"><a href="#LatticeMazeGenerators-245"><span class="linenos">245</span></a>		<span class="k">assert</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="p">,</span> <span class="p">(</span>
</span><span id="LatticeMazeGenerators-246"><a href="#LatticeMazeGenerators-246"><span class="linenos">246</span></a>			<span class="sa">f</span><span class="s2">&quot;gen_wilson does not take any additional arguments, got </span><span class="si">{</span><span class="n">kwargs</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="LatticeMazeGenerators-247"><a href="#LatticeMazeGenerators-247"><span class="linenos">247</span></a>		<span class="p">)</span>
</span><span id="LatticeMazeGenerators-248"><a href="#LatticeMazeGenerators-248"><span class="linenos">248</span></a>
</span><span id="LatticeMazeGenerators-249"><a href="#LatticeMazeGenerators-249"><span class="linenos">249</span></a>		<span class="n">grid_shape_</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grid_shape</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-250"><a href="#LatticeMazeGenerators-250"><span class="linenos">250</span></a>
</span><span id="LatticeMazeGenerators-251"><a href="#LatticeMazeGenerators-251"><span class="linenos">251</span></a>		<span class="c1"># Initialize grid and visited cells</span>
</span><span id="LatticeMazeGenerators-252"><a href="#LatticeMazeGenerators-252"><span class="linenos">252</span></a>		<span class="n">connection_list</span><span class="p">:</span> <span class="n">ConnectionList</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="o">*</span><span class="n">grid_shape_</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-253"><a href="#LatticeMazeGenerators-253"><span class="linenos">253</span></a>		<span class="n">visited</span><span class="p">:</span> <span class="n">Bool</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;x y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">grid_shape_</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-254"><a href="#LatticeMazeGenerators-254"><span class="linenos">254</span></a>
</span><span id="LatticeMazeGenerators-255"><a href="#LatticeMazeGenerators-255"><span class="linenos">255</span></a>		<span class="c1"># Choose a random cell and mark it as visited</span>
</span><span id="LatticeMazeGenerators-256"><a href="#LatticeMazeGenerators-256"><span class="linenos">256</span></a>		<span class="n">start_coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">_random_start_coord</span><span class="p">(</span><span class="n">grid_shape_</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-257"><a href="#LatticeMazeGenerators-257"><span class="linenos">257</span></a>		<span class="n">visited</span><span class="p">[</span><span class="n">start_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">start_coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="LatticeMazeGenerators-258"><a href="#LatticeMazeGenerators-258"><span class="linenos">258</span></a>		<span class="k">del</span> <span class="n">start_coord</span>
</span><span id="LatticeMazeGenerators-259"><a href="#LatticeMazeGenerators-259"><span class="linenos">259</span></a>
</span><span id="LatticeMazeGenerators-260"><a href="#LatticeMazeGenerators-260"><span class="linenos">260</span></a>		<span class="k">while</span> <span class="ow">not</span> <span class="n">visited</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
</span><span id="LatticeMazeGenerators-261"><a href="#LatticeMazeGenerators-261"><span class="linenos">261</span></a>			<span class="c1"># Perform loop-erased random walk from another random cell</span>
</span><span id="LatticeMazeGenerators-262"><a href="#LatticeMazeGenerators-262"><span class="linenos">262</span></a>
</span><span id="LatticeMazeGenerators-263"><a href="#LatticeMazeGenerators-263"><span class="linenos">263</span></a>			<span class="c1"># Choose walk_start only from unvisited cells</span>
</span><span id="LatticeMazeGenerators-264"><a href="#LatticeMazeGenerators-264"><span class="linenos">264</span></a>			<span class="n">unvisited_coords</span><span class="p">:</span> <span class="n">CoordArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">visited</span><span class="p">))</span>
</span><span id="LatticeMazeGenerators-265"><a href="#LatticeMazeGenerators-265"><span class="linenos">265</span></a>			<span class="n">walk_start</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">unvisited_coords</span><span class="p">[</span>
</span><span id="LatticeMazeGenerators-266"><a href="#LatticeMazeGenerators-266"><span class="linenos">266</span></a>				<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">unvisited_coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="LatticeMazeGenerators-267"><a href="#LatticeMazeGenerators-267"><span class="linenos">267</span></a>			<span class="p">]</span>
</span><span id="LatticeMazeGenerators-268"><a href="#LatticeMazeGenerators-268"><span class="linenos">268</span></a>
</span><span id="LatticeMazeGenerators-269"><a href="#LatticeMazeGenerators-269"><span class="linenos">269</span></a>			<span class="c1"># Perform the random walk</span>
</span><span id="LatticeMazeGenerators-270"><a href="#LatticeMazeGenerators-270"><span class="linenos">270</span></a>			<span class="n">path</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Coord</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">walk_start</span><span class="p">]</span>
</span><span id="LatticeMazeGenerators-271"><a href="#LatticeMazeGenerators-271"><span class="linenos">271</span></a>			<span class="n">current</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">walk_start</span>
</span><span id="LatticeMazeGenerators-272"><a href="#LatticeMazeGenerators-272"><span class="linenos">272</span></a>
</span><span id="LatticeMazeGenerators-273"><a href="#LatticeMazeGenerators-273"><span class="linenos">273</span></a>			<span class="c1"># exit the loop once the current path hits a visited cell</span>
</span><span id="LatticeMazeGenerators-274"><a href="#LatticeMazeGenerators-274"><span class="linenos">274</span></a>			<span class="k">while</span> <span class="ow">not</span> <span class="n">visited</span><span class="p">[</span><span class="n">current</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">current</span><span class="p">[</span><span class="mi">1</span><span class="p">]]:</span>
</span><span id="LatticeMazeGenerators-275"><a href="#LatticeMazeGenerators-275"><span class="linenos">275</span></a>				<span class="c1"># find a valid neighbor (one always exists on a lattice)</span>
</span><span id="LatticeMazeGenerators-276"><a href="#LatticeMazeGenerators-276"><span class="linenos">276</span></a>				<span class="n">neighbors</span><span class="p">:</span> <span class="n">CoordArray</span> <span class="o">=</span> <span class="n">get_neighbors_in_bounds</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">grid_shape_</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-277"><a href="#LatticeMazeGenerators-277"><span class="linenos">277</span></a>				<span class="n">next_cell</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">neighbors</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">neighbors</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
</span><span id="LatticeMazeGenerators-278"><a href="#LatticeMazeGenerators-278"><span class="linenos">278</span></a>
</span><span id="LatticeMazeGenerators-279"><a href="#LatticeMazeGenerators-279"><span class="linenos">279</span></a>				<span class="c1"># Check for loop</span>
</span><span id="LatticeMazeGenerators-280"><a href="#LatticeMazeGenerators-280"><span class="linenos">280</span></a>				<span class="n">loop_exit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="LatticeMazeGenerators-281"><a href="#LatticeMazeGenerators-281"><span class="linenos">281</span></a>				<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
</span><span id="LatticeMazeGenerators-282"><a href="#LatticeMazeGenerators-282"><span class="linenos">282</span></a>					<span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">next_cell</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
</span><span id="LatticeMazeGenerators-283"><a href="#LatticeMazeGenerators-283"><span class="linenos">283</span></a>						<span class="n">loop_exit</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="LatticeMazeGenerators-284"><a href="#LatticeMazeGenerators-284"><span class="linenos">284</span></a>						<span class="k">break</span>
</span><span id="LatticeMazeGenerators-285"><a href="#LatticeMazeGenerators-285"><span class="linenos">285</span></a>
</span><span id="LatticeMazeGenerators-286"><a href="#LatticeMazeGenerators-286"><span class="linenos">286</span></a>				<span class="c1"># erase the loop, or continue the walk</span>
</span><span id="LatticeMazeGenerators-287"><a href="#LatticeMazeGenerators-287"><span class="linenos">287</span></a>				<span class="k">if</span> <span class="n">loop_exit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators-288"><a href="#LatticeMazeGenerators-288"><span class="linenos">288</span></a>					<span class="c1"># this removes everything after and including the loop start</span>
</span><span id="LatticeMazeGenerators-289"><a href="#LatticeMazeGenerators-289"><span class="linenos">289</span></a>					<span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="p">[:</span> <span class="n">loop_exit</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="LatticeMazeGenerators-290"><a href="#LatticeMazeGenerators-290"><span class="linenos">290</span></a>					<span class="c1"># reset current cell to end of path</span>
</span><span id="LatticeMazeGenerators-291"><a href="#LatticeMazeGenerators-291"><span class="linenos">291</span></a>					<span class="n">current</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="LatticeMazeGenerators-292"><a href="#LatticeMazeGenerators-292"><span class="linenos">292</span></a>				<span class="k">else</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators-293"><a href="#LatticeMazeGenerators-293"><span class="linenos">293</span></a>					<span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">next_cell</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-294"><a href="#LatticeMazeGenerators-294"><span class="linenos">294</span></a>					<span class="n">current</span> <span class="o">=</span> <span class="n">next_cell</span>
</span><span id="LatticeMazeGenerators-295"><a href="#LatticeMazeGenerators-295"><span class="linenos">295</span></a>
</span><span id="LatticeMazeGenerators-296"><a href="#LatticeMazeGenerators-296"><span class="linenos">296</span></a>			<span class="c1"># Add the path to the maze</span>
</span><span id="LatticeMazeGenerators-297"><a href="#LatticeMazeGenerators-297"><span class="linenos">297</span></a>			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="LatticeMazeGenerators-298"><a href="#LatticeMazeGenerators-298"><span class="linenos">298</span></a>				<span class="n">c_1</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="LatticeMazeGenerators-299"><a href="#LatticeMazeGenerators-299"><span class="linenos">299</span></a>				<span class="n">c_2</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="LatticeMazeGenerators-300"><a href="#LatticeMazeGenerators-300"><span class="linenos">300</span></a>
</span><span id="LatticeMazeGenerators-301"><a href="#LatticeMazeGenerators-301"><span class="linenos">301</span></a>				<span class="c1"># find the dimension of the connection</span>
</span><span id="LatticeMazeGenerators-302"><a href="#LatticeMazeGenerators-302"><span class="linenos">302</span></a>				<span class="n">delta</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">c_2</span> <span class="o">-</span> <span class="n">c_1</span>
</span><span id="LatticeMazeGenerators-303"><a href="#LatticeMazeGenerators-303"><span class="linenos">303</span></a>				<span class="n">dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">delta</span><span class="p">)))</span>
</span><span id="LatticeMazeGenerators-304"><a href="#LatticeMazeGenerators-304"><span class="linenos">304</span></a>
</span><span id="LatticeMazeGenerators-305"><a href="#LatticeMazeGenerators-305"><span class="linenos">305</span></a>				<span class="c1"># if positive, down/right from current coord</span>
</span><span id="LatticeMazeGenerators-306"><a href="#LatticeMazeGenerators-306"><span class="linenos">306</span></a>				<span class="c1"># if negative, up/left from current coord (down/right from neighbor)</span>
</span><span id="LatticeMazeGenerators-307"><a href="#LatticeMazeGenerators-307"><span class="linenos">307</span></a>				<span class="n">clist_node</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">c_1</span> <span class="k">if</span> <span class="p">(</span><span class="n">delta</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="n">c_2</span>
</span><span id="LatticeMazeGenerators-308"><a href="#LatticeMazeGenerators-308"><span class="linenos">308</span></a>				<span class="n">connection_list</span><span class="p">[</span><span class="n">dim</span><span class="p">,</span> <span class="n">clist_node</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">clist_node</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="LatticeMazeGenerators-309"><a href="#LatticeMazeGenerators-309"><span class="linenos">309</span></a>				<span class="n">visited</span><span class="p">[</span><span class="n">c_1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="LatticeMazeGenerators-310"><a href="#LatticeMazeGenerators-310"><span class="linenos">310</span></a>				<span class="c1"># we dont add c_2 because the last c_2 will have already been visited</span>
</span><span id="LatticeMazeGenerators-311"><a href="#LatticeMazeGenerators-311"><span class="linenos">311</span></a>
</span><span id="LatticeMazeGenerators-312"><a href="#LatticeMazeGenerators-312"><span class="linenos">312</span></a>		<span class="k">return</span> <span class="n">LatticeMaze</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators-313"><a href="#LatticeMazeGenerators-313"><span class="linenos">313</span></a>			<span class="n">connection_list</span><span class="o">=</span><span class="n">connection_list</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-314"><a href="#LatticeMazeGenerators-314"><span class="linenos">314</span></a>			<span class="n">generation_meta</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators-315"><a href="#LatticeMazeGenerators-315"><span class="linenos">315</span></a>				<span class="n">func_name</span><span class="o">=</span><span class="s2">&quot;gen_wilson&quot;</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-316"><a href="#LatticeMazeGenerators-316"><span class="linenos">316</span></a>				<span class="n">grid_shape</span><span class="o">=</span><span class="n">grid_shape_</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-317"><a href="#LatticeMazeGenerators-317"><span class="linenos">317</span></a>				<span class="n">fully_connected</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-318"><a href="#LatticeMazeGenerators-318"><span class="linenos">318</span></a>			<span class="p">),</span>
</span><span id="LatticeMazeGenerators-319"><a href="#LatticeMazeGenerators-319"><span class="linenos">319</span></a>		<span class="p">)</span>
</span><span id="LatticeMazeGenerators-320"><a href="#LatticeMazeGenerators-320"><span class="linenos">320</span></a>
</span><span id="LatticeMazeGenerators-321"><a href="#LatticeMazeGenerators-321"><span class="linenos">321</span></a>	<span class="nd">@staticmethod</span>
</span><span id="LatticeMazeGenerators-322"><a href="#LatticeMazeGenerators-322"><span class="linenos">322</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">gen_percolation</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators-323"><a href="#LatticeMazeGenerators-323"><span class="linenos">323</span></a>		<span class="n">grid_shape</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-324"><a href="#LatticeMazeGenerators-324"><span class="linenos">324</span></a>		<span class="n">p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-325"><a href="#LatticeMazeGenerators-325"><span class="linenos">325</span></a>		<span class="n">lattice_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-326"><a href="#LatticeMazeGenerators-326"><span class="linenos">326</span></a>		<span class="n">start_coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-327"><a href="#LatticeMazeGenerators-327"><span class="linenos">327</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LatticeMaze</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators-328"><a href="#LatticeMazeGenerators-328"><span class="linenos">328</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;generate a lattice maze using simple percolation</span>
</span><span id="LatticeMazeGenerators-329"><a href="#LatticeMazeGenerators-329"><span class="linenos">329</span></a>
</span><span id="LatticeMazeGenerators-330"><a href="#LatticeMazeGenerators-330"><span class="linenos">330</span></a><span class="sd">		note that p in the range (0.4, 0.7) gives the most interesting mazes</span>
</span><span id="LatticeMazeGenerators-331"><a href="#LatticeMazeGenerators-331"><span class="linenos">331</span></a>
</span><span id="LatticeMazeGenerators-332"><a href="#LatticeMazeGenerators-332"><span class="linenos">332</span></a><span class="sd">		# Arguments</span>
</span><span id="LatticeMazeGenerators-333"><a href="#LatticeMazeGenerators-333"><span class="linenos">333</span></a><span class="sd">		- `grid_shape: Coord`: the shape of the grid</span>
</span><span id="LatticeMazeGenerators-334"><a href="#LatticeMazeGenerators-334"><span class="linenos">334</span></a><span class="sd">		- `lattice_dim: int`: the dimension of the lattice (default: `2`)</span>
</span><span id="LatticeMazeGenerators-335"><a href="#LatticeMazeGenerators-335"><span class="linenos">335</span></a><span class="sd">		- `p: float`: the probability of a cell being accessible (default: `0.5`)</span>
</span><span id="LatticeMazeGenerators-336"><a href="#LatticeMazeGenerators-336"><span class="linenos">336</span></a><span class="sd">		- `start_coord: Coord | None`: the starting coordinate for the connected component (default: `None` will give a random start)</span>
</span><span id="LatticeMazeGenerators-337"><a href="#LatticeMazeGenerators-337"><span class="linenos">337</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="LatticeMazeGenerators-338"><a href="#LatticeMazeGenerators-338"><span class="linenos">338</span></a>		<span class="k">assert</span> <span class="n">p</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">p</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;p must be between 0 and 1, got </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">&quot;</span>  <span class="c1"># noqa: PT018</span>
</span><span id="LatticeMazeGenerators-339"><a href="#LatticeMazeGenerators-339"><span class="linenos">339</span></a>		<span class="n">grid_shape_</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grid_shape</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-340"><a href="#LatticeMazeGenerators-340"><span class="linenos">340</span></a>
</span><span id="LatticeMazeGenerators-341"><a href="#LatticeMazeGenerators-341"><span class="linenos">341</span></a>		<span class="n">start_coord</span> <span class="o">=</span> <span class="n">_random_start_coord</span><span class="p">(</span><span class="n">grid_shape_</span><span class="p">,</span> <span class="n">start_coord</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-342"><a href="#LatticeMazeGenerators-342"><span class="linenos">342</span></a>
</span><span id="LatticeMazeGenerators-343"><a href="#LatticeMazeGenerators-343"><span class="linenos">343</span></a>		<span class="n">connection_list</span><span class="p">:</span> <span class="n">ConnectionList</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">lattice_dim</span><span class="p">,</span> <span class="o">*</span><span class="n">grid_shape_</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">p</span>
</span><span id="LatticeMazeGenerators-344"><a href="#LatticeMazeGenerators-344"><span class="linenos">344</span></a>
</span><span id="LatticeMazeGenerators-345"><a href="#LatticeMazeGenerators-345"><span class="linenos">345</span></a>		<span class="n">connection_list</span> <span class="o">=</span> <span class="n">_fill_edges_with_walls</span><span class="p">(</span><span class="n">connection_list</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-346"><a href="#LatticeMazeGenerators-346"><span class="linenos">346</span></a>
</span><span id="LatticeMazeGenerators-347"><a href="#LatticeMazeGenerators-347"><span class="linenos">347</span></a>		<span class="n">output</span><span class="p">:</span> <span class="n">LatticeMaze</span> <span class="o">=</span> <span class="n">LatticeMaze</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators-348"><a href="#LatticeMazeGenerators-348"><span class="linenos">348</span></a>			<span class="n">connection_list</span><span class="o">=</span><span class="n">connection_list</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-349"><a href="#LatticeMazeGenerators-349"><span class="linenos">349</span></a>			<span class="n">generation_meta</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators-350"><a href="#LatticeMazeGenerators-350"><span class="linenos">350</span></a>				<span class="n">func_name</span><span class="o">=</span><span class="s2">&quot;gen_percolation&quot;</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-351"><a href="#LatticeMazeGenerators-351"><span class="linenos">351</span></a>				<span class="n">grid_shape</span><span class="o">=</span><span class="n">grid_shape_</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-352"><a href="#LatticeMazeGenerators-352"><span class="linenos">352</span></a>				<span class="n">percolation_p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-353"><a href="#LatticeMazeGenerators-353"><span class="linenos">353</span></a>				<span class="n">start_coord</span><span class="o">=</span><span class="n">start_coord</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-354"><a href="#LatticeMazeGenerators-354"><span class="linenos">354</span></a>			<span class="p">),</span>
</span><span id="LatticeMazeGenerators-355"><a href="#LatticeMazeGenerators-355"><span class="linenos">355</span></a>		<span class="p">)</span>
</span><span id="LatticeMazeGenerators-356"><a href="#LatticeMazeGenerators-356"><span class="linenos">356</span></a>
</span><span id="LatticeMazeGenerators-357"><a href="#LatticeMazeGenerators-357"><span class="linenos">357</span></a>		<span class="c1"># generation_meta is sometimes None, but not here since we just made it a dict above</span>
</span><span id="LatticeMazeGenerators-358"><a href="#LatticeMazeGenerators-358"><span class="linenos">358</span></a>		<span class="n">output</span><span class="o">.</span><span class="n">generation_meta</span><span class="p">[</span><span class="s2">&quot;visited_cells&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">gen_connected_component_from</span><span class="p">(</span>  <span class="c1"># type: ignore[index]</span>
</span><span id="LatticeMazeGenerators-359"><a href="#LatticeMazeGenerators-359"><span class="linenos">359</span></a>			<span class="n">start_coord</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-360"><a href="#LatticeMazeGenerators-360"><span class="linenos">360</span></a>		<span class="p">)</span>
</span><span id="LatticeMazeGenerators-361"><a href="#LatticeMazeGenerators-361"><span class="linenos">361</span></a>
</span><span id="LatticeMazeGenerators-362"><a href="#LatticeMazeGenerators-362"><span class="linenos">362</span></a>		<span class="k">return</span> <span class="n">output</span>
</span><span id="LatticeMazeGenerators-363"><a href="#LatticeMazeGenerators-363"><span class="linenos">363</span></a>
</span><span id="LatticeMazeGenerators-364"><a href="#LatticeMazeGenerators-364"><span class="linenos">364</span></a>	<span class="nd">@staticmethod</span>
</span><span id="LatticeMazeGenerators-365"><a href="#LatticeMazeGenerators-365"><span class="linenos">365</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">gen_dfs_percolation</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators-366"><a href="#LatticeMazeGenerators-366"><span class="linenos">366</span></a>		<span class="n">grid_shape</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-367"><a href="#LatticeMazeGenerators-367"><span class="linenos">367</span></a>		<span class="n">p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-368"><a href="#LatticeMazeGenerators-368"><span class="linenos">368</span></a>		<span class="n">lattice_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-369"><a href="#LatticeMazeGenerators-369"><span class="linenos">369</span></a>		<span class="n">accessible_cells</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-370"><a href="#LatticeMazeGenerators-370"><span class="linenos">370</span></a>		<span class="n">max_tree_depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-371"><a href="#LatticeMazeGenerators-371"><span class="linenos">371</span></a>		<span class="n">start_coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-372"><a href="#LatticeMazeGenerators-372"><span class="linenos">372</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LatticeMaze</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators-373"><a href="#LatticeMazeGenerators-373"><span class="linenos">373</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;dfs and then percolation (adds cycles)&quot;&quot;&quot;</span>
</span><span id="LatticeMazeGenerators-374"><a href="#LatticeMazeGenerators-374"><span class="linenos">374</span></a>		<span class="n">grid_shape_</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grid_shape</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-375"><a href="#LatticeMazeGenerators-375"><span class="linenos">375</span></a>		<span class="n">start_coord</span> <span class="o">=</span> <span class="n">_random_start_coord</span><span class="p">(</span><span class="n">grid_shape_</span><span class="p">,</span> <span class="n">start_coord</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-376"><a href="#LatticeMazeGenerators-376"><span class="linenos">376</span></a>
</span><span id="LatticeMazeGenerators-377"><a href="#LatticeMazeGenerators-377"><span class="linenos">377</span></a>		<span class="c1"># generate initial maze via dfs</span>
</span><span id="LatticeMazeGenerators-378"><a href="#LatticeMazeGenerators-378"><span class="linenos">378</span></a>		<span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span> <span class="o">=</span> <span class="n">LatticeMazeGenerators</span><span class="o">.</span><span class="n">gen_dfs</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators-379"><a href="#LatticeMazeGenerators-379"><span class="linenos">379</span></a>			<span class="n">grid_shape</span><span class="o">=</span><span class="n">grid_shape_</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-380"><a href="#LatticeMazeGenerators-380"><span class="linenos">380</span></a>			<span class="n">lattice_dim</span><span class="o">=</span><span class="n">lattice_dim</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-381"><a href="#LatticeMazeGenerators-381"><span class="linenos">381</span></a>			<span class="n">accessible_cells</span><span class="o">=</span><span class="n">accessible_cells</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-382"><a href="#LatticeMazeGenerators-382"><span class="linenos">382</span></a>			<span class="n">max_tree_depth</span><span class="o">=</span><span class="n">max_tree_depth</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-383"><a href="#LatticeMazeGenerators-383"><span class="linenos">383</span></a>			<span class="n">start_coord</span><span class="o">=</span><span class="n">start_coord</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-384"><a href="#LatticeMazeGenerators-384"><span class="linenos">384</span></a>		<span class="p">)</span>
</span><span id="LatticeMazeGenerators-385"><a href="#LatticeMazeGenerators-385"><span class="linenos">385</span></a>
</span><span id="LatticeMazeGenerators-386"><a href="#LatticeMazeGenerators-386"><span class="linenos">386</span></a>		<span class="c1"># percolate</span>
</span><span id="LatticeMazeGenerators-387"><a href="#LatticeMazeGenerators-387"><span class="linenos">387</span></a>		<span class="n">connection_list_perc</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LatticeMazeGenerators-388"><a href="#LatticeMazeGenerators-388"><span class="linenos">388</span></a>			<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="o">*</span><span class="n">maze</span><span class="o">.</span><span class="n">connection_list</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">p</span>
</span><span id="LatticeMazeGenerators-389"><a href="#LatticeMazeGenerators-389"><span class="linenos">389</span></a>		<span class="p">)</span>
</span><span id="LatticeMazeGenerators-390"><a href="#LatticeMazeGenerators-390"><span class="linenos">390</span></a>		<span class="n">connection_list_perc</span> <span class="o">=</span> <span class="n">_fill_edges_with_walls</span><span class="p">(</span><span class="n">connection_list_perc</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-391"><a href="#LatticeMazeGenerators-391"><span class="linenos">391</span></a>
</span><span id="LatticeMazeGenerators-392"><a href="#LatticeMazeGenerators-392"><span class="linenos">392</span></a>		<span class="n">maze</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s2">&quot;connection_list&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators-393"><a href="#LatticeMazeGenerators-393"><span class="linenos">393</span></a>			<span class="n">maze</span><span class="o">.</span><span class="n">connection_list</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-394"><a href="#LatticeMazeGenerators-394"><span class="linenos">394</span></a>			<span class="n">connection_list_perc</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-395"><a href="#LatticeMazeGenerators-395"><span class="linenos">395</span></a>		<span class="p">)</span>
</span><span id="LatticeMazeGenerators-396"><a href="#LatticeMazeGenerators-396"><span class="linenos">396</span></a>
</span><span id="LatticeMazeGenerators-397"><a href="#LatticeMazeGenerators-397"><span class="linenos">397</span></a>		<span class="c1"># generation_meta is sometimes None, but not here since we just made it a dict above</span>
</span><span id="LatticeMazeGenerators-398"><a href="#LatticeMazeGenerators-398"><span class="linenos">398</span></a>		<span class="n">maze</span><span class="o">.</span><span class="n">generation_meta</span><span class="p">[</span><span class="s2">&quot;func_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;gen_dfs_percolation&quot;</span>  <span class="c1"># type: ignore[index]</span>
</span><span id="LatticeMazeGenerators-399"><a href="#LatticeMazeGenerators-399"><span class="linenos">399</span></a>		<span class="n">maze</span><span class="o">.</span><span class="n">generation_meta</span><span class="p">[</span><span class="s2">&quot;percolation_p&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span>  <span class="c1"># type: ignore[index]</span>
</span><span id="LatticeMazeGenerators-400"><a href="#LatticeMazeGenerators-400"><span class="linenos">400</span></a>		<span class="n">maze</span><span class="o">.</span><span class="n">generation_meta</span><span class="p">[</span><span class="s2">&quot;visited_cells&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">gen_connected_component_from</span><span class="p">(</span>  <span class="c1"># type: ignore[index]</span>
</span><span id="LatticeMazeGenerators-401"><a href="#LatticeMazeGenerators-401"><span class="linenos">401</span></a>			<span class="n">start_coord</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-402"><a href="#LatticeMazeGenerators-402"><span class="linenos">402</span></a>		<span class="p">)</span>
</span><span id="LatticeMazeGenerators-403"><a href="#LatticeMazeGenerators-403"><span class="linenos">403</span></a>
</span><span id="LatticeMazeGenerators-404"><a href="#LatticeMazeGenerators-404"><span class="linenos">404</span></a>		<span class="k">return</span> <span class="n">maze</span>
</span><span id="LatticeMazeGenerators-405"><a href="#LatticeMazeGenerators-405"><span class="linenos">405</span></a>
</span><span id="LatticeMazeGenerators-406"><a href="#LatticeMazeGenerators-406"><span class="linenos">406</span></a>	<span class="nd">@staticmethod</span>
</span><span id="LatticeMazeGenerators-407"><a href="#LatticeMazeGenerators-407"><span class="linenos">407</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">gen_kruskal</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators-408"><a href="#LatticeMazeGenerators-408"><span class="linenos">408</span></a>		<span class="n">grid_shape</span><span class="p">:</span> <span class="s2">&quot;Coord | CoordTup&quot;</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-409"><a href="#LatticeMazeGenerators-409"><span class="linenos">409</span></a>		<span class="n">lattice_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-410"><a href="#LatticeMazeGenerators-410"><span class="linenos">410</span></a>		<span class="n">start_coord</span><span class="p">:</span> <span class="s2">&quot;Coord | None&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-411"><a href="#LatticeMazeGenerators-411"><span class="linenos">411</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;LatticeMaze&quot;</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators-412"><a href="#LatticeMazeGenerators-412"><span class="linenos">412</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Generate a maze using Kruskal&#39;s algorithm.</span>
</span><span id="LatticeMazeGenerators-413"><a href="#LatticeMazeGenerators-413"><span class="linenos">413</span></a>
</span><span id="LatticeMazeGenerators-414"><a href="#LatticeMazeGenerators-414"><span class="linenos">414</span></a><span class="sd">		This function generates a random spanning tree over a grid using Kruskal&#39;s algorithm.</span>
</span><span id="LatticeMazeGenerators-415"><a href="#LatticeMazeGenerators-415"><span class="linenos">415</span></a><span class="sd">		Each cell is treated as a node, and all valid adjacent edges are listed and processed</span>
</span><span id="LatticeMazeGenerators-416"><a href="#LatticeMazeGenerators-416"><span class="linenos">416</span></a><span class="sd">		in random order. An edge is added (i.e. its passage carved) only if it connects two cells</span>
</span><span id="LatticeMazeGenerators-417"><a href="#LatticeMazeGenerators-417"><span class="linenos">417</span></a><span class="sd">		that are not already connected. The resulting maze is a perfect maze (i.e. a spanning tree)</span>
</span><span id="LatticeMazeGenerators-418"><a href="#LatticeMazeGenerators-418"><span class="linenos">418</span></a><span class="sd">		without cycles.</span>
</span><span id="LatticeMazeGenerators-419"><a href="#LatticeMazeGenerators-419"><span class="linenos">419</span></a>
</span><span id="LatticeMazeGenerators-420"><a href="#LatticeMazeGenerators-420"><span class="linenos">420</span></a><span class="sd">		https://en.wikipedia.org/wiki/Kruskal&#39;s_algorithm</span>
</span><span id="LatticeMazeGenerators-421"><a href="#LatticeMazeGenerators-421"><span class="linenos">421</span></a>
</span><span id="LatticeMazeGenerators-422"><a href="#LatticeMazeGenerators-422"><span class="linenos">422</span></a><span class="sd">		# Parameters:</span>
</span><span id="LatticeMazeGenerators-423"><a href="#LatticeMazeGenerators-423"><span class="linenos">423</span></a><span class="sd">		- `grid_shape : Coord | CoordTup`</span>
</span><span id="LatticeMazeGenerators-424"><a href="#LatticeMazeGenerators-424"><span class="linenos">424</span></a><span class="sd">			The shape of the maze grid (for example, `(n_rows, n_cols)`).</span>
</span><span id="LatticeMazeGenerators-425"><a href="#LatticeMazeGenerators-425"><span class="linenos">425</span></a><span class="sd">		- `lattice_dim : int`</span>
</span><span id="LatticeMazeGenerators-426"><a href="#LatticeMazeGenerators-426"><span class="linenos">426</span></a><span class="sd">			The lattice dimension (default is `2`).</span>
</span><span id="LatticeMazeGenerators-427"><a href="#LatticeMazeGenerators-427"><span class="linenos">427</span></a><span class="sd">		- `start_coord : Coord | None`</span>
</span><span id="LatticeMazeGenerators-428"><a href="#LatticeMazeGenerators-428"><span class="linenos">428</span></a><span class="sd">			Optionally, specify a starting coordinate. If `None`, a random coordinate will be chosen.</span>
</span><span id="LatticeMazeGenerators-429"><a href="#LatticeMazeGenerators-429"><span class="linenos">429</span></a><span class="sd">		- `**kwargs`</span>
</span><span id="LatticeMazeGenerators-430"><a href="#LatticeMazeGenerators-430"><span class="linenos">430</span></a><span class="sd">			Additional keyword arguments (currently unused).</span>
</span><span id="LatticeMazeGenerators-431"><a href="#LatticeMazeGenerators-431"><span class="linenos">431</span></a>
</span><span id="LatticeMazeGenerators-432"><a href="#LatticeMazeGenerators-432"><span class="linenos">432</span></a><span class="sd">		# Returns:</span>
</span><span id="LatticeMazeGenerators-433"><a href="#LatticeMazeGenerators-433"><span class="linenos">433</span></a><span class="sd">		- `LatticeMaze`</span>
</span><span id="LatticeMazeGenerators-434"><a href="#LatticeMazeGenerators-434"><span class="linenos">434</span></a><span class="sd">			A maze represented by a connection list, generated as a spanning tree using Kruskal&#39;s algorithm.</span>
</span><span id="LatticeMazeGenerators-435"><a href="#LatticeMazeGenerators-435"><span class="linenos">435</span></a>
</span><span id="LatticeMazeGenerators-436"><a href="#LatticeMazeGenerators-436"><span class="linenos">436</span></a><span class="sd">		# Usage:</span>
</span><span id="LatticeMazeGenerators-437"><a href="#LatticeMazeGenerators-437"><span class="linenos">437</span></a><span class="sd">		```python</span>
</span><span id="LatticeMazeGenerators-438"><a href="#LatticeMazeGenerators-438"><span class="linenos">438</span></a><span class="sd">		maze = gen_kruskal((10, 10))</span>
</span><span id="LatticeMazeGenerators-439"><a href="#LatticeMazeGenerators-439"><span class="linenos">439</span></a><span class="sd">		```</span>
</span><span id="LatticeMazeGenerators-440"><a href="#LatticeMazeGenerators-440"><span class="linenos">440</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="LatticeMazeGenerators-441"><a href="#LatticeMazeGenerators-441"><span class="linenos">441</span></a>		<span class="k">assert</span> <span class="n">lattice_dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span>  <span class="c1"># noqa: PLR2004</span>
</span><span id="LatticeMazeGenerators-442"><a href="#LatticeMazeGenerators-442"><span class="linenos">442</span></a>			<span class="s2">&quot;Kruskal&#39;s algorithm is only implemented for 2D lattices.&quot;</span>
</span><span id="LatticeMazeGenerators-443"><a href="#LatticeMazeGenerators-443"><span class="linenos">443</span></a>		<span class="p">)</span>
</span><span id="LatticeMazeGenerators-444"><a href="#LatticeMazeGenerators-444"><span class="linenos">444</span></a>		<span class="c1"># Convert grid_shape to a tuple of ints</span>
</span><span id="LatticeMazeGenerators-445"><a href="#LatticeMazeGenerators-445"><span class="linenos">445</span></a>		<span class="n">grid_shape_</span><span class="p">:</span> <span class="n">CoordTup</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">grid_shape</span><span class="p">)</span>  <span class="c1"># type: ignore[assignment]</span>
</span><span id="LatticeMazeGenerators-446"><a href="#LatticeMazeGenerators-446"><span class="linenos">446</span></a>		<span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">grid_shape_</span>
</span><span id="LatticeMazeGenerators-447"><a href="#LatticeMazeGenerators-447"><span class="linenos">447</span></a>
</span><span id="LatticeMazeGenerators-448"><a href="#LatticeMazeGenerators-448"><span class="linenos">448</span></a>		<span class="c1"># Initialize union-find data structure.</span>
</span><span id="LatticeMazeGenerators-449"><a href="#LatticeMazeGenerators-449"><span class="linenos">449</span></a>		<span class="n">parent</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LatticeMazeGenerators-450"><a href="#LatticeMazeGenerators-450"><span class="linenos">450</span></a>
</span><span id="LatticeMazeGenerators-451"><a href="#LatticeMazeGenerators-451"><span class="linenos">451</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">find</span><span class="p">(</span><span class="n">cell</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
</span><span id="LatticeMazeGenerators-452"><a href="#LatticeMazeGenerators-452"><span class="linenos">452</span></a>			<span class="k">while</span> <span class="n">parent</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">!=</span> <span class="n">cell</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators-453"><a href="#LatticeMazeGenerators-453"><span class="linenos">453</span></a>				<span class="n">parent</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">=</span> <span class="n">parent</span><span class="p">[</span><span class="n">parent</span><span class="p">[</span><span class="n">cell</span><span class="p">]]</span>
</span><span id="LatticeMazeGenerators-454"><a href="#LatticeMazeGenerators-454"><span class="linenos">454</span></a>				<span class="n">cell</span> <span class="o">=</span> <span class="n">parent</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span>
</span><span id="LatticeMazeGenerators-455"><a href="#LatticeMazeGenerators-455"><span class="linenos">455</span></a>			<span class="k">return</span> <span class="n">cell</span>
</span><span id="LatticeMazeGenerators-456"><a href="#LatticeMazeGenerators-456"><span class="linenos">456</span></a>
</span><span id="LatticeMazeGenerators-457"><a href="#LatticeMazeGenerators-457"><span class="linenos">457</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">union</span><span class="p">(</span><span class="n">cell1</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">cell2</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators-458"><a href="#LatticeMazeGenerators-458"><span class="linenos">458</span></a>			<span class="n">root1</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">cell1</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-459"><a href="#LatticeMazeGenerators-459"><span class="linenos">459</span></a>			<span class="n">root2</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">cell2</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-460"><a href="#LatticeMazeGenerators-460"><span class="linenos">460</span></a>			<span class="n">parent</span><span class="p">[</span><span class="n">root2</span><span class="p">]</span> <span class="o">=</span> <span class="n">root1</span>
</span><span id="LatticeMazeGenerators-461"><a href="#LatticeMazeGenerators-461"><span class="linenos">461</span></a>
</span><span id="LatticeMazeGenerators-462"><a href="#LatticeMazeGenerators-462"><span class="linenos">462</span></a>		<span class="c1"># Initialize each cell as its own set.</span>
</span><span id="LatticeMazeGenerators-463"><a href="#LatticeMazeGenerators-463"><span class="linenos">463</span></a>		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_rows</span><span class="p">):</span>
</span><span id="LatticeMazeGenerators-464"><a href="#LatticeMazeGenerators-464"><span class="linenos">464</span></a>			<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_cols</span><span class="p">):</span>
</span><span id="LatticeMazeGenerators-465"><a href="#LatticeMazeGenerators-465"><span class="linenos">465</span></a>				<span class="n">parent</span><span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-466"><a href="#LatticeMazeGenerators-466"><span class="linenos">466</span></a>
</span><span id="LatticeMazeGenerators-467"><a href="#LatticeMazeGenerators-467"><span class="linenos">467</span></a>		<span class="c1"># List all possible edges.</span>
</span><span id="LatticeMazeGenerators-468"><a href="#LatticeMazeGenerators-468"><span class="linenos">468</span></a>		<span class="c1"># For vertical edges (i.e. connecting a cell to its right neighbor):</span>
</span><span id="LatticeMazeGenerators-469"><a href="#LatticeMazeGenerators-469"><span class="linenos">469</span></a>		<span class="n">edges</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LatticeMazeGenerators-470"><a href="#LatticeMazeGenerators-470"><span class="linenos">470</span></a>		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_rows</span><span class="p">):</span>
</span><span id="LatticeMazeGenerators-471"><a href="#LatticeMazeGenerators-471"><span class="linenos">471</span></a>			<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="LatticeMazeGenerators-472"><a href="#LatticeMazeGenerators-472"><span class="linenos">472</span></a>				<span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">(((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="LatticeMazeGenerators-473"><a href="#LatticeMazeGenerators-473"><span class="linenos">473</span></a>		<span class="c1"># For horizontal edges (i.e. connecting a cell to its bottom neighbor):</span>
</span><span id="LatticeMazeGenerators-474"><a href="#LatticeMazeGenerators-474"><span class="linenos">474</span></a>		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_rows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="LatticeMazeGenerators-475"><a href="#LatticeMazeGenerators-475"><span class="linenos">475</span></a>			<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_cols</span><span class="p">):</span>
</span><span id="LatticeMazeGenerators-476"><a href="#LatticeMazeGenerators-476"><span class="linenos">476</span></a>				<span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">(((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="LatticeMazeGenerators-477"><a href="#LatticeMazeGenerators-477"><span class="linenos">477</span></a>
</span><span id="LatticeMazeGenerators-478"><a href="#LatticeMazeGenerators-478"><span class="linenos">478</span></a>		<span class="c1"># Shuffle the list of edges.</span>
</span><span id="LatticeMazeGenerators-479"><a href="#LatticeMazeGenerators-479"><span class="linenos">479</span></a>		<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
</span><span id="LatticeMazeGenerators-480"><a href="#LatticeMazeGenerators-480"><span class="linenos">480</span></a>
</span><span id="LatticeMazeGenerators-481"><a href="#LatticeMazeGenerators-481"><span class="linenos">481</span></a>		<span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-482"><a href="#LatticeMazeGenerators-482"><span class="linenos">482</span></a>
</span><span id="LatticeMazeGenerators-483"><a href="#LatticeMazeGenerators-483"><span class="linenos">483</span></a>		<span class="c1"># Initialize connection_list with no connections.</span>
</span><span id="LatticeMazeGenerators-484"><a href="#LatticeMazeGenerators-484"><span class="linenos">484</span></a>		<span class="c1"># connection_list[0] stores downward connections (from cell (i,j) to (i+1,j)).</span>
</span><span id="LatticeMazeGenerators-485"><a href="#LatticeMazeGenerators-485"><span class="linenos">485</span></a>		<span class="c1"># connection_list[1] stores rightward connections (from cell (i,j) to (i,j+1)).</span>
</span><span id="LatticeMazeGenerators-486"><a href="#LatticeMazeGenerators-486"><span class="linenos">486</span></a>		<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="LatticeMazeGenerators-487"><a href="#LatticeMazeGenerators-487"><span class="linenos">487</span></a>
</span><span id="LatticeMazeGenerators-488"><a href="#LatticeMazeGenerators-488"><span class="linenos">488</span></a>		<span class="n">connection_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-489"><a href="#LatticeMazeGenerators-489"><span class="linenos">489</span></a>
</span><span id="LatticeMazeGenerators-490"><a href="#LatticeMazeGenerators-490"><span class="linenos">490</span></a>		<span class="c1"># Process each edge; if it connects two different trees, union them and carve the passage.</span>
</span><span id="LatticeMazeGenerators-491"><a href="#LatticeMazeGenerators-491"><span class="linenos">491</span></a>		<span class="k">for</span> <span class="n">cell1</span><span class="p">,</span> <span class="n">cell2</span><span class="p">,</span> <span class="n">direction</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators-492"><a href="#LatticeMazeGenerators-492"><span class="linenos">492</span></a>			<span class="k">if</span> <span class="n">find</span><span class="p">(</span><span class="n">cell1</span><span class="p">)</span> <span class="o">!=</span> <span class="n">find</span><span class="p">(</span><span class="n">cell2</span><span class="p">):</span>
</span><span id="LatticeMazeGenerators-493"><a href="#LatticeMazeGenerators-493"><span class="linenos">493</span></a>				<span class="n">union</span><span class="p">(</span><span class="n">cell1</span><span class="p">,</span> <span class="n">cell2</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-494"><a href="#LatticeMazeGenerators-494"><span class="linenos">494</span></a>				<span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators-495"><a href="#LatticeMazeGenerators-495"><span class="linenos">495</span></a>					<span class="c1"># Horizontal edge: connection is stored in connection_list[0] at cell1.</span>
</span><span id="LatticeMazeGenerators-496"><a href="#LatticeMazeGenerators-496"><span class="linenos">496</span></a>					<span class="n">connection_list</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">cell1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cell1</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="LatticeMazeGenerators-497"><a href="#LatticeMazeGenerators-497"><span class="linenos">497</span></a>				<span class="k">else</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators-498"><a href="#LatticeMazeGenerators-498"><span class="linenos">498</span></a>					<span class="c1"># Vertical edge: connection is stored in connection_list[1] at cell1.</span>
</span><span id="LatticeMazeGenerators-499"><a href="#LatticeMazeGenerators-499"><span class="linenos">499</span></a>					<span class="n">connection_list</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">cell1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cell1</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="LatticeMazeGenerators-500"><a href="#LatticeMazeGenerators-500"><span class="linenos">500</span></a>
</span><span id="LatticeMazeGenerators-501"><a href="#LatticeMazeGenerators-501"><span class="linenos">501</span></a>		<span class="k">if</span> <span class="n">start_coord</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators-502"><a href="#LatticeMazeGenerators-502"><span class="linenos">502</span></a>			<span class="n">start_coord</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">grid_shape_</span><span class="p">)</span>  <span class="c1"># type: ignore[assignment]</span>
</span><span id="LatticeMazeGenerators-503"><a href="#LatticeMazeGenerators-503"><span class="linenos">503</span></a>
</span><span id="LatticeMazeGenerators-504"><a href="#LatticeMazeGenerators-504"><span class="linenos">504</span></a>		<span class="n">generation_meta</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators-505"><a href="#LatticeMazeGenerators-505"><span class="linenos">505</span></a>			<span class="n">func_name</span><span class="o">=</span><span class="s2">&quot;gen_kruskal&quot;</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-506"><a href="#LatticeMazeGenerators-506"><span class="linenos">506</span></a>			<span class="n">grid_shape</span><span class="o">=</span><span class="n">grid_shape_</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-507"><a href="#LatticeMazeGenerators-507"><span class="linenos">507</span></a>			<span class="n">start_coord</span><span class="o">=</span><span class="n">start_coord</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-508"><a href="#LatticeMazeGenerators-508"><span class="linenos">508</span></a>			<span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;kruskal&quot;</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-509"><a href="#LatticeMazeGenerators-509"><span class="linenos">509</span></a>			<span class="n">fully_connected</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-510"><a href="#LatticeMazeGenerators-510"><span class="linenos">510</span></a>		<span class="p">)</span>
</span><span id="LatticeMazeGenerators-511"><a href="#LatticeMazeGenerators-511"><span class="linenos">511</span></a>		<span class="k">return</span> <span class="n">LatticeMaze</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators-512"><a href="#LatticeMazeGenerators-512"><span class="linenos">512</span></a>			<span class="n">connection_list</span><span class="o">=</span><span class="n">connection_list</span><span class="p">,</span> <span class="n">generation_meta</span><span class="o">=</span><span class="n">generation_meta</span>
</span><span id="LatticeMazeGenerators-513"><a href="#LatticeMazeGenerators-513"><span class="linenos">513</span></a>		<span class="p">)</span>
</span><span id="LatticeMazeGenerators-514"><a href="#LatticeMazeGenerators-514"><span class="linenos">514</span></a>
</span><span id="LatticeMazeGenerators-515"><a href="#LatticeMazeGenerators-515"><span class="linenos">515</span></a>	<span class="nd">@staticmethod</span>
</span><span id="LatticeMazeGenerators-516"><a href="#LatticeMazeGenerators-516"><span class="linenos">516</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">gen_recursive_division</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators-517"><a href="#LatticeMazeGenerators-517"><span class="linenos">517</span></a>		<span class="n">grid_shape</span><span class="p">:</span> <span class="s2">&quot;Coord | CoordTup&quot;</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-518"><a href="#LatticeMazeGenerators-518"><span class="linenos">518</span></a>		<span class="n">lattice_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-519"><a href="#LatticeMazeGenerators-519"><span class="linenos">519</span></a>		<span class="n">start_coord</span><span class="p">:</span> <span class="s2">&quot;Coord | None&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-520"><a href="#LatticeMazeGenerators-520"><span class="linenos">520</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;LatticeMaze&quot;</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators-521"><a href="#LatticeMazeGenerators-521"><span class="linenos">521</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Generate a maze using the recursive division algorithm.</span>
</span><span id="LatticeMazeGenerators-522"><a href="#LatticeMazeGenerators-522"><span class="linenos">522</span></a>
</span><span id="LatticeMazeGenerators-523"><a href="#LatticeMazeGenerators-523"><span class="linenos">523</span></a><span class="sd">		This function generates a maze by recursively dividing the grid with walls and carving a single</span>
</span><span id="LatticeMazeGenerators-524"><a href="#LatticeMazeGenerators-524"><span class="linenos">524</span></a><span class="sd">		passage through each wall. The algorithm begins with a fully connected grid (i.e. every pair of adjacent</span>
</span><span id="LatticeMazeGenerators-525"><a href="#LatticeMazeGenerators-525"><span class="linenos">525</span></a><span class="sd">		cells is connected) and then removes connections along a chosen division line—leaving one gap as a passage.</span>
</span><span id="LatticeMazeGenerators-526"><a href="#LatticeMazeGenerators-526"><span class="linenos">526</span></a><span class="sd">		The resulting maze is a perfect maze, meaning there is exactly one path between any two cells.</span>
</span><span id="LatticeMazeGenerators-527"><a href="#LatticeMazeGenerators-527"><span class="linenos">527</span></a>
</span><span id="LatticeMazeGenerators-528"><a href="#LatticeMazeGenerators-528"><span class="linenos">528</span></a><span class="sd">		# Parameters:</span>
</span><span id="LatticeMazeGenerators-529"><a href="#LatticeMazeGenerators-529"><span class="linenos">529</span></a><span class="sd">		- `grid_shape : Coord | CoordTup`</span>
</span><span id="LatticeMazeGenerators-530"><a href="#LatticeMazeGenerators-530"><span class="linenos">530</span></a><span class="sd">			The shape of the maze grid (e.g., `(n_rows, n_cols)`).</span>
</span><span id="LatticeMazeGenerators-531"><a href="#LatticeMazeGenerators-531"><span class="linenos">531</span></a><span class="sd">		- `lattice_dim : int`</span>
</span><span id="LatticeMazeGenerators-532"><a href="#LatticeMazeGenerators-532"><span class="linenos">532</span></a><span class="sd">			The lattice dimension (default is `2`).</span>
</span><span id="LatticeMazeGenerators-533"><a href="#LatticeMazeGenerators-533"><span class="linenos">533</span></a><span class="sd">		- `start_coord : Coord | None`</span>
</span><span id="LatticeMazeGenerators-534"><a href="#LatticeMazeGenerators-534"><span class="linenos">534</span></a><span class="sd">			Optionally, specify a starting coordinate. If `None`, a random coordinate is chosen.</span>
</span><span id="LatticeMazeGenerators-535"><a href="#LatticeMazeGenerators-535"><span class="linenos">535</span></a><span class="sd">		- `**kwargs`</span>
</span><span id="LatticeMazeGenerators-536"><a href="#LatticeMazeGenerators-536"><span class="linenos">536</span></a><span class="sd">			Additional keyword arguments (currently unused).</span>
</span><span id="LatticeMazeGenerators-537"><a href="#LatticeMazeGenerators-537"><span class="linenos">537</span></a>
</span><span id="LatticeMazeGenerators-538"><a href="#LatticeMazeGenerators-538"><span class="linenos">538</span></a><span class="sd">		# Returns:</span>
</span><span id="LatticeMazeGenerators-539"><a href="#LatticeMazeGenerators-539"><span class="linenos">539</span></a><span class="sd">		- `LatticeMaze`</span>
</span><span id="LatticeMazeGenerators-540"><a href="#LatticeMazeGenerators-540"><span class="linenos">540</span></a><span class="sd">			A maze represented by a connection list, generated using recursive division.</span>
</span><span id="LatticeMazeGenerators-541"><a href="#LatticeMazeGenerators-541"><span class="linenos">541</span></a>
</span><span id="LatticeMazeGenerators-542"><a href="#LatticeMazeGenerators-542"><span class="linenos">542</span></a><span class="sd">		# Usage:</span>
</span><span id="LatticeMazeGenerators-543"><a href="#LatticeMazeGenerators-543"><span class="linenos">543</span></a><span class="sd">		```python</span>
</span><span id="LatticeMazeGenerators-544"><a href="#LatticeMazeGenerators-544"><span class="linenos">544</span></a><span class="sd">		maze = gen_recursive_division((10, 10))</span>
</span><span id="LatticeMazeGenerators-545"><a href="#LatticeMazeGenerators-545"><span class="linenos">545</span></a><span class="sd">		```</span>
</span><span id="LatticeMazeGenerators-546"><a href="#LatticeMazeGenerators-546"><span class="linenos">546</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="LatticeMazeGenerators-547"><a href="#LatticeMazeGenerators-547"><span class="linenos">547</span></a>		<span class="k">assert</span> <span class="n">lattice_dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span>  <span class="c1"># noqa: PLR2004</span>
</span><span id="LatticeMazeGenerators-548"><a href="#LatticeMazeGenerators-548"><span class="linenos">548</span></a>			<span class="s2">&quot;Recursive division algorithm is only implemented for 2D lattices.&quot;</span>
</span><span id="LatticeMazeGenerators-549"><a href="#LatticeMazeGenerators-549"><span class="linenos">549</span></a>		<span class="p">)</span>
</span><span id="LatticeMazeGenerators-550"><a href="#LatticeMazeGenerators-550"><span class="linenos">550</span></a>		<span class="c1"># Convert grid_shape to a tuple of ints.</span>
</span><span id="LatticeMazeGenerators-551"><a href="#LatticeMazeGenerators-551"><span class="linenos">551</span></a>		<span class="n">grid_shape_</span><span class="p">:</span> <span class="n">CoordTup</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">grid_shape</span><span class="p">)</span>  <span class="c1"># type: ignore[assignment]</span>
</span><span id="LatticeMazeGenerators-552"><a href="#LatticeMazeGenerators-552"><span class="linenos">552</span></a>		<span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">grid_shape_</span>
</span><span id="LatticeMazeGenerators-553"><a href="#LatticeMazeGenerators-553"><span class="linenos">553</span></a>
</span><span id="LatticeMazeGenerators-554"><a href="#LatticeMazeGenerators-554"><span class="linenos">554</span></a>		<span class="c1"># Initialize connection_list as a fully connected grid.</span>
</span><span id="LatticeMazeGenerators-555"><a href="#LatticeMazeGenerators-555"><span class="linenos">555</span></a>		<span class="c1"># For horizontal connections: for each cell (i,j) with i in [0, n_rows-2], set connection to True.</span>
</span><span id="LatticeMazeGenerators-556"><a href="#LatticeMazeGenerators-556"><span class="linenos">556</span></a>		<span class="c1"># For vertical connections: for each cell (i,j) with j in [0, n_cols-2], set connection to True.</span>
</span><span id="LatticeMazeGenerators-557"><a href="#LatticeMazeGenerators-557"><span class="linenos">557</span></a>		<span class="n">connection_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-558"><a href="#LatticeMazeGenerators-558"><span class="linenos">558</span></a>		<span class="n">connection_list</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span> <span class="n">n_rows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="LatticeMazeGenerators-559"><a href="#LatticeMazeGenerators-559"><span class="linenos">559</span></a>		<span class="n">connection_list</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:</span> <span class="n">n_cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="LatticeMazeGenerators-560"><a href="#LatticeMazeGenerators-560"><span class="linenos">560</span></a>
</span><span id="LatticeMazeGenerators-561"><a href="#LatticeMazeGenerators-561"><span class="linenos">561</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">divide</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">width</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">height</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators-562"><a href="#LatticeMazeGenerators-562"><span class="linenos">562</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Recursively divide the region starting at (x, y) with the given width and height.</span>
</span><span id="LatticeMazeGenerators-563"><a href="#LatticeMazeGenerators-563"><span class="linenos">563</span></a>
</span><span id="LatticeMazeGenerators-564"><a href="#LatticeMazeGenerators-564"><span class="linenos">564</span></a><span class="sd">			Removes connections along the chosen division line except for one randomly chosen gap.</span>
</span><span id="LatticeMazeGenerators-565"><a href="#LatticeMazeGenerators-565"><span class="linenos">565</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="LatticeMazeGenerators-566"><a href="#LatticeMazeGenerators-566"><span class="linenos">566</span></a>			<span class="k">if</span> <span class="n">width</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">height</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># noqa: PLR2004</span>
</span><span id="LatticeMazeGenerators-567"><a href="#LatticeMazeGenerators-567"><span class="linenos">567</span></a>				<span class="k">return</span>
</span><span id="LatticeMazeGenerators-568"><a href="#LatticeMazeGenerators-568"><span class="linenos">568</span></a>
</span><span id="LatticeMazeGenerators-569"><a href="#LatticeMazeGenerators-569"><span class="linenos">569</span></a>			<span class="k">if</span> <span class="n">width</span> <span class="o">&gt;</span> <span class="n">height</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators-570"><a href="#LatticeMazeGenerators-570"><span class="linenos">570</span></a>				<span class="c1"># Vertical division.</span>
</span><span id="LatticeMazeGenerators-571"><a href="#LatticeMazeGenerators-571"><span class="linenos">571</span></a>				<span class="n">wall_col</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-572"><a href="#LatticeMazeGenerators-572"><span class="linenos">572</span></a>				<span class="n">gap_row</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-573"><a href="#LatticeMazeGenerators-573"><span class="linenos">573</span></a>				<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">height</span><span class="p">):</span>
</span><span id="LatticeMazeGenerators-574"><a href="#LatticeMazeGenerators-574"><span class="linenos">574</span></a>					<span class="k">if</span> <span class="n">row</span> <span class="o">==</span> <span class="n">gap_row</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators-575"><a href="#LatticeMazeGenerators-575"><span class="linenos">575</span></a>						<span class="k">continue</span>
</span><span id="LatticeMazeGenerators-576"><a href="#LatticeMazeGenerators-576"><span class="linenos">576</span></a>					<span class="c1"># Remove the vertical connection between (row, wall_col-1) and (row, wall_col).</span>
</span><span id="LatticeMazeGenerators-577"><a href="#LatticeMazeGenerators-577"><span class="linenos">577</span></a>					<span class="k">if</span> <span class="n">wall_col</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">n_cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators-578"><a href="#LatticeMazeGenerators-578"><span class="linenos">578</span></a>						<span class="n">connection_list</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">wall_col</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="LatticeMazeGenerators-579"><a href="#LatticeMazeGenerators-579"><span class="linenos">579</span></a>				<span class="c1"># Recurse on the left and right subregions.</span>
</span><span id="LatticeMazeGenerators-580"><a href="#LatticeMazeGenerators-580"><span class="linenos">580</span></a>				<span class="n">divide</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">wall_col</span> <span class="o">-</span> <span class="n">x</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-581"><a href="#LatticeMazeGenerators-581"><span class="linenos">581</span></a>				<span class="n">divide</span><span class="p">(</span><span class="n">wall_col</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">width</span> <span class="o">-</span> <span class="n">wall_col</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-582"><a href="#LatticeMazeGenerators-582"><span class="linenos">582</span></a>			<span class="k">else</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators-583"><a href="#LatticeMazeGenerators-583"><span class="linenos">583</span></a>				<span class="c1"># Horizontal division.</span>
</span><span id="LatticeMazeGenerators-584"><a href="#LatticeMazeGenerators-584"><span class="linenos">584</span></a>				<span class="n">wall_row</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-585"><a href="#LatticeMazeGenerators-585"><span class="linenos">585</span></a>				<span class="n">gap_col</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-586"><a href="#LatticeMazeGenerators-586"><span class="linenos">586</span></a>				<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">width</span><span class="p">):</span>
</span><span id="LatticeMazeGenerators-587"><a href="#LatticeMazeGenerators-587"><span class="linenos">587</span></a>					<span class="k">if</span> <span class="n">col</span> <span class="o">==</span> <span class="n">gap_col</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators-588"><a href="#LatticeMazeGenerators-588"><span class="linenos">588</span></a>						<span class="k">continue</span>
</span><span id="LatticeMazeGenerators-589"><a href="#LatticeMazeGenerators-589"><span class="linenos">589</span></a>					<span class="c1"># Remove the horizontal connection between (wall_row-1, col) and (wall_row, col).</span>
</span><span id="LatticeMazeGenerators-590"><a href="#LatticeMazeGenerators-590"><span class="linenos">590</span></a>					<span class="k">if</span> <span class="n">wall_row</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">n_rows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators-591"><a href="#LatticeMazeGenerators-591"><span class="linenos">591</span></a>						<span class="n">connection_list</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">wall_row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="LatticeMazeGenerators-592"><a href="#LatticeMazeGenerators-592"><span class="linenos">592</span></a>				<span class="c1"># Recurse on the top and bottom subregions.</span>
</span><span id="LatticeMazeGenerators-593"><a href="#LatticeMazeGenerators-593"><span class="linenos">593</span></a>				<span class="n">divide</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">wall_row</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-594"><a href="#LatticeMazeGenerators-594"><span class="linenos">594</span></a>				<span class="n">divide</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">wall_row</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">height</span> <span class="o">-</span> <span class="n">wall_row</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-595"><a href="#LatticeMazeGenerators-595"><span class="linenos">595</span></a>
</span><span id="LatticeMazeGenerators-596"><a href="#LatticeMazeGenerators-596"><span class="linenos">596</span></a>		<span class="c1"># Begin the division on the full grid.</span>
</span><span id="LatticeMazeGenerators-597"><a href="#LatticeMazeGenerators-597"><span class="linenos">597</span></a>		<span class="n">divide</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators-598"><a href="#LatticeMazeGenerators-598"><span class="linenos">598</span></a>
</span><span id="LatticeMazeGenerators-599"><a href="#LatticeMazeGenerators-599"><span class="linenos">599</span></a>		<span class="k">if</span> <span class="n">start_coord</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators-600"><a href="#LatticeMazeGenerators-600"><span class="linenos">600</span></a>			<span class="n">start_coord</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">grid_shape_</span><span class="p">)</span>  <span class="c1"># type: ignore[assignment]</span>
</span><span id="LatticeMazeGenerators-601"><a href="#LatticeMazeGenerators-601"><span class="linenos">601</span></a>
</span><span id="LatticeMazeGenerators-602"><a href="#LatticeMazeGenerators-602"><span class="linenos">602</span></a>		<span class="n">generation_meta</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators-603"><a href="#LatticeMazeGenerators-603"><span class="linenos">603</span></a>			<span class="n">func_name</span><span class="o">=</span><span class="s2">&quot;gen_recursive_division&quot;</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-604"><a href="#LatticeMazeGenerators-604"><span class="linenos">604</span></a>			<span class="n">grid_shape</span><span class="o">=</span><span class="n">grid_shape_</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-605"><a href="#LatticeMazeGenerators-605"><span class="linenos">605</span></a>			<span class="n">start_coord</span><span class="o">=</span><span class="n">start_coord</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-606"><a href="#LatticeMazeGenerators-606"><span class="linenos">606</span></a>			<span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;recursive_division&quot;</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-607"><a href="#LatticeMazeGenerators-607"><span class="linenos">607</span></a>			<span class="n">fully_connected</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators-608"><a href="#LatticeMazeGenerators-608"><span class="linenos">608</span></a>		<span class="p">)</span>
</span><span id="LatticeMazeGenerators-609"><a href="#LatticeMazeGenerators-609"><span class="linenos">609</span></a>		<span class="k">return</span> <span class="n">LatticeMaze</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators-610"><a href="#LatticeMazeGenerators-610"><span class="linenos">610</span></a>			<span class="n">connection_list</span><span class="o">=</span><span class="n">connection_list</span><span class="p">,</span> <span class="n">generation_meta</span><span class="o">=</span><span class="n">generation_meta</span>
</span><span id="LatticeMazeGenerators-611"><a href="#LatticeMazeGenerators-611"><span class="linenos">611</span></a>		<span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>namespace for lattice maze generation algorithms</p>

<p>examples of generated mazes can be found here:
<a href="https://understanding-search.github.io/maze-dataset/examples/maze_examples.html">https://understanding-search.github.io/maze-dataset/examples/maze_examples.html</a></p>
</div>


                            <div id="LatticeMazeGenerators.gen_dfs" class="classattr">
                                        <input id="LatticeMazeGenerators.gen_dfs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">gen_dfs</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">grid_shape</span><span class="p">:</span> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">Int8</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="s1">&#39;row_col=2&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">lattice_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>,</span><span class="param">	<span class="n">accessible_cells</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">max_tree_depth</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">do_forks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">randomized_stack</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">start_coord</span><span class="p">:</span> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">Int8</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="s1">&#39;row_col=2&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="../../maze_dataset.html#LatticeMaze">maze_dataset.LatticeMaze</a></span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="LatticeMazeGenerators.gen_dfs-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/generation/generators.py#L60-L206" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#LatticeMazeGenerators.gen_dfs"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LatticeMazeGenerators.gen_dfs-61"><a href="#LatticeMazeGenerators.gen_dfs-61"><span class="linenos"> 61</span></a>	<span class="nd">@staticmethod</span>
</span><span id="LatticeMazeGenerators.gen_dfs-62"><a href="#LatticeMazeGenerators.gen_dfs-62"><span class="linenos"> 62</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">gen_dfs</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators.gen_dfs-63"><a href="#LatticeMazeGenerators.gen_dfs-63"><span class="linenos"> 63</span></a>		<span class="n">grid_shape</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_dfs-64"><a href="#LatticeMazeGenerators.gen_dfs-64"><span class="linenos"> 64</span></a>		<span class="o">*</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_dfs-65"><a href="#LatticeMazeGenerators.gen_dfs-65"><span class="linenos"> 65</span></a>		<span class="n">lattice_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_dfs-66"><a href="#LatticeMazeGenerators.gen_dfs-66"><span class="linenos"> 66</span></a>		<span class="n">accessible_cells</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_dfs-67"><a href="#LatticeMazeGenerators.gen_dfs-67"><span class="linenos"> 67</span></a>		<span class="n">max_tree_depth</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_dfs-68"><a href="#LatticeMazeGenerators.gen_dfs-68"><span class="linenos"> 68</span></a>		<span class="n">do_forks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_dfs-69"><a href="#LatticeMazeGenerators.gen_dfs-69"><span class="linenos"> 69</span></a>		<span class="n">randomized_stack</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_dfs-70"><a href="#LatticeMazeGenerators.gen_dfs-70"><span class="linenos"> 70</span></a>		<span class="n">start_coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_dfs-71"><a href="#LatticeMazeGenerators.gen_dfs-71"><span class="linenos"> 71</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LatticeMaze</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators.gen_dfs-72"><a href="#LatticeMazeGenerators.gen_dfs-72"><span class="linenos"> 72</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;generate a lattice maze using depth first search, iterative</span>
</span><span id="LatticeMazeGenerators.gen_dfs-73"><a href="#LatticeMazeGenerators.gen_dfs-73"><span class="linenos"> 73</span></a>
</span><span id="LatticeMazeGenerators.gen_dfs-74"><a href="#LatticeMazeGenerators.gen_dfs-74"><span class="linenos"> 74</span></a><span class="sd">		# Arguments</span>
</span><span id="LatticeMazeGenerators.gen_dfs-75"><a href="#LatticeMazeGenerators.gen_dfs-75"><span class="linenos"> 75</span></a><span class="sd">		- `grid_shape: Coord`: the shape of the grid</span>
</span><span id="LatticeMazeGenerators.gen_dfs-76"><a href="#LatticeMazeGenerators.gen_dfs-76"><span class="linenos"> 76</span></a><span class="sd">		- `lattice_dim: int`: the dimension of the lattice</span>
</span><span id="LatticeMazeGenerators.gen_dfs-77"><a href="#LatticeMazeGenerators.gen_dfs-77"><span class="linenos"> 77</span></a><span class="sd">			(default: `2`)</span>
</span><span id="LatticeMazeGenerators.gen_dfs-78"><a href="#LatticeMazeGenerators.gen_dfs-78"><span class="linenos"> 78</span></a><span class="sd">		- `accessible_cells: int | float |None`: the number of accessible cells in the maze. If `None`, defaults to the total number of cells in the grid. if a float, asserts it is &lt;= 1 and treats it as a proportion of **total cells**</span>
</span><span id="LatticeMazeGenerators.gen_dfs-79"><a href="#LatticeMazeGenerators.gen_dfs-79"><span class="linenos"> 79</span></a><span class="sd">			(default: `None`)</span>
</span><span id="LatticeMazeGenerators.gen_dfs-80"><a href="#LatticeMazeGenerators.gen_dfs-80"><span class="linenos"> 80</span></a><span class="sd">		- `max_tree_depth: int | float | None`: the maximum depth of the tree. If `None`, defaults to `2 * accessible_cells`. if a float, asserts it is &lt;= 1 and treats it as a proportion of the **sum of the grid shape**</span>
</span><span id="LatticeMazeGenerators.gen_dfs-81"><a href="#LatticeMazeGenerators.gen_dfs-81"><span class="linenos"> 81</span></a><span class="sd">			(default: `None`)</span>
</span><span id="LatticeMazeGenerators.gen_dfs-82"><a href="#LatticeMazeGenerators.gen_dfs-82"><span class="linenos"> 82</span></a><span class="sd">		- `do_forks: bool`: whether to allow forks in the maze. If `False`, the maze will be have no forks and will be a simple hallway.</span>
</span><span id="LatticeMazeGenerators.gen_dfs-83"><a href="#LatticeMazeGenerators.gen_dfs-83"><span class="linenos"> 83</span></a><span class="sd">		- `start_coord: Coord | None`: the starting coordinate of the generation algorithm. If `None`, defaults to a random coordinate.</span>
</span><span id="LatticeMazeGenerators.gen_dfs-84"><a href="#LatticeMazeGenerators.gen_dfs-84"><span class="linenos"> 84</span></a>
</span><span id="LatticeMazeGenerators.gen_dfs-85"><a href="#LatticeMazeGenerators.gen_dfs-85"><span class="linenos"> 85</span></a><span class="sd">		# algorithm</span>
</span><span id="LatticeMazeGenerators.gen_dfs-86"><a href="#LatticeMazeGenerators.gen_dfs-86"><span class="linenos"> 86</span></a><span class="sd">		1. Choose the initial cell, mark it as visited and push it to the stack</span>
</span><span id="LatticeMazeGenerators.gen_dfs-87"><a href="#LatticeMazeGenerators.gen_dfs-87"><span class="linenos"> 87</span></a><span class="sd">		2. While the stack is not empty</span>
</span><span id="LatticeMazeGenerators.gen_dfs-88"><a href="#LatticeMazeGenerators.gen_dfs-88"><span class="linenos"> 88</span></a><span class="sd">			1. Pop a cell from the stack and make it a current cell</span>
</span><span id="LatticeMazeGenerators.gen_dfs-89"><a href="#LatticeMazeGenerators.gen_dfs-89"><span class="linenos"> 89</span></a><span class="sd">			2. If the current cell has any neighbours which have not been visited</span>
</span><span id="LatticeMazeGenerators.gen_dfs-90"><a href="#LatticeMazeGenerators.gen_dfs-90"><span class="linenos"> 90</span></a><span class="sd">				1. Push the current cell to the stack</span>
</span><span id="LatticeMazeGenerators.gen_dfs-91"><a href="#LatticeMazeGenerators.gen_dfs-91"><span class="linenos"> 91</span></a><span class="sd">				2. Choose one of the unvisited neighbours</span>
</span><span id="LatticeMazeGenerators.gen_dfs-92"><a href="#LatticeMazeGenerators.gen_dfs-92"><span class="linenos"> 92</span></a><span class="sd">				3. Remove the wall between the current cell and the chosen cell</span>
</span><span id="LatticeMazeGenerators.gen_dfs-93"><a href="#LatticeMazeGenerators.gen_dfs-93"><span class="linenos"> 93</span></a><span class="sd">				4. Mark the chosen cell as visited and push it to the stack</span>
</span><span id="LatticeMazeGenerators.gen_dfs-94"><a href="#LatticeMazeGenerators.gen_dfs-94"><span class="linenos"> 94</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="LatticeMazeGenerators.gen_dfs-95"><a href="#LatticeMazeGenerators.gen_dfs-95"><span class="linenos"> 95</span></a>		<span class="c1"># Default values if no constraints have been passed</span>
</span><span id="LatticeMazeGenerators.gen_dfs-96"><a href="#LatticeMazeGenerators.gen_dfs-96"><span class="linenos"> 96</span></a>		<span class="n">grid_shape_</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grid_shape</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_dfs-97"><a href="#LatticeMazeGenerators.gen_dfs-97"><span class="linenos"> 97</span></a>		<span class="n">n_total_cells</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">grid_shape_</span><span class="p">))</span>
</span><span id="LatticeMazeGenerators.gen_dfs-98"><a href="#LatticeMazeGenerators.gen_dfs-98"><span class="linenos"> 98</span></a>
</span><span id="LatticeMazeGenerators.gen_dfs-99"><a href="#LatticeMazeGenerators.gen_dfs-99"><span class="linenos"> 99</span></a>		<span class="n">n_accessible_cells</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="LatticeMazeGenerators.gen_dfs-100"><a href="#LatticeMazeGenerators.gen_dfs-100"><span class="linenos">100</span></a>		<span class="k">if</span> <span class="n">accessible_cells</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators.gen_dfs-101"><a href="#LatticeMazeGenerators.gen_dfs-101"><span class="linenos">101</span></a>			<span class="n">n_accessible_cells</span> <span class="o">=</span> <span class="n">n_total_cells</span>
</span><span id="LatticeMazeGenerators.gen_dfs-102"><a href="#LatticeMazeGenerators.gen_dfs-102"><span class="linenos">102</span></a>		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">accessible_cells</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="LatticeMazeGenerators.gen_dfs-103"><a href="#LatticeMazeGenerators.gen_dfs-103"><span class="linenos">103</span></a>			<span class="k">assert</span> <span class="n">accessible_cells</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span>
</span><span id="LatticeMazeGenerators.gen_dfs-104"><a href="#LatticeMazeGenerators.gen_dfs-104"><span class="linenos">104</span></a>				<span class="sa">f</span><span class="s2">&quot;accessible_cells must be an int (count) or a float in the range [0, 1] (proportion), got </span><span class="si">{</span><span class="n">accessible_cells</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="LatticeMazeGenerators.gen_dfs-105"><a href="#LatticeMazeGenerators.gen_dfs-105"><span class="linenos">105</span></a>			<span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_dfs-106"><a href="#LatticeMazeGenerators.gen_dfs-106"><span class="linenos">106</span></a>
</span><span id="LatticeMazeGenerators.gen_dfs-107"><a href="#LatticeMazeGenerators.gen_dfs-107"><span class="linenos">107</span></a>			<span class="n">n_accessible_cells</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">accessible_cells</span> <span class="o">*</span> <span class="n">n_total_cells</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_dfs-108"><a href="#LatticeMazeGenerators.gen_dfs-108"><span class="linenos">108</span></a>		<span class="k">else</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators.gen_dfs-109"><a href="#LatticeMazeGenerators.gen_dfs-109"><span class="linenos">109</span></a>			<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">accessible_cells</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_dfs-110"><a href="#LatticeMazeGenerators.gen_dfs-110"><span class="linenos">110</span></a>			<span class="n">n_accessible_cells</span> <span class="o">=</span> <span class="n">accessible_cells</span>
</span><span id="LatticeMazeGenerators.gen_dfs-111"><a href="#LatticeMazeGenerators.gen_dfs-111"><span class="linenos">111</span></a>
</span><span id="LatticeMazeGenerators.gen_dfs-112"><a href="#LatticeMazeGenerators.gen_dfs-112"><span class="linenos">112</span></a>		<span class="k">if</span> <span class="n">max_tree_depth</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators.gen_dfs-113"><a href="#LatticeMazeGenerators.gen_dfs-113"><span class="linenos">113</span></a>			<span class="n">max_tree_depth</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LatticeMazeGenerators.gen_dfs-114"><a href="#LatticeMazeGenerators.gen_dfs-114"><span class="linenos">114</span></a>				<span class="mi">2</span> <span class="o">*</span> <span class="n">n_total_cells</span>
</span><span id="LatticeMazeGenerators.gen_dfs-115"><a href="#LatticeMazeGenerators.gen_dfs-115"><span class="linenos">115</span></a>			<span class="p">)</span>  <span class="c1"># We define max tree depth counting from the start coord in two directions. Therefore we divide by two in the if clause for neighboring sites later and multiply by two here.</span>
</span><span id="LatticeMazeGenerators.gen_dfs-116"><a href="#LatticeMazeGenerators.gen_dfs-116"><span class="linenos">116</span></a>		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">max_tree_depth</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="LatticeMazeGenerators.gen_dfs-117"><a href="#LatticeMazeGenerators.gen_dfs-117"><span class="linenos">117</span></a>			<span class="k">assert</span> <span class="n">max_tree_depth</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span>
</span><span id="LatticeMazeGenerators.gen_dfs-118"><a href="#LatticeMazeGenerators.gen_dfs-118"><span class="linenos">118</span></a>				<span class="sa">f</span><span class="s2">&quot;max_tree_depth must be an int (count) or a float in the range [0, 1] (proportion), got </span><span class="si">{</span><span class="n">max_tree_depth</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="LatticeMazeGenerators.gen_dfs-119"><a href="#LatticeMazeGenerators.gen_dfs-119"><span class="linenos">119</span></a>			<span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_dfs-120"><a href="#LatticeMazeGenerators.gen_dfs-120"><span class="linenos">120</span></a>
</span><span id="LatticeMazeGenerators.gen_dfs-121"><a href="#LatticeMazeGenerators.gen_dfs-121"><span class="linenos">121</span></a>			<span class="n">max_tree_depth</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">max_tree_depth</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">grid_shape_</span><span class="p">))</span>
</span><span id="LatticeMazeGenerators.gen_dfs-122"><a href="#LatticeMazeGenerators.gen_dfs-122"><span class="linenos">122</span></a>
</span><span id="LatticeMazeGenerators.gen_dfs-123"><a href="#LatticeMazeGenerators.gen_dfs-123"><span class="linenos">123</span></a>		<span class="c1"># choose a random start coord</span>
</span><span id="LatticeMazeGenerators.gen_dfs-124"><a href="#LatticeMazeGenerators.gen_dfs-124"><span class="linenos">124</span></a>		<span class="n">start_coord</span> <span class="o">=</span> <span class="n">_random_start_coord</span><span class="p">(</span><span class="n">grid_shape_</span><span class="p">,</span> <span class="n">start_coord</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_dfs-125"><a href="#LatticeMazeGenerators.gen_dfs-125"><span class="linenos">125</span></a>
</span><span id="LatticeMazeGenerators.gen_dfs-126"><a href="#LatticeMazeGenerators.gen_dfs-126"><span class="linenos">126</span></a>		<span class="c1"># initialize the maze with no connections</span>
</span><span id="LatticeMazeGenerators.gen_dfs-127"><a href="#LatticeMazeGenerators.gen_dfs-127"><span class="linenos">127</span></a>		<span class="n">connection_list</span><span class="p">:</span> <span class="n">ConnectionList</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators.gen_dfs-128"><a href="#LatticeMazeGenerators.gen_dfs-128"><span class="linenos">128</span></a>			<span class="p">(</span><span class="n">lattice_dim</span><span class="p">,</span> <span class="n">grid_shape_</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">grid_shape_</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
</span><span id="LatticeMazeGenerators.gen_dfs-129"><a href="#LatticeMazeGenerators.gen_dfs-129"><span class="linenos">129</span></a>			<span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_dfs-130"><a href="#LatticeMazeGenerators.gen_dfs-130"><span class="linenos">130</span></a>		<span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_dfs-131"><a href="#LatticeMazeGenerators.gen_dfs-131"><span class="linenos">131</span></a>
</span><span id="LatticeMazeGenerators.gen_dfs-132"><a href="#LatticeMazeGenerators.gen_dfs-132"><span class="linenos">132</span></a>		<span class="c1"># initialize the stack with the target coord</span>
</span><span id="LatticeMazeGenerators.gen_dfs-133"><a href="#LatticeMazeGenerators.gen_dfs-133"><span class="linenos">133</span></a>		<span class="n">visited_cells</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="LatticeMazeGenerators.gen_dfs-134"><a href="#LatticeMazeGenerators.gen_dfs-134"><span class="linenos">134</span></a>		<span class="n">visited_cells</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">start_coord</span><span class="p">))</span>  <span class="c1"># this wasnt a bug after all lol</span>
</span><span id="LatticeMazeGenerators.gen_dfs-135"><a href="#LatticeMazeGenerators.gen_dfs-135"><span class="linenos">135</span></a>		<span class="n">stack</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Coord</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">start_coord</span><span class="p">]</span>
</span><span id="LatticeMazeGenerators.gen_dfs-136"><a href="#LatticeMazeGenerators.gen_dfs-136"><span class="linenos">136</span></a>
</span><span id="LatticeMazeGenerators.gen_dfs-137"><a href="#LatticeMazeGenerators.gen_dfs-137"><span class="linenos">137</span></a>		<span class="c1"># initialize tree_depth_counter</span>
</span><span id="LatticeMazeGenerators.gen_dfs-138"><a href="#LatticeMazeGenerators.gen_dfs-138"><span class="linenos">138</span></a>		<span class="n">current_tree_depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="LatticeMazeGenerators.gen_dfs-139"><a href="#LatticeMazeGenerators.gen_dfs-139"><span class="linenos">139</span></a>
</span><span id="LatticeMazeGenerators.gen_dfs-140"><a href="#LatticeMazeGenerators.gen_dfs-140"><span class="linenos">140</span></a>		<span class="c1"># loop until the stack is empty or n_connected_cells is reached</span>
</span><span id="LatticeMazeGenerators.gen_dfs-141"><a href="#LatticeMazeGenerators.gen_dfs-141"><span class="linenos">141</span></a>		<span class="k">while</span> <span class="n">stack</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">visited_cells</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">n_accessible_cells</span><span class="p">):</span>
</span><span id="LatticeMazeGenerators.gen_dfs-142"><a href="#LatticeMazeGenerators.gen_dfs-142"><span class="linenos">142</span></a>			<span class="c1"># get the current coord from the stack</span>
</span><span id="LatticeMazeGenerators.gen_dfs-143"><a href="#LatticeMazeGenerators.gen_dfs-143"><span class="linenos">143</span></a>			<span class="n">current_coord</span><span class="p">:</span> <span class="n">Coord</span>
</span><span id="LatticeMazeGenerators.gen_dfs-144"><a href="#LatticeMazeGenerators.gen_dfs-144"><span class="linenos">144</span></a>			<span class="k">if</span> <span class="n">randomized_stack</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators.gen_dfs-145"><a href="#LatticeMazeGenerators.gen_dfs-145"><span class="linenos">145</span></a>				<span class="n">current_coord</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">stack</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="LatticeMazeGenerators.gen_dfs-146"><a href="#LatticeMazeGenerators.gen_dfs-146"><span class="linenos">146</span></a>			<span class="k">else</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators.gen_dfs-147"><a href="#LatticeMazeGenerators.gen_dfs-147"><span class="linenos">147</span></a>				<span class="n">current_coord</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</span><span id="LatticeMazeGenerators.gen_dfs-148"><a href="#LatticeMazeGenerators.gen_dfs-148"><span class="linenos">148</span></a>
</span><span id="LatticeMazeGenerators.gen_dfs-149"><a href="#LatticeMazeGenerators.gen_dfs-149"><span class="linenos">149</span></a>			<span class="c1"># filter neighbors by being within grid bounds and being unvisited</span>
</span><span id="LatticeMazeGenerators.gen_dfs-150"><a href="#LatticeMazeGenerators.gen_dfs-150"><span class="linenos">150</span></a>			<span class="n">unvisited_neighbors_deltas</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Coord</span><span class="p">,</span> <span class="n">Coord</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="LatticeMazeGenerators.gen_dfs-151"><a href="#LatticeMazeGenerators.gen_dfs-151"><span class="linenos">151</span></a>				<span class="p">(</span><span class="n">neighbor</span><span class="p">,</span> <span class="n">delta</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_dfs-152"><a href="#LatticeMazeGenerators.gen_dfs-152"><span class="linenos">152</span></a>				<span class="k">for</span> <span class="n">neighbor</span><span class="p">,</span> <span class="n">delta</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators.gen_dfs-153"><a href="#LatticeMazeGenerators.gen_dfs-153"><span class="linenos">153</span></a>					<span class="n">current_coord</span> <span class="o">+</span> <span class="n">NEIGHBORS_MASK</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_dfs-154"><a href="#LatticeMazeGenerators.gen_dfs-154"><span class="linenos">154</span></a>					<span class="n">NEIGHBORS_MASK</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_dfs-155"><a href="#LatticeMazeGenerators.gen_dfs-155"><span class="linenos">155</span></a>					<span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_dfs-156"><a href="#LatticeMazeGenerators.gen_dfs-156"><span class="linenos">156</span></a>				<span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_dfs-157"><a href="#LatticeMazeGenerators.gen_dfs-157"><span class="linenos">157</span></a>				<span class="k">if</span> <span class="p">(</span>
</span><span id="LatticeMazeGenerators.gen_dfs-158"><a href="#LatticeMazeGenerators.gen_dfs-158"><span class="linenos">158</span></a>					<span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">neighbor</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited_cells</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_dfs-159"><a href="#LatticeMazeGenerators.gen_dfs-159"><span class="linenos">159</span></a>					<span class="ow">and</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">neighbor</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">grid_shape_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="LatticeMazeGenerators.gen_dfs-160"><a href="#LatticeMazeGenerators.gen_dfs-160"><span class="linenos">160</span></a>					<span class="ow">and</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">neighbor</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">grid_shape_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="LatticeMazeGenerators.gen_dfs-161"><a href="#LatticeMazeGenerators.gen_dfs-161"><span class="linenos">161</span></a>				<span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_dfs-162"><a href="#LatticeMazeGenerators.gen_dfs-162"><span class="linenos">162</span></a>			<span class="p">]</span>
</span><span id="LatticeMazeGenerators.gen_dfs-163"><a href="#LatticeMazeGenerators.gen_dfs-163"><span class="linenos">163</span></a>
</span><span id="LatticeMazeGenerators.gen_dfs-164"><a href="#LatticeMazeGenerators.gen_dfs-164"><span class="linenos">164</span></a>			<span class="c1"># don&#39;t continue if max_tree_depth/2 is already reached (divide by 2 because we can branch to multiple directions)</span>
</span><span id="LatticeMazeGenerators.gen_dfs-165"><a href="#LatticeMazeGenerators.gen_dfs-165"><span class="linenos">165</span></a>			<span class="k">if</span> <span class="n">unvisited_neighbors_deltas</span> <span class="ow">and</span> <span class="p">(</span>
</span><span id="LatticeMazeGenerators.gen_dfs-166"><a href="#LatticeMazeGenerators.gen_dfs-166"><span class="linenos">166</span></a>				<span class="n">current_tree_depth</span> <span class="o">&lt;=</span> <span class="n">max_tree_depth</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="LatticeMazeGenerators.gen_dfs-167"><a href="#LatticeMazeGenerators.gen_dfs-167"><span class="linenos">167</span></a>			<span class="p">):</span>
</span><span id="LatticeMazeGenerators.gen_dfs-168"><a href="#LatticeMazeGenerators.gen_dfs-168"><span class="linenos">168</span></a>				<span class="c1"># if we want a maze without forks, simply don&#39;t add the current coord back to the stack</span>
</span><span id="LatticeMazeGenerators.gen_dfs-169"><a href="#LatticeMazeGenerators.gen_dfs-169"><span class="linenos">169</span></a>				<span class="k">if</span> <span class="n">do_forks</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">unvisited_neighbors_deltas</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="LatticeMazeGenerators.gen_dfs-170"><a href="#LatticeMazeGenerators.gen_dfs-170"><span class="linenos">170</span></a>					<span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_coord</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_dfs-171"><a href="#LatticeMazeGenerators.gen_dfs-171"><span class="linenos">171</span></a>
</span><span id="LatticeMazeGenerators.gen_dfs-172"><a href="#LatticeMazeGenerators.gen_dfs-172"><span class="linenos">172</span></a>				<span class="c1"># choose one of the unvisited neighbors</span>
</span><span id="LatticeMazeGenerators.gen_dfs-173"><a href="#LatticeMazeGenerators.gen_dfs-173"><span class="linenos">173</span></a>				<span class="n">chosen_neighbor</span><span class="p">,</span> <span class="n">delta</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">unvisited_neighbors_deltas</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_dfs-174"><a href="#LatticeMazeGenerators.gen_dfs-174"><span class="linenos">174</span></a>
</span><span id="LatticeMazeGenerators.gen_dfs-175"><a href="#LatticeMazeGenerators.gen_dfs-175"><span class="linenos">175</span></a>				<span class="c1"># add connection</span>
</span><span id="LatticeMazeGenerators.gen_dfs-176"><a href="#LatticeMazeGenerators.gen_dfs-176"><span class="linenos">176</span></a>				<span class="n">dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">delta</span><span class="p">)))</span>
</span><span id="LatticeMazeGenerators.gen_dfs-177"><a href="#LatticeMazeGenerators.gen_dfs-177"><span class="linenos">177</span></a>				<span class="c1"># if positive, down/right from current coord</span>
</span><span id="LatticeMazeGenerators.gen_dfs-178"><a href="#LatticeMazeGenerators.gen_dfs-178"><span class="linenos">178</span></a>				<span class="c1"># if negative, up/left from current coord (down/right from neighbor)</span>
</span><span id="LatticeMazeGenerators.gen_dfs-179"><a href="#LatticeMazeGenerators.gen_dfs-179"><span class="linenos">179</span></a>				<span class="n">clist_node</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LatticeMazeGenerators.gen_dfs-180"><a href="#LatticeMazeGenerators.gen_dfs-180"><span class="linenos">180</span></a>					<span class="n">current_coord</span> <span class="k">if</span> <span class="p">(</span><span class="n">delta</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="n">chosen_neighbor</span>
</span><span id="LatticeMazeGenerators.gen_dfs-181"><a href="#LatticeMazeGenerators.gen_dfs-181"><span class="linenos">181</span></a>				<span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_dfs-182"><a href="#LatticeMazeGenerators.gen_dfs-182"><span class="linenos">182</span></a>				<span class="n">connection_list</span><span class="p">[</span><span class="n">dim</span><span class="p">,</span> <span class="n">clist_node</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">clist_node</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="LatticeMazeGenerators.gen_dfs-183"><a href="#LatticeMazeGenerators.gen_dfs-183"><span class="linenos">183</span></a>
</span><span id="LatticeMazeGenerators.gen_dfs-184"><a href="#LatticeMazeGenerators.gen_dfs-184"><span class="linenos">184</span></a>				<span class="c1"># add to visited cells and stack</span>
</span><span id="LatticeMazeGenerators.gen_dfs-185"><a href="#LatticeMazeGenerators.gen_dfs-185"><span class="linenos">185</span></a>				<span class="n">visited_cells</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">chosen_neighbor</span><span class="p">))</span>
</span><span id="LatticeMazeGenerators.gen_dfs-186"><a href="#LatticeMazeGenerators.gen_dfs-186"><span class="linenos">186</span></a>				<span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chosen_neighbor</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_dfs-187"><a href="#LatticeMazeGenerators.gen_dfs-187"><span class="linenos">187</span></a>
</span><span id="LatticeMazeGenerators.gen_dfs-188"><a href="#LatticeMazeGenerators.gen_dfs-188"><span class="linenos">188</span></a>				<span class="c1"># Update current tree depth</span>
</span><span id="LatticeMazeGenerators.gen_dfs-189"><a href="#LatticeMazeGenerators.gen_dfs-189"><span class="linenos">189</span></a>				<span class="n">current_tree_depth</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="LatticeMazeGenerators.gen_dfs-190"><a href="#LatticeMazeGenerators.gen_dfs-190"><span class="linenos">190</span></a>			<span class="k">else</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators.gen_dfs-191"><a href="#LatticeMazeGenerators.gen_dfs-191"><span class="linenos">191</span></a>				<span class="n">current_tree_depth</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="LatticeMazeGenerators.gen_dfs-192"><a href="#LatticeMazeGenerators.gen_dfs-192"><span class="linenos">192</span></a>
</span><span id="LatticeMazeGenerators.gen_dfs-193"><a href="#LatticeMazeGenerators.gen_dfs-193"><span class="linenos">193</span></a>		<span class="k">return</span> <span class="n">LatticeMaze</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators.gen_dfs-194"><a href="#LatticeMazeGenerators.gen_dfs-194"><span class="linenos">194</span></a>			<span class="n">connection_list</span><span class="o">=</span><span class="n">connection_list</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_dfs-195"><a href="#LatticeMazeGenerators.gen_dfs-195"><span class="linenos">195</span></a>			<span class="n">generation_meta</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators.gen_dfs-196"><a href="#LatticeMazeGenerators.gen_dfs-196"><span class="linenos">196</span></a>				<span class="n">func_name</span><span class="o">=</span><span class="s2">&quot;gen_dfs&quot;</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_dfs-197"><a href="#LatticeMazeGenerators.gen_dfs-197"><span class="linenos">197</span></a>				<span class="n">grid_shape</span><span class="o">=</span><span class="n">grid_shape_</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_dfs-198"><a href="#LatticeMazeGenerators.gen_dfs-198"><span class="linenos">198</span></a>				<span class="n">start_coord</span><span class="o">=</span><span class="n">start_coord</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_dfs-199"><a href="#LatticeMazeGenerators.gen_dfs-199"><span class="linenos">199</span></a>				<span class="n">n_accessible_cells</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">n_accessible_cells</span><span class="p">),</span>
</span><span id="LatticeMazeGenerators.gen_dfs-200"><a href="#LatticeMazeGenerators.gen_dfs-200"><span class="linenos">200</span></a>				<span class="n">max_tree_depth</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">max_tree_depth</span><span class="p">),</span>
</span><span id="LatticeMazeGenerators.gen_dfs-201"><a href="#LatticeMazeGenerators.gen_dfs-201"><span class="linenos">201</span></a>				<span class="c1"># oh my god this took so long to track down. its almost 5am and I&#39;ve spent like 2 hours on this bug</span>
</span><span id="LatticeMazeGenerators.gen_dfs-202"><a href="#LatticeMazeGenerators.gen_dfs-202"><span class="linenos">202</span></a>				<span class="c1"># it was checking that len(visited_cells) == n_accessible_cells, but this means that the maze is</span>
</span><span id="LatticeMazeGenerators.gen_dfs-203"><a href="#LatticeMazeGenerators.gen_dfs-203"><span class="linenos">203</span></a>				<span class="c1"># treated as fully connected even when it is most certainly not, causing solving the maze to break</span>
</span><span id="LatticeMazeGenerators.gen_dfs-204"><a href="#LatticeMazeGenerators.gen_dfs-204"><span class="linenos">204</span></a>				<span class="n">fully_connected</span><span class="o">=</span><span class="nb">bool</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">visited_cells</span><span class="p">)</span> <span class="o">==</span> <span class="n">n_total_cells</span><span class="p">),</span>
</span><span id="LatticeMazeGenerators.gen_dfs-205"><a href="#LatticeMazeGenerators.gen_dfs-205"><span class="linenos">205</span></a>				<span class="n">visited_cells</span><span class="o">=</span><span class="p">{</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">coord</span><span class="p">)</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">visited_cells</span><span class="p">},</span>
</span><span id="LatticeMazeGenerators.gen_dfs-206"><a href="#LatticeMazeGenerators.gen_dfs-206"><span class="linenos">206</span></a>			<span class="p">),</span>
</span><span id="LatticeMazeGenerators.gen_dfs-207"><a href="#LatticeMazeGenerators.gen_dfs-207"><span class="linenos">207</span></a>		<span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>generate a lattice maze using depth first search, iterative</p>

<h1 id="arguments">Arguments</h1>

<ul>
<li><code>grid_shape: Coord</code>: the shape of the grid</li>
<li><code>lattice_dim: int</code>: the dimension of the lattice
(default: <code>2</code>)</li>
<li><code>accessible_cells: int | float |None</code>: the number of accessible cells in the maze. If <code>None</code>, defaults to the total number of cells in the grid. if a float, asserts it is &lt;= 1 and treats it as a proportion of <strong>total cells</strong>
(default: <code>None</code>)</li>
<li><code>max_tree_depth: int | float | None</code>: the maximum depth of the tree. If <code>None</code>, defaults to <code>2 * accessible_cells</code>. if a float, asserts it is &lt;= 1 and treats it as a proportion of the <strong>sum of the grid shape</strong>
(default: <code>None</code>)</li>
<li><code>do_forks: bool</code>: whether to allow forks in the maze. If <code>False</code>, the maze will be have no forks and will be a simple hallway.</li>
<li><code>start_coord: Coord | None</code>: the starting coordinate of the generation algorithm. If <code>None</code>, defaults to a random coordinate.</li>
</ul>

<h1 id="algorithm">algorithm</h1>

<ol>
<li>Choose the initial cell, mark it as visited and push it to the stack</li>
<li>While the stack is not empty
<ol>
<li>Pop a cell from the stack and make it a current cell</li>
<li>If the current cell has any neighbours which have not been visited
<ol>
<li>Push the current cell to the stack</li>
<li>Choose one of the unvisited neighbours</li>
<li>Remove the wall between the current cell and the chosen cell</li>
<li>Mark the chosen cell as visited and push it to the stack</li>
</ol></li>
</ol></li>
</ol>
</div>


                            </div>
                            <div id="LatticeMazeGenerators.gen_prim" class="classattr">
                                        <input id="LatticeMazeGenerators.gen_prim-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">gen_prim</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">grid_shape</span><span class="p">:</span> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">Int8</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="s1">&#39;row_col=2&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>,</span><span class="param">	<span class="n">lattice_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>,</span><span class="param">	<span class="n">accessible_cells</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">max_tree_depth</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">do_forks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">start_coord</span><span class="p">:</span> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">Int8</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="s1">&#39;row_col=2&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="../../maze_dataset.html#LatticeMaze">maze_dataset.LatticeMaze</a></span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="LatticeMazeGenerators.gen_prim-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/generation/generators.py#L208-L229" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#LatticeMazeGenerators.gen_prim"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LatticeMazeGenerators.gen_prim-209"><a href="#LatticeMazeGenerators.gen_prim-209"><span class="linenos">209</span></a>	<span class="nd">@staticmethod</span>
</span><span id="LatticeMazeGenerators.gen_prim-210"><a href="#LatticeMazeGenerators.gen_prim-210"><span class="linenos">210</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">gen_prim</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators.gen_prim-211"><a href="#LatticeMazeGenerators.gen_prim-211"><span class="linenos">211</span></a>		<span class="n">grid_shape</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_prim-212"><a href="#LatticeMazeGenerators.gen_prim-212"><span class="linenos">212</span></a>		<span class="n">lattice_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_prim-213"><a href="#LatticeMazeGenerators.gen_prim-213"><span class="linenos">213</span></a>		<span class="n">accessible_cells</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_prim-214"><a href="#LatticeMazeGenerators.gen_prim-214"><span class="linenos">214</span></a>		<span class="n">max_tree_depth</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_prim-215"><a href="#LatticeMazeGenerators.gen_prim-215"><span class="linenos">215</span></a>		<span class="n">do_forks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_prim-216"><a href="#LatticeMazeGenerators.gen_prim-216"><span class="linenos">216</span></a>		<span class="n">start_coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_prim-217"><a href="#LatticeMazeGenerators.gen_prim-217"><span class="linenos">217</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LatticeMaze</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators.gen_prim-218"><a href="#LatticeMazeGenerators.gen_prim-218"><span class="linenos">218</span></a>		<span class="s2">&quot;(broken!) generate a lattice maze using Prim&#39;s algorithm&quot;</span>
</span><span id="LatticeMazeGenerators.gen_prim-219"><a href="#LatticeMazeGenerators.gen_prim-219"><span class="linenos">219</span></a>		<span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators.gen_prim-220"><a href="#LatticeMazeGenerators.gen_prim-220"><span class="linenos">220</span></a>			<span class="s2">&quot;gen_prim does not correctly implement prim&#39;s algorithm, see issue: https://github.com/understanding-search/maze-dataset/issues/12&quot;</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_prim-221"><a href="#LatticeMazeGenerators.gen_prim-221"><span class="linenos">221</span></a>		<span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_prim-222"><a href="#LatticeMazeGenerators.gen_prim-222"><span class="linenos">222</span></a>		<span class="k">return</span> <span class="n">LatticeMazeGenerators</span><span class="o">.</span><span class="n">gen_dfs</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators.gen_prim-223"><a href="#LatticeMazeGenerators.gen_prim-223"><span class="linenos">223</span></a>			<span class="n">grid_shape</span><span class="o">=</span><span class="n">grid_shape</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_prim-224"><a href="#LatticeMazeGenerators.gen_prim-224"><span class="linenos">224</span></a>			<span class="n">lattice_dim</span><span class="o">=</span><span class="n">lattice_dim</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_prim-225"><a href="#LatticeMazeGenerators.gen_prim-225"><span class="linenos">225</span></a>			<span class="n">accessible_cells</span><span class="o">=</span><span class="n">accessible_cells</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_prim-226"><a href="#LatticeMazeGenerators.gen_prim-226"><span class="linenos">226</span></a>			<span class="n">max_tree_depth</span><span class="o">=</span><span class="n">max_tree_depth</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_prim-227"><a href="#LatticeMazeGenerators.gen_prim-227"><span class="linenos">227</span></a>			<span class="n">do_forks</span><span class="o">=</span><span class="n">do_forks</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_prim-228"><a href="#LatticeMazeGenerators.gen_prim-228"><span class="linenos">228</span></a>			<span class="n">start_coord</span><span class="o">=</span><span class="n">start_coord</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_prim-229"><a href="#LatticeMazeGenerators.gen_prim-229"><span class="linenos">229</span></a>			<span class="n">randomized_stack</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_prim-230"><a href="#LatticeMazeGenerators.gen_prim-230"><span class="linenos">230</span></a>		<span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>(broken!) generate a lattice maze using Prim's algorithm</p>
</div>


                            </div>
                            <div id="LatticeMazeGenerators.gen_wilson" class="classattr">
                                        <input id="LatticeMazeGenerators.gen_wilson-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">gen_wilson</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">grid_shape</span><span class="p">:</span> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">Int8</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="s1">&#39;row_col=2&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="n"><a href="../../maze_dataset.html#LatticeMaze">maze_dataset.LatticeMaze</a></span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="LatticeMazeGenerators.gen_wilson-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/generation/generators.py#L231-L318" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#LatticeMazeGenerators.gen_wilson"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LatticeMazeGenerators.gen_wilson-232"><a href="#LatticeMazeGenerators.gen_wilson-232"><span class="linenos">232</span></a>	<span class="nd">@staticmethod</span>
</span><span id="LatticeMazeGenerators.gen_wilson-233"><a href="#LatticeMazeGenerators.gen_wilson-233"><span class="linenos">233</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">gen_wilson</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators.gen_wilson-234"><a href="#LatticeMazeGenerators.gen_wilson-234"><span class="linenos">234</span></a>		<span class="n">grid_shape</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_wilson-235"><a href="#LatticeMazeGenerators.gen_wilson-235"><span class="linenos">235</span></a>		<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_wilson-236"><a href="#LatticeMazeGenerators.gen_wilson-236"><span class="linenos">236</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LatticeMaze</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators.gen_wilson-237"><a href="#LatticeMazeGenerators.gen_wilson-237"><span class="linenos">237</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Generate a lattice maze using Wilson&#39;s algorithm.</span>
</span><span id="LatticeMazeGenerators.gen_wilson-238"><a href="#LatticeMazeGenerators.gen_wilson-238"><span class="linenos">238</span></a>
</span><span id="LatticeMazeGenerators.gen_wilson-239"><a href="#LatticeMazeGenerators.gen_wilson-239"><span class="linenos">239</span></a><span class="sd">		# Algorithm</span>
</span><span id="LatticeMazeGenerators.gen_wilson-240"><a href="#LatticeMazeGenerators.gen_wilson-240"><span class="linenos">240</span></a><span class="sd">		Wilson&#39;s algorithm generates an unbiased (random) maze</span>
</span><span id="LatticeMazeGenerators.gen_wilson-241"><a href="#LatticeMazeGenerators.gen_wilson-241"><span class="linenos">241</span></a><span class="sd">		sampled from the uniform distribution over all mazes, using loop-erased random walks. The generated maze is</span>
</span><span id="LatticeMazeGenerators.gen_wilson-242"><a href="#LatticeMazeGenerators.gen_wilson-242"><span class="linenos">242</span></a><span class="sd">		acyclic and all cells are part of a unique connected space.</span>
</span><span id="LatticeMazeGenerators.gen_wilson-243"><a href="#LatticeMazeGenerators.gen_wilson-243"><span class="linenos">243</span></a><span class="sd">		https://en.wikipedia.org/wiki/Maze_generation_algorithm#Wilson&#39;s_algorithm</span>
</span><span id="LatticeMazeGenerators.gen_wilson-244"><a href="#LatticeMazeGenerators.gen_wilson-244"><span class="linenos">244</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="LatticeMazeGenerators.gen_wilson-245"><a href="#LatticeMazeGenerators.gen_wilson-245"><span class="linenos">245</span></a>		<span class="k">assert</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="p">,</span> <span class="p">(</span>
</span><span id="LatticeMazeGenerators.gen_wilson-246"><a href="#LatticeMazeGenerators.gen_wilson-246"><span class="linenos">246</span></a>			<span class="sa">f</span><span class="s2">&quot;gen_wilson does not take any additional arguments, got </span><span class="si">{</span><span class="n">kwargs</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="LatticeMazeGenerators.gen_wilson-247"><a href="#LatticeMazeGenerators.gen_wilson-247"><span class="linenos">247</span></a>		<span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_wilson-248"><a href="#LatticeMazeGenerators.gen_wilson-248"><span class="linenos">248</span></a>
</span><span id="LatticeMazeGenerators.gen_wilson-249"><a href="#LatticeMazeGenerators.gen_wilson-249"><span class="linenos">249</span></a>		<span class="n">grid_shape_</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grid_shape</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_wilson-250"><a href="#LatticeMazeGenerators.gen_wilson-250"><span class="linenos">250</span></a>
</span><span id="LatticeMazeGenerators.gen_wilson-251"><a href="#LatticeMazeGenerators.gen_wilson-251"><span class="linenos">251</span></a>		<span class="c1"># Initialize grid and visited cells</span>
</span><span id="LatticeMazeGenerators.gen_wilson-252"><a href="#LatticeMazeGenerators.gen_wilson-252"><span class="linenos">252</span></a>		<span class="n">connection_list</span><span class="p">:</span> <span class="n">ConnectionList</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="o">*</span><span class="n">grid_shape_</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_wilson-253"><a href="#LatticeMazeGenerators.gen_wilson-253"><span class="linenos">253</span></a>		<span class="n">visited</span><span class="p">:</span> <span class="n">Bool</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;x y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">grid_shape_</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_wilson-254"><a href="#LatticeMazeGenerators.gen_wilson-254"><span class="linenos">254</span></a>
</span><span id="LatticeMazeGenerators.gen_wilson-255"><a href="#LatticeMazeGenerators.gen_wilson-255"><span class="linenos">255</span></a>		<span class="c1"># Choose a random cell and mark it as visited</span>
</span><span id="LatticeMazeGenerators.gen_wilson-256"><a href="#LatticeMazeGenerators.gen_wilson-256"><span class="linenos">256</span></a>		<span class="n">start_coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">_random_start_coord</span><span class="p">(</span><span class="n">grid_shape_</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_wilson-257"><a href="#LatticeMazeGenerators.gen_wilson-257"><span class="linenos">257</span></a>		<span class="n">visited</span><span class="p">[</span><span class="n">start_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">start_coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="LatticeMazeGenerators.gen_wilson-258"><a href="#LatticeMazeGenerators.gen_wilson-258"><span class="linenos">258</span></a>		<span class="k">del</span> <span class="n">start_coord</span>
</span><span id="LatticeMazeGenerators.gen_wilson-259"><a href="#LatticeMazeGenerators.gen_wilson-259"><span class="linenos">259</span></a>
</span><span id="LatticeMazeGenerators.gen_wilson-260"><a href="#LatticeMazeGenerators.gen_wilson-260"><span class="linenos">260</span></a>		<span class="k">while</span> <span class="ow">not</span> <span class="n">visited</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
</span><span id="LatticeMazeGenerators.gen_wilson-261"><a href="#LatticeMazeGenerators.gen_wilson-261"><span class="linenos">261</span></a>			<span class="c1"># Perform loop-erased random walk from another random cell</span>
</span><span id="LatticeMazeGenerators.gen_wilson-262"><a href="#LatticeMazeGenerators.gen_wilson-262"><span class="linenos">262</span></a>
</span><span id="LatticeMazeGenerators.gen_wilson-263"><a href="#LatticeMazeGenerators.gen_wilson-263"><span class="linenos">263</span></a>			<span class="c1"># Choose walk_start only from unvisited cells</span>
</span><span id="LatticeMazeGenerators.gen_wilson-264"><a href="#LatticeMazeGenerators.gen_wilson-264"><span class="linenos">264</span></a>			<span class="n">unvisited_coords</span><span class="p">:</span> <span class="n">CoordArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">visited</span><span class="p">))</span>
</span><span id="LatticeMazeGenerators.gen_wilson-265"><a href="#LatticeMazeGenerators.gen_wilson-265"><span class="linenos">265</span></a>			<span class="n">walk_start</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">unvisited_coords</span><span class="p">[</span>
</span><span id="LatticeMazeGenerators.gen_wilson-266"><a href="#LatticeMazeGenerators.gen_wilson-266"><span class="linenos">266</span></a>				<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">unvisited_coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="LatticeMazeGenerators.gen_wilson-267"><a href="#LatticeMazeGenerators.gen_wilson-267"><span class="linenos">267</span></a>			<span class="p">]</span>
</span><span id="LatticeMazeGenerators.gen_wilson-268"><a href="#LatticeMazeGenerators.gen_wilson-268"><span class="linenos">268</span></a>
</span><span id="LatticeMazeGenerators.gen_wilson-269"><a href="#LatticeMazeGenerators.gen_wilson-269"><span class="linenos">269</span></a>			<span class="c1"># Perform the random walk</span>
</span><span id="LatticeMazeGenerators.gen_wilson-270"><a href="#LatticeMazeGenerators.gen_wilson-270"><span class="linenos">270</span></a>			<span class="n">path</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Coord</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">walk_start</span><span class="p">]</span>
</span><span id="LatticeMazeGenerators.gen_wilson-271"><a href="#LatticeMazeGenerators.gen_wilson-271"><span class="linenos">271</span></a>			<span class="n">current</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">walk_start</span>
</span><span id="LatticeMazeGenerators.gen_wilson-272"><a href="#LatticeMazeGenerators.gen_wilson-272"><span class="linenos">272</span></a>
</span><span id="LatticeMazeGenerators.gen_wilson-273"><a href="#LatticeMazeGenerators.gen_wilson-273"><span class="linenos">273</span></a>			<span class="c1"># exit the loop once the current path hits a visited cell</span>
</span><span id="LatticeMazeGenerators.gen_wilson-274"><a href="#LatticeMazeGenerators.gen_wilson-274"><span class="linenos">274</span></a>			<span class="k">while</span> <span class="ow">not</span> <span class="n">visited</span><span class="p">[</span><span class="n">current</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">current</span><span class="p">[</span><span class="mi">1</span><span class="p">]]:</span>
</span><span id="LatticeMazeGenerators.gen_wilson-275"><a href="#LatticeMazeGenerators.gen_wilson-275"><span class="linenos">275</span></a>				<span class="c1"># find a valid neighbor (one always exists on a lattice)</span>
</span><span id="LatticeMazeGenerators.gen_wilson-276"><a href="#LatticeMazeGenerators.gen_wilson-276"><span class="linenos">276</span></a>				<span class="n">neighbors</span><span class="p">:</span> <span class="n">CoordArray</span> <span class="o">=</span> <span class="n">get_neighbors_in_bounds</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">grid_shape_</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_wilson-277"><a href="#LatticeMazeGenerators.gen_wilson-277"><span class="linenos">277</span></a>				<span class="n">next_cell</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">neighbors</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">neighbors</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
</span><span id="LatticeMazeGenerators.gen_wilson-278"><a href="#LatticeMazeGenerators.gen_wilson-278"><span class="linenos">278</span></a>
</span><span id="LatticeMazeGenerators.gen_wilson-279"><a href="#LatticeMazeGenerators.gen_wilson-279"><span class="linenos">279</span></a>				<span class="c1"># Check for loop</span>
</span><span id="LatticeMazeGenerators.gen_wilson-280"><a href="#LatticeMazeGenerators.gen_wilson-280"><span class="linenos">280</span></a>				<span class="n">loop_exit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="LatticeMazeGenerators.gen_wilson-281"><a href="#LatticeMazeGenerators.gen_wilson-281"><span class="linenos">281</span></a>				<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
</span><span id="LatticeMazeGenerators.gen_wilson-282"><a href="#LatticeMazeGenerators.gen_wilson-282"><span class="linenos">282</span></a>					<span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">next_cell</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
</span><span id="LatticeMazeGenerators.gen_wilson-283"><a href="#LatticeMazeGenerators.gen_wilson-283"><span class="linenos">283</span></a>						<span class="n">loop_exit</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="LatticeMazeGenerators.gen_wilson-284"><a href="#LatticeMazeGenerators.gen_wilson-284"><span class="linenos">284</span></a>						<span class="k">break</span>
</span><span id="LatticeMazeGenerators.gen_wilson-285"><a href="#LatticeMazeGenerators.gen_wilson-285"><span class="linenos">285</span></a>
</span><span id="LatticeMazeGenerators.gen_wilson-286"><a href="#LatticeMazeGenerators.gen_wilson-286"><span class="linenos">286</span></a>				<span class="c1"># erase the loop, or continue the walk</span>
</span><span id="LatticeMazeGenerators.gen_wilson-287"><a href="#LatticeMazeGenerators.gen_wilson-287"><span class="linenos">287</span></a>				<span class="k">if</span> <span class="n">loop_exit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators.gen_wilson-288"><a href="#LatticeMazeGenerators.gen_wilson-288"><span class="linenos">288</span></a>					<span class="c1"># this removes everything after and including the loop start</span>
</span><span id="LatticeMazeGenerators.gen_wilson-289"><a href="#LatticeMazeGenerators.gen_wilson-289"><span class="linenos">289</span></a>					<span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="p">[:</span> <span class="n">loop_exit</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="LatticeMazeGenerators.gen_wilson-290"><a href="#LatticeMazeGenerators.gen_wilson-290"><span class="linenos">290</span></a>					<span class="c1"># reset current cell to end of path</span>
</span><span id="LatticeMazeGenerators.gen_wilson-291"><a href="#LatticeMazeGenerators.gen_wilson-291"><span class="linenos">291</span></a>					<span class="n">current</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="LatticeMazeGenerators.gen_wilson-292"><a href="#LatticeMazeGenerators.gen_wilson-292"><span class="linenos">292</span></a>				<span class="k">else</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators.gen_wilson-293"><a href="#LatticeMazeGenerators.gen_wilson-293"><span class="linenos">293</span></a>					<span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">next_cell</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_wilson-294"><a href="#LatticeMazeGenerators.gen_wilson-294"><span class="linenos">294</span></a>					<span class="n">current</span> <span class="o">=</span> <span class="n">next_cell</span>
</span><span id="LatticeMazeGenerators.gen_wilson-295"><a href="#LatticeMazeGenerators.gen_wilson-295"><span class="linenos">295</span></a>
</span><span id="LatticeMazeGenerators.gen_wilson-296"><a href="#LatticeMazeGenerators.gen_wilson-296"><span class="linenos">296</span></a>			<span class="c1"># Add the path to the maze</span>
</span><span id="LatticeMazeGenerators.gen_wilson-297"><a href="#LatticeMazeGenerators.gen_wilson-297"><span class="linenos">297</span></a>			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="LatticeMazeGenerators.gen_wilson-298"><a href="#LatticeMazeGenerators.gen_wilson-298"><span class="linenos">298</span></a>				<span class="n">c_1</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="LatticeMazeGenerators.gen_wilson-299"><a href="#LatticeMazeGenerators.gen_wilson-299"><span class="linenos">299</span></a>				<span class="n">c_2</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="LatticeMazeGenerators.gen_wilson-300"><a href="#LatticeMazeGenerators.gen_wilson-300"><span class="linenos">300</span></a>
</span><span id="LatticeMazeGenerators.gen_wilson-301"><a href="#LatticeMazeGenerators.gen_wilson-301"><span class="linenos">301</span></a>				<span class="c1"># find the dimension of the connection</span>
</span><span id="LatticeMazeGenerators.gen_wilson-302"><a href="#LatticeMazeGenerators.gen_wilson-302"><span class="linenos">302</span></a>				<span class="n">delta</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">c_2</span> <span class="o">-</span> <span class="n">c_1</span>
</span><span id="LatticeMazeGenerators.gen_wilson-303"><a href="#LatticeMazeGenerators.gen_wilson-303"><span class="linenos">303</span></a>				<span class="n">dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">delta</span><span class="p">)))</span>
</span><span id="LatticeMazeGenerators.gen_wilson-304"><a href="#LatticeMazeGenerators.gen_wilson-304"><span class="linenos">304</span></a>
</span><span id="LatticeMazeGenerators.gen_wilson-305"><a href="#LatticeMazeGenerators.gen_wilson-305"><span class="linenos">305</span></a>				<span class="c1"># if positive, down/right from current coord</span>
</span><span id="LatticeMazeGenerators.gen_wilson-306"><a href="#LatticeMazeGenerators.gen_wilson-306"><span class="linenos">306</span></a>				<span class="c1"># if negative, up/left from current coord (down/right from neighbor)</span>
</span><span id="LatticeMazeGenerators.gen_wilson-307"><a href="#LatticeMazeGenerators.gen_wilson-307"><span class="linenos">307</span></a>				<span class="n">clist_node</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">c_1</span> <span class="k">if</span> <span class="p">(</span><span class="n">delta</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="n">c_2</span>
</span><span id="LatticeMazeGenerators.gen_wilson-308"><a href="#LatticeMazeGenerators.gen_wilson-308"><span class="linenos">308</span></a>				<span class="n">connection_list</span><span class="p">[</span><span class="n">dim</span><span class="p">,</span> <span class="n">clist_node</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">clist_node</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="LatticeMazeGenerators.gen_wilson-309"><a href="#LatticeMazeGenerators.gen_wilson-309"><span class="linenos">309</span></a>				<span class="n">visited</span><span class="p">[</span><span class="n">c_1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="LatticeMazeGenerators.gen_wilson-310"><a href="#LatticeMazeGenerators.gen_wilson-310"><span class="linenos">310</span></a>				<span class="c1"># we dont add c_2 because the last c_2 will have already been visited</span>
</span><span id="LatticeMazeGenerators.gen_wilson-311"><a href="#LatticeMazeGenerators.gen_wilson-311"><span class="linenos">311</span></a>
</span><span id="LatticeMazeGenerators.gen_wilson-312"><a href="#LatticeMazeGenerators.gen_wilson-312"><span class="linenos">312</span></a>		<span class="k">return</span> <span class="n">LatticeMaze</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators.gen_wilson-313"><a href="#LatticeMazeGenerators.gen_wilson-313"><span class="linenos">313</span></a>			<span class="n">connection_list</span><span class="o">=</span><span class="n">connection_list</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_wilson-314"><a href="#LatticeMazeGenerators.gen_wilson-314"><span class="linenos">314</span></a>			<span class="n">generation_meta</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators.gen_wilson-315"><a href="#LatticeMazeGenerators.gen_wilson-315"><span class="linenos">315</span></a>				<span class="n">func_name</span><span class="o">=</span><span class="s2">&quot;gen_wilson&quot;</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_wilson-316"><a href="#LatticeMazeGenerators.gen_wilson-316"><span class="linenos">316</span></a>				<span class="n">grid_shape</span><span class="o">=</span><span class="n">grid_shape_</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_wilson-317"><a href="#LatticeMazeGenerators.gen_wilson-317"><span class="linenos">317</span></a>				<span class="n">fully_connected</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_wilson-318"><a href="#LatticeMazeGenerators.gen_wilson-318"><span class="linenos">318</span></a>			<span class="p">),</span>
</span><span id="LatticeMazeGenerators.gen_wilson-319"><a href="#LatticeMazeGenerators.gen_wilson-319"><span class="linenos">319</span></a>		<span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Generate a lattice maze using Wilson's algorithm.</p>

<h1 id="algorithm">Algorithm</h1>

<p>Wilson's algorithm generates an unbiased (random) maze
sampled from the uniform distribution over all mazes, using loop-erased random walks. The generated maze is
acyclic and all cells are part of a unique connected space.
https://en.wikipedia.org/wiki/Maze_generation_algorithm#Wilson's_algorithm</p>
</div>


                            </div>
                            <div id="LatticeMazeGenerators.gen_percolation" class="classattr">
                                        <input id="LatticeMazeGenerators.gen_percolation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">gen_percolation</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">grid_shape</span><span class="p">:</span> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">Int8</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="s1">&#39;row_col=2&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>,</span><span class="param">	<span class="n">p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.4</span>,</span><span class="param">	<span class="n">lattice_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>,</span><span class="param">	<span class="n">start_coord</span><span class="p">:</span> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">Int8</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="s1">&#39;row_col=2&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="../../maze_dataset.html#LatticeMaze">maze_dataset.LatticeMaze</a></span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="LatticeMazeGenerators.gen_percolation-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/generation/generators.py#L320-L361" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#LatticeMazeGenerators.gen_percolation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LatticeMazeGenerators.gen_percolation-321"><a href="#LatticeMazeGenerators.gen_percolation-321"><span class="linenos">321</span></a>	<span class="nd">@staticmethod</span>
</span><span id="LatticeMazeGenerators.gen_percolation-322"><a href="#LatticeMazeGenerators.gen_percolation-322"><span class="linenos">322</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">gen_percolation</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators.gen_percolation-323"><a href="#LatticeMazeGenerators.gen_percolation-323"><span class="linenos">323</span></a>		<span class="n">grid_shape</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_percolation-324"><a href="#LatticeMazeGenerators.gen_percolation-324"><span class="linenos">324</span></a>		<span class="n">p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_percolation-325"><a href="#LatticeMazeGenerators.gen_percolation-325"><span class="linenos">325</span></a>		<span class="n">lattice_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_percolation-326"><a href="#LatticeMazeGenerators.gen_percolation-326"><span class="linenos">326</span></a>		<span class="n">start_coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_percolation-327"><a href="#LatticeMazeGenerators.gen_percolation-327"><span class="linenos">327</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LatticeMaze</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators.gen_percolation-328"><a href="#LatticeMazeGenerators.gen_percolation-328"><span class="linenos">328</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;generate a lattice maze using simple percolation</span>
</span><span id="LatticeMazeGenerators.gen_percolation-329"><a href="#LatticeMazeGenerators.gen_percolation-329"><span class="linenos">329</span></a>
</span><span id="LatticeMazeGenerators.gen_percolation-330"><a href="#LatticeMazeGenerators.gen_percolation-330"><span class="linenos">330</span></a><span class="sd">		note that p in the range (0.4, 0.7) gives the most interesting mazes</span>
</span><span id="LatticeMazeGenerators.gen_percolation-331"><a href="#LatticeMazeGenerators.gen_percolation-331"><span class="linenos">331</span></a>
</span><span id="LatticeMazeGenerators.gen_percolation-332"><a href="#LatticeMazeGenerators.gen_percolation-332"><span class="linenos">332</span></a><span class="sd">		# Arguments</span>
</span><span id="LatticeMazeGenerators.gen_percolation-333"><a href="#LatticeMazeGenerators.gen_percolation-333"><span class="linenos">333</span></a><span class="sd">		- `grid_shape: Coord`: the shape of the grid</span>
</span><span id="LatticeMazeGenerators.gen_percolation-334"><a href="#LatticeMazeGenerators.gen_percolation-334"><span class="linenos">334</span></a><span class="sd">		- `lattice_dim: int`: the dimension of the lattice (default: `2`)</span>
</span><span id="LatticeMazeGenerators.gen_percolation-335"><a href="#LatticeMazeGenerators.gen_percolation-335"><span class="linenos">335</span></a><span class="sd">		- `p: float`: the probability of a cell being accessible (default: `0.5`)</span>
</span><span id="LatticeMazeGenerators.gen_percolation-336"><a href="#LatticeMazeGenerators.gen_percolation-336"><span class="linenos">336</span></a><span class="sd">		- `start_coord: Coord | None`: the starting coordinate for the connected component (default: `None` will give a random start)</span>
</span><span id="LatticeMazeGenerators.gen_percolation-337"><a href="#LatticeMazeGenerators.gen_percolation-337"><span class="linenos">337</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="LatticeMazeGenerators.gen_percolation-338"><a href="#LatticeMazeGenerators.gen_percolation-338"><span class="linenos">338</span></a>		<span class="k">assert</span> <span class="n">p</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">p</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;p must be between 0 and 1, got </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">&quot;</span>  <span class="c1"># noqa: PT018</span>
</span><span id="LatticeMazeGenerators.gen_percolation-339"><a href="#LatticeMazeGenerators.gen_percolation-339"><span class="linenos">339</span></a>		<span class="n">grid_shape_</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grid_shape</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_percolation-340"><a href="#LatticeMazeGenerators.gen_percolation-340"><span class="linenos">340</span></a>
</span><span id="LatticeMazeGenerators.gen_percolation-341"><a href="#LatticeMazeGenerators.gen_percolation-341"><span class="linenos">341</span></a>		<span class="n">start_coord</span> <span class="o">=</span> <span class="n">_random_start_coord</span><span class="p">(</span><span class="n">grid_shape_</span><span class="p">,</span> <span class="n">start_coord</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_percolation-342"><a href="#LatticeMazeGenerators.gen_percolation-342"><span class="linenos">342</span></a>
</span><span id="LatticeMazeGenerators.gen_percolation-343"><a href="#LatticeMazeGenerators.gen_percolation-343"><span class="linenos">343</span></a>		<span class="n">connection_list</span><span class="p">:</span> <span class="n">ConnectionList</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">lattice_dim</span><span class="p">,</span> <span class="o">*</span><span class="n">grid_shape_</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">p</span>
</span><span id="LatticeMazeGenerators.gen_percolation-344"><a href="#LatticeMazeGenerators.gen_percolation-344"><span class="linenos">344</span></a>
</span><span id="LatticeMazeGenerators.gen_percolation-345"><a href="#LatticeMazeGenerators.gen_percolation-345"><span class="linenos">345</span></a>		<span class="n">connection_list</span> <span class="o">=</span> <span class="n">_fill_edges_with_walls</span><span class="p">(</span><span class="n">connection_list</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_percolation-346"><a href="#LatticeMazeGenerators.gen_percolation-346"><span class="linenos">346</span></a>
</span><span id="LatticeMazeGenerators.gen_percolation-347"><a href="#LatticeMazeGenerators.gen_percolation-347"><span class="linenos">347</span></a>		<span class="n">output</span><span class="p">:</span> <span class="n">LatticeMaze</span> <span class="o">=</span> <span class="n">LatticeMaze</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators.gen_percolation-348"><a href="#LatticeMazeGenerators.gen_percolation-348"><span class="linenos">348</span></a>			<span class="n">connection_list</span><span class="o">=</span><span class="n">connection_list</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_percolation-349"><a href="#LatticeMazeGenerators.gen_percolation-349"><span class="linenos">349</span></a>			<span class="n">generation_meta</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators.gen_percolation-350"><a href="#LatticeMazeGenerators.gen_percolation-350"><span class="linenos">350</span></a>				<span class="n">func_name</span><span class="o">=</span><span class="s2">&quot;gen_percolation&quot;</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_percolation-351"><a href="#LatticeMazeGenerators.gen_percolation-351"><span class="linenos">351</span></a>				<span class="n">grid_shape</span><span class="o">=</span><span class="n">grid_shape_</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_percolation-352"><a href="#LatticeMazeGenerators.gen_percolation-352"><span class="linenos">352</span></a>				<span class="n">percolation_p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_percolation-353"><a href="#LatticeMazeGenerators.gen_percolation-353"><span class="linenos">353</span></a>				<span class="n">start_coord</span><span class="o">=</span><span class="n">start_coord</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_percolation-354"><a href="#LatticeMazeGenerators.gen_percolation-354"><span class="linenos">354</span></a>			<span class="p">),</span>
</span><span id="LatticeMazeGenerators.gen_percolation-355"><a href="#LatticeMazeGenerators.gen_percolation-355"><span class="linenos">355</span></a>		<span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_percolation-356"><a href="#LatticeMazeGenerators.gen_percolation-356"><span class="linenos">356</span></a>
</span><span id="LatticeMazeGenerators.gen_percolation-357"><a href="#LatticeMazeGenerators.gen_percolation-357"><span class="linenos">357</span></a>		<span class="c1"># generation_meta is sometimes None, but not here since we just made it a dict above</span>
</span><span id="LatticeMazeGenerators.gen_percolation-358"><a href="#LatticeMazeGenerators.gen_percolation-358"><span class="linenos">358</span></a>		<span class="n">output</span><span class="o">.</span><span class="n">generation_meta</span><span class="p">[</span><span class="s2">&quot;visited_cells&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">gen_connected_component_from</span><span class="p">(</span>  <span class="c1"># type: ignore[index]</span>
</span><span id="LatticeMazeGenerators.gen_percolation-359"><a href="#LatticeMazeGenerators.gen_percolation-359"><span class="linenos">359</span></a>			<span class="n">start_coord</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_percolation-360"><a href="#LatticeMazeGenerators.gen_percolation-360"><span class="linenos">360</span></a>		<span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_percolation-361"><a href="#LatticeMazeGenerators.gen_percolation-361"><span class="linenos">361</span></a>
</span><span id="LatticeMazeGenerators.gen_percolation-362"><a href="#LatticeMazeGenerators.gen_percolation-362"><span class="linenos">362</span></a>		<span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>generate a lattice maze using simple percolation</p>

<p>note that p in the range (0.4, 0.7) gives the most interesting mazes</p>

<h1 id="arguments">Arguments</h1>

<ul>
<li><code>grid_shape: Coord</code>: the shape of the grid</li>
<li><code>lattice_dim: int</code>: the dimension of the lattice (default: <code>2</code>)</li>
<li><code>p: float</code>: the probability of a cell being accessible (default: <code>0.5</code>)</li>
<li><code>start_coord: Coord | None</code>: the starting coordinate for the connected component (default: <code>None</code> will give a random start)</li>
</ul>
</div>


                            </div>
                            <div id="LatticeMazeGenerators.gen_dfs_percolation" class="classattr">
                                        <input id="LatticeMazeGenerators.gen_dfs_percolation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">gen_dfs_percolation</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">grid_shape</span><span class="p">:</span> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">Int8</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="s1">&#39;row_col=2&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>,</span><span class="param">	<span class="n">p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.4</span>,</span><span class="param">	<span class="n">lattice_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>,</span><span class="param">	<span class="n">accessible_cells</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">max_tree_depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">start_coord</span><span class="p">:</span> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">Int8</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="s1">&#39;row_col=2&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="../../maze_dataset.html#LatticeMaze">maze_dataset.LatticeMaze</a></span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="LatticeMazeGenerators.gen_dfs_percolation-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/generation/generators.py#L363-L403" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#LatticeMazeGenerators.gen_dfs_percolation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LatticeMazeGenerators.gen_dfs_percolation-364"><a href="#LatticeMazeGenerators.gen_dfs_percolation-364"><span class="linenos">364</span></a>	<span class="nd">@staticmethod</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-365"><a href="#LatticeMazeGenerators.gen_dfs_percolation-365"><span class="linenos">365</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">gen_dfs_percolation</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-366"><a href="#LatticeMazeGenerators.gen_dfs_percolation-366"><span class="linenos">366</span></a>		<span class="n">grid_shape</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-367"><a href="#LatticeMazeGenerators.gen_dfs_percolation-367"><span class="linenos">367</span></a>		<span class="n">p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-368"><a href="#LatticeMazeGenerators.gen_dfs_percolation-368"><span class="linenos">368</span></a>		<span class="n">lattice_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-369"><a href="#LatticeMazeGenerators.gen_dfs_percolation-369"><span class="linenos">369</span></a>		<span class="n">accessible_cells</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-370"><a href="#LatticeMazeGenerators.gen_dfs_percolation-370"><span class="linenos">370</span></a>		<span class="n">max_tree_depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-371"><a href="#LatticeMazeGenerators.gen_dfs_percolation-371"><span class="linenos">371</span></a>		<span class="n">start_coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-372"><a href="#LatticeMazeGenerators.gen_dfs_percolation-372"><span class="linenos">372</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LatticeMaze</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-373"><a href="#LatticeMazeGenerators.gen_dfs_percolation-373"><span class="linenos">373</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;dfs and then percolation (adds cycles)&quot;&quot;&quot;</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-374"><a href="#LatticeMazeGenerators.gen_dfs_percolation-374"><span class="linenos">374</span></a>		<span class="n">grid_shape_</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grid_shape</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-375"><a href="#LatticeMazeGenerators.gen_dfs_percolation-375"><span class="linenos">375</span></a>		<span class="n">start_coord</span> <span class="o">=</span> <span class="n">_random_start_coord</span><span class="p">(</span><span class="n">grid_shape_</span><span class="p">,</span> <span class="n">start_coord</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-376"><a href="#LatticeMazeGenerators.gen_dfs_percolation-376"><span class="linenos">376</span></a>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-377"><a href="#LatticeMazeGenerators.gen_dfs_percolation-377"><span class="linenos">377</span></a>		<span class="c1"># generate initial maze via dfs</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-378"><a href="#LatticeMazeGenerators.gen_dfs_percolation-378"><span class="linenos">378</span></a>		<span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span> <span class="o">=</span> <span class="n">LatticeMazeGenerators</span><span class="o">.</span><span class="n">gen_dfs</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-379"><a href="#LatticeMazeGenerators.gen_dfs_percolation-379"><span class="linenos">379</span></a>			<span class="n">grid_shape</span><span class="o">=</span><span class="n">grid_shape_</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-380"><a href="#LatticeMazeGenerators.gen_dfs_percolation-380"><span class="linenos">380</span></a>			<span class="n">lattice_dim</span><span class="o">=</span><span class="n">lattice_dim</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-381"><a href="#LatticeMazeGenerators.gen_dfs_percolation-381"><span class="linenos">381</span></a>			<span class="n">accessible_cells</span><span class="o">=</span><span class="n">accessible_cells</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-382"><a href="#LatticeMazeGenerators.gen_dfs_percolation-382"><span class="linenos">382</span></a>			<span class="n">max_tree_depth</span><span class="o">=</span><span class="n">max_tree_depth</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-383"><a href="#LatticeMazeGenerators.gen_dfs_percolation-383"><span class="linenos">383</span></a>			<span class="n">start_coord</span><span class="o">=</span><span class="n">start_coord</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-384"><a href="#LatticeMazeGenerators.gen_dfs_percolation-384"><span class="linenos">384</span></a>		<span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-385"><a href="#LatticeMazeGenerators.gen_dfs_percolation-385"><span class="linenos">385</span></a>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-386"><a href="#LatticeMazeGenerators.gen_dfs_percolation-386"><span class="linenos">386</span></a>		<span class="c1"># percolate</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-387"><a href="#LatticeMazeGenerators.gen_dfs_percolation-387"><span class="linenos">387</span></a>		<span class="n">connection_list_perc</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-388"><a href="#LatticeMazeGenerators.gen_dfs_percolation-388"><span class="linenos">388</span></a>			<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="o">*</span><span class="n">maze</span><span class="o">.</span><span class="n">connection_list</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">p</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-389"><a href="#LatticeMazeGenerators.gen_dfs_percolation-389"><span class="linenos">389</span></a>		<span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-390"><a href="#LatticeMazeGenerators.gen_dfs_percolation-390"><span class="linenos">390</span></a>		<span class="n">connection_list_perc</span> <span class="o">=</span> <span class="n">_fill_edges_with_walls</span><span class="p">(</span><span class="n">connection_list_perc</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-391"><a href="#LatticeMazeGenerators.gen_dfs_percolation-391"><span class="linenos">391</span></a>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-392"><a href="#LatticeMazeGenerators.gen_dfs_percolation-392"><span class="linenos">392</span></a>		<span class="n">maze</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s2">&quot;connection_list&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-393"><a href="#LatticeMazeGenerators.gen_dfs_percolation-393"><span class="linenos">393</span></a>			<span class="n">maze</span><span class="o">.</span><span class="n">connection_list</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-394"><a href="#LatticeMazeGenerators.gen_dfs_percolation-394"><span class="linenos">394</span></a>			<span class="n">connection_list_perc</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-395"><a href="#LatticeMazeGenerators.gen_dfs_percolation-395"><span class="linenos">395</span></a>		<span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-396"><a href="#LatticeMazeGenerators.gen_dfs_percolation-396"><span class="linenos">396</span></a>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-397"><a href="#LatticeMazeGenerators.gen_dfs_percolation-397"><span class="linenos">397</span></a>		<span class="c1"># generation_meta is sometimes None, but not here since we just made it a dict above</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-398"><a href="#LatticeMazeGenerators.gen_dfs_percolation-398"><span class="linenos">398</span></a>		<span class="n">maze</span><span class="o">.</span><span class="n">generation_meta</span><span class="p">[</span><span class="s2">&quot;func_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;gen_dfs_percolation&quot;</span>  <span class="c1"># type: ignore[index]</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-399"><a href="#LatticeMazeGenerators.gen_dfs_percolation-399"><span class="linenos">399</span></a>		<span class="n">maze</span><span class="o">.</span><span class="n">generation_meta</span><span class="p">[</span><span class="s2">&quot;percolation_p&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span>  <span class="c1"># type: ignore[index]</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-400"><a href="#LatticeMazeGenerators.gen_dfs_percolation-400"><span class="linenos">400</span></a>		<span class="n">maze</span><span class="o">.</span><span class="n">generation_meta</span><span class="p">[</span><span class="s2">&quot;visited_cells&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">gen_connected_component_from</span><span class="p">(</span>  <span class="c1"># type: ignore[index]</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-401"><a href="#LatticeMazeGenerators.gen_dfs_percolation-401"><span class="linenos">401</span></a>			<span class="n">start_coord</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-402"><a href="#LatticeMazeGenerators.gen_dfs_percolation-402"><span class="linenos">402</span></a>		<span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-403"><a href="#LatticeMazeGenerators.gen_dfs_percolation-403"><span class="linenos">403</span></a>
</span><span id="LatticeMazeGenerators.gen_dfs_percolation-404"><a href="#LatticeMazeGenerators.gen_dfs_percolation-404"><span class="linenos">404</span></a>		<span class="k">return</span> <span class="n">maze</span>
</span></pre></div>


            <div class="docstring"><p>dfs and then percolation (adds cycles)</p>
</div>


                            </div>
                            <div id="LatticeMazeGenerators.gen_kruskal" class="classattr">
                                        <input id="LatticeMazeGenerators.gen_kruskal-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">gen_kruskal</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">grid_shape</span><span class="p">:</span> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">Int8</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="s1">&#39;row_col=2&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>,</span><span class="param">	<span class="n">lattice_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>,</span><span class="param">	<span class="n">start_coord</span><span class="p">:</span> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">Int8</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="s1">&#39;row_col=2&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="../../maze_dataset.html#LatticeMaze">maze_dataset.LatticeMaze</a></span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="LatticeMazeGenerators.gen_kruskal-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/generation/generators.py#L405-L512" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#LatticeMazeGenerators.gen_kruskal"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LatticeMazeGenerators.gen_kruskal-406"><a href="#LatticeMazeGenerators.gen_kruskal-406"><span class="linenos">406</span></a>	<span class="nd">@staticmethod</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-407"><a href="#LatticeMazeGenerators.gen_kruskal-407"><span class="linenos">407</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">gen_kruskal</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-408"><a href="#LatticeMazeGenerators.gen_kruskal-408"><span class="linenos">408</span></a>		<span class="n">grid_shape</span><span class="p">:</span> <span class="s2">&quot;Coord | CoordTup&quot;</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-409"><a href="#LatticeMazeGenerators.gen_kruskal-409"><span class="linenos">409</span></a>		<span class="n">lattice_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-410"><a href="#LatticeMazeGenerators.gen_kruskal-410"><span class="linenos">410</span></a>		<span class="n">start_coord</span><span class="p">:</span> <span class="s2">&quot;Coord | None&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-411"><a href="#LatticeMazeGenerators.gen_kruskal-411"><span class="linenos">411</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;LatticeMaze&quot;</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-412"><a href="#LatticeMazeGenerators.gen_kruskal-412"><span class="linenos">412</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Generate a maze using Kruskal&#39;s algorithm.</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-413"><a href="#LatticeMazeGenerators.gen_kruskal-413"><span class="linenos">413</span></a>
</span><span id="LatticeMazeGenerators.gen_kruskal-414"><a href="#LatticeMazeGenerators.gen_kruskal-414"><span class="linenos">414</span></a><span class="sd">		This function generates a random spanning tree over a grid using Kruskal&#39;s algorithm.</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-415"><a href="#LatticeMazeGenerators.gen_kruskal-415"><span class="linenos">415</span></a><span class="sd">		Each cell is treated as a node, and all valid adjacent edges are listed and processed</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-416"><a href="#LatticeMazeGenerators.gen_kruskal-416"><span class="linenos">416</span></a><span class="sd">		in random order. An edge is added (i.e. its passage carved) only if it connects two cells</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-417"><a href="#LatticeMazeGenerators.gen_kruskal-417"><span class="linenos">417</span></a><span class="sd">		that are not already connected. The resulting maze is a perfect maze (i.e. a spanning tree)</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-418"><a href="#LatticeMazeGenerators.gen_kruskal-418"><span class="linenos">418</span></a><span class="sd">		without cycles.</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-419"><a href="#LatticeMazeGenerators.gen_kruskal-419"><span class="linenos">419</span></a>
</span><span id="LatticeMazeGenerators.gen_kruskal-420"><a href="#LatticeMazeGenerators.gen_kruskal-420"><span class="linenos">420</span></a><span class="sd">		https://en.wikipedia.org/wiki/Kruskal&#39;s_algorithm</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-421"><a href="#LatticeMazeGenerators.gen_kruskal-421"><span class="linenos">421</span></a>
</span><span id="LatticeMazeGenerators.gen_kruskal-422"><a href="#LatticeMazeGenerators.gen_kruskal-422"><span class="linenos">422</span></a><span class="sd">		# Parameters:</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-423"><a href="#LatticeMazeGenerators.gen_kruskal-423"><span class="linenos">423</span></a><span class="sd">		- `grid_shape : Coord | CoordTup`</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-424"><a href="#LatticeMazeGenerators.gen_kruskal-424"><span class="linenos">424</span></a><span class="sd">			The shape of the maze grid (for example, `(n_rows, n_cols)`).</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-425"><a href="#LatticeMazeGenerators.gen_kruskal-425"><span class="linenos">425</span></a><span class="sd">		- `lattice_dim : int`</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-426"><a href="#LatticeMazeGenerators.gen_kruskal-426"><span class="linenos">426</span></a><span class="sd">			The lattice dimension (default is `2`).</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-427"><a href="#LatticeMazeGenerators.gen_kruskal-427"><span class="linenos">427</span></a><span class="sd">		- `start_coord : Coord | None`</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-428"><a href="#LatticeMazeGenerators.gen_kruskal-428"><span class="linenos">428</span></a><span class="sd">			Optionally, specify a starting coordinate. If `None`, a random coordinate will be chosen.</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-429"><a href="#LatticeMazeGenerators.gen_kruskal-429"><span class="linenos">429</span></a><span class="sd">		- `**kwargs`</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-430"><a href="#LatticeMazeGenerators.gen_kruskal-430"><span class="linenos">430</span></a><span class="sd">			Additional keyword arguments (currently unused).</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-431"><a href="#LatticeMazeGenerators.gen_kruskal-431"><span class="linenos">431</span></a>
</span><span id="LatticeMazeGenerators.gen_kruskal-432"><a href="#LatticeMazeGenerators.gen_kruskal-432"><span class="linenos">432</span></a><span class="sd">		# Returns:</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-433"><a href="#LatticeMazeGenerators.gen_kruskal-433"><span class="linenos">433</span></a><span class="sd">		- `LatticeMaze`</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-434"><a href="#LatticeMazeGenerators.gen_kruskal-434"><span class="linenos">434</span></a><span class="sd">			A maze represented by a connection list, generated as a spanning tree using Kruskal&#39;s algorithm.</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-435"><a href="#LatticeMazeGenerators.gen_kruskal-435"><span class="linenos">435</span></a>
</span><span id="LatticeMazeGenerators.gen_kruskal-436"><a href="#LatticeMazeGenerators.gen_kruskal-436"><span class="linenos">436</span></a><span class="sd">		# Usage:</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-437"><a href="#LatticeMazeGenerators.gen_kruskal-437"><span class="linenos">437</span></a><span class="sd">		```python</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-438"><a href="#LatticeMazeGenerators.gen_kruskal-438"><span class="linenos">438</span></a><span class="sd">		maze = gen_kruskal((10, 10))</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-439"><a href="#LatticeMazeGenerators.gen_kruskal-439"><span class="linenos">439</span></a><span class="sd">		```</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-440"><a href="#LatticeMazeGenerators.gen_kruskal-440"><span class="linenos">440</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-441"><a href="#LatticeMazeGenerators.gen_kruskal-441"><span class="linenos">441</span></a>		<span class="k">assert</span> <span class="n">lattice_dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span>  <span class="c1"># noqa: PLR2004</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-442"><a href="#LatticeMazeGenerators.gen_kruskal-442"><span class="linenos">442</span></a>			<span class="s2">&quot;Kruskal&#39;s algorithm is only implemented for 2D lattices.&quot;</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-443"><a href="#LatticeMazeGenerators.gen_kruskal-443"><span class="linenos">443</span></a>		<span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-444"><a href="#LatticeMazeGenerators.gen_kruskal-444"><span class="linenos">444</span></a>		<span class="c1"># Convert grid_shape to a tuple of ints</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-445"><a href="#LatticeMazeGenerators.gen_kruskal-445"><span class="linenos">445</span></a>		<span class="n">grid_shape_</span><span class="p">:</span> <span class="n">CoordTup</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">grid_shape</span><span class="p">)</span>  <span class="c1"># type: ignore[assignment]</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-446"><a href="#LatticeMazeGenerators.gen_kruskal-446"><span class="linenos">446</span></a>		<span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">grid_shape_</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-447"><a href="#LatticeMazeGenerators.gen_kruskal-447"><span class="linenos">447</span></a>
</span><span id="LatticeMazeGenerators.gen_kruskal-448"><a href="#LatticeMazeGenerators.gen_kruskal-448"><span class="linenos">448</span></a>		<span class="c1"># Initialize union-find data structure.</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-449"><a href="#LatticeMazeGenerators.gen_kruskal-449"><span class="linenos">449</span></a>		<span class="n">parent</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-450"><a href="#LatticeMazeGenerators.gen_kruskal-450"><span class="linenos">450</span></a>
</span><span id="LatticeMazeGenerators.gen_kruskal-451"><a href="#LatticeMazeGenerators.gen_kruskal-451"><span class="linenos">451</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">find</span><span class="p">(</span><span class="n">cell</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-452"><a href="#LatticeMazeGenerators.gen_kruskal-452"><span class="linenos">452</span></a>			<span class="k">while</span> <span class="n">parent</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">!=</span> <span class="n">cell</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-453"><a href="#LatticeMazeGenerators.gen_kruskal-453"><span class="linenos">453</span></a>				<span class="n">parent</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">=</span> <span class="n">parent</span><span class="p">[</span><span class="n">parent</span><span class="p">[</span><span class="n">cell</span><span class="p">]]</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-454"><a href="#LatticeMazeGenerators.gen_kruskal-454"><span class="linenos">454</span></a>				<span class="n">cell</span> <span class="o">=</span> <span class="n">parent</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-455"><a href="#LatticeMazeGenerators.gen_kruskal-455"><span class="linenos">455</span></a>			<span class="k">return</span> <span class="n">cell</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-456"><a href="#LatticeMazeGenerators.gen_kruskal-456"><span class="linenos">456</span></a>
</span><span id="LatticeMazeGenerators.gen_kruskal-457"><a href="#LatticeMazeGenerators.gen_kruskal-457"><span class="linenos">457</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">union</span><span class="p">(</span><span class="n">cell1</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">cell2</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-458"><a href="#LatticeMazeGenerators.gen_kruskal-458"><span class="linenos">458</span></a>			<span class="n">root1</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">cell1</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-459"><a href="#LatticeMazeGenerators.gen_kruskal-459"><span class="linenos">459</span></a>			<span class="n">root2</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">cell2</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-460"><a href="#LatticeMazeGenerators.gen_kruskal-460"><span class="linenos">460</span></a>			<span class="n">parent</span><span class="p">[</span><span class="n">root2</span><span class="p">]</span> <span class="o">=</span> <span class="n">root1</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-461"><a href="#LatticeMazeGenerators.gen_kruskal-461"><span class="linenos">461</span></a>
</span><span id="LatticeMazeGenerators.gen_kruskal-462"><a href="#LatticeMazeGenerators.gen_kruskal-462"><span class="linenos">462</span></a>		<span class="c1"># Initialize each cell as its own set.</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-463"><a href="#LatticeMazeGenerators.gen_kruskal-463"><span class="linenos">463</span></a>		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_rows</span><span class="p">):</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-464"><a href="#LatticeMazeGenerators.gen_kruskal-464"><span class="linenos">464</span></a>			<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_cols</span><span class="p">):</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-465"><a href="#LatticeMazeGenerators.gen_kruskal-465"><span class="linenos">465</span></a>				<span class="n">parent</span><span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-466"><a href="#LatticeMazeGenerators.gen_kruskal-466"><span class="linenos">466</span></a>
</span><span id="LatticeMazeGenerators.gen_kruskal-467"><a href="#LatticeMazeGenerators.gen_kruskal-467"><span class="linenos">467</span></a>		<span class="c1"># List all possible edges.</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-468"><a href="#LatticeMazeGenerators.gen_kruskal-468"><span class="linenos">468</span></a>		<span class="c1"># For vertical edges (i.e. connecting a cell to its right neighbor):</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-469"><a href="#LatticeMazeGenerators.gen_kruskal-469"><span class="linenos">469</span></a>		<span class="n">edges</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-470"><a href="#LatticeMazeGenerators.gen_kruskal-470"><span class="linenos">470</span></a>		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_rows</span><span class="p">):</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-471"><a href="#LatticeMazeGenerators.gen_kruskal-471"><span class="linenos">471</span></a>			<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-472"><a href="#LatticeMazeGenerators.gen_kruskal-472"><span class="linenos">472</span></a>				<span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">(((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-473"><a href="#LatticeMazeGenerators.gen_kruskal-473"><span class="linenos">473</span></a>		<span class="c1"># For horizontal edges (i.e. connecting a cell to its bottom neighbor):</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-474"><a href="#LatticeMazeGenerators.gen_kruskal-474"><span class="linenos">474</span></a>		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_rows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-475"><a href="#LatticeMazeGenerators.gen_kruskal-475"><span class="linenos">475</span></a>			<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_cols</span><span class="p">):</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-476"><a href="#LatticeMazeGenerators.gen_kruskal-476"><span class="linenos">476</span></a>				<span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">(((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-477"><a href="#LatticeMazeGenerators.gen_kruskal-477"><span class="linenos">477</span></a>
</span><span id="LatticeMazeGenerators.gen_kruskal-478"><a href="#LatticeMazeGenerators.gen_kruskal-478"><span class="linenos">478</span></a>		<span class="c1"># Shuffle the list of edges.</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-479"><a href="#LatticeMazeGenerators.gen_kruskal-479"><span class="linenos">479</span></a>		<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-480"><a href="#LatticeMazeGenerators.gen_kruskal-480"><span class="linenos">480</span></a>
</span><span id="LatticeMazeGenerators.gen_kruskal-481"><a href="#LatticeMazeGenerators.gen_kruskal-481"><span class="linenos">481</span></a>		<span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-482"><a href="#LatticeMazeGenerators.gen_kruskal-482"><span class="linenos">482</span></a>
</span><span id="LatticeMazeGenerators.gen_kruskal-483"><a href="#LatticeMazeGenerators.gen_kruskal-483"><span class="linenos">483</span></a>		<span class="c1"># Initialize connection_list with no connections.</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-484"><a href="#LatticeMazeGenerators.gen_kruskal-484"><span class="linenos">484</span></a>		<span class="c1"># connection_list[0] stores downward connections (from cell (i,j) to (i+1,j)).</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-485"><a href="#LatticeMazeGenerators.gen_kruskal-485"><span class="linenos">485</span></a>		<span class="c1"># connection_list[1] stores rightward connections (from cell (i,j) to (i,j+1)).</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-486"><a href="#LatticeMazeGenerators.gen_kruskal-486"><span class="linenos">486</span></a>		<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-487"><a href="#LatticeMazeGenerators.gen_kruskal-487"><span class="linenos">487</span></a>
</span><span id="LatticeMazeGenerators.gen_kruskal-488"><a href="#LatticeMazeGenerators.gen_kruskal-488"><span class="linenos">488</span></a>		<span class="n">connection_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-489"><a href="#LatticeMazeGenerators.gen_kruskal-489"><span class="linenos">489</span></a>
</span><span id="LatticeMazeGenerators.gen_kruskal-490"><a href="#LatticeMazeGenerators.gen_kruskal-490"><span class="linenos">490</span></a>		<span class="c1"># Process each edge; if it connects two different trees, union them and carve the passage.</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-491"><a href="#LatticeMazeGenerators.gen_kruskal-491"><span class="linenos">491</span></a>		<span class="k">for</span> <span class="n">cell1</span><span class="p">,</span> <span class="n">cell2</span><span class="p">,</span> <span class="n">direction</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-492"><a href="#LatticeMazeGenerators.gen_kruskal-492"><span class="linenos">492</span></a>			<span class="k">if</span> <span class="n">find</span><span class="p">(</span><span class="n">cell1</span><span class="p">)</span> <span class="o">!=</span> <span class="n">find</span><span class="p">(</span><span class="n">cell2</span><span class="p">):</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-493"><a href="#LatticeMazeGenerators.gen_kruskal-493"><span class="linenos">493</span></a>				<span class="n">union</span><span class="p">(</span><span class="n">cell1</span><span class="p">,</span> <span class="n">cell2</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-494"><a href="#LatticeMazeGenerators.gen_kruskal-494"><span class="linenos">494</span></a>				<span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-495"><a href="#LatticeMazeGenerators.gen_kruskal-495"><span class="linenos">495</span></a>					<span class="c1"># Horizontal edge: connection is stored in connection_list[0] at cell1.</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-496"><a href="#LatticeMazeGenerators.gen_kruskal-496"><span class="linenos">496</span></a>					<span class="n">connection_list</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">cell1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cell1</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-497"><a href="#LatticeMazeGenerators.gen_kruskal-497"><span class="linenos">497</span></a>				<span class="k">else</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-498"><a href="#LatticeMazeGenerators.gen_kruskal-498"><span class="linenos">498</span></a>					<span class="c1"># Vertical edge: connection is stored in connection_list[1] at cell1.</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-499"><a href="#LatticeMazeGenerators.gen_kruskal-499"><span class="linenos">499</span></a>					<span class="n">connection_list</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">cell1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cell1</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-500"><a href="#LatticeMazeGenerators.gen_kruskal-500"><span class="linenos">500</span></a>
</span><span id="LatticeMazeGenerators.gen_kruskal-501"><a href="#LatticeMazeGenerators.gen_kruskal-501"><span class="linenos">501</span></a>		<span class="k">if</span> <span class="n">start_coord</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-502"><a href="#LatticeMazeGenerators.gen_kruskal-502"><span class="linenos">502</span></a>			<span class="n">start_coord</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">grid_shape_</span><span class="p">)</span>  <span class="c1"># type: ignore[assignment]</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-503"><a href="#LatticeMazeGenerators.gen_kruskal-503"><span class="linenos">503</span></a>
</span><span id="LatticeMazeGenerators.gen_kruskal-504"><a href="#LatticeMazeGenerators.gen_kruskal-504"><span class="linenos">504</span></a>		<span class="n">generation_meta</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-505"><a href="#LatticeMazeGenerators.gen_kruskal-505"><span class="linenos">505</span></a>			<span class="n">func_name</span><span class="o">=</span><span class="s2">&quot;gen_kruskal&quot;</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-506"><a href="#LatticeMazeGenerators.gen_kruskal-506"><span class="linenos">506</span></a>			<span class="n">grid_shape</span><span class="o">=</span><span class="n">grid_shape_</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-507"><a href="#LatticeMazeGenerators.gen_kruskal-507"><span class="linenos">507</span></a>			<span class="n">start_coord</span><span class="o">=</span><span class="n">start_coord</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-508"><a href="#LatticeMazeGenerators.gen_kruskal-508"><span class="linenos">508</span></a>			<span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;kruskal&quot;</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-509"><a href="#LatticeMazeGenerators.gen_kruskal-509"><span class="linenos">509</span></a>			<span class="n">fully_connected</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-510"><a href="#LatticeMazeGenerators.gen_kruskal-510"><span class="linenos">510</span></a>		<span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-511"><a href="#LatticeMazeGenerators.gen_kruskal-511"><span class="linenos">511</span></a>		<span class="k">return</span> <span class="n">LatticeMaze</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-512"><a href="#LatticeMazeGenerators.gen_kruskal-512"><span class="linenos">512</span></a>			<span class="n">connection_list</span><span class="o">=</span><span class="n">connection_list</span><span class="p">,</span> <span class="n">generation_meta</span><span class="o">=</span><span class="n">generation_meta</span>
</span><span id="LatticeMazeGenerators.gen_kruskal-513"><a href="#LatticeMazeGenerators.gen_kruskal-513"><span class="linenos">513</span></a>		<span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Generate a maze using Kruskal's algorithm.</p>

<p>This function generates a random spanning tree over a grid using Kruskal's algorithm.
Each cell is treated as a node, and all valid adjacent edges are listed and processed
in random order. An edge is added (i.e. its passage carved) only if it connects two cells
that are not already connected. The resulting maze is a perfect maze (i.e. a spanning tree)
without cycles.</p>

<p>https://en.wikipedia.org/wiki/Kruskal's_algorithm</p>

<h1 id="parameters">Parameters:</h1>

<ul>
<li><code>grid_shape : Coord | CoordTup</code>
The shape of the maze grid (for example, <code>(n_rows, n_cols)</code>).</li>
<li><code>lattice_dim : int</code>
The lattice dimension (default is <code>2</code>).</li>
<li><code>start_coord : Coord | None</code>
Optionally, specify a starting coordinate. If <code>None</code>, a random coordinate will be chosen.</li>
<li><code>**kwargs</code>
Additional keyword arguments (currently unused).</li>
</ul>

<h1 id="returns">Returns:</h1>

<ul>
<li><code>LatticeMaze</code>
A maze represented by a connection list, generated as a spanning tree using Kruskal's algorithm.</li>
</ul>

<h1 id="usage">Usage:</h1>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="n">maze</span> <span class="o">=</span> <span class="n">gen_kruskal</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="LatticeMazeGenerators.gen_recursive_division" class="classattr">
                                        <input id="LatticeMazeGenerators.gen_recursive_division-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">gen_recursive_division</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">grid_shape</span><span class="p">:</span> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">Int8</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="s1">&#39;row_col=2&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>,</span><span class="param">	<span class="n">lattice_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>,</span><span class="param">	<span class="n">start_coord</span><span class="p">:</span> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">Int8</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="s1">&#39;row_col=2&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="../../maze_dataset.html#LatticeMaze">maze_dataset.LatticeMaze</a></span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="LatticeMazeGenerators.gen_recursive_division-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/generation/generators.py#L514-L610" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#LatticeMazeGenerators.gen_recursive_division"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LatticeMazeGenerators.gen_recursive_division-515"><a href="#LatticeMazeGenerators.gen_recursive_division-515"><span class="linenos">515</span></a>	<span class="nd">@staticmethod</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-516"><a href="#LatticeMazeGenerators.gen_recursive_division-516"><span class="linenos">516</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">gen_recursive_division</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-517"><a href="#LatticeMazeGenerators.gen_recursive_division-517"><span class="linenos">517</span></a>		<span class="n">grid_shape</span><span class="p">:</span> <span class="s2">&quot;Coord | CoordTup&quot;</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-518"><a href="#LatticeMazeGenerators.gen_recursive_division-518"><span class="linenos">518</span></a>		<span class="n">lattice_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-519"><a href="#LatticeMazeGenerators.gen_recursive_division-519"><span class="linenos">519</span></a>		<span class="n">start_coord</span><span class="p">:</span> <span class="s2">&quot;Coord | None&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-520"><a href="#LatticeMazeGenerators.gen_recursive_division-520"><span class="linenos">520</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;LatticeMaze&quot;</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-521"><a href="#LatticeMazeGenerators.gen_recursive_division-521"><span class="linenos">521</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Generate a maze using the recursive division algorithm.</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-522"><a href="#LatticeMazeGenerators.gen_recursive_division-522"><span class="linenos">522</span></a>
</span><span id="LatticeMazeGenerators.gen_recursive_division-523"><a href="#LatticeMazeGenerators.gen_recursive_division-523"><span class="linenos">523</span></a><span class="sd">		This function generates a maze by recursively dividing the grid with walls and carving a single</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-524"><a href="#LatticeMazeGenerators.gen_recursive_division-524"><span class="linenos">524</span></a><span class="sd">		passage through each wall. The algorithm begins with a fully connected grid (i.e. every pair of adjacent</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-525"><a href="#LatticeMazeGenerators.gen_recursive_division-525"><span class="linenos">525</span></a><span class="sd">		cells is connected) and then removes connections along a chosen division line—leaving one gap as a passage.</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-526"><a href="#LatticeMazeGenerators.gen_recursive_division-526"><span class="linenos">526</span></a><span class="sd">		The resulting maze is a perfect maze, meaning there is exactly one path between any two cells.</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-527"><a href="#LatticeMazeGenerators.gen_recursive_division-527"><span class="linenos">527</span></a>
</span><span id="LatticeMazeGenerators.gen_recursive_division-528"><a href="#LatticeMazeGenerators.gen_recursive_division-528"><span class="linenos">528</span></a><span class="sd">		# Parameters:</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-529"><a href="#LatticeMazeGenerators.gen_recursive_division-529"><span class="linenos">529</span></a><span class="sd">		- `grid_shape : Coord | CoordTup`</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-530"><a href="#LatticeMazeGenerators.gen_recursive_division-530"><span class="linenos">530</span></a><span class="sd">			The shape of the maze grid (e.g., `(n_rows, n_cols)`).</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-531"><a href="#LatticeMazeGenerators.gen_recursive_division-531"><span class="linenos">531</span></a><span class="sd">		- `lattice_dim : int`</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-532"><a href="#LatticeMazeGenerators.gen_recursive_division-532"><span class="linenos">532</span></a><span class="sd">			The lattice dimension (default is `2`).</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-533"><a href="#LatticeMazeGenerators.gen_recursive_division-533"><span class="linenos">533</span></a><span class="sd">		- `start_coord : Coord | None`</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-534"><a href="#LatticeMazeGenerators.gen_recursive_division-534"><span class="linenos">534</span></a><span class="sd">			Optionally, specify a starting coordinate. If `None`, a random coordinate is chosen.</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-535"><a href="#LatticeMazeGenerators.gen_recursive_division-535"><span class="linenos">535</span></a><span class="sd">		- `**kwargs`</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-536"><a href="#LatticeMazeGenerators.gen_recursive_division-536"><span class="linenos">536</span></a><span class="sd">			Additional keyword arguments (currently unused).</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-537"><a href="#LatticeMazeGenerators.gen_recursive_division-537"><span class="linenos">537</span></a>
</span><span id="LatticeMazeGenerators.gen_recursive_division-538"><a href="#LatticeMazeGenerators.gen_recursive_division-538"><span class="linenos">538</span></a><span class="sd">		# Returns:</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-539"><a href="#LatticeMazeGenerators.gen_recursive_division-539"><span class="linenos">539</span></a><span class="sd">		- `LatticeMaze`</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-540"><a href="#LatticeMazeGenerators.gen_recursive_division-540"><span class="linenos">540</span></a><span class="sd">			A maze represented by a connection list, generated using recursive division.</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-541"><a href="#LatticeMazeGenerators.gen_recursive_division-541"><span class="linenos">541</span></a>
</span><span id="LatticeMazeGenerators.gen_recursive_division-542"><a href="#LatticeMazeGenerators.gen_recursive_division-542"><span class="linenos">542</span></a><span class="sd">		# Usage:</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-543"><a href="#LatticeMazeGenerators.gen_recursive_division-543"><span class="linenos">543</span></a><span class="sd">		```python</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-544"><a href="#LatticeMazeGenerators.gen_recursive_division-544"><span class="linenos">544</span></a><span class="sd">		maze = gen_recursive_division((10, 10))</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-545"><a href="#LatticeMazeGenerators.gen_recursive_division-545"><span class="linenos">545</span></a><span class="sd">		```</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-546"><a href="#LatticeMazeGenerators.gen_recursive_division-546"><span class="linenos">546</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-547"><a href="#LatticeMazeGenerators.gen_recursive_division-547"><span class="linenos">547</span></a>		<span class="k">assert</span> <span class="n">lattice_dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span>  <span class="c1"># noqa: PLR2004</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-548"><a href="#LatticeMazeGenerators.gen_recursive_division-548"><span class="linenos">548</span></a>			<span class="s2">&quot;Recursive division algorithm is only implemented for 2D lattices.&quot;</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-549"><a href="#LatticeMazeGenerators.gen_recursive_division-549"><span class="linenos">549</span></a>		<span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-550"><a href="#LatticeMazeGenerators.gen_recursive_division-550"><span class="linenos">550</span></a>		<span class="c1"># Convert grid_shape to a tuple of ints.</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-551"><a href="#LatticeMazeGenerators.gen_recursive_division-551"><span class="linenos">551</span></a>		<span class="n">grid_shape_</span><span class="p">:</span> <span class="n">CoordTup</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">grid_shape</span><span class="p">)</span>  <span class="c1"># type: ignore[assignment]</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-552"><a href="#LatticeMazeGenerators.gen_recursive_division-552"><span class="linenos">552</span></a>		<span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">grid_shape_</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-553"><a href="#LatticeMazeGenerators.gen_recursive_division-553"><span class="linenos">553</span></a>
</span><span id="LatticeMazeGenerators.gen_recursive_division-554"><a href="#LatticeMazeGenerators.gen_recursive_division-554"><span class="linenos">554</span></a>		<span class="c1"># Initialize connection_list as a fully connected grid.</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-555"><a href="#LatticeMazeGenerators.gen_recursive_division-555"><span class="linenos">555</span></a>		<span class="c1"># For horizontal connections: for each cell (i,j) with i in [0, n_rows-2], set connection to True.</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-556"><a href="#LatticeMazeGenerators.gen_recursive_division-556"><span class="linenos">556</span></a>		<span class="c1"># For vertical connections: for each cell (i,j) with j in [0, n_cols-2], set connection to True.</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-557"><a href="#LatticeMazeGenerators.gen_recursive_division-557"><span class="linenos">557</span></a>		<span class="n">connection_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-558"><a href="#LatticeMazeGenerators.gen_recursive_division-558"><span class="linenos">558</span></a>		<span class="n">connection_list</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span> <span class="n">n_rows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-559"><a href="#LatticeMazeGenerators.gen_recursive_division-559"><span class="linenos">559</span></a>		<span class="n">connection_list</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:</span> <span class="n">n_cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-560"><a href="#LatticeMazeGenerators.gen_recursive_division-560"><span class="linenos">560</span></a>
</span><span id="LatticeMazeGenerators.gen_recursive_division-561"><a href="#LatticeMazeGenerators.gen_recursive_division-561"><span class="linenos">561</span></a>		<span class="k">def</span><span class="w"> </span><span class="nf">divide</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">width</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">height</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-562"><a href="#LatticeMazeGenerators.gen_recursive_division-562"><span class="linenos">562</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot;Recursively divide the region starting at (x, y) with the given width and height.</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-563"><a href="#LatticeMazeGenerators.gen_recursive_division-563"><span class="linenos">563</span></a>
</span><span id="LatticeMazeGenerators.gen_recursive_division-564"><a href="#LatticeMazeGenerators.gen_recursive_division-564"><span class="linenos">564</span></a><span class="sd">			Removes connections along the chosen division line except for one randomly chosen gap.</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-565"><a href="#LatticeMazeGenerators.gen_recursive_division-565"><span class="linenos">565</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-566"><a href="#LatticeMazeGenerators.gen_recursive_division-566"><span class="linenos">566</span></a>			<span class="k">if</span> <span class="n">width</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">height</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># noqa: PLR2004</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-567"><a href="#LatticeMazeGenerators.gen_recursive_division-567"><span class="linenos">567</span></a>				<span class="k">return</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-568"><a href="#LatticeMazeGenerators.gen_recursive_division-568"><span class="linenos">568</span></a>
</span><span id="LatticeMazeGenerators.gen_recursive_division-569"><a href="#LatticeMazeGenerators.gen_recursive_division-569"><span class="linenos">569</span></a>			<span class="k">if</span> <span class="n">width</span> <span class="o">&gt;</span> <span class="n">height</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-570"><a href="#LatticeMazeGenerators.gen_recursive_division-570"><span class="linenos">570</span></a>				<span class="c1"># Vertical division.</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-571"><a href="#LatticeMazeGenerators.gen_recursive_division-571"><span class="linenos">571</span></a>				<span class="n">wall_col</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-572"><a href="#LatticeMazeGenerators.gen_recursive_division-572"><span class="linenos">572</span></a>				<span class="n">gap_row</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-573"><a href="#LatticeMazeGenerators.gen_recursive_division-573"><span class="linenos">573</span></a>				<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">height</span><span class="p">):</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-574"><a href="#LatticeMazeGenerators.gen_recursive_division-574"><span class="linenos">574</span></a>					<span class="k">if</span> <span class="n">row</span> <span class="o">==</span> <span class="n">gap_row</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-575"><a href="#LatticeMazeGenerators.gen_recursive_division-575"><span class="linenos">575</span></a>						<span class="k">continue</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-576"><a href="#LatticeMazeGenerators.gen_recursive_division-576"><span class="linenos">576</span></a>					<span class="c1"># Remove the vertical connection between (row, wall_col-1) and (row, wall_col).</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-577"><a href="#LatticeMazeGenerators.gen_recursive_division-577"><span class="linenos">577</span></a>					<span class="k">if</span> <span class="n">wall_col</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">n_cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-578"><a href="#LatticeMazeGenerators.gen_recursive_division-578"><span class="linenos">578</span></a>						<span class="n">connection_list</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">wall_col</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-579"><a href="#LatticeMazeGenerators.gen_recursive_division-579"><span class="linenos">579</span></a>				<span class="c1"># Recurse on the left and right subregions.</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-580"><a href="#LatticeMazeGenerators.gen_recursive_division-580"><span class="linenos">580</span></a>				<span class="n">divide</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">wall_col</span> <span class="o">-</span> <span class="n">x</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-581"><a href="#LatticeMazeGenerators.gen_recursive_division-581"><span class="linenos">581</span></a>				<span class="n">divide</span><span class="p">(</span><span class="n">wall_col</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">width</span> <span class="o">-</span> <span class="n">wall_col</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-582"><a href="#LatticeMazeGenerators.gen_recursive_division-582"><span class="linenos">582</span></a>			<span class="k">else</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-583"><a href="#LatticeMazeGenerators.gen_recursive_division-583"><span class="linenos">583</span></a>				<span class="c1"># Horizontal division.</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-584"><a href="#LatticeMazeGenerators.gen_recursive_division-584"><span class="linenos">584</span></a>				<span class="n">wall_row</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-585"><a href="#LatticeMazeGenerators.gen_recursive_division-585"><span class="linenos">585</span></a>				<span class="n">gap_col</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-586"><a href="#LatticeMazeGenerators.gen_recursive_division-586"><span class="linenos">586</span></a>				<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">width</span><span class="p">):</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-587"><a href="#LatticeMazeGenerators.gen_recursive_division-587"><span class="linenos">587</span></a>					<span class="k">if</span> <span class="n">col</span> <span class="o">==</span> <span class="n">gap_col</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-588"><a href="#LatticeMazeGenerators.gen_recursive_division-588"><span class="linenos">588</span></a>						<span class="k">continue</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-589"><a href="#LatticeMazeGenerators.gen_recursive_division-589"><span class="linenos">589</span></a>					<span class="c1"># Remove the horizontal connection between (wall_row-1, col) and (wall_row, col).</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-590"><a href="#LatticeMazeGenerators.gen_recursive_division-590"><span class="linenos">590</span></a>					<span class="k">if</span> <span class="n">wall_row</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">n_rows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-591"><a href="#LatticeMazeGenerators.gen_recursive_division-591"><span class="linenos">591</span></a>						<span class="n">connection_list</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">wall_row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-592"><a href="#LatticeMazeGenerators.gen_recursive_division-592"><span class="linenos">592</span></a>				<span class="c1"># Recurse on the top and bottom subregions.</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-593"><a href="#LatticeMazeGenerators.gen_recursive_division-593"><span class="linenos">593</span></a>				<span class="n">divide</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">wall_row</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-594"><a href="#LatticeMazeGenerators.gen_recursive_division-594"><span class="linenos">594</span></a>				<span class="n">divide</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">wall_row</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">height</span> <span class="o">-</span> <span class="n">wall_row</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-595"><a href="#LatticeMazeGenerators.gen_recursive_division-595"><span class="linenos">595</span></a>
</span><span id="LatticeMazeGenerators.gen_recursive_division-596"><a href="#LatticeMazeGenerators.gen_recursive_division-596"><span class="linenos">596</span></a>		<span class="c1"># Begin the division on the full grid.</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-597"><a href="#LatticeMazeGenerators.gen_recursive_division-597"><span class="linenos">597</span></a>		<span class="n">divide</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-598"><a href="#LatticeMazeGenerators.gen_recursive_division-598"><span class="linenos">598</span></a>
</span><span id="LatticeMazeGenerators.gen_recursive_division-599"><a href="#LatticeMazeGenerators.gen_recursive_division-599"><span class="linenos">599</span></a>		<span class="k">if</span> <span class="n">start_coord</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-600"><a href="#LatticeMazeGenerators.gen_recursive_division-600"><span class="linenos">600</span></a>			<span class="n">start_coord</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">grid_shape_</span><span class="p">)</span>  <span class="c1"># type: ignore[assignment]</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-601"><a href="#LatticeMazeGenerators.gen_recursive_division-601"><span class="linenos">601</span></a>
</span><span id="LatticeMazeGenerators.gen_recursive_division-602"><a href="#LatticeMazeGenerators.gen_recursive_division-602"><span class="linenos">602</span></a>		<span class="n">generation_meta</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-603"><a href="#LatticeMazeGenerators.gen_recursive_division-603"><span class="linenos">603</span></a>			<span class="n">func_name</span><span class="o">=</span><span class="s2">&quot;gen_recursive_division&quot;</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-604"><a href="#LatticeMazeGenerators.gen_recursive_division-604"><span class="linenos">604</span></a>			<span class="n">grid_shape</span><span class="o">=</span><span class="n">grid_shape_</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-605"><a href="#LatticeMazeGenerators.gen_recursive_division-605"><span class="linenos">605</span></a>			<span class="n">start_coord</span><span class="o">=</span><span class="n">start_coord</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-606"><a href="#LatticeMazeGenerators.gen_recursive_division-606"><span class="linenos">606</span></a>			<span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;recursive_division&quot;</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-607"><a href="#LatticeMazeGenerators.gen_recursive_division-607"><span class="linenos">607</span></a>			<span class="n">fully_connected</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-608"><a href="#LatticeMazeGenerators.gen_recursive_division-608"><span class="linenos">608</span></a>		<span class="p">)</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-609"><a href="#LatticeMazeGenerators.gen_recursive_division-609"><span class="linenos">609</span></a>		<span class="k">return</span> <span class="n">LatticeMaze</span><span class="p">(</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-610"><a href="#LatticeMazeGenerators.gen_recursive_division-610"><span class="linenos">610</span></a>			<span class="n">connection_list</span><span class="o">=</span><span class="n">connection_list</span><span class="p">,</span> <span class="n">generation_meta</span><span class="o">=</span><span class="n">generation_meta</span>
</span><span id="LatticeMazeGenerators.gen_recursive_division-611"><a href="#LatticeMazeGenerators.gen_recursive_division-611"><span class="linenos">611</span></a>		<span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Generate a maze using the recursive division algorithm.</p>

<p>This function generates a maze by recursively dividing the grid with walls and carving a single
passage through each wall. The algorithm begins with a fully connected grid (i.e. every pair of adjacent
cells is connected) and then removes connections along a chosen division line—leaving one gap as a passage.
The resulting maze is a perfect maze, meaning there is exactly one path between any two cells.</p>

<h1 id="parameters">Parameters:</h1>

<ul>
<li><code>grid_shape : Coord | CoordTup</code>
The shape of the maze grid (e.g., <code>(n_rows, n_cols)</code>).</li>
<li><code>lattice_dim : int</code>
The lattice dimension (default is <code>2</code>).</li>
<li><code>start_coord : Coord | None</code>
Optionally, specify a starting coordinate. If <code>None</code>, a random coordinate is chosen.</li>
<li><code>**kwargs</code>
Additional keyword arguments (currently unused).</li>
</ul>

<h1 id="returns">Returns:</h1>

<ul>
<li><code>LatticeMaze</code>
A maze represented by a connection list, generated using recursive division.</li>
</ul>

<h1 id="usage">Usage:</h1>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="n">maze</span> <span class="o">=</span> <span class="n">gen_recursive_division</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</code></pre>
</div>
</div>


                            </div>
                </section>
                <section id="P_GeneratorKwargs">
                    <div class="attr variable">
            <span class="name">P_GeneratorKwargs</span>        =
<span class="default_value">~P_GeneratorKwargs</span>

        
    </div>
    <a class="headerlink" href="#P_GeneratorKwargs"></a>
    
    

                </section>
                <section id="MazeGeneratorFunc">
                    <div class="attr variable">
            <span class="name">MazeGeneratorFunc</span>        =
<input id="MazeGeneratorFunc-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="MazeGeneratorFunc-view-value"></label><span class="default_value">typing.Callable[typing.Concatenate[jaxtyping.Int8[ndarray, &#39;row_col=2&#39;] | tuple[int, int], ~P_GeneratorKwargs], <a href="../../maze_dataset.html#LatticeMaze">maze_dataset.LatticeMaze</a>]</span>

        
    </div>
    <a class="headerlink" href="#MazeGeneratorFunc"></a>
    
    

                </section>
                <section id="GENERATORS_MAP">
                    <div class="attr variable">
            <span class="name">GENERATORS_MAP</span><span class="annotation">: dict[str, typing.Callable[typing.Concatenate[jaxtyping.Int8[ndarray, &#39;row_col=2&#39;] | tuple[int, int], ~P_GeneratorKwargs], <a href="../../maze_dataset.html#LatticeMaze">maze_dataset.LatticeMaze</a>]]</span>        =
<input id="GENERATORS_MAP-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="GENERATORS_MAP-view-value"></label><span class="default_value">{&#39;gen_dfs&#39;: &lt;function <a href="#LatticeMazeGenerators.gen_dfs">LatticeMazeGenerators.gen_dfs</a>&gt;, &#39;gen_wilson&#39;: &lt;function <a href="#LatticeMazeGenerators.gen_wilson">LatticeMazeGenerators.gen_wilson</a>&gt;, &#39;gen_percolation&#39;: &lt;function <a href="#LatticeMazeGenerators.gen_percolation">LatticeMazeGenerators.gen_percolation</a>&gt;, &#39;gen_dfs_percolation&#39;: &lt;function <a href="#LatticeMazeGenerators.gen_dfs_percolation">LatticeMazeGenerators.gen_dfs_percolation</a>&gt;, &#39;gen_prim&#39;: &lt;function <a href="#LatticeMazeGenerators.gen_prim">LatticeMazeGenerators.gen_prim</a>&gt;, &#39;gen_kruskal&#39;: &lt;function <a href="#LatticeMazeGenerators.gen_kruskal">LatticeMazeGenerators.gen_kruskal</a>&gt;, &#39;gen_recursive_division&#39;: &lt;function <a href="#LatticeMazeGenerators.gen_recursive_division">LatticeMazeGenerators.gen_recursive_division</a>&gt;}</span>

        
    </div>
    <a class="headerlink" href="#GENERATORS_MAP"></a>
    
            <div class="docstring"><p>mapping of generator names to generator functions, useful for loading <code>MazeDatasetConfig</code></p>
</div>


                </section>
                <section id="get_maze_with_solution">
                            <input id="get_maze_with_solution-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_maze_with_solution</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">gen_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">grid_shape</span><span class="p">:</span> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">Int8</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="s1">&#39;row_col=2&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>,</span><span class="param">	<span class="n">maze_ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="../../maze_dataset.html#SolvedMaze">maze_dataset.SolvedMaze</a></span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="get_maze_with_solution-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/generation/generators.py#L648-L660" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#get_maze_with_solution"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_maze_with_solution-649"><a href="#get_maze_with_solution-649"><span class="linenos">649</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_maze_with_solution</span><span class="p">(</span>
</span><span id="get_maze_with_solution-650"><a href="#get_maze_with_solution-650"><span class="linenos">650</span></a>	<span class="n">gen_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="get_maze_with_solution-651"><a href="#get_maze_with_solution-651"><span class="linenos">651</span></a>	<span class="n">grid_shape</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">,</span>
</span><span id="get_maze_with_solution-652"><a href="#get_maze_with_solution-652"><span class="linenos">652</span></a>	<span class="n">maze_ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="get_maze_with_solution-653"><a href="#get_maze_with_solution-653"><span class="linenos">653</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SolvedMaze</span><span class="p">:</span>
</span><span id="get_maze_with_solution-654"><a href="#get_maze_with_solution-654"><span class="linenos">654</span></a>	<span class="s2">&quot;helper function to get a maze already with a solution&quot;</span>
</span><span id="get_maze_with_solution-655"><a href="#get_maze_with_solution-655"><span class="linenos">655</span></a>	<span class="k">if</span> <span class="n">maze_ctor_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="get_maze_with_solution-656"><a href="#get_maze_with_solution-656"><span class="linenos">656</span></a>		<span class="n">maze_ctor_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="get_maze_with_solution-657"><a href="#get_maze_with_solution-657"><span class="linenos">657</span></a>	<span class="c1"># TYPING: error: Too few arguments  [call-arg]</span>
</span><span id="get_maze_with_solution-658"><a href="#get_maze_with_solution-658"><span class="linenos">658</span></a>	<span class="c1"># not sure why this is happening -- doesnt recognize the kwargs?</span>
</span><span id="get_maze_with_solution-659"><a href="#get_maze_with_solution-659"><span class="linenos">659</span></a>	<span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span> <span class="o">=</span> <span class="n">GENERATORS_MAP</span><span class="p">[</span><span class="n">gen_name</span><span class="p">](</span><span class="n">grid_shape</span><span class="p">,</span> <span class="o">**</span><span class="n">maze_ctor_kwargs</span><span class="p">)</span>  <span class="c1"># type: ignore[call-arg]</span>
</span><span id="get_maze_with_solution-660"><a href="#get_maze_with_solution-660"><span class="linenos">660</span></a>	<span class="n">solution</span><span class="p">:</span> <span class="n">CoordArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">generate_random_path</span><span class="p">())</span>
</span><span id="get_maze_with_solution-661"><a href="#get_maze_with_solution-661"><span class="linenos">661</span></a>	<span class="k">return</span> <span class="n">SolvedMaze</span><span class="o">.</span><span class="n">from_lattice_maze</span><span class="p">(</span><span class="n">lattice_maze</span><span class="o">=</span><span class="n">maze</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>helper function to get a maze already with a solution</p>
</div>


                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>