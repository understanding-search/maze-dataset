<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.4"/>
    <title>maze_dataset.dataset API documentation</title>
    <link rel="icon" href="../resources/favicon.png"/>
<link rel="stylesheet" href="../resources/css/bootstrap-reboot.min.css"><link rel="stylesheet" href="../resources/css/syntax-highlighting.css"><link rel="stylesheet" href="../resources/css/theme.css"><link rel="stylesheet" href="../resources/css/layout.css"><link rel="stylesheet" href="../resources/css/content.css"><link rel="stylesheet" href="../resources/css/custom.css"><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
        overflow-y: hidden;
    }
</style><style>
    .pdoc .mermaid-pre {
        border: none;
        background: none;
    }
</style>
<script type="module" defer>
    import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs";

    /* Re-invoke Mermaid when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => mermaid.run()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script></head>
<body>
<div class="package-version">
    docs for <a href="https://github.com/understanding-search/maze-dataset">maze-dataset</a> v1.4.0<br>
</div>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button">
            <img src="../resources/svg/navtoggle.svg" alt="Toggle navigation"> 
        </label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../maze_dataset.html">
                <img src="../resources/svg/box-arrow-in-left.svg" alt="Back to parent module"/>
                &nbsp;maze_dataset</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>


            <h2>Submodules</h2>
            <ul>
                    <li><a href="dataset/collected_dataset.html">collected_dataset</a></li>
                    <li><a href="dataset/configs.html">configs</a></li>
                    <li><a href="dataset/dataset.html">dataset</a></li>
                    <li><a href="dataset/filters.html">filters</a></li>
                    <li><a href="dataset/maze_dataset_config.html">maze_dataset_config</a></li>
                    <li><a href="dataset/maze_dataset.html">maze_dataset</a></li>
                    <li><a href="dataset/rasterized.html">rasterized</a></li>
                    <li><a href="dataset/success_predict_math.html">success_predict_math</a></li>
            </ul>

            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#MazeDataset">MazeDataset</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#MazeDataset.__init__">MazeDataset</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeDataset.cfg">cfg</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeDataset.mazes">mazes</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeDataset.generation_metadata_collected">generation_metadata_collected</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeDataset.from_config">from_config</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeDataset.data_hash">data_hash</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeDataset.as_tokens">as_tokens</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeDataset.assert_equal">assert_equal</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeDataset.generate">generate</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeDataset.download">download</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeDataset.load">load</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeDataset.serialize">serialize</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeDataset.update_self_config">update_self_config</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeDataset.custom_maze_filter">custom_maze_filter</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#MazeDatasetConfig">MazeDatasetConfig</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#MazeDatasetConfig.__init__">MazeDatasetConfig</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeDatasetConfig.config_version">config_version</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeDatasetConfig.versions">versions</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeDatasetConfig.serialize">serialize</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeDatasetConfig.summary">summary</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeDatasetConfig.success_fraction_estimate">success_fraction_estimate</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeDatasetConfig.success_fraction_compensate">success_fraction_compensate</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeDatasetConfig.load">load</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeDatasetConfig.validate_fields_types">validate_fields_types</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#MazeDatasetCollection">MazeDatasetCollection</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#MazeDatasetCollection.__init__">MazeDatasetCollection</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeDatasetCollection.cfg">cfg</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeDatasetCollection.maze_datasets">maze_datasets</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeDatasetCollection.generation_metadata_collected">generation_metadata_collected</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeDatasetCollection.dataset_lengths">dataset_lengths</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeDatasetCollection.dataset_cum_lengths">dataset_cum_lengths</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeDatasetCollection.mazes">mazes</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeDatasetCollection.generate">generate</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeDatasetCollection.download">download</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeDatasetCollection.serialize">serialize</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeDatasetCollection.load">load</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeDatasetCollection.as_tokens">as_tokens</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeDatasetCollection.update_self_config">update_self_config</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#MazeDatasetCollectionConfig">MazeDatasetCollectionConfig</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#MazeDatasetCollectionConfig.__init__">MazeDatasetCollectionConfig</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeDatasetCollectionConfig.maze_dataset_configs">maze_dataset_configs</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeDatasetCollectionConfig.summary">summary</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeDatasetCollectionConfig.n_mazes">n_mazes</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeDatasetCollectionConfig.max_grid_n">max_grid_n</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeDatasetCollectionConfig.max_grid_shape">max_grid_shape</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeDatasetCollectionConfig.max_grid_shape_np">max_grid_shape_np</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeDatasetCollectionConfig.stable_hash_cfg">stable_hash_cfg</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeDatasetCollectionConfig.to_fname">to_fname</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeDatasetCollectionConfig.serialize">serialize</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeDatasetCollectionConfig.load">load</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeDatasetCollectionConfig.validate_fields_types">validate_fields_types</a>
                        </li>
                </ul>

            </li>
    </ul>


    <hr/>
    
    <div>
        <a href="../coverage/html/index.html" class="pdoc-button" title="View test coverage report">
            Coverage
        </a>
        <a href="../other/todo-inline.html" class="pdoc-button" title="Table of TODOs scraped from source code, with links to create issues from them">
            TODOs
        </a>
        <a href="../other/lmcat.txt" class="pdoc-button" title="a view of the repo contents made for LLMs, using https://miv.name/lmcat">
            lmcat
        </a>
    </div>


        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span>
            <img src="../resources/svg/pdoc-logo.svg" alt="pdoc logo"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                        <a class="pdoc-button git-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py">View Source on GitHub</a>
                    <h1 class="modulename">
<a href="./../maze_dataset.html">maze_dataset</a><wbr>.dataset    </h1>

                        <div class="docstring"><p><code><a href="#MazeDatasetConfig">MazeDatasetConfig</a></code>s are used to create a <code><a href="#MazeDataset">MazeDataset</a></code> via <code><a href="#MazeDataset.from_config">MazeDataset.from_config</a>(cfg)</code>"</p>

<p>When initializing mazes, further configuration options can be specified through the <code>from_config()</code> factory method as necessary. Options include 1) whether to generate the dataset during runtime or load an existing dataset, 2) if and how to parallelize generation, and 3) where to store the generated dataset. Full documentation of configuration options is available in our repository [@maze-dataset-github]. Available maze generation algorithms are static methods of the <code>LatticeMazeGenerators</code> class.</p>

<p>Furthermore, a dataset of mazes can be filtered to satisfy certain properties:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="n">dataset_filtered</span><span class="p">:</span> <span class="n">MazeDataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">filter_by</span><span class="o">.</span><span class="n">path_length</span><span class="p">(</span><span class="n">min_length</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</code></pre>
</div>

<p>Custom filters can be specified, and several filters are included:</p>

<ul>
<li><code>path_length(min_length: int)</code>: shortest length from the origin to target should be at least <code>min_length</code>.</li>
<li><code>start_end_distance(min_distance: int)</code>: Manhattan distance between start and end should be at least <code>min_distance</code>, ignoring walls.</li>
<li><code>remove_duplicates(...)</code>: remove mazes which are similar to others in the dataset, measured via Hamming distance.</li>
<li><code>remove_duplicates_fast()</code>: remove mazes which are exactly identical to others in the dataset.</li>
</ul>

<p>All implemented maze generation algorithms are stochastic by nature. For reproducibility, the <code>seed</code> parameter of <code><a href="#MazeDatasetConfig">MazeDatasetConfig</a></code> may be set. In practice, we do not find that exact duplicates of mazes are generated with any meaningful frequency,
even when generating large datasets.</p>
</div>

                        <input id="mod-dataset-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="mod-dataset-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L0-L44" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

                <br/>
                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos"> 1</span></a><span class="sd">&quot;&quot;&quot;`MazeDatasetConfig`s are used to create a `MazeDataset` via `MazeDataset.from_config(cfg)`&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos"> 2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos"> 3</span></a><span class="sd">When initializing mazes, further configuration options can be specified through the `from_config()` factory method as necessary. Options include 1) whether to generate the dataset during runtime or load an existing dataset, 2) if and how to parallelize generation, and 3) where to store the generated dataset. Full documentation of configuration options is available in our repository [@maze-dataset-github]. Available maze generation algorithms are static methods of the `LatticeMazeGenerators` class.</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos"> 4</span></a>
</span><span id="L-5"><a href="#L-5"><span class="linenos"> 5</span></a><span class="sd">Furthermore, a dataset of mazes can be filtered to satisfy certain properties:</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos"> 6</span></a>
</span><span id="L-7"><a href="#L-7"><span class="linenos"> 7</span></a><span class="sd">```python</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos"> 8</span></a><span class="sd">dataset_filtered: MazeDataset = dataset.filter_by.path_length(min_length=3)</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos"> 9</span></a><span class="sd">```</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">10</span></a>
</span><span id="L-11"><a href="#L-11"><span class="linenos">11</span></a><span class="sd">Custom filters can be specified, and several filters are included:</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">12</span></a>
</span><span id="L-13"><a href="#L-13"><span class="linenos">13</span></a><span class="sd">- `path_length(min_length: int)`: shortest length from the origin to target should be at least `min_length`.</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">14</span></a><span class="sd">- `start_end_distance(min_distance: int)`: Manhattan distance between start and end should be at least `min_distance`, ignoring walls.</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">15</span></a><span class="sd">- `remove_duplicates(...)`: remove mazes which are similar to others in the dataset, measured via Hamming distance.</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">16</span></a><span class="sd">- `remove_duplicates_fast()`: remove mazes which are exactly identical to others in the dataset.</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">17</span></a>
</span><span id="L-18"><a href="#L-18"><span class="linenos">18</span></a><span class="sd">All implemented maze generation algorithms are stochastic by nature. For reproducibility, the `seed` parameter of `MazeDatasetConfig` may be set. In practice, we do not find that exact duplicates of mazes are generated with any meaningful frequency,</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">19</span></a><span class="sd">even when generating large datasets.</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">20</span></a>
</span><span id="L-21"><a href="#L-21"><span class="linenos">21</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">22</span></a>
</span><span id="L-23"><a href="#L-23"><span class="linenos">23</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">maze_dataset.dataset.collected_dataset</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">24</span></a>	<span class="n">MazeDatasetCollection</span><span class="p">,</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">25</span></a>	<span class="n">MazeDatasetCollectionConfig</span><span class="p">,</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">26</span></a><span class="p">)</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">27</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">maze_dataset.dataset.maze_dataset</span><span class="w"> </span><span class="kn">import</span> <span class="n">MazeDataset</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">28</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">maze_dataset.dataset.maze_dataset_config</span><span class="w"> </span><span class="kn">import</span> <span class="n">MazeDatasetConfig</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">29</span></a>
</span><span id="L-30"><a href="#L-30"><span class="linenos">30</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">31</span></a>	<span class="c1"># submodules</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">32</span></a>	<span class="s2">&quot;collected_dataset&quot;</span><span class="p">,</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">33</span></a>	<span class="s2">&quot;configs&quot;</span><span class="p">,</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">34</span></a>	<span class="s2">&quot;dataset&quot;</span><span class="p">,</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">35</span></a>	<span class="s2">&quot;filters&quot;</span><span class="p">,</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos">36</span></a>	<span class="s2">&quot;maze_dataset_config&quot;</span><span class="p">,</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">37</span></a>	<span class="s2">&quot;maze_dataset&quot;</span><span class="p">,</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">38</span></a>	<span class="s2">&quot;rasterized&quot;</span><span class="p">,</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">39</span></a>	<span class="s2">&quot;success_predict_math&quot;</span><span class="p">,</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">40</span></a>	<span class="c1"># dataset classes</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">41</span></a>	<span class="s2">&quot;MazeDataset&quot;</span><span class="p">,</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">42</span></a>	<span class="s2">&quot;MazeDatasetConfig&quot;</span><span class="p">,</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos">43</span></a>	<span class="s2">&quot;MazeDatasetCollection&quot;</span><span class="p">,</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">44</span></a>	<span class="s2">&quot;MazeDatasetCollectionConfig&quot;</span><span class="p">,</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">45</span></a><span class="p">]</span>
</span></pre></div>


                <br/>
            </section>
                <section id="MazeDataset">
                            <input id="MazeDataset-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">MazeDataset</span><wbr>(<span class="base"><a href="dataset/dataset.html#GPTDataset">maze_dataset.dataset.dataset.GPTDataset[maze_dataset.dataset.maze_dataset_config.MazeDatasetConfig]</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDataset-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L113-L566" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDataset"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDataset-114"><a href="#MazeDataset-114"><span class="linenos">114</span></a><span class="k">class</span><span class="w"> </span><span class="nc">MazeDataset</span><span class="p">(</span><span class="n">GPTDataset</span><span class="p">[</span><span class="n">MazeDatasetConfig</span><span class="p">]):</span>  <span class="c1"># noqa: PLW1641</span>
</span><span id="MazeDataset-115"><a href="#MazeDataset-115"><span class="linenos">115</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;a maze dataset class. This is a collection of solved mazes, and should be initialized via `MazeDataset.from_config`&quot;&quot;&quot;</span>
</span><span id="MazeDataset-116"><a href="#MazeDataset-116"><span class="linenos">116</span></a>
</span><span id="MazeDataset-117"><a href="#MazeDataset-117"><span class="linenos">117</span></a>	<span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="MazeDataset-118"><a href="#MazeDataset-118"><span class="linenos">118</span></a>		<span class="bp">self</span><span class="p">,</span>
</span><span id="MazeDataset-119"><a href="#MazeDataset-119"><span class="linenos">119</span></a>		<span class="n">cfg</span><span class="p">:</span> <span class="n">MazeDatasetConfig</span><span class="p">,</span>
</span><span id="MazeDataset-120"><a href="#MazeDataset-120"><span class="linenos">120</span></a>		<span class="n">mazes</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">SolvedMaze</span><span class="p">],</span>
</span><span id="MazeDataset-121"><a href="#MazeDataset-121"><span class="linenos">121</span></a>		<span class="n">generation_metadata_collected</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="MazeDataset-122"><a href="#MazeDataset-122"><span class="linenos">122</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeDataset-123"><a href="#MazeDataset-123"><span class="linenos">123</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;initialize a maze dataset from a config and a list of solved mazes&quot;&quot;&quot;</span>
</span><span id="MazeDataset-124"><a href="#MazeDataset-124"><span class="linenos">124</span></a>		<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="MazeDataset-125"><a href="#MazeDataset-125"><span class="linenos">125</span></a>		<span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">:</span> <span class="n">MazeDatasetConfig</span> <span class="o">=</span> <span class="n">cfg</span>
</span><span id="MazeDataset-126"><a href="#MazeDataset-126"><span class="linenos">126</span></a>		<span class="bp">self</span><span class="o">.</span><span class="n">mazes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">SolvedMaze</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mazes</span><span class="p">)</span>
</span><span id="MazeDataset-127"><a href="#MazeDataset-127"><span class="linenos">127</span></a>		<span class="bp">self</span><span class="o">.</span><span class="n">generation_metadata_collected</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">generation_metadata_collected</span>
</span><span id="MazeDataset-128"><a href="#MazeDataset-128"><span class="linenos">128</span></a>
</span><span id="MazeDataset-129"><a href="#MazeDataset-129"><span class="linenos">129</span></a>	<span class="c1"># TYPING: error: Return type &quot;MazeDataset&quot; of &quot;from_config&quot; incompatible with return type &quot;T_Dataset&quot; in supertype &quot;GPTDataset&quot;  [override]</span>
</span><span id="MazeDataset-130"><a href="#MazeDataset-130"><span class="linenos">130</span></a>	<span class="nd">@classmethod</span>
</span><span id="MazeDataset-131"><a href="#MazeDataset-131"><span class="linenos">131</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">from_config</span><span class="p">(</span>  <span class="c1"># type: ignore[override]</span>
</span><span id="MazeDataset-132"><a href="#MazeDataset-132"><span class="linenos">132</span></a>		<span class="bp">cls</span><span class="p">,</span>
</span><span id="MazeDataset-133"><a href="#MazeDataset-133"><span class="linenos">133</span></a>		<span class="c1"># TYPING: error: Argument 1 of &quot;from_config&quot; is incompatible with supertype &quot;GPTDataset&quot;; supertype defines the argument type as &quot;T_DatasetConfig&quot;  [override]</span>
</span><span id="MazeDataset-134"><a href="#MazeDataset-134"><span class="linenos">134</span></a>		<span class="n">cfg</span><span class="p">:</span> <span class="n">MazeDatasetConfig</span><span class="p">,</span>  <span class="c1"># type: ignore[override]</span>
</span><span id="MazeDataset-135"><a href="#MazeDataset-135"><span class="linenos">135</span></a>		<span class="n">do_generate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="MazeDataset-136"><a href="#MazeDataset-136"><span class="linenos">136</span></a>		<span class="n">load_local</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="MazeDataset-137"><a href="#MazeDataset-137"><span class="linenos">137</span></a>		<span class="n">save_local</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="MazeDataset-138"><a href="#MazeDataset-138"><span class="linenos">138</span></a>		<span class="n">zanj</span><span class="p">:</span> <span class="n">ZANJ</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="MazeDataset-139"><a href="#MazeDataset-139"><span class="linenos">139</span></a>		<span class="n">do_download</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="MazeDataset-140"><a href="#MazeDataset-140"><span class="linenos">140</span></a>		<span class="n">local_base_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;data/maze_dataset&quot;</span><span class="p">),</span>
</span><span id="MazeDataset-141"><a href="#MazeDataset-141"><span class="linenos">141</span></a>		<span class="n">except_on_config_mismatch</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="MazeDataset-142"><a href="#MazeDataset-142"><span class="linenos">142</span></a>		<span class="n">allow_generation_metadata_filter_mismatch</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="MazeDataset-143"><a href="#MazeDataset-143"><span class="linenos">143</span></a>		<span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="MazeDataset-144"><a href="#MazeDataset-144"><span class="linenos">144</span></a>		<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="MazeDataset-145"><a href="#MazeDataset-145"><span class="linenos">145</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MazeDataset&quot;</span><span class="p">:</span>
</span><span id="MazeDataset-146"><a href="#MazeDataset-146"><span class="linenos">146</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;create a maze dataset from a config</span>
</span><span id="MazeDataset-147"><a href="#MazeDataset-147"><span class="linenos">147</span></a>
</span><span id="MazeDataset-148"><a href="#MazeDataset-148"><span class="linenos">148</span></a><span class="sd">		priority of loading:</span>
</span><span id="MazeDataset-149"><a href="#MazeDataset-149"><span class="linenos">149</span></a><span class="sd">		1. load from local</span>
</span><span id="MazeDataset-150"><a href="#MazeDataset-150"><span class="linenos">150</span></a><span class="sd">		2. download</span>
</span><span id="MazeDataset-151"><a href="#MazeDataset-151"><span class="linenos">151</span></a><span class="sd">		3. generate</span>
</span><span id="MazeDataset-152"><a href="#MazeDataset-152"><span class="linenos">152</span></a>
</span><span id="MazeDataset-153"><a href="#MazeDataset-153"><span class="linenos">153</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="MazeDataset-154"><a href="#MazeDataset-154"><span class="linenos">154</span></a>		<span class="k">return</span> <span class="n">cast</span><span class="p">(</span>
</span><span id="MazeDataset-155"><a href="#MazeDataset-155"><span class="linenos">155</span></a>			<span class="s2">&quot;MazeDataset&quot;</span><span class="p">,</span>
</span><span id="MazeDataset-156"><a href="#MazeDataset-156"><span class="linenos">156</span></a>			<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span>
</span><span id="MazeDataset-157"><a href="#MazeDataset-157"><span class="linenos">157</span></a>				<span class="n">cfg</span><span class="o">=</span><span class="n">cfg</span><span class="p">,</span>
</span><span id="MazeDataset-158"><a href="#MazeDataset-158"><span class="linenos">158</span></a>				<span class="n">do_generate</span><span class="o">=</span><span class="n">do_generate</span><span class="p">,</span>
</span><span id="MazeDataset-159"><a href="#MazeDataset-159"><span class="linenos">159</span></a>				<span class="n">load_local</span><span class="o">=</span><span class="n">load_local</span><span class="p">,</span>
</span><span id="MazeDataset-160"><a href="#MazeDataset-160"><span class="linenos">160</span></a>				<span class="n">save_local</span><span class="o">=</span><span class="n">save_local</span><span class="p">,</span>
</span><span id="MazeDataset-161"><a href="#MazeDataset-161"><span class="linenos">161</span></a>				<span class="n">zanj</span><span class="o">=</span><span class="n">zanj</span><span class="p">,</span>
</span><span id="MazeDataset-162"><a href="#MazeDataset-162"><span class="linenos">162</span></a>				<span class="n">do_download</span><span class="o">=</span><span class="n">do_download</span><span class="p">,</span>
</span><span id="MazeDataset-163"><a href="#MazeDataset-163"><span class="linenos">163</span></a>				<span class="n">local_base_path</span><span class="o">=</span><span class="n">local_base_path</span><span class="p">,</span>
</span><span id="MazeDataset-164"><a href="#MazeDataset-164"><span class="linenos">164</span></a>				<span class="n">except_on_config_mismatch</span><span class="o">=</span><span class="n">except_on_config_mismatch</span><span class="p">,</span>
</span><span id="MazeDataset-165"><a href="#MazeDataset-165"><span class="linenos">165</span></a>				<span class="n">allow_generation_metadata_filter_mismatch</span><span class="o">=</span><span class="n">allow_generation_metadata_filter_mismatch</span><span class="p">,</span>
</span><span id="MazeDataset-166"><a href="#MazeDataset-166"><span class="linenos">166</span></a>				<span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
</span><span id="MazeDataset-167"><a href="#MazeDataset-167"><span class="linenos">167</span></a>				<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="MazeDataset-168"><a href="#MazeDataset-168"><span class="linenos">168</span></a>			<span class="p">),</span>
</span><span id="MazeDataset-169"><a href="#MazeDataset-169"><span class="linenos">169</span></a>		<span class="p">)</span>
</span><span id="MazeDataset-170"><a href="#MazeDataset-170"><span class="linenos">170</span></a>
</span><span id="MazeDataset-171"><a href="#MazeDataset-171"><span class="linenos">171</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">data_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="MazeDataset-172"><a href="#MazeDataset-172"><span class="linenos">172</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;return a hash of the data&quot;&quot;&quot;</span>
</span><span id="MazeDataset-173"><a href="#MazeDataset-173"><span class="linenos">173</span></a>		<span class="k">return</span> <span class="n">stable_hash</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">tuple</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mazes</span><span class="p">])))</span>
</span><span id="MazeDataset-174"><a href="#MazeDataset-174"><span class="linenos">174</span></a>
</span><span id="MazeDataset-175"><a href="#MazeDataset-175"><span class="linenos">175</span></a>	<span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SolvedMaze</span><span class="p">:</span>
</span><span id="MazeDataset-176"><a href="#MazeDataset-176"><span class="linenos">176</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;get a maze by index&quot;&quot;&quot;</span>
</span><span id="MazeDataset-177"><a href="#MazeDataset-177"><span class="linenos">177</span></a>		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mazes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="MazeDataset-178"><a href="#MazeDataset-178"><span class="linenos">178</span></a>
</span><span id="MazeDataset-179"><a href="#MazeDataset-179"><span class="linenos">179</span></a>	<span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">SolvedMaze</span><span class="p">]:</span>
</span><span id="MazeDataset-180"><a href="#MazeDataset-180"><span class="linenos">180</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;iterate over the mazes&quot;&quot;&quot;</span>
</span><span id="MazeDataset-181"><a href="#MazeDataset-181"><span class="linenos">181</span></a>		<span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mazes</span><span class="p">)</span>
</span><span id="MazeDataset-182"><a href="#MazeDataset-182"><span class="linenos">182</span></a>
</span><span id="MazeDataset-183"><a href="#MazeDataset-183"><span class="linenos">183</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MazeDataset&quot;</span><span class="p">:</span>  <span class="c1"># noqa: ANN001</span>
</span><span id="MazeDataset-184"><a href="#MazeDataset-184"><span class="linenos">184</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;deepcopy the dataset</span>
</span><span id="MazeDataset-185"><a href="#MazeDataset-185"><span class="linenos">185</span></a>
</span><span id="MazeDataset-186"><a href="#MazeDataset-186"><span class="linenos">186</span></a><span class="sd">		FIX: this isnt actually a deepcopy I think?</span>
</span><span id="MazeDataset-187"><a href="#MazeDataset-187"><span class="linenos">187</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="MazeDataset-188"><a href="#MazeDataset-188"><span class="linenos">188</span></a>		<span class="k">return</span> <span class="n">MazeDataset</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_serialize_full</span><span class="p">())</span>
</span><span id="MazeDataset-189"><a href="#MazeDataset-189"><span class="linenos">189</span></a>
</span><span id="MazeDataset-190"><a href="#MazeDataset-190"><span class="linenos">190</span></a>	<span class="c1"># TYPING: get type hints on the tokenizer here</span>
</span><span id="MazeDataset-191"><a href="#MazeDataset-191"><span class="linenos">191</span></a>	<span class="nd">@overload</span>
</span><span id="MazeDataset-192"><a href="#MazeDataset-192"><span class="linenos">192</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">as_tokens</span><span class="p">(</span>
</span><span id="MazeDataset-193"><a href="#MazeDataset-193"><span class="linenos">193</span></a>		<span class="bp">self</span><span class="p">,</span>
</span><span id="MazeDataset-194"><a href="#MazeDataset-194"><span class="linenos">194</span></a>		<span class="n">maze_tokenizer</span><span class="p">,</span>  <span class="c1"># noqa: ANN001</span>
</span><span id="MazeDataset-195"><a href="#MazeDataset-195"><span class="linenos">195</span></a>		<span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="MazeDataset-196"><a href="#MazeDataset-196"><span class="linenos">196</span></a>		<span class="n">join_tokens_individual_maze</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="MazeDataset-197"><a href="#MazeDataset-197"><span class="linenos">197</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span> <span class="o">...</span>
</span><span id="MazeDataset-198"><a href="#MazeDataset-198"><span class="linenos">198</span></a>	<span class="nd">@overload</span>
</span><span id="MazeDataset-199"><a href="#MazeDataset-199"><span class="linenos">199</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">as_tokens</span><span class="p">(</span>
</span><span id="MazeDataset-200"><a href="#MazeDataset-200"><span class="linenos">200</span></a>		<span class="bp">self</span><span class="p">,</span>
</span><span id="MazeDataset-201"><a href="#MazeDataset-201"><span class="linenos">201</span></a>		<span class="n">maze_tokenizer</span><span class="p">,</span>  <span class="c1"># noqa: ANN001</span>
</span><span id="MazeDataset-202"><a href="#MazeDataset-202"><span class="linenos">202</span></a>		<span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="MazeDataset-203"><a href="#MazeDataset-203"><span class="linenos">203</span></a>		<span class="n">join_tokens_individual_maze</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="MazeDataset-204"><a href="#MazeDataset-204"><span class="linenos">204</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span> <span class="o">...</span>
</span><span id="MazeDataset-205"><a href="#MazeDataset-205"><span class="linenos">205</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">as_tokens</span><span class="p">(</span>
</span><span id="MazeDataset-206"><a href="#MazeDataset-206"><span class="linenos">206</span></a>		<span class="bp">self</span><span class="p">,</span>
</span><span id="MazeDataset-207"><a href="#MazeDataset-207"><span class="linenos">207</span></a>		<span class="n">maze_tokenizer</span><span class="p">,</span>  <span class="c1"># TODO: MazeTokenizer</span>
</span><span id="MazeDataset-208"><a href="#MazeDataset-208"><span class="linenos">208</span></a>		<span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="MazeDataset-209"><a href="#MazeDataset-209"><span class="linenos">209</span></a>		<span class="n">join_tokens_individual_maze</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="MazeDataset-210"><a href="#MazeDataset-210"><span class="linenos">210</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="MazeDataset-211"><a href="#MazeDataset-211"><span class="linenos">211</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;return the dataset as tokens according to the passed `maze_tokenizer`</span>
</span><span id="MazeDataset-212"><a href="#MazeDataset-212"><span class="linenos">212</span></a>
</span><span id="MazeDataset-213"><a href="#MazeDataset-213"><span class="linenos">213</span></a><span class="sd">		the `maze_tokenizer` should be either a `MazeTokenizer` or a `MazeTokenizerModular`</span>
</span><span id="MazeDataset-214"><a href="#MazeDataset-214"><span class="linenos">214</span></a>
</span><span id="MazeDataset-215"><a href="#MazeDataset-215"><span class="linenos">215</span></a><span class="sd">		if `join_tokens_individual_maze` is True, then the tokens of each maze are</span>
</span><span id="MazeDataset-216"><a href="#MazeDataset-216"><span class="linenos">216</span></a><span class="sd">		joined with a space, and the result is a list of strings.</span>
</span><span id="MazeDataset-217"><a href="#MazeDataset-217"><span class="linenos">217</span></a><span class="sd">		i.e.:</span>
</span><span id="MazeDataset-218"><a href="#MazeDataset-218"><span class="linenos">218</span></a>
</span><span id="MazeDataset-219"><a href="#MazeDataset-219"><span class="linenos">219</span></a><span class="sd">			&gt;&gt;&gt; dataset.as_tokens(join_tokens_individual_maze=False)</span>
</span><span id="MazeDataset-220"><a href="#MazeDataset-220"><span class="linenos">220</span></a><span class="sd">			[[&quot;a&quot;, &quot;b&quot;, &quot;c&quot;], [&quot;d&quot;, &quot;e&quot;, &quot;f&quot;]]</span>
</span><span id="MazeDataset-221"><a href="#MazeDataset-221"><span class="linenos">221</span></a><span class="sd">			&gt;&gt;&gt; dataset.as_tokens(join_tokens_individual_maze=True)</span>
</span><span id="MazeDataset-222"><a href="#MazeDataset-222"><span class="linenos">222</span></a><span class="sd">			[&quot;a b c&quot;, &quot;d e f&quot;]</span>
</span><span id="MazeDataset-223"><a href="#MazeDataset-223"><span class="linenos">223</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="MazeDataset-224"><a href="#MazeDataset-224"><span class="linenos">224</span></a>		<span class="n">output</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="MazeDataset-225"><a href="#MazeDataset-225"><span class="linenos">225</span></a>			<span class="n">maze</span><span class="o">.</span><span class="n">as_tokens</span><span class="p">(</span><span class="n">maze_tokenizer</span><span class="p">)</span> <span class="k">for</span> <span class="n">maze</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mazes</span><span class="p">[:</span><span class="n">limit</span><span class="p">]</span>
</span><span id="MazeDataset-226"><a href="#MazeDataset-226"><span class="linenos">226</span></a>		<span class="p">]</span>
</span><span id="MazeDataset-227"><a href="#MazeDataset-227"><span class="linenos">227</span></a>		<span class="k">if</span> <span class="n">join_tokens_individual_maze</span><span class="p">:</span>
</span><span id="MazeDataset-228"><a href="#MazeDataset-228"><span class="linenos">228</span></a>			<span class="k">return</span> <span class="p">[</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span> <span class="k">for</span> <span class="n">tokens</span> <span class="ow">in</span> <span class="n">output</span><span class="p">]</span>
</span><span id="MazeDataset-229"><a href="#MazeDataset-229"><span class="linenos">229</span></a>		<span class="k">else</span><span class="p">:</span>
</span><span id="MazeDataset-230"><a href="#MazeDataset-230"><span class="linenos">230</span></a>			<span class="k">return</span> <span class="n">output</span>
</span><span id="MazeDataset-231"><a href="#MazeDataset-231"><span class="linenos">231</span></a>
</span><span id="MazeDataset-232"><a href="#MazeDataset-232"><span class="linenos">232</span></a>	<span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="MazeDataset-233"><a href="#MazeDataset-233"><span class="linenos">233</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;return the number of mazes in the dataset&quot;&quot;&quot;</span>
</span><span id="MazeDataset-234"><a href="#MazeDataset-234"><span class="linenos">234</span></a>		<span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mazes</span><span class="p">)</span>
</span><span id="MazeDataset-235"><a href="#MazeDataset-235"><span class="linenos">235</span></a>
</span><span id="MazeDataset-236"><a href="#MazeDataset-236"><span class="linenos">236</span></a>	<span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="MazeDataset-237"><a href="#MazeDataset-237"><span class="linenos">237</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;compare two datasets&quot;&quot;&quot;</span>
</span><span id="MazeDataset-238"><a href="#MazeDataset-238"><span class="linenos">238</span></a>		<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">MazeDataset</span><span class="p">):</span>
</span><span id="MazeDataset-239"><a href="#MazeDataset-239"><span class="linenos">239</span></a>			<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="MazeDataset-240"><a href="#MazeDataset-240"><span class="linenos">240</span></a>				<span class="s2">&quot;can only compare with other MazeDataset objects&quot;</span><span class="p">,</span>
</span><span id="MazeDataset-241"><a href="#MazeDataset-241"><span class="linenos">241</span></a>			<span class="p">)</span>
</span><span id="MazeDataset-242"><a href="#MazeDataset-242"><span class="linenos">242</span></a>		<span class="c1"># TODO: compare hashes of data instead of the data itself?</span>
</span><span id="MazeDataset-243"><a href="#MazeDataset-243"><span class="linenos">243</span></a>		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">cfg</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">mazes</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">mazes</span>
</span><span id="MazeDataset-244"><a href="#MazeDataset-244"><span class="linenos">244</span></a>
</span><span id="MazeDataset-245"><a href="#MazeDataset-245"><span class="linenos">245</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">assert_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;MazeDataset&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeDataset-246"><a href="#MazeDataset-246"><span class="linenos">246</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;assert that two datasets are equal&quot;&quot;&quot;</span>
</span><span id="MazeDataset-247"><a href="#MazeDataset-247"><span class="linenos">247</span></a>		<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">MazeDataset</span><span class="p">)</span>
</span><span id="MazeDataset-248"><a href="#MazeDataset-248"><span class="linenos">248</span></a>		<span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">cfg</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">cfg</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="MazeDataset-249"><a href="#MazeDataset-249"><span class="linenos">249</span></a>		<span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">mazes</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">mazes</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mazes</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="n">other</span><span class="o">.</span><span class="n">mazes</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="MazeDataset-250"><a href="#MazeDataset-250"><span class="linenos">250</span></a>
</span><span id="MazeDataset-251"><a href="#MazeDataset-251"><span class="linenos">251</span></a>	<span class="nd">@classmethod</span>
</span><span id="MazeDataset-252"><a href="#MazeDataset-252"><span class="linenos">252</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">generate</span><span class="p">(</span>
</span><span id="MazeDataset-253"><a href="#MazeDataset-253"><span class="linenos">253</span></a>		<span class="bp">cls</span><span class="p">,</span>
</span><span id="MazeDataset-254"><a href="#MazeDataset-254"><span class="linenos">254</span></a>		<span class="n">cfg</span><span class="p">:</span> <span class="n">MazeDatasetConfig</span><span class="p">,</span>
</span><span id="MazeDataset-255"><a href="#MazeDataset-255"><span class="linenos">255</span></a>		<span class="n">gen_parallel</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="MazeDataset-256"><a href="#MazeDataset-256"><span class="linenos">256</span></a>		<span class="n">pool_kwargs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="MazeDataset-257"><a href="#MazeDataset-257"><span class="linenos">257</span></a>		<span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="MazeDataset-258"><a href="#MazeDataset-258"><span class="linenos">258</span></a>		<span class="c1"># TODO: what to do when unexpected kwargs are passed?</span>
</span><span id="MazeDataset-259"><a href="#MazeDataset-259"><span class="linenos">259</span></a>		<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>  <span class="c1"># noqa: ARG003</span>
</span><span id="MazeDataset-260"><a href="#MazeDataset-260"><span class="linenos">260</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MazeDataset&quot;</span><span class="p">:</span>
</span><span id="MazeDataset-261"><a href="#MazeDataset-261"><span class="linenos">261</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Generate a maze dataset given a config and some generation parameters&quot;&quot;&quot;</span>
</span><span id="MazeDataset-262"><a href="#MazeDataset-262"><span class="linenos">262</span></a>		<span class="c1"># Copy the config to avoid modifying the original</span>
</span><span id="MazeDataset-263"><a href="#MazeDataset-263"><span class="linenos">263</span></a>		<span class="n">cfg_cpy</span><span class="p">:</span> <span class="n">MazeDatasetConfig</span> <span class="o">=</span> <span class="n">MazeDatasetConfig</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
</span><span id="MazeDataset-264"><a href="#MazeDataset-264"><span class="linenos">264</span></a>			<span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">serialize</span><span class="p">())),</span>
</span><span id="MazeDataset-265"><a href="#MazeDataset-265"><span class="linenos">265</span></a>		<span class="p">)</span>
</span><span id="MazeDataset-266"><a href="#MazeDataset-266"><span class="linenos">266</span></a>
</span><span id="MazeDataset-267"><a href="#MazeDataset-267"><span class="linenos">267</span></a>		<span class="k">if</span> <span class="n">pool_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeDataset-268"><a href="#MazeDataset-268"><span class="linenos">268</span></a>			<span class="n">pool_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="MazeDataset-269"><a href="#MazeDataset-269"><span class="linenos">269</span></a>		<span class="n">maze_indexes</span><span class="p">:</span> <span class="n">Int</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot; maze_index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">cfg_cpy</span><span class="o">.</span><span class="n">n_mazes</span><span class="p">)</span>  <span class="c1"># type: ignore[assignment]</span>
</span><span id="MazeDataset-270"><a href="#MazeDataset-270"><span class="linenos">270</span></a>
</span><span id="MazeDataset-271"><a href="#MazeDataset-271"><span class="linenos">271</span></a>		<span class="n">solved_mazes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">SolvedMaze</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span>
</span><span id="MazeDataset-272"><a href="#MazeDataset-272"><span class="linenos">272</span></a>		<span class="c1"># Configure tqdm for progress bar</span>
</span><span id="MazeDataset-273"><a href="#MazeDataset-273"><span class="linenos">273</span></a>		<span class="n">tqdm_kwargs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
</span><span id="MazeDataset-274"><a href="#MazeDataset-274"><span class="linenos">274</span></a>			<span class="n">total</span><span class="o">=</span><span class="n">cfg_cpy</span><span class="o">.</span><span class="n">n_mazes</span><span class="p">,</span>
</span><span id="MazeDataset-275"><a href="#MazeDataset-275"><span class="linenos">275</span></a>			<span class="n">unit</span><span class="o">=</span><span class="s2">&quot;maze&quot;</span><span class="p">,</span>
</span><span id="MazeDataset-276"><a href="#MazeDataset-276"><span class="linenos">276</span></a>			<span class="n">desc</span><span class="o">=</span><span class="s2">&quot;generating &amp; solving mazes&quot;</span><span class="p">,</span>
</span><span id="MazeDataset-277"><a href="#MazeDataset-277"><span class="linenos">277</span></a>			<span class="n">disable</span><span class="o">=</span><span class="ow">not</span> <span class="n">verbose</span><span class="p">,</span>
</span><span id="MazeDataset-278"><a href="#MazeDataset-278"><span class="linenos">278</span></a>		<span class="p">)</span>
</span><span id="MazeDataset-279"><a href="#MazeDataset-279"><span class="linenos">279</span></a>		<span class="c1"># TODO: don&#39;t use the global unless generating in parallel!</span>
</span><span id="MazeDataset-280"><a href="#MazeDataset-280"><span class="linenos">280</span></a>		<span class="k">if</span> <span class="n">gen_parallel</span><span class="p">:</span>
</span><span id="MazeDataset-281"><a href="#MazeDataset-281"><span class="linenos">281</span></a>			<span class="k">with</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span>
</span><span id="MazeDataset-282"><a href="#MazeDataset-282"><span class="linenos">282</span></a>				<span class="o">**</span><span class="n">pool_kwargs</span><span class="p">,</span>
</span><span id="MazeDataset-283"><a href="#MazeDataset-283"><span class="linenos">283</span></a>				<span class="n">initializer</span><span class="o">=</span><span class="n">_maze_gen_init_worker</span><span class="p">,</span>
</span><span id="MazeDataset-284"><a href="#MazeDataset-284"><span class="linenos">284</span></a>				<span class="n">initargs</span><span class="o">=</span><span class="p">(</span><span class="n">cfg_cpy</span><span class="p">,),</span>
</span><span id="MazeDataset-285"><a href="#MazeDataset-285"><span class="linenos">285</span></a>			<span class="p">)</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>
</span><span id="MazeDataset-286"><a href="#MazeDataset-286"><span class="linenos">286</span></a>				<span class="n">solved_mazes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="MazeDataset-287"><a href="#MazeDataset-287"><span class="linenos">287</span></a>					<span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span>
</span><span id="MazeDataset-288"><a href="#MazeDataset-288"><span class="linenos">288</span></a>						<span class="n">pool</span><span class="o">.</span><span class="n">imap</span><span class="p">(</span><span class="n">_generate_maze_helper</span><span class="p">,</span> <span class="n">maze_indexes</span><span class="p">),</span>
</span><span id="MazeDataset-289"><a href="#MazeDataset-289"><span class="linenos">289</span></a>						<span class="o">**</span><span class="n">tqdm_kwargs</span><span class="p">,</span>
</span><span id="MazeDataset-290"><a href="#MazeDataset-290"><span class="linenos">290</span></a>					<span class="p">),</span>
</span><span id="MazeDataset-291"><a href="#MazeDataset-291"><span class="linenos">291</span></a>				<span class="p">)</span>
</span><span id="MazeDataset-292"><a href="#MazeDataset-292"><span class="linenos">292</span></a>
</span><span id="MazeDataset-293"><a href="#MazeDataset-293"><span class="linenos">293</span></a>		<span class="k">else</span><span class="p">:</span>
</span><span id="MazeDataset-294"><a href="#MazeDataset-294"><span class="linenos">294</span></a>			<span class="n">_maze_gen_init_worker</span><span class="p">(</span><span class="n">cfg_cpy</span><span class="p">)</span>
</span><span id="MazeDataset-295"><a href="#MazeDataset-295"><span class="linenos">295</span></a>			<span class="n">solved_mazes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="MazeDataset-296"><a href="#MazeDataset-296"><span class="linenos">296</span></a>				<span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span>
</span><span id="MazeDataset-297"><a href="#MazeDataset-297"><span class="linenos">297</span></a>					<span class="nb">map</span><span class="p">(</span>
</span><span id="MazeDataset-298"><a href="#MazeDataset-298"><span class="linenos">298</span></a>						<span class="c1"># TYPING:  error: Argument 1 to &quot;map&quot; has incompatible type &quot;Callable[[int], SolvedMaze | None]&quot;; expected &quot;Callable[[str], SolvedMaze | None]&quot;  [arg-type]</span>
</span><span id="MazeDataset-299"><a href="#MazeDataset-299"><span class="linenos">299</span></a>						<span class="c1"># why does it think tolist() returns a string?</span>
</span><span id="MazeDataset-300"><a href="#MazeDataset-300"><span class="linenos">300</span></a>						<span class="n">_generate_maze_helper</span><span class="p">,</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="MazeDataset-301"><a href="#MazeDataset-301"><span class="linenos">301</span></a>						<span class="n">maze_indexes</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
</span><span id="MazeDataset-302"><a href="#MazeDataset-302"><span class="linenos">302</span></a>					<span class="p">),</span>
</span><span id="MazeDataset-303"><a href="#MazeDataset-303"><span class="linenos">303</span></a>					<span class="o">**</span><span class="n">tqdm_kwargs</span><span class="p">,</span>
</span><span id="MazeDataset-304"><a href="#MazeDataset-304"><span class="linenos">304</span></a>				<span class="p">),</span>
</span><span id="MazeDataset-305"><a href="#MazeDataset-305"><span class="linenos">305</span></a>			<span class="p">)</span>
</span><span id="MazeDataset-306"><a href="#MazeDataset-306"><span class="linenos">306</span></a>
</span><span id="MazeDataset-307"><a href="#MazeDataset-307"><span class="linenos">307</span></a>		<span class="c1"># Filter out None values explicitly after ensuring all results are collected</span>
</span><span id="MazeDataset-308"><a href="#MazeDataset-308"><span class="linenos">308</span></a>		<span class="n">solved_mazes_</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">SolvedMaze</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="MazeDataset-309"><a href="#MazeDataset-309"><span class="linenos">309</span></a>			<span class="n">maze</span> <span class="k">for</span> <span class="n">maze</span> <span class="ow">in</span> <span class="n">solved_mazes</span> <span class="k">if</span> <span class="n">maze</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="MazeDataset-310"><a href="#MazeDataset-310"><span class="linenos">310</span></a>		<span class="p">]</span>
</span><span id="MazeDataset-311"><a href="#MazeDataset-311"><span class="linenos">311</span></a>		<span class="c1"># solved_mazes_ = list(filter(lambda x: x is not None, solved_mazes))</span>
</span><span id="MazeDataset-312"><a href="#MazeDataset-312"><span class="linenos">312</span></a>
</span><span id="MazeDataset-313"><a href="#MazeDataset-313"><span class="linenos">313</span></a>		<span class="c1"># Update the config with the actual number of mazes</span>
</span><span id="MazeDataset-314"><a href="#MazeDataset-314"><span class="linenos">314</span></a>		<span class="n">cfg_cpy</span><span class="o">.</span><span class="n">n_mazes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">solved_mazes_</span><span class="p">)</span>
</span><span id="MazeDataset-315"><a href="#MazeDataset-315"><span class="linenos">315</span></a>
</span><span id="MazeDataset-316"><a href="#MazeDataset-316"><span class="linenos">316</span></a>		<span class="n">dataset</span><span class="p">:</span> <span class="n">MazeDataset</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="MazeDataset-317"><a href="#MazeDataset-317"><span class="linenos">317</span></a>			<span class="n">cfg</span><span class="o">=</span><span class="n">cfg_cpy</span><span class="p">,</span>
</span><span id="MazeDataset-318"><a href="#MazeDataset-318"><span class="linenos">318</span></a>			<span class="n">mazes</span><span class="o">=</span><span class="n">solved_mazes_</span><span class="p">,</span>
</span><span id="MazeDataset-319"><a href="#MazeDataset-319"><span class="linenos">319</span></a>		<span class="p">)</span>
</span><span id="MazeDataset-320"><a href="#MazeDataset-320"><span class="linenos">320</span></a>
</span><span id="MazeDataset-321"><a href="#MazeDataset-321"><span class="linenos">321</span></a>		<span class="n">dataset</span><span class="o">.</span><span class="n">update_self_config</span><span class="p">()</span>  <span class="c1"># Call `update_self_config()` to ensure the dataset&#39;s config reflects changes</span>
</span><span id="MazeDataset-322"><a href="#MazeDataset-322"><span class="linenos">322</span></a>
</span><span id="MazeDataset-323"><a href="#MazeDataset-323"><span class="linenos">323</span></a>		<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">cfg_cpy</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>  <span class="c1"># Reset the seed to the value in the config copy</span>
</span><span id="MazeDataset-324"><a href="#MazeDataset-324"><span class="linenos">324</span></a>
</span><span id="MazeDataset-325"><a href="#MazeDataset-325"><span class="linenos">325</span></a>		<span class="k">return</span> <span class="n">dataset</span>
</span><span id="MazeDataset-326"><a href="#MazeDataset-326"><span class="linenos">326</span></a>
</span><span id="MazeDataset-327"><a href="#MazeDataset-327"><span class="linenos">327</span></a>	<span class="nd">@classmethod</span>
</span><span id="MazeDataset-328"><a href="#MazeDataset-328"><span class="linenos">328</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">download</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">MazeDatasetConfig</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MazeDataset&quot;</span><span class="p">:</span>
</span><span id="MazeDataset-329"><a href="#MazeDataset-329"><span class="linenos">329</span></a>		<span class="s2">&quot;(not implemented yet!) download a maze dataset from the internet&quot;</span>
</span><span id="MazeDataset-330"><a href="#MazeDataset-330"><span class="linenos">330</span></a>		<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;not implemented yet&quot;</span><span class="p">)</span>
</span><span id="MazeDataset-331"><a href="#MazeDataset-331"><span class="linenos">331</span></a>
</span><span id="MazeDataset-332"><a href="#MazeDataset-332"><span class="linenos">332</span></a>	<span class="nd">@classmethod</span>
</span><span id="MazeDataset-333"><a href="#MazeDataset-333"><span class="linenos">333</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="s2">&quot;type[MazeDataset]&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">JSONdict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MazeDataset&quot;</span><span class="p">:</span>
</span><span id="MazeDataset-334"><a href="#MazeDataset-334"><span class="linenos">334</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;load from zanj/json&quot;&quot;&quot;</span>
</span><span id="MazeDataset-335"><a href="#MazeDataset-335"><span class="linenos">335</span></a>		<span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">_FORMAT_KEY</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;MazeDataset:minimal&quot;</span><span class="p">:</span>
</span><span id="MazeDataset-336"><a href="#MazeDataset-336"><span class="linenos">336</span></a>			<span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_load_minimal</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="MazeDataset-337"><a href="#MazeDataset-337"><span class="linenos">337</span></a>		<span class="k">elif</span> <span class="n">data</span><span class="p">[</span><span class="n">_FORMAT_KEY</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;MazeDataset:minimal_soln_cat&quot;</span><span class="p">:</span>
</span><span id="MazeDataset-338"><a href="#MazeDataset-338"><span class="linenos">338</span></a>			<span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_load_minimal_soln_cat</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="MazeDataset-339"><a href="#MazeDataset-339"><span class="linenos">339</span></a>		<span class="k">elif</span> <span class="n">data</span><span class="p">[</span><span class="n">_FORMAT_KEY</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;MazeDataset&quot;</span><span class="p">:</span>
</span><span id="MazeDataset-340"><a href="#MazeDataset-340"><span class="linenos">340</span></a>			<span class="k">if</span> <span class="p">(</span>
</span><span id="MazeDataset-341"><a href="#MazeDataset-341"><span class="linenos">341</span></a>				<span class="n">SERIALIZE_MINIMAL_THRESHOLD</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="MazeDataset-342"><a href="#MazeDataset-342"><span class="linenos">342</span></a>			<span class="p">):</span>  <span class="c1"># Allow access to `_load_legacy` for profiling</span>
</span><span id="MazeDataset-343"><a href="#MazeDataset-343"><span class="linenos">343</span></a>				<span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_load_legacy</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="MazeDataset-344"><a href="#MazeDataset-344"><span class="linenos">344</span></a>			<span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_load_full</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="MazeDataset-345"><a href="#MazeDataset-345"><span class="linenos">345</span></a>		<span class="k">else</span><span class="p">:</span>
</span><span id="MazeDataset-346"><a href="#MazeDataset-346"><span class="linenos">346</span></a>			<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;`_FORMAT_KEY` string </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="n">_FORMAT_KEY</span><span class="p">]</span><span class="w"> </span><span class="si">= }</span><span class="s2"> is not a recognized `MazeDataset` format. (</span><span class="si">{</span><span class="n">_FORMAT_KEY</span><span class="w"> </span><span class="si">= }</span><span class="s2">)&quot;</span>
</span><span id="MazeDataset-347"><a href="#MazeDataset-347"><span class="linenos">347</span></a>			<span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
</span><span id="MazeDataset-348"><a href="#MazeDataset-348"><span class="linenos">348</span></a>				<span class="n">err_msg</span><span class="p">,</span>
</span><span id="MazeDataset-349"><a href="#MazeDataset-349"><span class="linenos">349</span></a>			<span class="p">)</span>
</span><span id="MazeDataset-350"><a href="#MazeDataset-350"><span class="linenos">350</span></a>
</span><span id="MazeDataset-351"><a href="#MazeDataset-351"><span class="linenos">351</span></a>	<span class="nd">@classmethod</span>
</span><span id="MazeDataset-352"><a href="#MazeDataset-352"><span class="linenos">352</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">_load_full</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">JSONdict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MazeDataset&quot;</span><span class="p">:</span>
</span><span id="MazeDataset-353"><a href="#MazeDataset-353"><span class="linenos">353</span></a>		<span class="k">assert</span> <span class="n">data</span><span class="p">[</span><span class="n">_FORMAT_KEY</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;MazeDataset&quot;</span>
</span><span id="MazeDataset-354"><a href="#MazeDataset-354"><span class="linenos">354</span></a>		<span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="MazeDataset-355"><a href="#MazeDataset-355"><span class="linenos">355</span></a>			<span class="n">cfg</span><span class="o">=</span><span class="n">MazeDatasetConfig</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;cfg&quot;</span><span class="p">]),</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="MazeDataset-356"><a href="#MazeDataset-356"><span class="linenos">356</span></a>			<span class="n">mazes</span><span class="o">=</span><span class="n">load_item_recursive</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;mazes&quot;</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">()),</span>
</span><span id="MazeDataset-357"><a href="#MazeDataset-357"><span class="linenos">357</span></a>			<span class="n">generation_metadata_collected</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;generation_metadata_collected&quot;</span><span class="p">],</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="MazeDataset-358"><a href="#MazeDataset-358"><span class="linenos">358</span></a>		<span class="p">)</span>
</span><span id="MazeDataset-359"><a href="#MazeDataset-359"><span class="linenos">359</span></a>
</span><span id="MazeDataset-360"><a href="#MazeDataset-360"><span class="linenos">360</span></a>	<span class="nd">@classmethod</span>
</span><span id="MazeDataset-361"><a href="#MazeDataset-361"><span class="linenos">361</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">_load_minimal</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">JSONdict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MazeDataset&quot;</span><span class="p">:</span>
</span><span id="MazeDataset-362"><a href="#MazeDataset-362"><span class="linenos">362</span></a>		<span class="k">assert</span> <span class="n">data</span><span class="p">[</span><span class="n">_FORMAT_KEY</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;MazeDataset:minimal&quot;</span>
</span><span id="MazeDataset-363"><a href="#MazeDataset-363"><span class="linenos">363</span></a>		<span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="MazeDataset-364"><a href="#MazeDataset-364"><span class="linenos">364</span></a>			<span class="n">cfg</span><span class="o">=</span><span class="n">MazeDatasetConfig</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;cfg&quot;</span><span class="p">]),</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="MazeDataset-365"><a href="#MazeDataset-365"><span class="linenos">365</span></a>			<span class="n">generation_metadata_collected</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;generation_metadata_collected&quot;</span><span class="p">],</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="MazeDataset-366"><a href="#MazeDataset-366"><span class="linenos">366</span></a>			<span class="n">mazes</span><span class="o">=</span><span class="p">[</span>
</span><span id="MazeDataset-367"><a href="#MazeDataset-367"><span class="linenos">367</span></a>				<span class="n">SolvedMaze</span><span class="p">(</span>
</span><span id="MazeDataset-368"><a href="#MazeDataset-368"><span class="linenos">368</span></a>					<span class="n">clist</span><span class="p">,</span>
</span><span id="MazeDataset-369"><a href="#MazeDataset-369"><span class="linenos">369</span></a>					<span class="n">soln</span><span class="p">[:</span><span class="n">slen</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
</span><span id="MazeDataset-370"><a href="#MazeDataset-370"><span class="linenos">370</span></a>				<span class="p">)</span>
</span><span id="MazeDataset-371"><a href="#MazeDataset-371"><span class="linenos">371</span></a>				<span class="k">for</span> <span class="n">clist</span><span class="p">,</span> <span class="n">slen</span><span class="p">,</span> <span class="n">soln</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
</span><span id="MazeDataset-372"><a href="#MazeDataset-372"><span class="linenos">372</span></a>					<span class="n">load_item_recursive</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;maze_connection_lists&quot;</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">()),</span>
</span><span id="MazeDataset-373"><a href="#MazeDataset-373"><span class="linenos">373</span></a>					<span class="n">load_item_recursive</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;maze_solution_lengths&quot;</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">()),</span>
</span><span id="MazeDataset-374"><a href="#MazeDataset-374"><span class="linenos">374</span></a>					<span class="n">load_item_recursive</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;maze_solutions&quot;</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">()),</span>
</span><span id="MazeDataset-375"><a href="#MazeDataset-375"><span class="linenos">375</span></a>					<span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="MazeDataset-376"><a href="#MazeDataset-376"><span class="linenos">376</span></a>					<span class="c1"># load_item_recursive(data[&quot;maze_endpoints&quot;], tuple()),</span>
</span><span id="MazeDataset-377"><a href="#MazeDataset-377"><span class="linenos">377</span></a>				<span class="p">)</span>
</span><span id="MazeDataset-378"><a href="#MazeDataset-378"><span class="linenos">378</span></a>			<span class="p">],</span>
</span><span id="MazeDataset-379"><a href="#MazeDataset-379"><span class="linenos">379</span></a>		<span class="p">)</span>
</span><span id="MazeDataset-380"><a href="#MazeDataset-380"><span class="linenos">380</span></a>
</span><span id="MazeDataset-381"><a href="#MazeDataset-381"><span class="linenos">381</span></a>	<span class="nd">@classmethod</span>
</span><span id="MazeDataset-382"><a href="#MazeDataset-382"><span class="linenos">382</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">_load_minimal_soln_cat</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">JSONdict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MazeDataset&quot;</span><span class="p">:</span>
</span><span id="MazeDataset-383"><a href="#MazeDataset-383"><span class="linenos">383</span></a>		<span class="k">assert</span> <span class="n">data</span><span class="p">[</span><span class="n">_FORMAT_KEY</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;MazeDataset:minimal_soln_cat&quot;</span>
</span><span id="MazeDataset-384"><a href="#MazeDataset-384"><span class="linenos">384</span></a>
</span><span id="MazeDataset-385"><a href="#MazeDataset-385"><span class="linenos">385</span></a>		<span class="n">maze_solution_lengths</span> <span class="o">=</span> <span class="n">load_item_recursive</span><span class="p">(</span>
</span><span id="MazeDataset-386"><a href="#MazeDataset-386"><span class="linenos">386</span></a>			<span class="n">data</span><span class="p">[</span><span class="s2">&quot;maze_solution_lengths&quot;</span><span class="p">],</span>
</span><span id="MazeDataset-387"><a href="#MazeDataset-387"><span class="linenos">387</span></a>			<span class="nb">tuple</span><span class="p">(),</span>
</span><span id="MazeDataset-388"><a href="#MazeDataset-388"><span class="linenos">388</span></a>		<span class="p">)</span>
</span><span id="MazeDataset-389"><a href="#MazeDataset-389"><span class="linenos">389</span></a>		<span class="n">maze_solutions_concat</span> <span class="o">=</span> <span class="n">load_item_recursive</span><span class="p">(</span>
</span><span id="MazeDataset-390"><a href="#MazeDataset-390"><span class="linenos">390</span></a>			<span class="n">data</span><span class="p">[</span><span class="s2">&quot;maze_solutions_concat&quot;</span><span class="p">],</span>
</span><span id="MazeDataset-391"><a href="#MazeDataset-391"><span class="linenos">391</span></a>			<span class="nb">tuple</span><span class="p">(),</span>
</span><span id="MazeDataset-392"><a href="#MazeDataset-392"><span class="linenos">392</span></a>		<span class="p">)</span>
</span><span id="MazeDataset-393"><a href="#MazeDataset-393"><span class="linenos">393</span></a>		<span class="n">maze_solutions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span>
</span><span id="MazeDataset-394"><a href="#MazeDataset-394"><span class="linenos">394</span></a>			<span class="n">maze_solutions_concat</span><span class="p">,</span>
</span><span id="MazeDataset-395"><a href="#MazeDataset-395"><span class="linenos">395</span></a>			<span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">maze_solution_lengths</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
</span><span id="MazeDataset-396"><a href="#MazeDataset-396"><span class="linenos">396</span></a>			<span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="MazeDataset-397"><a href="#MazeDataset-397"><span class="linenos">397</span></a>		<span class="p">)</span>
</span><span id="MazeDataset-398"><a href="#MazeDataset-398"><span class="linenos">398</span></a>
</span><span id="MazeDataset-399"><a href="#MazeDataset-399"><span class="linenos">399</span></a>		<span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="MazeDataset-400"><a href="#MazeDataset-400"><span class="linenos">400</span></a>			<span class="n">cfg</span><span class="o">=</span><span class="n">load_item_recursive</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;cfg&quot;</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">()),</span>
</span><span id="MazeDataset-401"><a href="#MazeDataset-401"><span class="linenos">401</span></a>			<span class="n">generation_metadata_collected</span><span class="o">=</span><span class="n">load_item_recursive</span><span class="p">(</span>
</span><span id="MazeDataset-402"><a href="#MazeDataset-402"><span class="linenos">402</span></a>				<span class="n">data</span><span class="p">[</span><span class="s2">&quot;generation_metadata_collected&quot;</span><span class="p">],</span>
</span><span id="MazeDataset-403"><a href="#MazeDataset-403"><span class="linenos">403</span></a>				<span class="nb">tuple</span><span class="p">(),</span>
</span><span id="MazeDataset-404"><a href="#MazeDataset-404"><span class="linenos">404</span></a>			<span class="p">),</span>
</span><span id="MazeDataset-405"><a href="#MazeDataset-405"><span class="linenos">405</span></a>			<span class="n">mazes</span><span class="o">=</span><span class="p">[</span>
</span><span id="MazeDataset-406"><a href="#MazeDataset-406"><span class="linenos">406</span></a>				<span class="n">SolvedMaze</span><span class="p">(</span>
</span><span id="MazeDataset-407"><a href="#MazeDataset-407"><span class="linenos">407</span></a>					<span class="n">connection_list</span><span class="o">=</span><span class="n">clist</span><span class="p">,</span>
</span><span id="MazeDataset-408"><a href="#MazeDataset-408"><span class="linenos">408</span></a>					<span class="n">solution</span><span class="o">=</span><span class="n">soln</span><span class="p">,</span>
</span><span id="MazeDataset-409"><a href="#MazeDataset-409"><span class="linenos">409</span></a>				<span class="p">)</span>
</span><span id="MazeDataset-410"><a href="#MazeDataset-410"><span class="linenos">410</span></a>				<span class="k">for</span> <span class="n">clist</span><span class="p">,</span> <span class="n">soln</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
</span><span id="MazeDataset-411"><a href="#MazeDataset-411"><span class="linenos">411</span></a>					<span class="n">load_item_recursive</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;maze_connection_lists&quot;</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">()),</span>
</span><span id="MazeDataset-412"><a href="#MazeDataset-412"><span class="linenos">412</span></a>					<span class="c1"># load_item_recursive(data[&quot;maze_endpoints&quot;], tuple()),</span>
</span><span id="MazeDataset-413"><a href="#MazeDataset-413"><span class="linenos">413</span></a>					<span class="n">maze_solutions</span><span class="p">,</span>
</span><span id="MazeDataset-414"><a href="#MazeDataset-414"><span class="linenos">414</span></a>					<span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="MazeDataset-415"><a href="#MazeDataset-415"><span class="linenos">415</span></a>				<span class="p">)</span>
</span><span id="MazeDataset-416"><a href="#MazeDataset-416"><span class="linenos">416</span></a>			<span class="p">],</span>
</span><span id="MazeDataset-417"><a href="#MazeDataset-417"><span class="linenos">417</span></a>		<span class="p">)</span>
</span><span id="MazeDataset-418"><a href="#MazeDataset-418"><span class="linenos">418</span></a>
</span><span id="MazeDataset-419"><a href="#MazeDataset-419"><span class="linenos">419</span></a>	<span class="nd">@classmethod</span>
</span><span id="MazeDataset-420"><a href="#MazeDataset-420"><span class="linenos">420</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">_load_legacy</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">JSONdict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MazeDataset&quot;</span><span class="p">:</span>
</span><span id="MazeDataset-421"><a href="#MazeDataset-421"><span class="linenos">421</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Legacy `load` method from &lt;0.5.2. Used exclusively for profiling comparison.&quot;&quot;&quot;</span>
</span><span id="MazeDataset-422"><a href="#MazeDataset-422"><span class="linenos">422</span></a>		<span class="k">assert</span> <span class="n">data</span><span class="p">[</span><span class="n">_FORMAT_KEY</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;MazeDataset&quot;</span>
</span><span id="MazeDataset-423"><a href="#MazeDataset-423"><span class="linenos">423</span></a>		<span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="MazeDataset-424"><a href="#MazeDataset-424"><span class="linenos">424</span></a>			<span class="o">**</span><span class="p">{</span>
</span><span id="MazeDataset-425"><a href="#MazeDataset-425"><span class="linenos">425</span></a>				<span class="n">key</span><span class="p">:</span> <span class="n">load_item_recursive</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">())</span>
</span><span id="MazeDataset-426"><a href="#MazeDataset-426"><span class="linenos">426</span></a>				<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;cfg&quot;</span><span class="p">,</span> <span class="s2">&quot;mazes&quot;</span><span class="p">,</span> <span class="s2">&quot;generation_metadata_collected&quot;</span><span class="p">]</span>
</span><span id="MazeDataset-427"><a href="#MazeDataset-427"><span class="linenos">427</span></a>			<span class="p">},</span>
</span><span id="MazeDataset-428"><a href="#MazeDataset-428"><span class="linenos">428</span></a>		<span class="p">)</span>
</span><span id="MazeDataset-429"><a href="#MazeDataset-429"><span class="linenos">429</span></a>
</span><span id="MazeDataset-430"><a href="#MazeDataset-430"><span class="linenos">430</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JSONdict</span><span class="p">:</span>
</span><span id="MazeDataset-431"><a href="#MazeDataset-431"><span class="linenos">431</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;serialize to zanj/json&quot;&quot;&quot;</span>
</span><span id="MazeDataset-432"><a href="#MazeDataset-432"><span class="linenos">432</span></a>		<span class="k">if</span> <span class="p">(</span>
</span><span id="MazeDataset-433"><a href="#MazeDataset-433"><span class="linenos">433</span></a>			<span class="n">SERIALIZE_MINIMAL_THRESHOLD</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="MazeDataset-434"><a href="#MazeDataset-434"><span class="linenos">434</span></a>			<span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">SERIALIZE_MINIMAL_THRESHOLD</span>
</span><span id="MazeDataset-435"><a href="#MazeDataset-435"><span class="linenos">435</span></a>		<span class="p">):</span>
</span><span id="MazeDataset-436"><a href="#MazeDataset-436"><span class="linenos">436</span></a>			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_serialize_minimal</span><span class="p">()</span>
</span><span id="MazeDataset-437"><a href="#MazeDataset-437"><span class="linenos">437</span></a>		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_serialize_full</span><span class="p">()</span>
</span><span id="MazeDataset-438"><a href="#MazeDataset-438"><span class="linenos">438</span></a>
</span><span id="MazeDataset-439"><a href="#MazeDataset-439"><span class="linenos">439</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">_serialize_full</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JSONdict</span><span class="p">:</span>
</span><span id="MazeDataset-440"><a href="#MazeDataset-440"><span class="linenos">440</span></a>		<span class="k">return</span> <span class="p">{</span>
</span><span id="MazeDataset-441"><a href="#MazeDataset-441"><span class="linenos">441</span></a>			<span class="n">_FORMAT_KEY</span><span class="p">:</span> <span class="s2">&quot;MazeDataset&quot;</span><span class="p">,</span>
</span><span id="MazeDataset-442"><a href="#MazeDataset-442"><span class="linenos">442</span></a>			<span class="s2">&quot;cfg&quot;</span><span class="p">:</span> <span class="n">json_serialize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">),</span>
</span><span id="MazeDataset-443"><a href="#MazeDataset-443"><span class="linenos">443</span></a>			<span class="s2">&quot;fname&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">to_fname</span><span class="p">(),</span>
</span><span id="MazeDataset-444"><a href="#MazeDataset-444"><span class="linenos">444</span></a>			<span class="s2">&quot;mazes&quot;</span><span class="p">:</span> <span class="n">json_serialize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mazes</span><span class="p">),</span>
</span><span id="MazeDataset-445"><a href="#MazeDataset-445"><span class="linenos">445</span></a>			<span class="s2">&quot;generation_metadata_collected&quot;</span><span class="p">:</span> <span class="n">json_serialize</span><span class="p">(</span>
</span><span id="MazeDataset-446"><a href="#MazeDataset-446"><span class="linenos">446</span></a>				<span class="bp">self</span><span class="o">.</span><span class="n">generation_metadata_collected</span><span class="p">,</span>
</span><span id="MazeDataset-447"><a href="#MazeDataset-447"><span class="linenos">447</span></a>			<span class="p">),</span>
</span><span id="MazeDataset-448"><a href="#MazeDataset-448"><span class="linenos">448</span></a>		<span class="p">}</span>
</span><span id="MazeDataset-449"><a href="#MazeDataset-449"><span class="linenos">449</span></a>
</span><span id="MazeDataset-450"><a href="#MazeDataset-450"><span class="linenos">450</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">_serialize_minimal</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JSONdict</span><span class="p">:</span>
</span><span id="MazeDataset-451"><a href="#MazeDataset-451"><span class="linenos">451</span></a>		<span class="s2">&quot;alternate serialization where metadata is collected and mazes are stored in concatenated form&quot;</span>
</span><span id="MazeDataset-452"><a href="#MazeDataset-452"><span class="linenos">452</span></a>		<span class="n">filtered_meta</span><span class="p">:</span> <span class="n">MazeDataset</span>
</span><span id="MazeDataset-453"><a href="#MazeDataset-453"><span class="linenos">453</span></a>		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">generation_metadata_collected</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeDataset-454"><a href="#MazeDataset-454"><span class="linenos">454</span></a>			<span class="n">filtered_meta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_by</span><span class="o">.</span><span class="n">collect_generation_meta</span><span class="p">()</span>
</span><span id="MazeDataset-455"><a href="#MazeDataset-455"><span class="linenos">455</span></a>		<span class="k">else</span><span class="p">:</span>
</span><span id="MazeDataset-456"><a href="#MazeDataset-456"><span class="linenos">456</span></a>			<span class="n">filtered_meta</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="MazeDataset-457"><a href="#MazeDataset-457"><span class="linenos">457</span></a>
</span><span id="MazeDataset-458"><a href="#MazeDataset-458"><span class="linenos">458</span></a>		<span class="n">max_solution_len</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">solution</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">filtered_meta</span><span class="o">.</span><span class="n">mazes</span><span class="p">)</span>
</span><span id="MazeDataset-459"><a href="#MazeDataset-459"><span class="linenos">459</span></a>		<span class="n">n_mazes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">filtered_meta</span><span class="o">.</span><span class="n">mazes</span><span class="p">)</span>
</span><span id="MazeDataset-460"><a href="#MazeDataset-460"><span class="linenos">460</span></a>		<span class="n">grid_n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">filtered_meta</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">grid_n</span>
</span><span id="MazeDataset-461"><a href="#MazeDataset-461"><span class="linenos">461</span></a>
</span><span id="MazeDataset-462"><a href="#MazeDataset-462"><span class="linenos">462</span></a>		<span class="n">maze_connection_lists</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span>
</span><span id="MazeDataset-463"><a href="#MazeDataset-463"><span class="linenos">463</span></a>			<span class="p">(</span><span class="n">n_mazes</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">grid_n</span><span class="p">,</span> <span class="n">grid_n</span><span class="p">),</span>
</span><span id="MazeDataset-464"><a href="#MazeDataset-464"><span class="linenos">464</span></a>			<span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span>
</span><span id="MazeDataset-465"><a href="#MazeDataset-465"><span class="linenos">465</span></a>		<span class="p">)</span>
</span><span id="MazeDataset-466"><a href="#MazeDataset-466"><span class="linenos">466</span></a>		<span class="c1"># maze_endpoints: np.ndarray = np.empty((n_mazes, 2, 2), dtype=np.int8)</span>
</span><span id="MazeDataset-467"><a href="#MazeDataset-467"><span class="linenos">467</span></a>		<span class="n">maze_solution_lengths</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">n_mazes</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</span><span id="MazeDataset-468"><a href="#MazeDataset-468"><span class="linenos">468</span></a>		<span class="n">maze_solutions</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span>
</span><span id="MazeDataset-469"><a href="#MazeDataset-469"><span class="linenos">469</span></a>			<span class="p">(</span><span class="n">n_mazes</span><span class="p">,</span> <span class="n">max_solution_len</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
</span><span id="MazeDataset-470"><a href="#MazeDataset-470"><span class="linenos">470</span></a>			<span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">,</span>
</span><span id="MazeDataset-471"><a href="#MazeDataset-471"><span class="linenos">471</span></a>		<span class="p">)</span>
</span><span id="MazeDataset-472"><a href="#MazeDataset-472"><span class="linenos">472</span></a>
</span><span id="MazeDataset-473"><a href="#MazeDataset-473"><span class="linenos">473</span></a>		<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">maze</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">filtered_meta</span><span class="o">.</span><span class="n">mazes</span><span class="p">):</span>
</span><span id="MazeDataset-474"><a href="#MazeDataset-474"><span class="linenos">474</span></a>			<span class="n">maze_connection_lists</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">connection_list</span>
</span><span id="MazeDataset-475"><a href="#MazeDataset-475"><span class="linenos">475</span></a>			<span class="c1"># maze_endpoints[idx] = np.array([maze.start_pos, maze.end_pos])</span>
</span><span id="MazeDataset-476"><a href="#MazeDataset-476"><span class="linenos">476</span></a>			<span class="n">maze_solution_lengths</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="MazeDataset-477"><a href="#MazeDataset-477"><span class="linenos">477</span></a>			<span class="n">maze_solutions</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:</span> <span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">solution</span>
</span><span id="MazeDataset-478"><a href="#MazeDataset-478"><span class="linenos">478</span></a>
</span><span id="MazeDataset-479"><a href="#MazeDataset-479"><span class="linenos">479</span></a>		<span class="k">return</span> <span class="p">{</span>
</span><span id="MazeDataset-480"><a href="#MazeDataset-480"><span class="linenos">480</span></a>			<span class="n">_FORMAT_KEY</span><span class="p">:</span> <span class="s2">&quot;MazeDataset:minimal&quot;</span><span class="p">,</span>
</span><span id="MazeDataset-481"><a href="#MazeDataset-481"><span class="linenos">481</span></a>			<span class="s2">&quot;cfg&quot;</span><span class="p">:</span> <span class="n">json_serialize</span><span class="p">(</span><span class="n">filtered_meta</span><span class="o">.</span><span class="n">cfg</span><span class="p">),</span>
</span><span id="MazeDataset-482"><a href="#MazeDataset-482"><span class="linenos">482</span></a>			<span class="s2">&quot;fname&quot;</span><span class="p">:</span> <span class="n">filtered_meta</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">to_fname</span><span class="p">(),</span>
</span><span id="MazeDataset-483"><a href="#MazeDataset-483"><span class="linenos">483</span></a>			<span class="s2">&quot;generation_metadata_collected&quot;</span><span class="p">:</span> <span class="n">json_serialize</span><span class="p">(</span>
</span><span id="MazeDataset-484"><a href="#MazeDataset-484"><span class="linenos">484</span></a>				<span class="n">filtered_meta</span><span class="o">.</span><span class="n">generation_metadata_collected</span><span class="p">,</span>
</span><span id="MazeDataset-485"><a href="#MazeDataset-485"><span class="linenos">485</span></a>			<span class="p">),</span>
</span><span id="MazeDataset-486"><a href="#MazeDataset-486"><span class="linenos">486</span></a>			<span class="s2">&quot;maze_connection_lists&quot;</span><span class="p">:</span> <span class="n">maze_connection_lists</span><span class="p">,</span>  <span class="c1"># type: ignore[dict-item]</span>
</span><span id="MazeDataset-487"><a href="#MazeDataset-487"><span class="linenos">487</span></a>			<span class="c1"># &quot;maze_endpoints&quot;: maze_endpoints,</span>
</span><span id="MazeDataset-488"><a href="#MazeDataset-488"><span class="linenos">488</span></a>			<span class="s2">&quot;maze_solution_lengths&quot;</span><span class="p">:</span> <span class="n">maze_solution_lengths</span><span class="p">,</span>  <span class="c1"># type: ignore[dict-item]</span>
</span><span id="MazeDataset-489"><a href="#MazeDataset-489"><span class="linenos">489</span></a>			<span class="s2">&quot;maze_solutions&quot;</span><span class="p">:</span> <span class="n">maze_solutions</span><span class="p">,</span>  <span class="c1"># type: ignore[dict-item]</span>
</span><span id="MazeDataset-490"><a href="#MazeDataset-490"><span class="linenos">490</span></a>		<span class="p">}</span>
</span><span id="MazeDataset-491"><a href="#MazeDataset-491"><span class="linenos">491</span></a>
</span><span id="MazeDataset-492"><a href="#MazeDataset-492"><span class="linenos">492</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">_serialize_minimal_soln_cat</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="s2">&quot;MazeDataset&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JSONdict</span><span class="p">:</span>
</span><span id="MazeDataset-493"><a href="#MazeDataset-493"><span class="linenos">493</span></a>		<span class="s2">&quot;alternate serialization where metadata is collected, and mazes and their solutions are stored in concatenated form&quot;</span>
</span><span id="MazeDataset-494"><a href="#MazeDataset-494"><span class="linenos">494</span></a>		<span class="n">filtered_meta</span><span class="p">:</span> <span class="n">MazeDataset</span>
</span><span id="MazeDataset-495"><a href="#MazeDataset-495"><span class="linenos">495</span></a>		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">generation_metadata_collected</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeDataset-496"><a href="#MazeDataset-496"><span class="linenos">496</span></a>			<span class="n">filtered_meta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_by</span><span class="o">.</span><span class="n">collect_generation_meta</span><span class="p">()</span>
</span><span id="MazeDataset-497"><a href="#MazeDataset-497"><span class="linenos">497</span></a>		<span class="k">else</span><span class="p">:</span>
</span><span id="MazeDataset-498"><a href="#MazeDataset-498"><span class="linenos">498</span></a>			<span class="n">filtered_meta</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="MazeDataset-499"><a href="#MazeDataset-499"><span class="linenos">499</span></a>
</span><span id="MazeDataset-500"><a href="#MazeDataset-500"><span class="linenos">500</span></a>		<span class="n">maze_solution_lengths</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span><span id="MazeDataset-501"><a href="#MazeDataset-501"><span class="linenos">501</span></a>			<span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">solution</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">filtered_meta</span><span class="o">.</span><span class="n">mazes</span><span class="p">],</span>
</span><span id="MazeDataset-502"><a href="#MazeDataset-502"><span class="linenos">502</span></a>			<span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span>
</span><span id="MazeDataset-503"><a href="#MazeDataset-503"><span class="linenos">503</span></a>		<span class="p">)</span>
</span><span id="MazeDataset-504"><a href="#MazeDataset-504"><span class="linenos">504</span></a>		<span class="n">n_mazes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">filtered_meta</span><span class="o">.</span><span class="n">mazes</span><span class="p">)</span>
</span><span id="MazeDataset-505"><a href="#MazeDataset-505"><span class="linenos">505</span></a>		<span class="n">grid_n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">filtered_meta</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">grid_n</span>
</span><span id="MazeDataset-506"><a href="#MazeDataset-506"><span class="linenos">506</span></a>		<span class="n">total_solution_len</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">maze_solution_lengths</span><span class="p">)</span>
</span><span id="MazeDataset-507"><a href="#MazeDataset-507"><span class="linenos">507</span></a>
</span><span id="MazeDataset-508"><a href="#MazeDataset-508"><span class="linenos">508</span></a>		<span class="n">maze_connection_lists</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span>
</span><span id="MazeDataset-509"><a href="#MazeDataset-509"><span class="linenos">509</span></a>			<span class="p">(</span><span class="n">n_mazes</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">grid_n</span><span class="p">,</span> <span class="n">grid_n</span><span class="p">),</span>
</span><span id="MazeDataset-510"><a href="#MazeDataset-510"><span class="linenos">510</span></a>			<span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span>
</span><span id="MazeDataset-511"><a href="#MazeDataset-511"><span class="linenos">511</span></a>		<span class="p">)</span>
</span><span id="MazeDataset-512"><a href="#MazeDataset-512"><span class="linenos">512</span></a>		<span class="n">maze_endpoints</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">n_mazes</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>
</span><span id="MazeDataset-513"><a href="#MazeDataset-513"><span class="linenos">513</span></a>		<span class="n">maze_solutions_concat</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span>
</span><span id="MazeDataset-514"><a href="#MazeDataset-514"><span class="linenos">514</span></a>			<span class="p">(</span><span class="n">total_solution_len</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
</span><span id="MazeDataset-515"><a href="#MazeDataset-515"><span class="linenos">515</span></a>			<span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">,</span>
</span><span id="MazeDataset-516"><a href="#MazeDataset-516"><span class="linenos">516</span></a>		<span class="p">)</span>
</span><span id="MazeDataset-517"><a href="#MazeDataset-517"><span class="linenos">517</span></a>
</span><span id="MazeDataset-518"><a href="#MazeDataset-518"><span class="linenos">518</span></a>		<span class="n">solutions_running_idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="MazeDataset-519"><a href="#MazeDataset-519"><span class="linenos">519</span></a>		<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">maze</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">filtered_meta</span><span class="o">.</span><span class="n">mazes</span><span class="p">):</span>
</span><span id="MazeDataset-520"><a href="#MazeDataset-520"><span class="linenos">520</span></a>			<span class="n">maze_connection_lists</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">connection_list</span>
</span><span id="MazeDataset-521"><a href="#MazeDataset-521"><span class="linenos">521</span></a>			<span class="n">maze_endpoints</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">maze</span><span class="o">.</span><span class="n">start_pos</span><span class="p">,</span> <span class="n">maze</span><span class="o">.</span><span class="n">end_pos</span><span class="p">])</span>
</span><span id="MazeDataset-522"><a href="#MazeDataset-522"><span class="linenos">522</span></a>			<span class="n">soln_len</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="MazeDataset-523"><a href="#MazeDataset-523"><span class="linenos">523</span></a>			<span class="n">maze_solution_lengths</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">soln_len</span>
</span><span id="MazeDataset-524"><a href="#MazeDataset-524"><span class="linenos">524</span></a>			<span class="n">maze_solutions_concat</span><span class="p">[</span>
</span><span id="MazeDataset-525"><a href="#MazeDataset-525"><span class="linenos">525</span></a>				<span class="n">solutions_running_idx</span> <span class="p">:</span> <span class="n">solutions_running_idx</span> <span class="o">+</span> <span class="n">soln_len</span>
</span><span id="MazeDataset-526"><a href="#MazeDataset-526"><span class="linenos">526</span></a>			<span class="p">]</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">solution</span>
</span><span id="MazeDataset-527"><a href="#MazeDataset-527"><span class="linenos">527</span></a>			<span class="n">solutions_running_idx</span> <span class="o">+=</span> <span class="n">soln_len</span>
</span><span id="MazeDataset-528"><a href="#MazeDataset-528"><span class="linenos">528</span></a>
</span><span id="MazeDataset-529"><a href="#MazeDataset-529"><span class="linenos">529</span></a>		<span class="k">return</span> <span class="p">{</span>
</span><span id="MazeDataset-530"><a href="#MazeDataset-530"><span class="linenos">530</span></a>			<span class="n">_FORMAT_KEY</span><span class="p">:</span> <span class="s2">&quot;MazeDataset:minimal_soln_cat&quot;</span><span class="p">,</span>
</span><span id="MazeDataset-531"><a href="#MazeDataset-531"><span class="linenos">531</span></a>			<span class="s2">&quot;cfg&quot;</span><span class="p">:</span> <span class="n">json_serialize</span><span class="p">(</span><span class="n">filtered_meta</span><span class="o">.</span><span class="n">cfg</span><span class="p">),</span>
</span><span id="MazeDataset-532"><a href="#MazeDataset-532"><span class="linenos">532</span></a>			<span class="s2">&quot;fname&quot;</span><span class="p">:</span> <span class="n">filtered_meta</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">to_fname</span><span class="p">(),</span>
</span><span id="MazeDataset-533"><a href="#MazeDataset-533"><span class="linenos">533</span></a>			<span class="s2">&quot;generation_metadata_collected&quot;</span><span class="p">:</span> <span class="n">json_serialize</span><span class="p">(</span>
</span><span id="MazeDataset-534"><a href="#MazeDataset-534"><span class="linenos">534</span></a>				<span class="n">filtered_meta</span><span class="o">.</span><span class="n">generation_metadata_collected</span><span class="p">,</span>
</span><span id="MazeDataset-535"><a href="#MazeDataset-535"><span class="linenos">535</span></a>			<span class="p">),</span>
</span><span id="MazeDataset-536"><a href="#MazeDataset-536"><span class="linenos">536</span></a>			<span class="s2">&quot;maze_connection_lists&quot;</span><span class="p">:</span> <span class="n">maze_connection_lists</span><span class="p">,</span>  <span class="c1"># type: ignore[dict-item]</span>
</span><span id="MazeDataset-537"><a href="#MazeDataset-537"><span class="linenos">537</span></a>			<span class="s2">&quot;maze_endpoints&quot;</span><span class="p">:</span> <span class="n">maze_endpoints</span><span class="p">,</span>  <span class="c1"># type: ignore[dict-item]</span>
</span><span id="MazeDataset-538"><a href="#MazeDataset-538"><span class="linenos">538</span></a>			<span class="s2">&quot;maze_solution_lengths&quot;</span><span class="p">:</span> <span class="n">maze_solution_lengths</span><span class="p">,</span>  <span class="c1"># type: ignore[dict-item]</span>
</span><span id="MazeDataset-539"><a href="#MazeDataset-539"><span class="linenos">539</span></a>			<span class="s2">&quot;maze_solutions_concat&quot;</span><span class="p">:</span> <span class="n">maze_solutions_concat</span><span class="p">,</span>  <span class="c1"># type: ignore[dict-item]</span>
</span><span id="MazeDataset-540"><a href="#MazeDataset-540"><span class="linenos">540</span></a>		<span class="p">}</span>
</span><span id="MazeDataset-541"><a href="#MazeDataset-541"><span class="linenos">541</span></a>
</span><span id="MazeDataset-542"><a href="#MazeDataset-542"><span class="linenos">542</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">update_self_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeDataset-543"><a href="#MazeDataset-543"><span class="linenos">543</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;update the config to match the current state of the dataset (number of mazes, such as after filtering)&quot;&quot;&quot;</span>
</span><span id="MazeDataset-544"><a href="#MazeDataset-544"><span class="linenos">544</span></a>		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">n_mazes</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mazes</span><span class="p">):</span>
</span><span id="MazeDataset-545"><a href="#MazeDataset-545"><span class="linenos">545</span></a>			<span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="MazeDataset-546"><a href="#MazeDataset-546"><span class="linenos">546</span></a>				<span class="sa">f</span><span class="s2">&quot;updating config n_mazes from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">n_mazes</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mazes</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="MazeDataset-547"><a href="#MazeDataset-547"><span class="linenos">547</span></a>			<span class="p">)</span>
</span><span id="MazeDataset-548"><a href="#MazeDataset-548"><span class="linenos">548</span></a>			<span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">n_mazes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mazes</span><span class="p">)</span>
</span><span id="MazeDataset-549"><a href="#MazeDataset-549"><span class="linenos">549</span></a>
</span><span id="MazeDataset-550"><a href="#MazeDataset-550"><span class="linenos">550</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">custom_maze_filter</span><span class="p">(</span>
</span><span id="MazeDataset-551"><a href="#MazeDataset-551"><span class="linenos">551</span></a>		<span class="bp">self</span><span class="p">,</span>
</span><span id="MazeDataset-552"><a href="#MazeDataset-552"><span class="linenos">552</span></a>		<span class="n">method</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">SolvedMaze</span><span class="p">],</span> <span class="nb">bool</span><span class="p">],</span>
</span><span id="MazeDataset-553"><a href="#MazeDataset-553"><span class="linenos">553</span></a>		<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="MazeDataset-554"><a href="#MazeDataset-554"><span class="linenos">554</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MazeDataset&quot;</span><span class="p">:</span>
</span><span id="MazeDataset-555"><a href="#MazeDataset-555"><span class="linenos">555</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;filter the dataset using a custom method&quot;&quot;&quot;</span>
</span><span id="MazeDataset-556"><a href="#MazeDataset-556"><span class="linenos">556</span></a>		<span class="n">output</span><span class="p">:</span> <span class="n">MazeDataset</span> <span class="o">=</span> <span class="n">MazeDataset</span><span class="p">(</span>
</span><span id="MazeDataset-557"><a href="#MazeDataset-557"><span class="linenos">557</span></a>			<span class="n">cfg</span><span class="o">=</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">),</span>
</span><span id="MazeDataset-558"><a href="#MazeDataset-558"><span class="linenos">558</span></a>			<span class="n">mazes</span><span class="o">=</span><span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mazes</span> <span class="k">if</span> <span class="n">method</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)],</span>
</span><span id="MazeDataset-559"><a href="#MazeDataset-559"><span class="linenos">559</span></a>		<span class="p">)</span>
</span><span id="MazeDataset-560"><a href="#MazeDataset-560"><span class="linenos">560</span></a>		<span class="n">output</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">applied_filters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="MazeDataset-561"><a href="#MazeDataset-561"><span class="linenos">561</span></a>			<span class="p">{</span>
</span><span id="MazeDataset-562"><a href="#MazeDataset-562"><span class="linenos">562</span></a>				<span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;__custom__:</span><span class="si">{</span><span class="n">method</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="MazeDataset-563"><a href="#MazeDataset-563"><span class="linenos">563</span></a>				<span class="s2">&quot;kwargs&quot;</span><span class="p">:</span> <span class="n">kwargs</span><span class="p">,</span>
</span><span id="MazeDataset-564"><a href="#MazeDataset-564"><span class="linenos">564</span></a>			<span class="p">},</span>
</span><span id="MazeDataset-565"><a href="#MazeDataset-565"><span class="linenos">565</span></a>		<span class="p">)</span>
</span><span id="MazeDataset-566"><a href="#MazeDataset-566"><span class="linenos">566</span></a>		<span class="n">output</span><span class="o">.</span><span class="n">update_self_config</span><span class="p">()</span>
</span><span id="MazeDataset-567"><a href="#MazeDataset-567"><span class="linenos">567</span></a>		<span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>a maze dataset class. This is a collection of solved mazes, and should be initialized via <code><a href="#MazeDataset.from_config">MazeDataset.from_config</a></code></p>
</div>


                            <div id="MazeDataset.__init__" class="classattr">
                                        <input id="MazeDataset.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">MazeDataset</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">cfg</span><span class="p">:</span> <span class="n"><a href="#MazeDatasetConfig">MazeDatasetConfig</a></span>,</span><span class="param">	<span class="n">mazes</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n"><a href="../maze_dataset.html#SolvedMaze">maze_dataset.SolvedMaze</a></span><span class="p">]</span>,</span><span class="param">	<span class="n">generation_metadata_collected</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDataset.__init__-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L116-L126" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDataset.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDataset.__init__-117"><a href="#MazeDataset.__init__-117"><span class="linenos">117</span></a>	<span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="MazeDataset.__init__-118"><a href="#MazeDataset.__init__-118"><span class="linenos">118</span></a>		<span class="bp">self</span><span class="p">,</span>
</span><span id="MazeDataset.__init__-119"><a href="#MazeDataset.__init__-119"><span class="linenos">119</span></a>		<span class="n">cfg</span><span class="p">:</span> <span class="n">MazeDatasetConfig</span><span class="p">,</span>
</span><span id="MazeDataset.__init__-120"><a href="#MazeDataset.__init__-120"><span class="linenos">120</span></a>		<span class="n">mazes</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">SolvedMaze</span><span class="p">],</span>
</span><span id="MazeDataset.__init__-121"><a href="#MazeDataset.__init__-121"><span class="linenos">121</span></a>		<span class="n">generation_metadata_collected</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="MazeDataset.__init__-122"><a href="#MazeDataset.__init__-122"><span class="linenos">122</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeDataset.__init__-123"><a href="#MazeDataset.__init__-123"><span class="linenos">123</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;initialize a maze dataset from a config and a list of solved mazes&quot;&quot;&quot;</span>
</span><span id="MazeDataset.__init__-124"><a href="#MazeDataset.__init__-124"><span class="linenos">124</span></a>		<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="MazeDataset.__init__-125"><a href="#MazeDataset.__init__-125"><span class="linenos">125</span></a>		<span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">:</span> <span class="n">MazeDatasetConfig</span> <span class="o">=</span> <span class="n">cfg</span>
</span><span id="MazeDataset.__init__-126"><a href="#MazeDataset.__init__-126"><span class="linenos">126</span></a>		<span class="bp">self</span><span class="o">.</span><span class="n">mazes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">SolvedMaze</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mazes</span><span class="p">)</span>
</span><span id="MazeDataset.__init__-127"><a href="#MazeDataset.__init__-127"><span class="linenos">127</span></a>		<span class="bp">self</span><span class="o">.</span><span class="n">generation_metadata_collected</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">generation_metadata_collected</span>
</span></pre></div>


            <div class="docstring"><p>initialize a maze dataset from a config and a list of solved mazes</p>
</div>


                            </div>
                            <div id="MazeDataset.cfg" class="classattr">
                                <div class="attr variable">
            <span class="name">cfg</span><span class="annotation">: <a href="#MazeDatasetConfig">MazeDatasetConfig</a></span>

        
    </div>
    <a class="headerlink" href="#MazeDataset.cfg"></a>
    
    

                            </div>
                            <div id="MazeDataset.mazes" class="classattr">
                                <div class="attr variable">
            <span class="name">mazes</span><span class="annotation">: list[<a href="../maze_dataset.html#SolvedMaze">maze_dataset.SolvedMaze</a>]</span>

        
    </div>
    <a class="headerlink" href="#MazeDataset.mazes"></a>
    
    

                            </div>
                            <div id="MazeDataset.generation_metadata_collected" class="classattr">
                                <div class="attr variable">
            <span class="name">generation_metadata_collected</span><span class="annotation">: dict | None</span>

        
    </div>
    <a class="headerlink" href="#MazeDataset.generation_metadata_collected"></a>
    
    

                            </div>
                            <div id="MazeDataset.from_config" class="classattr">
                                        <input id="MazeDataset.from_config-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_config</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">cls</span>,</span><span class="param">	<span class="n">cfg</span><span class="p">:</span> <span class="n"><a href="#MazeDatasetConfig">MazeDatasetConfig</a></span>,</span><span class="param">	<span class="n">do_generate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">load_local</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">save_local</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">zanj</span><span class="p">:</span> <span class="n">zanj</span><span class="o">.</span><span class="n">zanj</span><span class="o">.</span><span class="n">ZANJ</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">do_download</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">local_base_path</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">_local</span><span class="o">.</span><span class="n">Path</span> <span class="o">=</span> <span class="n">PosixPath</span><span class="p">(</span><span class="s1">&#39;data/maze_dataset&#39;</span><span class="p">)</span>,</span><span class="param">	<span class="n">except_on_config_mismatch</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">allow_generation_metadata_filter_mismatch</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="n"><a href="#MazeDataset">MazeDataset</a></span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDataset.from_config-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L129-L168" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDataset.from_config"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDataset.from_config-130"><a href="#MazeDataset.from_config-130"><span class="linenos">130</span></a>	<span class="nd">@classmethod</span>
</span><span id="MazeDataset.from_config-131"><a href="#MazeDataset.from_config-131"><span class="linenos">131</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">from_config</span><span class="p">(</span>  <span class="c1"># type: ignore[override]</span>
</span><span id="MazeDataset.from_config-132"><a href="#MazeDataset.from_config-132"><span class="linenos">132</span></a>		<span class="bp">cls</span><span class="p">,</span>
</span><span id="MazeDataset.from_config-133"><a href="#MazeDataset.from_config-133"><span class="linenos">133</span></a>		<span class="c1"># TYPING: error: Argument 1 of &quot;from_config&quot; is incompatible with supertype &quot;GPTDataset&quot;; supertype defines the argument type as &quot;T_DatasetConfig&quot;  [override]</span>
</span><span id="MazeDataset.from_config-134"><a href="#MazeDataset.from_config-134"><span class="linenos">134</span></a>		<span class="n">cfg</span><span class="p">:</span> <span class="n">MazeDatasetConfig</span><span class="p">,</span>  <span class="c1"># type: ignore[override]</span>
</span><span id="MazeDataset.from_config-135"><a href="#MazeDataset.from_config-135"><span class="linenos">135</span></a>		<span class="n">do_generate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="MazeDataset.from_config-136"><a href="#MazeDataset.from_config-136"><span class="linenos">136</span></a>		<span class="n">load_local</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="MazeDataset.from_config-137"><a href="#MazeDataset.from_config-137"><span class="linenos">137</span></a>		<span class="n">save_local</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="MazeDataset.from_config-138"><a href="#MazeDataset.from_config-138"><span class="linenos">138</span></a>		<span class="n">zanj</span><span class="p">:</span> <span class="n">ZANJ</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="MazeDataset.from_config-139"><a href="#MazeDataset.from_config-139"><span class="linenos">139</span></a>		<span class="n">do_download</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="MazeDataset.from_config-140"><a href="#MazeDataset.from_config-140"><span class="linenos">140</span></a>		<span class="n">local_base_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;data/maze_dataset&quot;</span><span class="p">),</span>
</span><span id="MazeDataset.from_config-141"><a href="#MazeDataset.from_config-141"><span class="linenos">141</span></a>		<span class="n">except_on_config_mismatch</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="MazeDataset.from_config-142"><a href="#MazeDataset.from_config-142"><span class="linenos">142</span></a>		<span class="n">allow_generation_metadata_filter_mismatch</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="MazeDataset.from_config-143"><a href="#MazeDataset.from_config-143"><span class="linenos">143</span></a>		<span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="MazeDataset.from_config-144"><a href="#MazeDataset.from_config-144"><span class="linenos">144</span></a>		<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="MazeDataset.from_config-145"><a href="#MazeDataset.from_config-145"><span class="linenos">145</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MazeDataset&quot;</span><span class="p">:</span>
</span><span id="MazeDataset.from_config-146"><a href="#MazeDataset.from_config-146"><span class="linenos">146</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;create a maze dataset from a config</span>
</span><span id="MazeDataset.from_config-147"><a href="#MazeDataset.from_config-147"><span class="linenos">147</span></a>
</span><span id="MazeDataset.from_config-148"><a href="#MazeDataset.from_config-148"><span class="linenos">148</span></a><span class="sd">		priority of loading:</span>
</span><span id="MazeDataset.from_config-149"><a href="#MazeDataset.from_config-149"><span class="linenos">149</span></a><span class="sd">		1. load from local</span>
</span><span id="MazeDataset.from_config-150"><a href="#MazeDataset.from_config-150"><span class="linenos">150</span></a><span class="sd">		2. download</span>
</span><span id="MazeDataset.from_config-151"><a href="#MazeDataset.from_config-151"><span class="linenos">151</span></a><span class="sd">		3. generate</span>
</span><span id="MazeDataset.from_config-152"><a href="#MazeDataset.from_config-152"><span class="linenos">152</span></a>
</span><span id="MazeDataset.from_config-153"><a href="#MazeDataset.from_config-153"><span class="linenos">153</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="MazeDataset.from_config-154"><a href="#MazeDataset.from_config-154"><span class="linenos">154</span></a>		<span class="k">return</span> <span class="n">cast</span><span class="p">(</span>
</span><span id="MazeDataset.from_config-155"><a href="#MazeDataset.from_config-155"><span class="linenos">155</span></a>			<span class="s2">&quot;MazeDataset&quot;</span><span class="p">,</span>
</span><span id="MazeDataset.from_config-156"><a href="#MazeDataset.from_config-156"><span class="linenos">156</span></a>			<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span>
</span><span id="MazeDataset.from_config-157"><a href="#MazeDataset.from_config-157"><span class="linenos">157</span></a>				<span class="n">cfg</span><span class="o">=</span><span class="n">cfg</span><span class="p">,</span>
</span><span id="MazeDataset.from_config-158"><a href="#MazeDataset.from_config-158"><span class="linenos">158</span></a>				<span class="n">do_generate</span><span class="o">=</span><span class="n">do_generate</span><span class="p">,</span>
</span><span id="MazeDataset.from_config-159"><a href="#MazeDataset.from_config-159"><span class="linenos">159</span></a>				<span class="n">load_local</span><span class="o">=</span><span class="n">load_local</span><span class="p">,</span>
</span><span id="MazeDataset.from_config-160"><a href="#MazeDataset.from_config-160"><span class="linenos">160</span></a>				<span class="n">save_local</span><span class="o">=</span><span class="n">save_local</span><span class="p">,</span>
</span><span id="MazeDataset.from_config-161"><a href="#MazeDataset.from_config-161"><span class="linenos">161</span></a>				<span class="n">zanj</span><span class="o">=</span><span class="n">zanj</span><span class="p">,</span>
</span><span id="MazeDataset.from_config-162"><a href="#MazeDataset.from_config-162"><span class="linenos">162</span></a>				<span class="n">do_download</span><span class="o">=</span><span class="n">do_download</span><span class="p">,</span>
</span><span id="MazeDataset.from_config-163"><a href="#MazeDataset.from_config-163"><span class="linenos">163</span></a>				<span class="n">local_base_path</span><span class="o">=</span><span class="n">local_base_path</span><span class="p">,</span>
</span><span id="MazeDataset.from_config-164"><a href="#MazeDataset.from_config-164"><span class="linenos">164</span></a>				<span class="n">except_on_config_mismatch</span><span class="o">=</span><span class="n">except_on_config_mismatch</span><span class="p">,</span>
</span><span id="MazeDataset.from_config-165"><a href="#MazeDataset.from_config-165"><span class="linenos">165</span></a>				<span class="n">allow_generation_metadata_filter_mismatch</span><span class="o">=</span><span class="n">allow_generation_metadata_filter_mismatch</span><span class="p">,</span>
</span><span id="MazeDataset.from_config-166"><a href="#MazeDataset.from_config-166"><span class="linenos">166</span></a>				<span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
</span><span id="MazeDataset.from_config-167"><a href="#MazeDataset.from_config-167"><span class="linenos">167</span></a>				<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="MazeDataset.from_config-168"><a href="#MazeDataset.from_config-168"><span class="linenos">168</span></a>			<span class="p">),</span>
</span><span id="MazeDataset.from_config-169"><a href="#MazeDataset.from_config-169"><span class="linenos">169</span></a>		<span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>create a maze dataset from a config</p>

<p>priority of loading:</p>

<ol>
<li>load from local</li>
<li>download</li>
<li>generate</li>
</ol>
</div>


                            </div>
                            <div id="MazeDataset.data_hash" class="classattr">
                                        <input id="MazeDataset.data_hash-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">data_hash</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">int</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDataset.data_hash-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L170-L172" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDataset.data_hash"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDataset.data_hash-171"><a href="#MazeDataset.data_hash-171"><span class="linenos">171</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">data_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="MazeDataset.data_hash-172"><a href="#MazeDataset.data_hash-172"><span class="linenos">172</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;return a hash of the data&quot;&quot;&quot;</span>
</span><span id="MazeDataset.data_hash-173"><a href="#MazeDataset.data_hash-173"><span class="linenos">173</span></a>		<span class="k">return</span> <span class="n">stable_hash</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">tuple</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mazes</span><span class="p">])))</span>
</span></pre></div>


            <div class="docstring"><p>return a hash of the data</p>
</div>


                            </div>
                            <div id="MazeDataset.as_tokens" class="classattr">
                                        <input id="MazeDataset.as_tokens-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">as_tokens</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">maze_tokenizer</span>,</span><span class="param">	<span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">join_tokens_individual_maze</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDataset.as_tokens-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L204-L229" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDataset.as_tokens"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDataset.as_tokens-205"><a href="#MazeDataset.as_tokens-205"><span class="linenos">205</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">as_tokens</span><span class="p">(</span>
</span><span id="MazeDataset.as_tokens-206"><a href="#MazeDataset.as_tokens-206"><span class="linenos">206</span></a>		<span class="bp">self</span><span class="p">,</span>
</span><span id="MazeDataset.as_tokens-207"><a href="#MazeDataset.as_tokens-207"><span class="linenos">207</span></a>		<span class="n">maze_tokenizer</span><span class="p">,</span>  <span class="c1"># TODO: MazeTokenizer</span>
</span><span id="MazeDataset.as_tokens-208"><a href="#MazeDataset.as_tokens-208"><span class="linenos">208</span></a>		<span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="MazeDataset.as_tokens-209"><a href="#MazeDataset.as_tokens-209"><span class="linenos">209</span></a>		<span class="n">join_tokens_individual_maze</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="MazeDataset.as_tokens-210"><a href="#MazeDataset.as_tokens-210"><span class="linenos">210</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="MazeDataset.as_tokens-211"><a href="#MazeDataset.as_tokens-211"><span class="linenos">211</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;return the dataset as tokens according to the passed `maze_tokenizer`</span>
</span><span id="MazeDataset.as_tokens-212"><a href="#MazeDataset.as_tokens-212"><span class="linenos">212</span></a>
</span><span id="MazeDataset.as_tokens-213"><a href="#MazeDataset.as_tokens-213"><span class="linenos">213</span></a><span class="sd">		the `maze_tokenizer` should be either a `MazeTokenizer` or a `MazeTokenizerModular`</span>
</span><span id="MazeDataset.as_tokens-214"><a href="#MazeDataset.as_tokens-214"><span class="linenos">214</span></a>
</span><span id="MazeDataset.as_tokens-215"><a href="#MazeDataset.as_tokens-215"><span class="linenos">215</span></a><span class="sd">		if `join_tokens_individual_maze` is True, then the tokens of each maze are</span>
</span><span id="MazeDataset.as_tokens-216"><a href="#MazeDataset.as_tokens-216"><span class="linenos">216</span></a><span class="sd">		joined with a space, and the result is a list of strings.</span>
</span><span id="MazeDataset.as_tokens-217"><a href="#MazeDataset.as_tokens-217"><span class="linenos">217</span></a><span class="sd">		i.e.:</span>
</span><span id="MazeDataset.as_tokens-218"><a href="#MazeDataset.as_tokens-218"><span class="linenos">218</span></a>
</span><span id="MazeDataset.as_tokens-219"><a href="#MazeDataset.as_tokens-219"><span class="linenos">219</span></a><span class="sd">			&gt;&gt;&gt; dataset.as_tokens(join_tokens_individual_maze=False)</span>
</span><span id="MazeDataset.as_tokens-220"><a href="#MazeDataset.as_tokens-220"><span class="linenos">220</span></a><span class="sd">			[[&quot;a&quot;, &quot;b&quot;, &quot;c&quot;], [&quot;d&quot;, &quot;e&quot;, &quot;f&quot;]]</span>
</span><span id="MazeDataset.as_tokens-221"><a href="#MazeDataset.as_tokens-221"><span class="linenos">221</span></a><span class="sd">			&gt;&gt;&gt; dataset.as_tokens(join_tokens_individual_maze=True)</span>
</span><span id="MazeDataset.as_tokens-222"><a href="#MazeDataset.as_tokens-222"><span class="linenos">222</span></a><span class="sd">			[&quot;a b c&quot;, &quot;d e f&quot;]</span>
</span><span id="MazeDataset.as_tokens-223"><a href="#MazeDataset.as_tokens-223"><span class="linenos">223</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="MazeDataset.as_tokens-224"><a href="#MazeDataset.as_tokens-224"><span class="linenos">224</span></a>		<span class="n">output</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="MazeDataset.as_tokens-225"><a href="#MazeDataset.as_tokens-225"><span class="linenos">225</span></a>			<span class="n">maze</span><span class="o">.</span><span class="n">as_tokens</span><span class="p">(</span><span class="n">maze_tokenizer</span><span class="p">)</span> <span class="k">for</span> <span class="n">maze</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mazes</span><span class="p">[:</span><span class="n">limit</span><span class="p">]</span>
</span><span id="MazeDataset.as_tokens-226"><a href="#MazeDataset.as_tokens-226"><span class="linenos">226</span></a>		<span class="p">]</span>
</span><span id="MazeDataset.as_tokens-227"><a href="#MazeDataset.as_tokens-227"><span class="linenos">227</span></a>		<span class="k">if</span> <span class="n">join_tokens_individual_maze</span><span class="p">:</span>
</span><span id="MazeDataset.as_tokens-228"><a href="#MazeDataset.as_tokens-228"><span class="linenos">228</span></a>			<span class="k">return</span> <span class="p">[</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span> <span class="k">for</span> <span class="n">tokens</span> <span class="ow">in</span> <span class="n">output</span><span class="p">]</span>
</span><span id="MazeDataset.as_tokens-229"><a href="#MazeDataset.as_tokens-229"><span class="linenos">229</span></a>		<span class="k">else</span><span class="p">:</span>
</span><span id="MazeDataset.as_tokens-230"><a href="#MazeDataset.as_tokens-230"><span class="linenos">230</span></a>			<span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>return the dataset as tokens according to the passed <code>maze_tokenizer</code></p>

<p>the <code>maze_tokenizer</code> should be either a <code>MazeTokenizer</code> or a <code>MazeTokenizerModular</code></p>

<p>if <code>join_tokens_individual_maze</code> is True, then the tokens of each maze are
joined with a space, and the result is a list of strings.
i.e.:</p>

<pre><code>    &gt;&gt;&gt; dataset.as_tokens(join_tokens_individual_maze=False)
    [["a", "b", "c"], ["d", "e", "f"]]
    &gt;&gt;&gt; dataset.as_tokens(join_tokens_individual_maze=True)
    ["a b c", "d e f"]
</code></pre>
</div>


                            </div>
                            <div id="MazeDataset.assert_equal" class="classattr">
                                        <input id="MazeDataset.assert_equal-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">assert_equal</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">other</span><span class="p">:</span> <span class="n"><a href="#MazeDataset">MazeDataset</a></span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDataset.assert_equal-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L244-L248" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDataset.assert_equal"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDataset.assert_equal-245"><a href="#MazeDataset.assert_equal-245"><span class="linenos">245</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">assert_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;MazeDataset&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeDataset.assert_equal-246"><a href="#MazeDataset.assert_equal-246"><span class="linenos">246</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;assert that two datasets are equal&quot;&quot;&quot;</span>
</span><span id="MazeDataset.assert_equal-247"><a href="#MazeDataset.assert_equal-247"><span class="linenos">247</span></a>		<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">MazeDataset</span><span class="p">)</span>
</span><span id="MazeDataset.assert_equal-248"><a href="#MazeDataset.assert_equal-248"><span class="linenos">248</span></a>		<span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">cfg</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">cfg</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="MazeDataset.assert_equal-249"><a href="#MazeDataset.assert_equal-249"><span class="linenos">249</span></a>		<span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">mazes</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">mazes</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mazes</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="n">other</span><span class="o">.</span><span class="n">mazes</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span></pre></div>


            <div class="docstring"><p>assert that two datasets are equal</p>
</div>


                            </div>
                            <div id="MazeDataset.generate" class="classattr">
                                        <input id="MazeDataset.generate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">generate</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">cls</span>,</span><span class="param">	<span class="n">cfg</span><span class="p">:</span> <span class="n"><a href="#MazeDatasetConfig">MazeDatasetConfig</a></span>,</span><span class="param">	<span class="n">gen_parallel</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">pool_kwargs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="n"><a href="#MazeDataset">MazeDataset</a></span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDataset.generate-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L250-L324" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDataset.generate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDataset.generate-251"><a href="#MazeDataset.generate-251"><span class="linenos">251</span></a>	<span class="nd">@classmethod</span>
</span><span id="MazeDataset.generate-252"><a href="#MazeDataset.generate-252"><span class="linenos">252</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">generate</span><span class="p">(</span>
</span><span id="MazeDataset.generate-253"><a href="#MazeDataset.generate-253"><span class="linenos">253</span></a>		<span class="bp">cls</span><span class="p">,</span>
</span><span id="MazeDataset.generate-254"><a href="#MazeDataset.generate-254"><span class="linenos">254</span></a>		<span class="n">cfg</span><span class="p">:</span> <span class="n">MazeDatasetConfig</span><span class="p">,</span>
</span><span id="MazeDataset.generate-255"><a href="#MazeDataset.generate-255"><span class="linenos">255</span></a>		<span class="n">gen_parallel</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="MazeDataset.generate-256"><a href="#MazeDataset.generate-256"><span class="linenos">256</span></a>		<span class="n">pool_kwargs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="MazeDataset.generate-257"><a href="#MazeDataset.generate-257"><span class="linenos">257</span></a>		<span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="MazeDataset.generate-258"><a href="#MazeDataset.generate-258"><span class="linenos">258</span></a>		<span class="c1"># TODO: what to do when unexpected kwargs are passed?</span>
</span><span id="MazeDataset.generate-259"><a href="#MazeDataset.generate-259"><span class="linenos">259</span></a>		<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>  <span class="c1"># noqa: ARG003</span>
</span><span id="MazeDataset.generate-260"><a href="#MazeDataset.generate-260"><span class="linenos">260</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MazeDataset&quot;</span><span class="p">:</span>
</span><span id="MazeDataset.generate-261"><a href="#MazeDataset.generate-261"><span class="linenos">261</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Generate a maze dataset given a config and some generation parameters&quot;&quot;&quot;</span>
</span><span id="MazeDataset.generate-262"><a href="#MazeDataset.generate-262"><span class="linenos">262</span></a>		<span class="c1"># Copy the config to avoid modifying the original</span>
</span><span id="MazeDataset.generate-263"><a href="#MazeDataset.generate-263"><span class="linenos">263</span></a>		<span class="n">cfg_cpy</span><span class="p">:</span> <span class="n">MazeDatasetConfig</span> <span class="o">=</span> <span class="n">MazeDatasetConfig</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
</span><span id="MazeDataset.generate-264"><a href="#MazeDataset.generate-264"><span class="linenos">264</span></a>			<span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">serialize</span><span class="p">())),</span>
</span><span id="MazeDataset.generate-265"><a href="#MazeDataset.generate-265"><span class="linenos">265</span></a>		<span class="p">)</span>
</span><span id="MazeDataset.generate-266"><a href="#MazeDataset.generate-266"><span class="linenos">266</span></a>
</span><span id="MazeDataset.generate-267"><a href="#MazeDataset.generate-267"><span class="linenos">267</span></a>		<span class="k">if</span> <span class="n">pool_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeDataset.generate-268"><a href="#MazeDataset.generate-268"><span class="linenos">268</span></a>			<span class="n">pool_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="MazeDataset.generate-269"><a href="#MazeDataset.generate-269"><span class="linenos">269</span></a>		<span class="n">maze_indexes</span><span class="p">:</span> <span class="n">Int</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot; maze_index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">cfg_cpy</span><span class="o">.</span><span class="n">n_mazes</span><span class="p">)</span>  <span class="c1"># type: ignore[assignment]</span>
</span><span id="MazeDataset.generate-270"><a href="#MazeDataset.generate-270"><span class="linenos">270</span></a>
</span><span id="MazeDataset.generate-271"><a href="#MazeDataset.generate-271"><span class="linenos">271</span></a>		<span class="n">solved_mazes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">SolvedMaze</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span>
</span><span id="MazeDataset.generate-272"><a href="#MazeDataset.generate-272"><span class="linenos">272</span></a>		<span class="c1"># Configure tqdm for progress bar</span>
</span><span id="MazeDataset.generate-273"><a href="#MazeDataset.generate-273"><span class="linenos">273</span></a>		<span class="n">tqdm_kwargs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
</span><span id="MazeDataset.generate-274"><a href="#MazeDataset.generate-274"><span class="linenos">274</span></a>			<span class="n">total</span><span class="o">=</span><span class="n">cfg_cpy</span><span class="o">.</span><span class="n">n_mazes</span><span class="p">,</span>
</span><span id="MazeDataset.generate-275"><a href="#MazeDataset.generate-275"><span class="linenos">275</span></a>			<span class="n">unit</span><span class="o">=</span><span class="s2">&quot;maze&quot;</span><span class="p">,</span>
</span><span id="MazeDataset.generate-276"><a href="#MazeDataset.generate-276"><span class="linenos">276</span></a>			<span class="n">desc</span><span class="o">=</span><span class="s2">&quot;generating &amp; solving mazes&quot;</span><span class="p">,</span>
</span><span id="MazeDataset.generate-277"><a href="#MazeDataset.generate-277"><span class="linenos">277</span></a>			<span class="n">disable</span><span class="o">=</span><span class="ow">not</span> <span class="n">verbose</span><span class="p">,</span>
</span><span id="MazeDataset.generate-278"><a href="#MazeDataset.generate-278"><span class="linenos">278</span></a>		<span class="p">)</span>
</span><span id="MazeDataset.generate-279"><a href="#MazeDataset.generate-279"><span class="linenos">279</span></a>		<span class="c1"># TODO: don&#39;t use the global unless generating in parallel!</span>
</span><span id="MazeDataset.generate-280"><a href="#MazeDataset.generate-280"><span class="linenos">280</span></a>		<span class="k">if</span> <span class="n">gen_parallel</span><span class="p">:</span>
</span><span id="MazeDataset.generate-281"><a href="#MazeDataset.generate-281"><span class="linenos">281</span></a>			<span class="k">with</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span>
</span><span id="MazeDataset.generate-282"><a href="#MazeDataset.generate-282"><span class="linenos">282</span></a>				<span class="o">**</span><span class="n">pool_kwargs</span><span class="p">,</span>
</span><span id="MazeDataset.generate-283"><a href="#MazeDataset.generate-283"><span class="linenos">283</span></a>				<span class="n">initializer</span><span class="o">=</span><span class="n">_maze_gen_init_worker</span><span class="p">,</span>
</span><span id="MazeDataset.generate-284"><a href="#MazeDataset.generate-284"><span class="linenos">284</span></a>				<span class="n">initargs</span><span class="o">=</span><span class="p">(</span><span class="n">cfg_cpy</span><span class="p">,),</span>
</span><span id="MazeDataset.generate-285"><a href="#MazeDataset.generate-285"><span class="linenos">285</span></a>			<span class="p">)</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>
</span><span id="MazeDataset.generate-286"><a href="#MazeDataset.generate-286"><span class="linenos">286</span></a>				<span class="n">solved_mazes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="MazeDataset.generate-287"><a href="#MazeDataset.generate-287"><span class="linenos">287</span></a>					<span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span>
</span><span id="MazeDataset.generate-288"><a href="#MazeDataset.generate-288"><span class="linenos">288</span></a>						<span class="n">pool</span><span class="o">.</span><span class="n">imap</span><span class="p">(</span><span class="n">_generate_maze_helper</span><span class="p">,</span> <span class="n">maze_indexes</span><span class="p">),</span>
</span><span id="MazeDataset.generate-289"><a href="#MazeDataset.generate-289"><span class="linenos">289</span></a>						<span class="o">**</span><span class="n">tqdm_kwargs</span><span class="p">,</span>
</span><span id="MazeDataset.generate-290"><a href="#MazeDataset.generate-290"><span class="linenos">290</span></a>					<span class="p">),</span>
</span><span id="MazeDataset.generate-291"><a href="#MazeDataset.generate-291"><span class="linenos">291</span></a>				<span class="p">)</span>
</span><span id="MazeDataset.generate-292"><a href="#MazeDataset.generate-292"><span class="linenos">292</span></a>
</span><span id="MazeDataset.generate-293"><a href="#MazeDataset.generate-293"><span class="linenos">293</span></a>		<span class="k">else</span><span class="p">:</span>
</span><span id="MazeDataset.generate-294"><a href="#MazeDataset.generate-294"><span class="linenos">294</span></a>			<span class="n">_maze_gen_init_worker</span><span class="p">(</span><span class="n">cfg_cpy</span><span class="p">)</span>
</span><span id="MazeDataset.generate-295"><a href="#MazeDataset.generate-295"><span class="linenos">295</span></a>			<span class="n">solved_mazes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="MazeDataset.generate-296"><a href="#MazeDataset.generate-296"><span class="linenos">296</span></a>				<span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span>
</span><span id="MazeDataset.generate-297"><a href="#MazeDataset.generate-297"><span class="linenos">297</span></a>					<span class="nb">map</span><span class="p">(</span>
</span><span id="MazeDataset.generate-298"><a href="#MazeDataset.generate-298"><span class="linenos">298</span></a>						<span class="c1"># TYPING:  error: Argument 1 to &quot;map&quot; has incompatible type &quot;Callable[[int], SolvedMaze | None]&quot;; expected &quot;Callable[[str], SolvedMaze | None]&quot;  [arg-type]</span>
</span><span id="MazeDataset.generate-299"><a href="#MazeDataset.generate-299"><span class="linenos">299</span></a>						<span class="c1"># why does it think tolist() returns a string?</span>
</span><span id="MazeDataset.generate-300"><a href="#MazeDataset.generate-300"><span class="linenos">300</span></a>						<span class="n">_generate_maze_helper</span><span class="p">,</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="MazeDataset.generate-301"><a href="#MazeDataset.generate-301"><span class="linenos">301</span></a>						<span class="n">maze_indexes</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
</span><span id="MazeDataset.generate-302"><a href="#MazeDataset.generate-302"><span class="linenos">302</span></a>					<span class="p">),</span>
</span><span id="MazeDataset.generate-303"><a href="#MazeDataset.generate-303"><span class="linenos">303</span></a>					<span class="o">**</span><span class="n">tqdm_kwargs</span><span class="p">,</span>
</span><span id="MazeDataset.generate-304"><a href="#MazeDataset.generate-304"><span class="linenos">304</span></a>				<span class="p">),</span>
</span><span id="MazeDataset.generate-305"><a href="#MazeDataset.generate-305"><span class="linenos">305</span></a>			<span class="p">)</span>
</span><span id="MazeDataset.generate-306"><a href="#MazeDataset.generate-306"><span class="linenos">306</span></a>
</span><span id="MazeDataset.generate-307"><a href="#MazeDataset.generate-307"><span class="linenos">307</span></a>		<span class="c1"># Filter out None values explicitly after ensuring all results are collected</span>
</span><span id="MazeDataset.generate-308"><a href="#MazeDataset.generate-308"><span class="linenos">308</span></a>		<span class="n">solved_mazes_</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">SolvedMaze</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="MazeDataset.generate-309"><a href="#MazeDataset.generate-309"><span class="linenos">309</span></a>			<span class="n">maze</span> <span class="k">for</span> <span class="n">maze</span> <span class="ow">in</span> <span class="n">solved_mazes</span> <span class="k">if</span> <span class="n">maze</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="MazeDataset.generate-310"><a href="#MazeDataset.generate-310"><span class="linenos">310</span></a>		<span class="p">]</span>
</span><span id="MazeDataset.generate-311"><a href="#MazeDataset.generate-311"><span class="linenos">311</span></a>		<span class="c1"># solved_mazes_ = list(filter(lambda x: x is not None, solved_mazes))</span>
</span><span id="MazeDataset.generate-312"><a href="#MazeDataset.generate-312"><span class="linenos">312</span></a>
</span><span id="MazeDataset.generate-313"><a href="#MazeDataset.generate-313"><span class="linenos">313</span></a>		<span class="c1"># Update the config with the actual number of mazes</span>
</span><span id="MazeDataset.generate-314"><a href="#MazeDataset.generate-314"><span class="linenos">314</span></a>		<span class="n">cfg_cpy</span><span class="o">.</span><span class="n">n_mazes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">solved_mazes_</span><span class="p">)</span>
</span><span id="MazeDataset.generate-315"><a href="#MazeDataset.generate-315"><span class="linenos">315</span></a>
</span><span id="MazeDataset.generate-316"><a href="#MazeDataset.generate-316"><span class="linenos">316</span></a>		<span class="n">dataset</span><span class="p">:</span> <span class="n">MazeDataset</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="MazeDataset.generate-317"><a href="#MazeDataset.generate-317"><span class="linenos">317</span></a>			<span class="n">cfg</span><span class="o">=</span><span class="n">cfg_cpy</span><span class="p">,</span>
</span><span id="MazeDataset.generate-318"><a href="#MazeDataset.generate-318"><span class="linenos">318</span></a>			<span class="n">mazes</span><span class="o">=</span><span class="n">solved_mazes_</span><span class="p">,</span>
</span><span id="MazeDataset.generate-319"><a href="#MazeDataset.generate-319"><span class="linenos">319</span></a>		<span class="p">)</span>
</span><span id="MazeDataset.generate-320"><a href="#MazeDataset.generate-320"><span class="linenos">320</span></a>
</span><span id="MazeDataset.generate-321"><a href="#MazeDataset.generate-321"><span class="linenos">321</span></a>		<span class="n">dataset</span><span class="o">.</span><span class="n">update_self_config</span><span class="p">()</span>  <span class="c1"># Call `update_self_config()` to ensure the dataset&#39;s config reflects changes</span>
</span><span id="MazeDataset.generate-322"><a href="#MazeDataset.generate-322"><span class="linenos">322</span></a>
</span><span id="MazeDataset.generate-323"><a href="#MazeDataset.generate-323"><span class="linenos">323</span></a>		<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">cfg_cpy</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>  <span class="c1"># Reset the seed to the value in the config copy</span>
</span><span id="MazeDataset.generate-324"><a href="#MazeDataset.generate-324"><span class="linenos">324</span></a>
</span><span id="MazeDataset.generate-325"><a href="#MazeDataset.generate-325"><span class="linenos">325</span></a>		<span class="k">return</span> <span class="n">dataset</span>
</span></pre></div>


            <div class="docstring"><p>Generate a maze dataset given a config and some generation parameters</p>
</div>


                            </div>
                            <div id="MazeDataset.download" class="classattr">
                                        <input id="MazeDataset.download-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">download</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">cls</span>,</span><span class="param">	<span class="n">cfg</span><span class="p">:</span> <span class="n"><a href="#MazeDatasetConfig">MazeDatasetConfig</a></span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="n"><a href="#MazeDataset">MazeDataset</a></span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDataset.download-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L326-L329" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDataset.download"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDataset.download-327"><a href="#MazeDataset.download-327"><span class="linenos">327</span></a>	<span class="nd">@classmethod</span>
</span><span id="MazeDataset.download-328"><a href="#MazeDataset.download-328"><span class="linenos">328</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">download</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">MazeDatasetConfig</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MazeDataset&quot;</span><span class="p">:</span>
</span><span id="MazeDataset.download-329"><a href="#MazeDataset.download-329"><span class="linenos">329</span></a>		<span class="s2">&quot;(not implemented yet!) download a maze dataset from the internet&quot;</span>
</span><span id="MazeDataset.download-330"><a href="#MazeDataset.download-330"><span class="linenos">330</span></a>		<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;not implemented yet&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>(not implemented yet!) download a maze dataset from the internet</p>
</div>


                            </div>
                            <div id="MazeDataset.load" class="classattr">
                                        <input id="MazeDataset.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n"><a href="#MazeDataset">MazeDataset</a></span><span class="p">]</span>,</span><span class="param">	<span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]]]</span></span><span class="return-annotation">) -> <span class="n"><a href="#MazeDataset">MazeDataset</a></span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDataset.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L331-L348" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDataset.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDataset.load-332"><a href="#MazeDataset.load-332"><span class="linenos">332</span></a>	<span class="nd">@classmethod</span>
</span><span id="MazeDataset.load-333"><a href="#MazeDataset.load-333"><span class="linenos">333</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="s2">&quot;type[MazeDataset]&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">JSONdict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MazeDataset&quot;</span><span class="p">:</span>
</span><span id="MazeDataset.load-334"><a href="#MazeDataset.load-334"><span class="linenos">334</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;load from zanj/json&quot;&quot;&quot;</span>
</span><span id="MazeDataset.load-335"><a href="#MazeDataset.load-335"><span class="linenos">335</span></a>		<span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">_FORMAT_KEY</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;MazeDataset:minimal&quot;</span><span class="p">:</span>
</span><span id="MazeDataset.load-336"><a href="#MazeDataset.load-336"><span class="linenos">336</span></a>			<span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_load_minimal</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="MazeDataset.load-337"><a href="#MazeDataset.load-337"><span class="linenos">337</span></a>		<span class="k">elif</span> <span class="n">data</span><span class="p">[</span><span class="n">_FORMAT_KEY</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;MazeDataset:minimal_soln_cat&quot;</span><span class="p">:</span>
</span><span id="MazeDataset.load-338"><a href="#MazeDataset.load-338"><span class="linenos">338</span></a>			<span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_load_minimal_soln_cat</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="MazeDataset.load-339"><a href="#MazeDataset.load-339"><span class="linenos">339</span></a>		<span class="k">elif</span> <span class="n">data</span><span class="p">[</span><span class="n">_FORMAT_KEY</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;MazeDataset&quot;</span><span class="p">:</span>
</span><span id="MazeDataset.load-340"><a href="#MazeDataset.load-340"><span class="linenos">340</span></a>			<span class="k">if</span> <span class="p">(</span>
</span><span id="MazeDataset.load-341"><a href="#MazeDataset.load-341"><span class="linenos">341</span></a>				<span class="n">SERIALIZE_MINIMAL_THRESHOLD</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="MazeDataset.load-342"><a href="#MazeDataset.load-342"><span class="linenos">342</span></a>			<span class="p">):</span>  <span class="c1"># Allow access to `_load_legacy` for profiling</span>
</span><span id="MazeDataset.load-343"><a href="#MazeDataset.load-343"><span class="linenos">343</span></a>				<span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_load_legacy</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="MazeDataset.load-344"><a href="#MazeDataset.load-344"><span class="linenos">344</span></a>			<span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_load_full</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="MazeDataset.load-345"><a href="#MazeDataset.load-345"><span class="linenos">345</span></a>		<span class="k">else</span><span class="p">:</span>
</span><span id="MazeDataset.load-346"><a href="#MazeDataset.load-346"><span class="linenos">346</span></a>			<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;`_FORMAT_KEY` string </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="n">_FORMAT_KEY</span><span class="p">]</span><span class="w"> </span><span class="si">= }</span><span class="s2"> is not a recognized `MazeDataset` format. (</span><span class="si">{</span><span class="n">_FORMAT_KEY</span><span class="w"> </span><span class="si">= }</span><span class="s2">)&quot;</span>
</span><span id="MazeDataset.load-347"><a href="#MazeDataset.load-347"><span class="linenos">347</span></a>			<span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
</span><span id="MazeDataset.load-348"><a href="#MazeDataset.load-348"><span class="linenos">348</span></a>				<span class="n">err_msg</span><span class="p">,</span>
</span><span id="MazeDataset.load-349"><a href="#MazeDataset.load-349"><span class="linenos">349</span></a>			<span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>load from zanj/json</p>
</div>


                            </div>
                            <div id="MazeDataset.serialize" class="classattr">
                                        <input id="MazeDataset.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]]]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDataset.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L429-L436" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDataset.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDataset.serialize-430"><a href="#MazeDataset.serialize-430"><span class="linenos">430</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JSONdict</span><span class="p">:</span>
</span><span id="MazeDataset.serialize-431"><a href="#MazeDataset.serialize-431"><span class="linenos">431</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;serialize to zanj/json&quot;&quot;&quot;</span>
</span><span id="MazeDataset.serialize-432"><a href="#MazeDataset.serialize-432"><span class="linenos">432</span></a>		<span class="k">if</span> <span class="p">(</span>
</span><span id="MazeDataset.serialize-433"><a href="#MazeDataset.serialize-433"><span class="linenos">433</span></a>			<span class="n">SERIALIZE_MINIMAL_THRESHOLD</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="MazeDataset.serialize-434"><a href="#MazeDataset.serialize-434"><span class="linenos">434</span></a>			<span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">SERIALIZE_MINIMAL_THRESHOLD</span>
</span><span id="MazeDataset.serialize-435"><a href="#MazeDataset.serialize-435"><span class="linenos">435</span></a>		<span class="p">):</span>
</span><span id="MazeDataset.serialize-436"><a href="#MazeDataset.serialize-436"><span class="linenos">436</span></a>			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_serialize_minimal</span><span class="p">()</span>
</span><span id="MazeDataset.serialize-437"><a href="#MazeDataset.serialize-437"><span class="linenos">437</span></a>		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_serialize_full</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>serialize to zanj/json</p>
</div>


                            </div>
                            <div id="MazeDataset.update_self_config" class="classattr">
                                        <input id="MazeDataset.update_self_config-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_self_config</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDataset.update_self_config-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L541-L547" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDataset.update_self_config"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDataset.update_self_config-542"><a href="#MazeDataset.update_self_config-542"><span class="linenos">542</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">update_self_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeDataset.update_self_config-543"><a href="#MazeDataset.update_self_config-543"><span class="linenos">543</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;update the config to match the current state of the dataset (number of mazes, such as after filtering)&quot;&quot;&quot;</span>
</span><span id="MazeDataset.update_self_config-544"><a href="#MazeDataset.update_self_config-544"><span class="linenos">544</span></a>		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">n_mazes</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mazes</span><span class="p">):</span>
</span><span id="MazeDataset.update_self_config-545"><a href="#MazeDataset.update_self_config-545"><span class="linenos">545</span></a>			<span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="MazeDataset.update_self_config-546"><a href="#MazeDataset.update_self_config-546"><span class="linenos">546</span></a>				<span class="sa">f</span><span class="s2">&quot;updating config n_mazes from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">n_mazes</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mazes</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="MazeDataset.update_self_config-547"><a href="#MazeDataset.update_self_config-547"><span class="linenos">547</span></a>			<span class="p">)</span>
</span><span id="MazeDataset.update_self_config-548"><a href="#MazeDataset.update_self_config-548"><span class="linenos">548</span></a>			<span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">n_mazes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mazes</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>update the config to match the current state of the dataset (number of mazes, such as after filtering)</p>
</div>


                            </div>
                            <div id="MazeDataset.custom_maze_filter" class="classattr">
                                        <input id="MazeDataset.custom_maze_filter-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">custom_maze_filter</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">method</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n"><a href="../maze_dataset.html#SolvedMaze">maze_dataset.SolvedMaze</a></span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="n"><a href="#MazeDataset">MazeDataset</a></span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDataset.custom_maze_filter-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L549-L566" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDataset.custom_maze_filter"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDataset.custom_maze_filter-550"><a href="#MazeDataset.custom_maze_filter-550"><span class="linenos">550</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">custom_maze_filter</span><span class="p">(</span>
</span><span id="MazeDataset.custom_maze_filter-551"><a href="#MazeDataset.custom_maze_filter-551"><span class="linenos">551</span></a>		<span class="bp">self</span><span class="p">,</span>
</span><span id="MazeDataset.custom_maze_filter-552"><a href="#MazeDataset.custom_maze_filter-552"><span class="linenos">552</span></a>		<span class="n">method</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">SolvedMaze</span><span class="p">],</span> <span class="nb">bool</span><span class="p">],</span>
</span><span id="MazeDataset.custom_maze_filter-553"><a href="#MazeDataset.custom_maze_filter-553"><span class="linenos">553</span></a>		<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="MazeDataset.custom_maze_filter-554"><a href="#MazeDataset.custom_maze_filter-554"><span class="linenos">554</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MazeDataset&quot;</span><span class="p">:</span>
</span><span id="MazeDataset.custom_maze_filter-555"><a href="#MazeDataset.custom_maze_filter-555"><span class="linenos">555</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;filter the dataset using a custom method&quot;&quot;&quot;</span>
</span><span id="MazeDataset.custom_maze_filter-556"><a href="#MazeDataset.custom_maze_filter-556"><span class="linenos">556</span></a>		<span class="n">output</span><span class="p">:</span> <span class="n">MazeDataset</span> <span class="o">=</span> <span class="n">MazeDataset</span><span class="p">(</span>
</span><span id="MazeDataset.custom_maze_filter-557"><a href="#MazeDataset.custom_maze_filter-557"><span class="linenos">557</span></a>			<span class="n">cfg</span><span class="o">=</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">),</span>
</span><span id="MazeDataset.custom_maze_filter-558"><a href="#MazeDataset.custom_maze_filter-558"><span class="linenos">558</span></a>			<span class="n">mazes</span><span class="o">=</span><span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mazes</span> <span class="k">if</span> <span class="n">method</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)],</span>
</span><span id="MazeDataset.custom_maze_filter-559"><a href="#MazeDataset.custom_maze_filter-559"><span class="linenos">559</span></a>		<span class="p">)</span>
</span><span id="MazeDataset.custom_maze_filter-560"><a href="#MazeDataset.custom_maze_filter-560"><span class="linenos">560</span></a>		<span class="n">output</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">applied_filters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="MazeDataset.custom_maze_filter-561"><a href="#MazeDataset.custom_maze_filter-561"><span class="linenos">561</span></a>			<span class="p">{</span>
</span><span id="MazeDataset.custom_maze_filter-562"><a href="#MazeDataset.custom_maze_filter-562"><span class="linenos">562</span></a>				<span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;__custom__:</span><span class="si">{</span><span class="n">method</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="MazeDataset.custom_maze_filter-563"><a href="#MazeDataset.custom_maze_filter-563"><span class="linenos">563</span></a>				<span class="s2">&quot;kwargs&quot;</span><span class="p">:</span> <span class="n">kwargs</span><span class="p">,</span>
</span><span id="MazeDataset.custom_maze_filter-564"><a href="#MazeDataset.custom_maze_filter-564"><span class="linenos">564</span></a>			<span class="p">},</span>
</span><span id="MazeDataset.custom_maze_filter-565"><a href="#MazeDataset.custom_maze_filter-565"><span class="linenos">565</span></a>		<span class="p">)</span>
</span><span id="MazeDataset.custom_maze_filter-566"><a href="#MazeDataset.custom_maze_filter-566"><span class="linenos">566</span></a>		<span class="n">output</span><span class="o">.</span><span class="n">update_self_config</span><span class="p">()</span>
</span><span id="MazeDataset.custom_maze_filter-567"><a href="#MazeDataset.custom_maze_filter-567"><span class="linenos">567</span></a>		<span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>filter the dataset using a custom method</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="dataset/dataset.html#GPTDataset">maze_dataset.dataset.dataset.GPTDataset</a></dt>
                                <dd id="MazeDataset.save" class="function"><a href="dataset/dataset.html#GPTDataset.save">save</a></dd>
                <dd id="MazeDataset.read" class="function"><a href="dataset/dataset.html#GPTDataset.read">read</a></dd>
                <dd id="MazeDataset.FilterBy" class="class"><a href="dataset/dataset.html#GPTDataset.FilterBy">FilterBy</a></dd>
                <dd id="MazeDataset.filter_by" class="variable"><a href="dataset/dataset.html#GPTDataset.filter_by">filter_by</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="MazeDatasetConfig">
                            <input id="MazeDatasetConfig-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(kw_only=True, methods_no_override=[&#39;serialize&#39;])</div>

    <span class="def">class</span>
    <span class="name">MazeDatasetConfig</span><wbr>(<span class="base"><a href="dataset/maze_dataset_config.html#MazeDatasetConfig_base">maze_dataset.dataset.maze_dataset_config.MazeDatasetConfig_base</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDatasetConfig-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L256-L496" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDatasetConfig"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDatasetConfig-257"><a href="#MazeDatasetConfig-257"><span class="linenos">257</span></a><span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">methods_no_override</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;serialize&quot;</span><span class="p">])</span>
</span><span id="MazeDatasetConfig-258"><a href="#MazeDatasetConfig-258"><span class="linenos">258</span></a><span class="k">class</span><span class="w"> </span><span class="nc">MazeDatasetConfig</span><span class="p">(</span><span class="n">MazeDatasetConfig_base</span><span class="p">):</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="MazeDatasetConfig-259"><a href="#MazeDatasetConfig-259"><span class="linenos">259</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;config object which is passed to `MazeDataset.from_config` to generate or load a dataset</span>
</span><span id="MazeDatasetConfig-260"><a href="#MazeDatasetConfig-260"><span class="linenos">260</span></a>
</span><span id="MazeDatasetConfig-261"><a href="#MazeDatasetConfig-261"><span class="linenos">261</span></a><span class="sd">	# Parameters:</span>
</span><span id="MazeDatasetConfig-262"><a href="#MazeDatasetConfig-262"><span class="linenos">262</span></a><span class="sd">	- `name : str`</span>
</span><span id="MazeDatasetConfig-263"><a href="#MazeDatasetConfig-263"><span class="linenos">263</span></a><span class="sd">		name of the dataset -- this can be anything, but should be filesystem safe since we use it in the `fname`</span>
</span><span id="MazeDatasetConfig-264"><a href="#MazeDatasetConfig-264"><span class="linenos">264</span></a><span class="sd">	- `grid_n : int`</span>
</span><span id="MazeDatasetConfig-265"><a href="#MazeDatasetConfig-265"><span class="linenos">265</span></a><span class="sd">		grid size of the maze (number of rows/columns)</span>
</span><span id="MazeDatasetConfig-266"><a href="#MazeDatasetConfig-266"><span class="linenos">266</span></a><span class="sd">	- `n_mazes : int`</span>
</span><span id="MazeDatasetConfig-267"><a href="#MazeDatasetConfig-267"><span class="linenos">267</span></a><span class="sd">		number of mazes to request. For some combinations of `endpoint_kwargs` and `maze_ctor`, not all mazes might successfully generate.</span>
</span><span id="MazeDatasetConfig-268"><a href="#MazeDatasetConfig-268"><span class="linenos">268</span></a><span class="sd">		see `EndpointKwargsType` for more details.</span>
</span><span id="MazeDatasetConfig-269"><a href="#MazeDatasetConfig-269"><span class="linenos">269</span></a><span class="sd">	- `maze_ctor : Callable`</span>
</span><span id="MazeDatasetConfig-270"><a href="#MazeDatasetConfig-270"><span class="linenos">270</span></a><span class="sd">		maze generator function. This should be a function that takes a grid size and returns a maze.</span>
</span><span id="MazeDatasetConfig-271"><a href="#MazeDatasetConfig-271"><span class="linenos">271</span></a><span class="sd">		This will usually be one of the functions in `LatticeMazeGenerators`.</span>
</span><span id="MazeDatasetConfig-272"><a href="#MazeDatasetConfig-272"><span class="linenos">272</span></a><span class="sd">	- `maze_ctor_kwargs : dict`</span>
</span><span id="MazeDatasetConfig-273"><a href="#MazeDatasetConfig-273"><span class="linenos">273</span></a><span class="sd">		keyword arguments to pass to the maze generator function. Specific to the `maze_ctor` you are using.</span>
</span><span id="MazeDatasetConfig-274"><a href="#MazeDatasetConfig-274"><span class="linenos">274</span></a><span class="sd">	- `endpoint_kwargs : EndpointKwargsType`</span>
</span><span id="MazeDatasetConfig-275"><a href="#MazeDatasetConfig-275"><span class="linenos">275</span></a><span class="sd">		keyword arguments passed to `LatticeMaze.generate_random_path()`. see `EndpointKwargsType` for more info.</span>
</span><span id="MazeDatasetConfig-276"><a href="#MazeDatasetConfig-276"><span class="linenos">276</span></a><span class="sd">	- `applied_filters : list[dict]`</span>
</span><span id="MazeDatasetConfig-277"><a href="#MazeDatasetConfig-277"><span class="linenos">277</span></a><span class="sd">		list of filters that have been applied to the dataset. We recommend applying filters to datasets directly,</span>
</span><span id="MazeDatasetConfig-278"><a href="#MazeDatasetConfig-278"><span class="linenos">278</span></a><span class="sd">		but these are stored with the config in case you want to re-generate the dataset with the same filters.</span>
</span><span id="MazeDatasetConfig-279"><a href="#MazeDatasetConfig-279"><span class="linenos">279</span></a>
</span><span id="MazeDatasetConfig-280"><a href="#MazeDatasetConfig-280"><span class="linenos">280</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="MazeDatasetConfig-281"><a href="#MazeDatasetConfig-281"><span class="linenos">281</span></a>
</span><span id="MazeDatasetConfig-282"><a href="#MazeDatasetConfig-282"><span class="linenos">282</span></a>	<span class="nd">@property</span>
</span><span id="MazeDatasetConfig-283"><a href="#MazeDatasetConfig-283"><span class="linenos">283</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">config_version</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="MazeDatasetConfig-284"><a href="#MazeDatasetConfig-284"><span class="linenos">284</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;return the version of the config. added in maze_dataset v1.3.0, previous versions had no dataset config&quot;&quot;&quot;</span>
</span><span id="MazeDatasetConfig-285"><a href="#MazeDatasetConfig-285"><span class="linenos">285</span></a>		<span class="k">return</span> <span class="s2">&quot;1.0&quot;</span>
</span><span id="MazeDatasetConfig-286"><a href="#MazeDatasetConfig-286"><span class="linenos">286</span></a>
</span><span id="MazeDatasetConfig-287"><a href="#MazeDatasetConfig-287"><span class="linenos">287</span></a>	<span class="nd">@property</span>
</span><span id="MazeDatasetConfig-288"><a href="#MazeDatasetConfig-288"><span class="linenos">288</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">versions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="MazeDatasetConfig-289"><a href="#MazeDatasetConfig-289"><span class="linenos">289</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;return the versions of the config and the maze_dataset&quot;&quot;&quot;</span>
</span><span id="MazeDatasetConfig-290"><a href="#MazeDatasetConfig-290"><span class="linenos">290</span></a>		<span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
</span><span id="MazeDatasetConfig-291"><a href="#MazeDatasetConfig-291"><span class="linenos">291</span></a>			<span class="n">config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config_version</span><span class="p">,</span>
</span><span id="MazeDatasetConfig-292"><a href="#MazeDatasetConfig-292"><span class="linenos">292</span></a>			<span class="n">maze_dataset</span><span class="o">=</span><span class="n">importlib</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">version</span><span class="p">(</span><span class="s2">&quot;maze_dataset&quot;</span><span class="p">),</span>
</span><span id="MazeDatasetConfig-293"><a href="#MazeDatasetConfig-293"><span class="linenos">293</span></a>		<span class="p">)</span>
</span><span id="MazeDatasetConfig-294"><a href="#MazeDatasetConfig-294"><span class="linenos">294</span></a>
</span><span id="MazeDatasetConfig-295"><a href="#MazeDatasetConfig-295"><span class="linenos">295</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="MazeDatasetConfig-296"><a href="#MazeDatasetConfig-296"><span class="linenos">296</span></a>		<span class="s2">&quot;serialize the MazeDatasetConfig with all fields and fname&quot;</span>
</span><span id="MazeDatasetConfig-297"><a href="#MazeDatasetConfig-297"><span class="linenos">297</span></a>		<span class="k">return</span> <span class="p">{</span>
</span><span id="MazeDatasetConfig-298"><a href="#MazeDatasetConfig-298"><span class="linenos">298</span></a>			<span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_serialize_base</span><span class="p">(</span>
</span><span id="MazeDatasetConfig-299"><a href="#MazeDatasetConfig-299"><span class="linenos">299</span></a>				<span class="n">applied_filters__skip__collect_generation_meta</span><span class="o">=</span><span class="kc">False</span>
</span><span id="MazeDatasetConfig-300"><a href="#MazeDatasetConfig-300"><span class="linenos">300</span></a>			<span class="p">),</span>
</span><span id="MazeDatasetConfig-301"><a href="#MazeDatasetConfig-301"><span class="linenos">301</span></a>			<span class="s2">&quot;fname&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_fname</span><span class="p">(),</span>
</span><span id="MazeDatasetConfig-302"><a href="#MazeDatasetConfig-302"><span class="linenos">302</span></a>			<span class="s2">&quot;versions&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">versions</span><span class="p">,</span>
</span><span id="MazeDatasetConfig-303"><a href="#MazeDatasetConfig-303"><span class="linenos">303</span></a>		<span class="p">}</span>
</span><span id="MazeDatasetConfig-304"><a href="#MazeDatasetConfig-304"><span class="linenos">304</span></a>
</span><span id="MazeDatasetConfig-305"><a href="#MazeDatasetConfig-305"><span class="linenos">305</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="MazeDatasetConfig-306"><a href="#MazeDatasetConfig-306"><span class="linenos">306</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;return a summary of the config&quot;&quot;&quot;</span>
</span><span id="MazeDatasetConfig-307"><a href="#MazeDatasetConfig-307"><span class="linenos">307</span></a>		<span class="c1"># do we run this to make sure it doesn&#39;t error?</span>
</span><span id="MazeDatasetConfig-308"><a href="#MazeDatasetConfig-308"><span class="linenos">308</span></a>		<span class="n">super_summary</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</span><span id="MazeDatasetConfig-309"><a href="#MazeDatasetConfig-309"><span class="linenos">309</span></a>		<span class="k">assert</span> <span class="n">super_summary</span>
</span><span id="MazeDatasetConfig-310"><a href="#MazeDatasetConfig-310"><span class="linenos">310</span></a>		<span class="n">self_ser</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="MazeDatasetConfig-311"><a href="#MazeDatasetConfig-311"><span class="linenos">311</span></a>		<span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
</span><span id="MazeDatasetConfig-312"><a href="#MazeDatasetConfig-312"><span class="linenos">312</span></a>			<span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="MazeDatasetConfig-313"><a href="#MazeDatasetConfig-313"><span class="linenos">313</span></a>			<span class="n">fname</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">to_fname</span><span class="p">(),</span>
</span><span id="MazeDatasetConfig-314"><a href="#MazeDatasetConfig-314"><span class="linenos">314</span></a>			<span class="n">sdc_hash</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stable_hash_cfg</span><span class="p">(),</span>
</span><span id="MazeDatasetConfig-315"><a href="#MazeDatasetConfig-315"><span class="linenos">315</span></a>			<span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="MazeDatasetConfig-316"><a href="#MazeDatasetConfig-316"><span class="linenos">316</span></a>			<span class="n">seq_len_min</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seq_len_min</span><span class="p">,</span>
</span><span id="MazeDatasetConfig-317"><a href="#MazeDatasetConfig-317"><span class="linenos">317</span></a>			<span class="n">seq_len_max</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seq_len_max</span><span class="p">,</span>
</span><span id="MazeDatasetConfig-318"><a href="#MazeDatasetConfig-318"><span class="linenos">318</span></a>			<span class="n">applied_filters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">applied_filters</span><span class="p">,</span>
</span><span id="MazeDatasetConfig-319"><a href="#MazeDatasetConfig-319"><span class="linenos">319</span></a>			<span class="n">grid_n</span><span class="o">=</span><span class="n">self_ser</span><span class="p">[</span><span class="s2">&quot;grid_n&quot;</span><span class="p">],</span>
</span><span id="MazeDatasetConfig-320"><a href="#MazeDatasetConfig-320"><span class="linenos">320</span></a>			<span class="n">n_mazes</span><span class="o">=</span><span class="n">self_ser</span><span class="p">[</span><span class="s2">&quot;n_mazes&quot;</span><span class="p">],</span>
</span><span id="MazeDatasetConfig-321"><a href="#MazeDatasetConfig-321"><span class="linenos">321</span></a>			<span class="n">maze_ctor_name</span><span class="o">=</span><span class="n">self_ser</span><span class="p">[</span><span class="s2">&quot;maze_ctor&quot;</span><span class="p">][</span><span class="s2">&quot;__name__&quot;</span><span class="p">],</span>
</span><span id="MazeDatasetConfig-322"><a href="#MazeDatasetConfig-322"><span class="linenos">322</span></a>			<span class="n">maze_ctor_kwargs</span><span class="o">=</span><span class="n">self_ser</span><span class="p">[</span><span class="s2">&quot;maze_ctor_kwargs&quot;</span><span class="p">],</span>
</span><span id="MazeDatasetConfig-323"><a href="#MazeDatasetConfig-323"><span class="linenos">323</span></a>			<span class="n">endpoint_kwargs</span><span class="o">=</span><span class="n">self_ser</span><span class="p">[</span><span class="s2">&quot;endpoint_kwargs&quot;</span><span class="p">],</span>
</span><span id="MazeDatasetConfig-324"><a href="#MazeDatasetConfig-324"><span class="linenos">324</span></a>		<span class="p">)</span>
</span><span id="MazeDatasetConfig-325"><a href="#MazeDatasetConfig-325"><span class="linenos">325</span></a>
</span><span id="MazeDatasetConfig-326"><a href="#MazeDatasetConfig-326"><span class="linenos">326</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">_to_ps_array</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_PercolationSuccessArray</span><span class="p">:</span>
</span><span id="MazeDatasetConfig-327"><a href="#MazeDatasetConfig-327"><span class="linenos">327</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Convert this config to a [p, grid_n, deadends, endpoints_not_equal, generator_func] vector.</span>
</span><span id="MazeDatasetConfig-328"><a href="#MazeDatasetConfig-328"><span class="linenos">328</span></a>
</span><span id="MazeDatasetConfig-329"><a href="#MazeDatasetConfig-329"><span class="linenos">329</span></a><span class="sd">		used in predicting the success rate</span>
</span><span id="MazeDatasetConfig-330"><a href="#MazeDatasetConfig-330"><span class="linenos">330</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="MazeDatasetConfig-331"><a href="#MazeDatasetConfig-331"><span class="linenos">331</span></a>		<span class="k">try</span><span class="p">:</span>
</span><span id="MazeDatasetConfig-332"><a href="#MazeDatasetConfig-332"><span class="linenos">332</span></a>			<span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">maze_ctor</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">in</span> <span class="n">_GENERATORS_PERCOLATED</span><span class="p">,</span> <span class="p">(</span>
</span><span id="MazeDatasetConfig-333"><a href="#MazeDatasetConfig-333"><span class="linenos">333</span></a>				<span class="sa">f</span><span class="s2">&quot;generator not supported, must be a percolation generator</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">maze_ctor</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="n">_GENERATORS_PERCOLATED</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="MazeDatasetConfig-334"><a href="#MazeDatasetConfig-334"><span class="linenos">334</span></a>			<span class="p">)</span>
</span><span id="MazeDatasetConfig-335"><a href="#MazeDatasetConfig-335"><span class="linenos">335</span></a>			<span class="k">assert</span> <span class="s2">&quot;p&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">maze_ctor_kwargs</span><span class="p">,</span> <span class="p">(</span>
</span><span id="MazeDatasetConfig-336"><a href="#MazeDatasetConfig-336"><span class="linenos">336</span></a>				<span class="sa">f</span><span class="s2">&quot;maze_ctor_kwargs must have a &#39;p&#39; (percolation value) key: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">maze_ctor_kwargs</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="MazeDatasetConfig-337"><a href="#MazeDatasetConfig-337"><span class="linenos">337</span></a>			<span class="p">)</span>
</span><span id="MazeDatasetConfig-338"><a href="#MazeDatasetConfig-338"><span class="linenos">338</span></a>			<span class="k">assert</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;except_on_no_valid_endpoint&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span> <span class="p">(</span>
</span><span id="MazeDatasetConfig-339"><a href="#MazeDatasetConfig-339"><span class="linenos">339</span></a>				<span class="sa">f</span><span class="s2">&quot;except_on_no_valid_endpoint must be False, or else if any maze fails to generate, the whole dataset will fail: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">endpoint_kwargs</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="MazeDatasetConfig-340"><a href="#MazeDatasetConfig-340"><span class="linenos">340</span></a>			<span class="p">)</span>
</span><span id="MazeDatasetConfig-341"><a href="#MazeDatasetConfig-341"><span class="linenos">341</span></a>		<span class="k">except</span> <span class="ne">AssertionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="MazeDatasetConfig-342"><a href="#MazeDatasetConfig-342"><span class="linenos">342</span></a>			<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;invalid config for percolation success prediction: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="MazeDatasetConfig-343"><a href="#MazeDatasetConfig-343"><span class="linenos">343</span></a>			<span class="k">raise</span> <span class="n">NoPercolationInConfigError</span><span class="p">(</span>
</span><span id="MazeDatasetConfig-344"><a href="#MazeDatasetConfig-344"><span class="linenos">344</span></a>				<span class="n">err_msg</span><span class="p">,</span>
</span><span id="MazeDatasetConfig-345"><a href="#MazeDatasetConfig-345"><span class="linenos">345</span></a>			<span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</span><span id="MazeDatasetConfig-346"><a href="#MazeDatasetConfig-346"><span class="linenos">346</span></a>
</span><span id="MazeDatasetConfig-347"><a href="#MazeDatasetConfig-347"><span class="linenos">347</span></a>		<span class="n">endpoints_unique_flag</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
</span><span id="MazeDatasetConfig-348"><a href="#MazeDatasetConfig-348"><span class="linenos">348</span></a>			<span class="c1"># we are pretty sure it will be an int or bool here</span>
</span><span id="MazeDatasetConfig-349"><a href="#MazeDatasetConfig-349"><span class="linenos">349</span></a>			<span class="bp">self</span><span class="o">.</span><span class="n">endpoint_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;endpoints_not_equal&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="MazeDatasetConfig-350"><a href="#MazeDatasetConfig-350"><span class="linenos">350</span></a>		<span class="p">)</span>
</span><span id="MazeDatasetConfig-351"><a href="#MazeDatasetConfig-351"><span class="linenos">351</span></a>
</span><span id="MazeDatasetConfig-352"><a href="#MazeDatasetConfig-352"><span class="linenos">352</span></a>		<span class="c1"># adjustment for bknutson0</span>
</span><span id="MazeDatasetConfig-353"><a href="#MazeDatasetConfig-353"><span class="linenos">353</span></a>		<span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
</span><span id="MazeDatasetConfig-354"><a href="#MazeDatasetConfig-354"><span class="linenos">354</span></a>			<span class="bp">self</span><span class="o">.</span><span class="n">endpoint_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;deadend_start&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="MazeDatasetConfig-355"><a href="#MazeDatasetConfig-355"><span class="linenos">355</span></a>			<span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;deadend_end&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="MazeDatasetConfig-356"><a href="#MazeDatasetConfig-356"><span class="linenos">356</span></a>		<span class="p">):</span>
</span><span id="MazeDatasetConfig-357"><a href="#MazeDatasetConfig-357"><span class="linenos">357</span></a>			<span class="c1"># we didnt train on this, but if either endpoint is not required to be in a dead end</span>
</span><span id="MazeDatasetConfig-358"><a href="#MazeDatasetConfig-358"><span class="linenos">358</span></a>			<span class="c1"># then  requiring the endpoints to be unique does not really affect the success rate</span>
</span><span id="MazeDatasetConfig-359"><a href="#MazeDatasetConfig-359"><span class="linenos">359</span></a>			<span class="c1"># (except for very small percolation values, pure percolation generation)</span>
</span><span id="MazeDatasetConfig-360"><a href="#MazeDatasetConfig-360"><span class="linenos">360</span></a>			<span class="n">endpoints_unique_flag</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="MazeDatasetConfig-361"><a href="#MazeDatasetConfig-361"><span class="linenos">361</span></a>
</span><span id="MazeDatasetConfig-362"><a href="#MazeDatasetConfig-362"><span class="linenos">362</span></a>		<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span><span id="MazeDatasetConfig-363"><a href="#MazeDatasetConfig-363"><span class="linenos">363</span></a>			<span class="p">[</span>
</span><span id="MazeDatasetConfig-364"><a href="#MazeDatasetConfig-364"><span class="linenos">364</span></a>				<span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maze_ctor_kwargs</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">]),</span>
</span><span id="MazeDatasetConfig-365"><a href="#MazeDatasetConfig-365"><span class="linenos">365</span></a>				<span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_n</span><span class="p">),</span>
</span><span id="MazeDatasetConfig-366"><a href="#MazeDatasetConfig-366"><span class="linenos">366</span></a>				<span class="nb">float</span><span class="p">(</span>
</span><span id="MazeDatasetConfig-367"><a href="#MazeDatasetConfig-367"><span class="linenos">367</span></a>					<span class="nb">int</span><span class="p">(</span>
</span><span id="MazeDatasetConfig-368"><a href="#MazeDatasetConfig-368"><span class="linenos">368</span></a>						<span class="bp">self</span><span class="o">.</span><span class="n">endpoint_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;deadend_start&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="MazeDatasetConfig-369"><a href="#MazeDatasetConfig-369"><span class="linenos">369</span></a>						<span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;deadend_end&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
</span><span id="MazeDatasetConfig-370"><a href="#MazeDatasetConfig-370"><span class="linenos">370</span></a>					<span class="p">),</span>
</span><span id="MazeDatasetConfig-371"><a href="#MazeDatasetConfig-371"><span class="linenos">371</span></a>				<span class="p">),</span>
</span><span id="MazeDatasetConfig-372"><a href="#MazeDatasetConfig-372"><span class="linenos">372</span></a>				<span class="nb">float</span><span class="p">(</span><span class="n">endpoints_unique_flag</span><span class="p">),</span>
</span><span id="MazeDatasetConfig-373"><a href="#MazeDatasetConfig-373"><span class="linenos">373</span></a>				<span class="nb">float</span><span class="p">(</span><span class="n">_GENERATORS_PERCOLATED</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maze_ctor</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)),</span>
</span><span id="MazeDatasetConfig-374"><a href="#MazeDatasetConfig-374"><span class="linenos">374</span></a>			<span class="p">],</span>
</span><span id="MazeDatasetConfig-375"><a href="#MazeDatasetConfig-375"><span class="linenos">375</span></a>			<span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span>
</span><span id="MazeDatasetConfig-376"><a href="#MazeDatasetConfig-376"><span class="linenos">376</span></a>		<span class="p">)</span>
</span><span id="MazeDatasetConfig-377"><a href="#MazeDatasetConfig-377"><span class="linenos">377</span></a>
</span><span id="MazeDatasetConfig-378"><a href="#MazeDatasetConfig-378"><span class="linenos">378</span></a>	<span class="nd">@classmethod</span>
</span><span id="MazeDatasetConfig-379"><a href="#MazeDatasetConfig-379"><span class="linenos">379</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">_from_ps_array</span><span class="p">(</span>
</span><span id="MazeDatasetConfig-380"><a href="#MazeDatasetConfig-380"><span class="linenos">380</span></a>		<span class="bp">cls</span><span class="p">,</span>
</span><span id="MazeDatasetConfig-381"><a href="#MazeDatasetConfig-381"><span class="linenos">381</span></a>		<span class="n">arr</span><span class="p">:</span> <span class="n">_PercolationSuccessArray</span><span class="p">,</span>
</span><span id="MazeDatasetConfig-382"><a href="#MazeDatasetConfig-382"><span class="linenos">382</span></a>		<span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;predict&quot;</span><span class="p">,</span>
</span><span id="MazeDatasetConfig-383"><a href="#MazeDatasetConfig-383"><span class="linenos">383</span></a>		<span class="n">n_mazes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
</span><span id="MazeDatasetConfig-384"><a href="#MazeDatasetConfig-384"><span class="linenos">384</span></a>		<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="MazeDatasetConfig-385"><a href="#MazeDatasetConfig-385"><span class="linenos">385</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MazeDatasetConfig&quot;</span><span class="p">:</span>
</span><span id="MazeDatasetConfig-386"><a href="#MazeDatasetConfig-386"><span class="linenos">386</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Reconstruct a config from an array [p, grid_n, deadends, endpoints_not_equal, generator_func] and other config parameters.</span>
</span><span id="MazeDatasetConfig-387"><a href="#MazeDatasetConfig-387"><span class="linenos">387</span></a>
</span><span id="MazeDatasetConfig-388"><a href="#MazeDatasetConfig-388"><span class="linenos">388</span></a><span class="sd">		# Returns:</span>
</span><span id="MazeDatasetConfig-389"><a href="#MazeDatasetConfig-389"><span class="linenos">389</span></a><span class="sd">		- `MazeDatasetConfig`</span>
</span><span id="MazeDatasetConfig-390"><a href="#MazeDatasetConfig-390"><span class="linenos">390</span></a><span class="sd">			Config corresponding to `arr`</span>
</span><span id="MazeDatasetConfig-391"><a href="#MazeDatasetConfig-391"><span class="linenos">391</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="MazeDatasetConfig-392"><a href="#MazeDatasetConfig-392"><span class="linenos">392</span></a>		<span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="MazeDatasetConfig-393"><a href="#MazeDatasetConfig-393"><span class="linenos">393</span></a>			<span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
</span><span id="MazeDatasetConfig-394"><a href="#MazeDatasetConfig-394"><span class="linenos">394</span></a>			<span class="n">grid_n</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
</span><span id="MazeDatasetConfig-395"><a href="#MazeDatasetConfig-395"><span class="linenos">395</span></a>			<span class="n">n_mazes</span><span class="o">=</span><span class="n">n_mazes</span><span class="p">,</span>
</span><span id="MazeDatasetConfig-396"><a href="#MazeDatasetConfig-396"><span class="linenos">396</span></a>			<span class="n">maze_ctor</span><span class="o">=</span><span class="n">GENERATORS_MAP</span><span class="p">[</span><span class="n">_GENERATORS_PERCOLATED</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="mi">4</span><span class="p">])]],</span>
</span><span id="MazeDatasetConfig-397"><a href="#MazeDatasetConfig-397"><span class="linenos">397</span></a>			<span class="n">maze_ctor_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;p&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">])},</span>
</span><span id="MazeDatasetConfig-398"><a href="#MazeDatasetConfig-398"><span class="linenos">398</span></a>			<span class="n">endpoint_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
</span><span id="MazeDatasetConfig-399"><a href="#MazeDatasetConfig-399"><span class="linenos">399</span></a>				<span class="n">deadend_start</span><span class="o">=</span><span class="nb">bool</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
</span><span id="MazeDatasetConfig-400"><a href="#MazeDatasetConfig-400"><span class="linenos">400</span></a>				<span class="n">deadend_end</span><span class="o">=</span><span class="nb">bool</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
</span><span id="MazeDatasetConfig-401"><a href="#MazeDatasetConfig-401"><span class="linenos">401</span></a>				<span class="n">endpoints_not_equal</span><span class="o">=</span><span class="nb">bool</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span>
</span><span id="MazeDatasetConfig-402"><a href="#MazeDatasetConfig-402"><span class="linenos">402</span></a>				<span class="n">except_on_no_valid_endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="MazeDatasetConfig-403"><a href="#MazeDatasetConfig-403"><span class="linenos">403</span></a>			<span class="p">),</span>
</span><span id="MazeDatasetConfig-404"><a href="#MazeDatasetConfig-404"><span class="linenos">404</span></a>			<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="MazeDatasetConfig-405"><a href="#MazeDatasetConfig-405"><span class="linenos">405</span></a>		<span class="p">)</span>
</span><span id="MazeDatasetConfig-406"><a href="#MazeDatasetConfig-406"><span class="linenos">406</span></a>
</span><span id="MazeDatasetConfig-407"><a href="#MazeDatasetConfig-407"><span class="linenos">407</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">success_fraction_estimate</span><span class="p">(</span>
</span><span id="MazeDatasetConfig-408"><a href="#MazeDatasetConfig-408"><span class="linenos">408</span></a>		<span class="bp">self</span><span class="p">,</span>
</span><span id="MazeDatasetConfig-409"><a href="#MazeDatasetConfig-409"><span class="linenos">409</span></a>		<span class="n">except_if_all_success_expected</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="MazeDatasetConfig-410"><a href="#MazeDatasetConfig-410"><span class="linenos">410</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="MazeDatasetConfig-411"><a href="#MazeDatasetConfig-411"><span class="linenos">411</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Estimate the success fraction of this config.</span>
</span><span id="MazeDatasetConfig-412"><a href="#MazeDatasetConfig-412"><span class="linenos">412</span></a>
</span><span id="MazeDatasetConfig-413"><a href="#MazeDatasetConfig-413"><span class="linenos">413</span></a><span class="sd">		only valid when the generator is a percolation generator,</span>
</span><span id="MazeDatasetConfig-414"><a href="#MazeDatasetConfig-414"><span class="linenos">414</span></a><span class="sd">		and endpoints are enforced to be dead ends</span>
</span><span id="MazeDatasetConfig-415"><a href="#MazeDatasetConfig-415"><span class="linenos">415</span></a>
</span><span id="MazeDatasetConfig-416"><a href="#MazeDatasetConfig-416"><span class="linenos">416</span></a><span class="sd">		more information on where this comes from can be found in</span>
</span><span id="MazeDatasetConfig-417"><a href="#MazeDatasetConfig-417"><span class="linenos">417</span></a><span class="sd">		- `cfg_success_predict_fn()` from `maze_dataset.dataset.success_predict_math`</span>
</span><span id="MazeDatasetConfig-418"><a href="#MazeDatasetConfig-418"><span class="linenos">418</span></a><span class="sd">		- `estimate_dataset_fractions.ipynb`</span>
</span><span id="MazeDatasetConfig-419"><a href="#MazeDatasetConfig-419"><span class="linenos">419</span></a><span class="sd">		- `maze_dataset.benchmarks.sweep_fit`</span>
</span><span id="MazeDatasetConfig-420"><a href="#MazeDatasetConfig-420"><span class="linenos">420</span></a>
</span><span id="MazeDatasetConfig-421"><a href="#MazeDatasetConfig-421"><span class="linenos">421</span></a><span class="sd">		# Parameters:</span>
</span><span id="MazeDatasetConfig-422"><a href="#MazeDatasetConfig-422"><span class="linenos">422</span></a><span class="sd">		- `except_if_all_success_expected : bool`</span>
</span><span id="MazeDatasetConfig-423"><a href="#MazeDatasetConfig-423"><span class="linenos">423</span></a><span class="sd">			if `True`, don&#39;t raise an error if the success fraction is below the threshold.</span>
</span><span id="MazeDatasetConfig-424"><a href="#MazeDatasetConfig-424"><span class="linenos">424</span></a><span class="sd">			will always return `1.0` if the config is not expected to fail</span>
</span><span id="MazeDatasetConfig-425"><a href="#MazeDatasetConfig-425"><span class="linenos">425</span></a>
</span><span id="MazeDatasetConfig-426"><a href="#MazeDatasetConfig-426"><span class="linenos">426</span></a><span class="sd">		# Returns:</span>
</span><span id="MazeDatasetConfig-427"><a href="#MazeDatasetConfig-427"><span class="linenos">427</span></a><span class="sd">		- `float`</span>
</span><span id="MazeDatasetConfig-428"><a href="#MazeDatasetConfig-428"><span class="linenos">428</span></a><span class="sd">			estimated success fraction</span>
</span><span id="MazeDatasetConfig-429"><a href="#MazeDatasetConfig-429"><span class="linenos">429</span></a>
</span><span id="MazeDatasetConfig-430"><a href="#MazeDatasetConfig-430"><span class="linenos">430</span></a><span class="sd">		# Raises:</span>
</span><span id="MazeDatasetConfig-431"><a href="#MazeDatasetConfig-431"><span class="linenos">431</span></a><span class="sd">		- `NoPercolationInConfigError` : if the config is not expected to fail, and `except_if_all_success_expected` is `False`</span>
</span><span id="MazeDatasetConfig-432"><a href="#MazeDatasetConfig-432"><span class="linenos">432</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="MazeDatasetConfig-433"><a href="#MazeDatasetConfig-433"><span class="linenos">433</span></a>		<span class="k">try</span><span class="p">:</span>
</span><span id="MazeDatasetConfig-434"><a href="#MazeDatasetConfig-434"><span class="linenos">434</span></a>			<span class="k">return</span> <span class="n">cfg_success_predict_fn</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="MazeDatasetConfig-435"><a href="#MazeDatasetConfig-435"><span class="linenos">435</span></a>
</span><span id="MazeDatasetConfig-436"><a href="#MazeDatasetConfig-436"><span class="linenos">436</span></a>		<span class="k">except</span> <span class="n">NoPercolationInConfigError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="MazeDatasetConfig-437"><a href="#MazeDatasetConfig-437"><span class="linenos">437</span></a>			<span class="k">if</span> <span class="n">except_if_all_success_expected</span><span class="p">:</span>
</span><span id="MazeDatasetConfig-438"><a href="#MazeDatasetConfig-438"><span class="linenos">438</span></a>				<span class="k">raise</span> <span class="n">e</span>  <span class="c1"># noqa: TRY201</span>
</span><span id="MazeDatasetConfig-439"><a href="#MazeDatasetConfig-439"><span class="linenos">439</span></a>			<span class="k">return</span> <span class="mf">1.0</span>
</span><span id="MazeDatasetConfig-440"><a href="#MazeDatasetConfig-440"><span class="linenos">440</span></a>
</span><span id="MazeDatasetConfig-441"><a href="#MazeDatasetConfig-441"><span class="linenos">441</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">success_fraction_compensate</span><span class="p">(</span>
</span><span id="MazeDatasetConfig-442"><a href="#MazeDatasetConfig-442"><span class="linenos">442</span></a>		<span class="bp">self</span><span class="p">,</span>
</span><span id="MazeDatasetConfig-443"><a href="#MazeDatasetConfig-443"><span class="linenos">443</span></a>		<span class="n">safety_margin</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.2</span><span class="p">,</span>
</span><span id="MazeDatasetConfig-444"><a href="#MazeDatasetConfig-444"><span class="linenos">444</span></a>		<span class="n">except_if_all_success_expected</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="MazeDatasetConfig-445"><a href="#MazeDatasetConfig-445"><span class="linenos">445</span></a>		<span class="n">epsilon</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-2</span><span class="p">,</span>
</span><span id="MazeDatasetConfig-446"><a href="#MazeDatasetConfig-446"><span class="linenos">446</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MazeDatasetConfig&quot;</span><span class="p">:</span>
</span><span id="MazeDatasetConfig-447"><a href="#MazeDatasetConfig-447"><span class="linenos">447</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;return a new `MazeDatasetConfig` like this one with `n_mazes` adjusted to compensate for the success fraction</span>
</span><span id="MazeDatasetConfig-448"><a href="#MazeDatasetConfig-448"><span class="linenos">448</span></a>
</span><span id="MazeDatasetConfig-449"><a href="#MazeDatasetConfig-449"><span class="linenos">449</span></a><span class="sd">		calls `MazeDatasetConfig.success_fraction_estimate()` to get the success fraction, and then</span>
</span><span id="MazeDatasetConfig-450"><a href="#MazeDatasetConfig-450"><span class="linenos">450</span></a><span class="sd">		computes the new number of mazes as `n_mazes = n_mazes * safety_margin / success_fraction + 1`</span>
</span><span id="MazeDatasetConfig-451"><a href="#MazeDatasetConfig-451"><span class="linenos">451</span></a>
</span><span id="MazeDatasetConfig-452"><a href="#MazeDatasetConfig-452"><span class="linenos">452</span></a><span class="sd">		more information on where this comes from can be found in</span>
</span><span id="MazeDatasetConfig-453"><a href="#MazeDatasetConfig-453"><span class="linenos">453</span></a><span class="sd">		- `cfg_success_predict_fn()` from `maze_dataset.dataset.success_predict_math`</span>
</span><span id="MazeDatasetConfig-454"><a href="#MazeDatasetConfig-454"><span class="linenos">454</span></a><span class="sd">		- `estimate_dataset_fractions.ipynb`</span>
</span><span id="MazeDatasetConfig-455"><a href="#MazeDatasetConfig-455"><span class="linenos">455</span></a><span class="sd">		- `maze_dataset.benchmarks.sweep_fit`</span>
</span><span id="MazeDatasetConfig-456"><a href="#MazeDatasetConfig-456"><span class="linenos">456</span></a>
</span><span id="MazeDatasetConfig-457"><a href="#MazeDatasetConfig-457"><span class="linenos">457</span></a><span class="sd">		# Parameters:</span>
</span><span id="MazeDatasetConfig-458"><a href="#MazeDatasetConfig-458"><span class="linenos">458</span></a><span class="sd">		- `safety_margin : float`</span>
</span><span id="MazeDatasetConfig-459"><a href="#MazeDatasetConfig-459"><span class="linenos">459</span></a><span class="sd">			safety margin to apply to the success fraction estimate</span>
</span><span id="MazeDatasetConfig-460"><a href="#MazeDatasetConfig-460"><span class="linenos">460</span></a><span class="sd">			(defaults to `1.2`, or 20% more mazes than estimated)</span>
</span><span id="MazeDatasetConfig-461"><a href="#MazeDatasetConfig-461"><span class="linenos">461</span></a><span class="sd">		- `except_if_all_success_expected : bool`</span>
</span><span id="MazeDatasetConfig-462"><a href="#MazeDatasetConfig-462"><span class="linenos">462</span></a><span class="sd">			if `True`, don&#39;t raise an error if the success fraction is below the threshold.</span>
</span><span id="MazeDatasetConfig-463"><a href="#MazeDatasetConfig-463"><span class="linenos">463</span></a><span class="sd">			this is passed to `MazeDatasetConfig.success_fraction_estimate`.</span>
</span><span id="MazeDatasetConfig-464"><a href="#MazeDatasetConfig-464"><span class="linenos">464</span></a><span class="sd">			if your config isn&#39;t expected to fail, passing this might mean you generate more mazes than needed</span>
</span><span id="MazeDatasetConfig-465"><a href="#MazeDatasetConfig-465"><span class="linenos">465</span></a><span class="sd">			since `safety_margin` is still applied.</span>
</span><span id="MazeDatasetConfig-466"><a href="#MazeDatasetConfig-466"><span class="linenos">466</span></a><span class="sd">			(defaults to `False`)</span>
</span><span id="MazeDatasetConfig-467"><a href="#MazeDatasetConfig-467"><span class="linenos">467</span></a><span class="sd">		- `epsilon : float`</span>
</span><span id="MazeDatasetConfig-468"><a href="#MazeDatasetConfig-468"><span class="linenos">468</span></a><span class="sd">			raise `SuccessChanceTooSmallError` if the success fraction is below this threshold</span>
</span><span id="MazeDatasetConfig-469"><a href="#MazeDatasetConfig-469"><span class="linenos">469</span></a><span class="sd">			(defaults to `1e-2`)</span>
</span><span id="MazeDatasetConfig-470"><a href="#MazeDatasetConfig-470"><span class="linenos">470</span></a>
</span><span id="MazeDatasetConfig-471"><a href="#MazeDatasetConfig-471"><span class="linenos">471</span></a><span class="sd">		# Returns:</span>
</span><span id="MazeDatasetConfig-472"><a href="#MazeDatasetConfig-472"><span class="linenos">472</span></a><span class="sd">		- `MazeDatasetConfig`</span>
</span><span id="MazeDatasetConfig-473"><a href="#MazeDatasetConfig-473"><span class="linenos">473</span></a><span class="sd">			new config with adjusted `n_mazes`</span>
</span><span id="MazeDatasetConfig-474"><a href="#MazeDatasetConfig-474"><span class="linenos">474</span></a>
</span><span id="MazeDatasetConfig-475"><a href="#MazeDatasetConfig-475"><span class="linenos">475</span></a><span class="sd">		# Raises:</span>
</span><span id="MazeDatasetConfig-476"><a href="#MazeDatasetConfig-476"><span class="linenos">476</span></a><span class="sd">		- `SuccessChanceTooSmallError` : if the computed success fraction is below `epsilon`</span>
</span><span id="MazeDatasetConfig-477"><a href="#MazeDatasetConfig-477"><span class="linenos">477</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="MazeDatasetConfig-478"><a href="#MazeDatasetConfig-478"><span class="linenos">478</span></a>		<span class="c1"># compute and check the success fraction</span>
</span><span id="MazeDatasetConfig-479"><a href="#MazeDatasetConfig-479"><span class="linenos">479</span></a>		<span class="n">success_fraction</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">success_fraction_estimate</span><span class="p">(</span>
</span><span id="MazeDatasetConfig-480"><a href="#MazeDatasetConfig-480"><span class="linenos">480</span></a>			<span class="n">except_if_all_success_expected</span><span class="o">=</span><span class="n">except_if_all_success_expected</span><span class="p">,</span>
</span><span id="MazeDatasetConfig-481"><a href="#MazeDatasetConfig-481"><span class="linenos">481</span></a>		<span class="p">)</span>
</span><span id="MazeDatasetConfig-482"><a href="#MazeDatasetConfig-482"><span class="linenos">482</span></a>		<span class="k">if</span> <span class="n">success_fraction</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">:</span>
</span><span id="MazeDatasetConfig-483"><a href="#MazeDatasetConfig-483"><span class="linenos">483</span></a>			<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="MazeDatasetConfig-484"><a href="#MazeDatasetConfig-484"><span class="linenos">484</span></a>				<span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">success_fraction</span><span class="w"> </span><span class="si">= }</span><span class="s2"> is below the threshold of </span><span class="si">{</span><span class="n">epsilon</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="MazeDatasetConfig-485"><a href="#MazeDatasetConfig-485"><span class="linenos">485</span></a>			<span class="p">)</span>
</span><span id="MazeDatasetConfig-486"><a href="#MazeDatasetConfig-486"><span class="linenos">486</span></a>			<span class="k">raise</span> <span class="n">SuccessChanceTooSmallError</span><span class="p">(</span>
</span><span id="MazeDatasetConfig-487"><a href="#MazeDatasetConfig-487"><span class="linenos">487</span></a>				<span class="n">err_msg</span><span class="p">,</span>
</span><span id="MazeDatasetConfig-488"><a href="#MazeDatasetConfig-488"><span class="linenos">488</span></a>			<span class="p">)</span>
</span><span id="MazeDatasetConfig-489"><a href="#MazeDatasetConfig-489"><span class="linenos">489</span></a>
</span><span id="MazeDatasetConfig-490"><a href="#MazeDatasetConfig-490"><span class="linenos">490</span></a>		<span class="c1"># compute the new number of mazes</span>
</span><span id="MazeDatasetConfig-491"><a href="#MazeDatasetConfig-491"><span class="linenos">491</span></a>		<span class="n">n_mazes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_mazes</span>
</span><span id="MazeDatasetConfig-492"><a href="#MazeDatasetConfig-492"><span class="linenos">492</span></a>		<span class="n">new_n_mazes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">n_mazes</span> <span class="o">*</span> <span class="n">safety_margin</span><span class="p">)</span> <span class="o">/</span> <span class="n">success_fraction</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="MazeDatasetConfig-493"><a href="#MazeDatasetConfig-493"><span class="linenos">493</span></a>
</span><span id="MazeDatasetConfig-494"><a href="#MazeDatasetConfig-494"><span class="linenos">494</span></a>		<span class="c1"># put it in a new config and return</span>
</span><span id="MazeDatasetConfig-495"><a href="#MazeDatasetConfig-495"><span class="linenos">495</span></a>		<span class="n">cfg_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="MazeDatasetConfig-496"><a href="#MazeDatasetConfig-496"><span class="linenos">496</span></a>		<span class="n">cfg_dict</span><span class="p">[</span><span class="s2">&quot;n_mazes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_n_mazes</span>
</span><span id="MazeDatasetConfig-497"><a href="#MazeDatasetConfig-497"><span class="linenos">497</span></a>		<span class="k">return</span> <span class="n">MazeDatasetConfig</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">cfg_dict</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>config object which is passed to <code><a href="#MazeDataset.from_config">MazeDataset.from_config</a></code> to generate or load a dataset</p>

<h1 id="parameters">Parameters:</h1>

<ul>
<li><code>name : str</code>
name of the dataset -- this can be anything, but should be filesystem safe since we use it in the <code>fname</code></li>
<li><code>grid_n : int</code>
grid size of the maze (number of rows/columns)</li>
<li><code>n_mazes : int</code>
number of mazes to request. For some combinations of <code><a href="#MazeDatasetConfig.endpoint_kwargs">endpoint_kwargs</a></code> and <code><a href="#MazeDatasetConfig.maze_ctor">maze_ctor</a></code>, not all mazes might successfully generate.
see <code>EndpointKwargsType</code> for more details.</li>
<li><code>maze_ctor : Callable</code>
maze generator function. This should be a function that takes a grid size and returns a maze.
This will usually be one of the functions in <code>LatticeMazeGenerators</code>.</li>
<li><code>maze_ctor_kwargs : dict</code>
keyword arguments to pass to the maze generator function. Specific to the <code><a href="#MazeDatasetConfig.maze_ctor">maze_ctor</a></code> you are using.</li>
<li><code>endpoint_kwargs : EndpointKwargsType</code>
keyword arguments passed to <code>LatticeMaze.generate_random_path()</code>. see <code>EndpointKwargsType</code> for more info.</li>
<li><code>applied_filters : list[dict]</code>
list of filters that have been applied to the dataset. We recommend applying filters to datasets directly,
but these are stored with the config in case you want to re-generate the dataset with the same filters.</li>
</ul>
</div>


                            <div id="MazeDatasetConfig.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">MazeDatasetConfig</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">seq_len_min</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">seq_len_max</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">512</span>,</span><span class="param">	<span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="mi">42</span>,</span><span class="param">	<span class="n">applied_filters</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">,</span> <span class="s1">&#39;kwargs&#39;</span><span class="p">],</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="nb">tuple</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">grid_n</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">n_mazes</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">maze_ctor</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">function</span> <span class="n">LatticeMazeGenerators</span><span class="o">.</span><span class="n">gen_dfs</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">maze_ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">endpoint_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;allowed_start&#39;</span><span class="p">,</span> <span class="s1">&#39;allowed_end&#39;</span><span class="p">,</span> <span class="s1">&#39;deadend_start&#39;</span><span class="p">,</span> <span class="s1">&#39;deadend_end&#39;</span><span class="p">,</span> <span class="s1">&#39;endpoints_not_equal&#39;</span><span class="p">,</span> <span class="s1">&#39;except_on_no_valid_endpoint&#39;</span><span class="p">],</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">_fname_loaded</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MazeDatasetConfig.__init__"></a>
    
    

                            </div>
                            <div id="MazeDatasetConfig.config_version" class="classattr">
                                        <input id="MazeDatasetConfig.config_version-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">config_version</span><span class="annotation">: str</span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDatasetConfig.config_version-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L281-L284" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDatasetConfig.config_version"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDatasetConfig.config_version-282"><a href="#MazeDatasetConfig.config_version-282"><span class="linenos">282</span></a>	<span class="nd">@property</span>
</span><span id="MazeDatasetConfig.config_version-283"><a href="#MazeDatasetConfig.config_version-283"><span class="linenos">283</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">config_version</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="MazeDatasetConfig.config_version-284"><a href="#MazeDatasetConfig.config_version-284"><span class="linenos">284</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;return the version of the config. added in maze_dataset v1.3.0, previous versions had no dataset config&quot;&quot;&quot;</span>
</span><span id="MazeDatasetConfig.config_version-285"><a href="#MazeDatasetConfig.config_version-285"><span class="linenos">285</span></a>		<span class="k">return</span> <span class="s2">&quot;1.0&quot;</span>
</span></pre></div>


            <div class="docstring"><p>return the version of the config. added in maze_dataset v1.3.0, previous versions had no dataset config</p>
</div>


                            </div>
                            <div id="MazeDatasetConfig.versions" class="classattr">
                                        <input id="MazeDatasetConfig.versions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">versions</span><span class="annotation">: dict</span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDatasetConfig.versions-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L286-L292" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDatasetConfig.versions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDatasetConfig.versions-287"><a href="#MazeDatasetConfig.versions-287"><span class="linenos">287</span></a>	<span class="nd">@property</span>
</span><span id="MazeDatasetConfig.versions-288"><a href="#MazeDatasetConfig.versions-288"><span class="linenos">288</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">versions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="MazeDatasetConfig.versions-289"><a href="#MazeDatasetConfig.versions-289"><span class="linenos">289</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;return the versions of the config and the maze_dataset&quot;&quot;&quot;</span>
</span><span id="MazeDatasetConfig.versions-290"><a href="#MazeDatasetConfig.versions-290"><span class="linenos">290</span></a>		<span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
</span><span id="MazeDatasetConfig.versions-291"><a href="#MazeDatasetConfig.versions-291"><span class="linenos">291</span></a>			<span class="n">config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config_version</span><span class="p">,</span>
</span><span id="MazeDatasetConfig.versions-292"><a href="#MazeDatasetConfig.versions-292"><span class="linenos">292</span></a>			<span class="n">maze_dataset</span><span class="o">=</span><span class="n">importlib</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">version</span><span class="p">(</span><span class="s2">&quot;maze_dataset&quot;</span><span class="p">),</span>
</span><span id="MazeDatasetConfig.versions-293"><a href="#MazeDatasetConfig.versions-293"><span class="linenos">293</span></a>		<span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>return the versions of the config and the maze_dataset</p>
</div>


                            </div>
                            <div id="MazeDatasetConfig.serialize" class="classattr">
                                        <input id="MazeDatasetConfig.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDatasetConfig.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L294-L302" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDatasetConfig.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDatasetConfig.serialize-295"><a href="#MazeDatasetConfig.serialize-295"><span class="linenos">295</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="MazeDatasetConfig.serialize-296"><a href="#MazeDatasetConfig.serialize-296"><span class="linenos">296</span></a>		<span class="s2">&quot;serialize the MazeDatasetConfig with all fields and fname&quot;</span>
</span><span id="MazeDatasetConfig.serialize-297"><a href="#MazeDatasetConfig.serialize-297"><span class="linenos">297</span></a>		<span class="k">return</span> <span class="p">{</span>
</span><span id="MazeDatasetConfig.serialize-298"><a href="#MazeDatasetConfig.serialize-298"><span class="linenos">298</span></a>			<span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_serialize_base</span><span class="p">(</span>
</span><span id="MazeDatasetConfig.serialize-299"><a href="#MazeDatasetConfig.serialize-299"><span class="linenos">299</span></a>				<span class="n">applied_filters__skip__collect_generation_meta</span><span class="o">=</span><span class="kc">False</span>
</span><span id="MazeDatasetConfig.serialize-300"><a href="#MazeDatasetConfig.serialize-300"><span class="linenos">300</span></a>			<span class="p">),</span>
</span><span id="MazeDatasetConfig.serialize-301"><a href="#MazeDatasetConfig.serialize-301"><span class="linenos">301</span></a>			<span class="s2">&quot;fname&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_fname</span><span class="p">(),</span>
</span><span id="MazeDatasetConfig.serialize-302"><a href="#MazeDatasetConfig.serialize-302"><span class="linenos">302</span></a>			<span class="s2">&quot;versions&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">versions</span><span class="p">,</span>
</span><span id="MazeDatasetConfig.serialize-303"><a href="#MazeDatasetConfig.serialize-303"><span class="linenos">303</span></a>		<span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>serialize the MazeDatasetConfig with all fields and fname</p>
</div>


                            </div>
                            <div id="MazeDatasetConfig.summary" class="classattr">
                                        <input id="MazeDatasetConfig.summary-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">summary</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDatasetConfig.summary-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L304-L323" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDatasetConfig.summary"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDatasetConfig.summary-305"><a href="#MazeDatasetConfig.summary-305"><span class="linenos">305</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="MazeDatasetConfig.summary-306"><a href="#MazeDatasetConfig.summary-306"><span class="linenos">306</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;return a summary of the config&quot;&quot;&quot;</span>
</span><span id="MazeDatasetConfig.summary-307"><a href="#MazeDatasetConfig.summary-307"><span class="linenos">307</span></a>		<span class="c1"># do we run this to make sure it doesn&#39;t error?</span>
</span><span id="MazeDatasetConfig.summary-308"><a href="#MazeDatasetConfig.summary-308"><span class="linenos">308</span></a>		<span class="n">super_summary</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</span><span id="MazeDatasetConfig.summary-309"><a href="#MazeDatasetConfig.summary-309"><span class="linenos">309</span></a>		<span class="k">assert</span> <span class="n">super_summary</span>
</span><span id="MazeDatasetConfig.summary-310"><a href="#MazeDatasetConfig.summary-310"><span class="linenos">310</span></a>		<span class="n">self_ser</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="MazeDatasetConfig.summary-311"><a href="#MazeDatasetConfig.summary-311"><span class="linenos">311</span></a>		<span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
</span><span id="MazeDatasetConfig.summary-312"><a href="#MazeDatasetConfig.summary-312"><span class="linenos">312</span></a>			<span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="MazeDatasetConfig.summary-313"><a href="#MazeDatasetConfig.summary-313"><span class="linenos">313</span></a>			<span class="n">fname</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">to_fname</span><span class="p">(),</span>
</span><span id="MazeDatasetConfig.summary-314"><a href="#MazeDatasetConfig.summary-314"><span class="linenos">314</span></a>			<span class="n">sdc_hash</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stable_hash_cfg</span><span class="p">(),</span>
</span><span id="MazeDatasetConfig.summary-315"><a href="#MazeDatasetConfig.summary-315"><span class="linenos">315</span></a>			<span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="MazeDatasetConfig.summary-316"><a href="#MazeDatasetConfig.summary-316"><span class="linenos">316</span></a>			<span class="n">seq_len_min</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seq_len_min</span><span class="p">,</span>
</span><span id="MazeDatasetConfig.summary-317"><a href="#MazeDatasetConfig.summary-317"><span class="linenos">317</span></a>			<span class="n">seq_len_max</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seq_len_max</span><span class="p">,</span>
</span><span id="MazeDatasetConfig.summary-318"><a href="#MazeDatasetConfig.summary-318"><span class="linenos">318</span></a>			<span class="n">applied_filters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">applied_filters</span><span class="p">,</span>
</span><span id="MazeDatasetConfig.summary-319"><a href="#MazeDatasetConfig.summary-319"><span class="linenos">319</span></a>			<span class="n">grid_n</span><span class="o">=</span><span class="n">self_ser</span><span class="p">[</span><span class="s2">&quot;grid_n&quot;</span><span class="p">],</span>
</span><span id="MazeDatasetConfig.summary-320"><a href="#MazeDatasetConfig.summary-320"><span class="linenos">320</span></a>			<span class="n">n_mazes</span><span class="o">=</span><span class="n">self_ser</span><span class="p">[</span><span class="s2">&quot;n_mazes&quot;</span><span class="p">],</span>
</span><span id="MazeDatasetConfig.summary-321"><a href="#MazeDatasetConfig.summary-321"><span class="linenos">321</span></a>			<span class="n">maze_ctor_name</span><span class="o">=</span><span class="n">self_ser</span><span class="p">[</span><span class="s2">&quot;maze_ctor&quot;</span><span class="p">][</span><span class="s2">&quot;__name__&quot;</span><span class="p">],</span>
</span><span id="MazeDatasetConfig.summary-322"><a href="#MazeDatasetConfig.summary-322"><span class="linenos">322</span></a>			<span class="n">maze_ctor_kwargs</span><span class="o">=</span><span class="n">self_ser</span><span class="p">[</span><span class="s2">&quot;maze_ctor_kwargs&quot;</span><span class="p">],</span>
</span><span id="MazeDatasetConfig.summary-323"><a href="#MazeDatasetConfig.summary-323"><span class="linenos">323</span></a>			<span class="n">endpoint_kwargs</span><span class="o">=</span><span class="n">self_ser</span><span class="p">[</span><span class="s2">&quot;endpoint_kwargs&quot;</span><span class="p">],</span>
</span><span id="MazeDatasetConfig.summary-324"><a href="#MazeDatasetConfig.summary-324"><span class="linenos">324</span></a>		<span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>return a summary of the config</p>
</div>


                            </div>
                            <div id="MazeDatasetConfig.success_fraction_estimate" class="classattr">
                                        <input id="MazeDatasetConfig.success_fraction_estimate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">success_fraction_estimate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">except_if_all_success_expected</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDatasetConfig.success_fraction_estimate-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L406-L438" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDatasetConfig.success_fraction_estimate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDatasetConfig.success_fraction_estimate-407"><a href="#MazeDatasetConfig.success_fraction_estimate-407"><span class="linenos">407</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">success_fraction_estimate</span><span class="p">(</span>
</span><span id="MazeDatasetConfig.success_fraction_estimate-408"><a href="#MazeDatasetConfig.success_fraction_estimate-408"><span class="linenos">408</span></a>		<span class="bp">self</span><span class="p">,</span>
</span><span id="MazeDatasetConfig.success_fraction_estimate-409"><a href="#MazeDatasetConfig.success_fraction_estimate-409"><span class="linenos">409</span></a>		<span class="n">except_if_all_success_expected</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="MazeDatasetConfig.success_fraction_estimate-410"><a href="#MazeDatasetConfig.success_fraction_estimate-410"><span class="linenos">410</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="MazeDatasetConfig.success_fraction_estimate-411"><a href="#MazeDatasetConfig.success_fraction_estimate-411"><span class="linenos">411</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Estimate the success fraction of this config.</span>
</span><span id="MazeDatasetConfig.success_fraction_estimate-412"><a href="#MazeDatasetConfig.success_fraction_estimate-412"><span class="linenos">412</span></a>
</span><span id="MazeDatasetConfig.success_fraction_estimate-413"><a href="#MazeDatasetConfig.success_fraction_estimate-413"><span class="linenos">413</span></a><span class="sd">		only valid when the generator is a percolation generator,</span>
</span><span id="MazeDatasetConfig.success_fraction_estimate-414"><a href="#MazeDatasetConfig.success_fraction_estimate-414"><span class="linenos">414</span></a><span class="sd">		and endpoints are enforced to be dead ends</span>
</span><span id="MazeDatasetConfig.success_fraction_estimate-415"><a href="#MazeDatasetConfig.success_fraction_estimate-415"><span class="linenos">415</span></a>
</span><span id="MazeDatasetConfig.success_fraction_estimate-416"><a href="#MazeDatasetConfig.success_fraction_estimate-416"><span class="linenos">416</span></a><span class="sd">		more information on where this comes from can be found in</span>
</span><span id="MazeDatasetConfig.success_fraction_estimate-417"><a href="#MazeDatasetConfig.success_fraction_estimate-417"><span class="linenos">417</span></a><span class="sd">		- `cfg_success_predict_fn()` from `maze_dataset.dataset.success_predict_math`</span>
</span><span id="MazeDatasetConfig.success_fraction_estimate-418"><a href="#MazeDatasetConfig.success_fraction_estimate-418"><span class="linenos">418</span></a><span class="sd">		- `estimate_dataset_fractions.ipynb`</span>
</span><span id="MazeDatasetConfig.success_fraction_estimate-419"><a href="#MazeDatasetConfig.success_fraction_estimate-419"><span class="linenos">419</span></a><span class="sd">		- `maze_dataset.benchmarks.sweep_fit`</span>
</span><span id="MazeDatasetConfig.success_fraction_estimate-420"><a href="#MazeDatasetConfig.success_fraction_estimate-420"><span class="linenos">420</span></a>
</span><span id="MazeDatasetConfig.success_fraction_estimate-421"><a href="#MazeDatasetConfig.success_fraction_estimate-421"><span class="linenos">421</span></a><span class="sd">		# Parameters:</span>
</span><span id="MazeDatasetConfig.success_fraction_estimate-422"><a href="#MazeDatasetConfig.success_fraction_estimate-422"><span class="linenos">422</span></a><span class="sd">		- `except_if_all_success_expected : bool`</span>
</span><span id="MazeDatasetConfig.success_fraction_estimate-423"><a href="#MazeDatasetConfig.success_fraction_estimate-423"><span class="linenos">423</span></a><span class="sd">			if `True`, don&#39;t raise an error if the success fraction is below the threshold.</span>
</span><span id="MazeDatasetConfig.success_fraction_estimate-424"><a href="#MazeDatasetConfig.success_fraction_estimate-424"><span class="linenos">424</span></a><span class="sd">			will always return `1.0` if the config is not expected to fail</span>
</span><span id="MazeDatasetConfig.success_fraction_estimate-425"><a href="#MazeDatasetConfig.success_fraction_estimate-425"><span class="linenos">425</span></a>
</span><span id="MazeDatasetConfig.success_fraction_estimate-426"><a href="#MazeDatasetConfig.success_fraction_estimate-426"><span class="linenos">426</span></a><span class="sd">		# Returns:</span>
</span><span id="MazeDatasetConfig.success_fraction_estimate-427"><a href="#MazeDatasetConfig.success_fraction_estimate-427"><span class="linenos">427</span></a><span class="sd">		- `float`</span>
</span><span id="MazeDatasetConfig.success_fraction_estimate-428"><a href="#MazeDatasetConfig.success_fraction_estimate-428"><span class="linenos">428</span></a><span class="sd">			estimated success fraction</span>
</span><span id="MazeDatasetConfig.success_fraction_estimate-429"><a href="#MazeDatasetConfig.success_fraction_estimate-429"><span class="linenos">429</span></a>
</span><span id="MazeDatasetConfig.success_fraction_estimate-430"><a href="#MazeDatasetConfig.success_fraction_estimate-430"><span class="linenos">430</span></a><span class="sd">		# Raises:</span>
</span><span id="MazeDatasetConfig.success_fraction_estimate-431"><a href="#MazeDatasetConfig.success_fraction_estimate-431"><span class="linenos">431</span></a><span class="sd">		- `NoPercolationInConfigError` : if the config is not expected to fail, and `except_if_all_success_expected` is `False`</span>
</span><span id="MazeDatasetConfig.success_fraction_estimate-432"><a href="#MazeDatasetConfig.success_fraction_estimate-432"><span class="linenos">432</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="MazeDatasetConfig.success_fraction_estimate-433"><a href="#MazeDatasetConfig.success_fraction_estimate-433"><span class="linenos">433</span></a>		<span class="k">try</span><span class="p">:</span>
</span><span id="MazeDatasetConfig.success_fraction_estimate-434"><a href="#MazeDatasetConfig.success_fraction_estimate-434"><span class="linenos">434</span></a>			<span class="k">return</span> <span class="n">cfg_success_predict_fn</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="MazeDatasetConfig.success_fraction_estimate-435"><a href="#MazeDatasetConfig.success_fraction_estimate-435"><span class="linenos">435</span></a>
</span><span id="MazeDatasetConfig.success_fraction_estimate-436"><a href="#MazeDatasetConfig.success_fraction_estimate-436"><span class="linenos">436</span></a>		<span class="k">except</span> <span class="n">NoPercolationInConfigError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="MazeDatasetConfig.success_fraction_estimate-437"><a href="#MazeDatasetConfig.success_fraction_estimate-437"><span class="linenos">437</span></a>			<span class="k">if</span> <span class="n">except_if_all_success_expected</span><span class="p">:</span>
</span><span id="MazeDatasetConfig.success_fraction_estimate-438"><a href="#MazeDatasetConfig.success_fraction_estimate-438"><span class="linenos">438</span></a>				<span class="k">raise</span> <span class="n">e</span>  <span class="c1"># noqa: TRY201</span>
</span><span id="MazeDatasetConfig.success_fraction_estimate-439"><a href="#MazeDatasetConfig.success_fraction_estimate-439"><span class="linenos">439</span></a>			<span class="k">return</span> <span class="mf">1.0</span>
</span></pre></div>


            <div class="docstring"><p>Estimate the success fraction of this config.</p>

<p>only valid when the generator is a percolation generator,
and endpoints are enforced to be dead ends</p>

<p>more information on where this comes from can be found in</p>

<ul>
<li><code>cfg_success_predict_fn()</code> from <code><a href="dataset/success_predict_math.html">maze_dataset.dataset.success_predict_math</a></code></li>
<li><code>estimate_dataset_fractions.ipynb</code></li>
<li><code>maze_dataset.benchmarks.sweep_fit</code></li>
</ul>

<h1 id="parameters">Parameters:</h1>

<ul>
<li><code>except_if_all_success_expected : bool</code>
if <code>True</code>, don't raise an error if the success fraction is below the threshold.
will always return <code>1.0</code> if the config is not expected to fail</li>
</ul>

<h1 id="returns">Returns:</h1>

<ul>
<li><code>float</code>
estimated success fraction</li>
</ul>

<h1 id="raises">Raises:</h1>

<ul>
<li><code>NoPercolationInConfigError</code> : if the config is not expected to fail, and <code>except_if_all_success_expected</code> is <code>False</code></li>
</ul>
</div>


                            </div>
                            <div id="MazeDatasetConfig.success_fraction_compensate" class="classattr">
                                        <input id="MazeDatasetConfig.success_fraction_compensate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">success_fraction_compensate</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">safety_margin</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.2</span>,</span><span class="param">	<span class="n">except_if_all_success_expected</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">epsilon</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span></span><span class="return-annotation">) -> <span class="n"><a href="#MazeDatasetConfig">MazeDatasetConfig</a></span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDatasetConfig.success_fraction_compensate-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L440-L496" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDatasetConfig.success_fraction_compensate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDatasetConfig.success_fraction_compensate-441"><a href="#MazeDatasetConfig.success_fraction_compensate-441"><span class="linenos">441</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">success_fraction_compensate</span><span class="p">(</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-442"><a href="#MazeDatasetConfig.success_fraction_compensate-442"><span class="linenos">442</span></a>		<span class="bp">self</span><span class="p">,</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-443"><a href="#MazeDatasetConfig.success_fraction_compensate-443"><span class="linenos">443</span></a>		<span class="n">safety_margin</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.2</span><span class="p">,</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-444"><a href="#MazeDatasetConfig.success_fraction_compensate-444"><span class="linenos">444</span></a>		<span class="n">except_if_all_success_expected</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-445"><a href="#MazeDatasetConfig.success_fraction_compensate-445"><span class="linenos">445</span></a>		<span class="n">epsilon</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-2</span><span class="p">,</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-446"><a href="#MazeDatasetConfig.success_fraction_compensate-446"><span class="linenos">446</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MazeDatasetConfig&quot;</span><span class="p">:</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-447"><a href="#MazeDatasetConfig.success_fraction_compensate-447"><span class="linenos">447</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;return a new `MazeDatasetConfig` like this one with `n_mazes` adjusted to compensate for the success fraction</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-448"><a href="#MazeDatasetConfig.success_fraction_compensate-448"><span class="linenos">448</span></a>
</span><span id="MazeDatasetConfig.success_fraction_compensate-449"><a href="#MazeDatasetConfig.success_fraction_compensate-449"><span class="linenos">449</span></a><span class="sd">		calls `MazeDatasetConfig.success_fraction_estimate()` to get the success fraction, and then</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-450"><a href="#MazeDatasetConfig.success_fraction_compensate-450"><span class="linenos">450</span></a><span class="sd">		computes the new number of mazes as `n_mazes = n_mazes * safety_margin / success_fraction + 1`</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-451"><a href="#MazeDatasetConfig.success_fraction_compensate-451"><span class="linenos">451</span></a>
</span><span id="MazeDatasetConfig.success_fraction_compensate-452"><a href="#MazeDatasetConfig.success_fraction_compensate-452"><span class="linenos">452</span></a><span class="sd">		more information on where this comes from can be found in</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-453"><a href="#MazeDatasetConfig.success_fraction_compensate-453"><span class="linenos">453</span></a><span class="sd">		- `cfg_success_predict_fn()` from `maze_dataset.dataset.success_predict_math`</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-454"><a href="#MazeDatasetConfig.success_fraction_compensate-454"><span class="linenos">454</span></a><span class="sd">		- `estimate_dataset_fractions.ipynb`</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-455"><a href="#MazeDatasetConfig.success_fraction_compensate-455"><span class="linenos">455</span></a><span class="sd">		- `maze_dataset.benchmarks.sweep_fit`</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-456"><a href="#MazeDatasetConfig.success_fraction_compensate-456"><span class="linenos">456</span></a>
</span><span id="MazeDatasetConfig.success_fraction_compensate-457"><a href="#MazeDatasetConfig.success_fraction_compensate-457"><span class="linenos">457</span></a><span class="sd">		# Parameters:</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-458"><a href="#MazeDatasetConfig.success_fraction_compensate-458"><span class="linenos">458</span></a><span class="sd">		- `safety_margin : float`</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-459"><a href="#MazeDatasetConfig.success_fraction_compensate-459"><span class="linenos">459</span></a><span class="sd">			safety margin to apply to the success fraction estimate</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-460"><a href="#MazeDatasetConfig.success_fraction_compensate-460"><span class="linenos">460</span></a><span class="sd">			(defaults to `1.2`, or 20% more mazes than estimated)</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-461"><a href="#MazeDatasetConfig.success_fraction_compensate-461"><span class="linenos">461</span></a><span class="sd">		- `except_if_all_success_expected : bool`</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-462"><a href="#MazeDatasetConfig.success_fraction_compensate-462"><span class="linenos">462</span></a><span class="sd">			if `True`, don&#39;t raise an error if the success fraction is below the threshold.</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-463"><a href="#MazeDatasetConfig.success_fraction_compensate-463"><span class="linenos">463</span></a><span class="sd">			this is passed to `MazeDatasetConfig.success_fraction_estimate`.</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-464"><a href="#MazeDatasetConfig.success_fraction_compensate-464"><span class="linenos">464</span></a><span class="sd">			if your config isn&#39;t expected to fail, passing this might mean you generate more mazes than needed</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-465"><a href="#MazeDatasetConfig.success_fraction_compensate-465"><span class="linenos">465</span></a><span class="sd">			since `safety_margin` is still applied.</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-466"><a href="#MazeDatasetConfig.success_fraction_compensate-466"><span class="linenos">466</span></a><span class="sd">			(defaults to `False`)</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-467"><a href="#MazeDatasetConfig.success_fraction_compensate-467"><span class="linenos">467</span></a><span class="sd">		- `epsilon : float`</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-468"><a href="#MazeDatasetConfig.success_fraction_compensate-468"><span class="linenos">468</span></a><span class="sd">			raise `SuccessChanceTooSmallError` if the success fraction is below this threshold</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-469"><a href="#MazeDatasetConfig.success_fraction_compensate-469"><span class="linenos">469</span></a><span class="sd">			(defaults to `1e-2`)</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-470"><a href="#MazeDatasetConfig.success_fraction_compensate-470"><span class="linenos">470</span></a>
</span><span id="MazeDatasetConfig.success_fraction_compensate-471"><a href="#MazeDatasetConfig.success_fraction_compensate-471"><span class="linenos">471</span></a><span class="sd">		# Returns:</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-472"><a href="#MazeDatasetConfig.success_fraction_compensate-472"><span class="linenos">472</span></a><span class="sd">		- `MazeDatasetConfig`</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-473"><a href="#MazeDatasetConfig.success_fraction_compensate-473"><span class="linenos">473</span></a><span class="sd">			new config with adjusted `n_mazes`</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-474"><a href="#MazeDatasetConfig.success_fraction_compensate-474"><span class="linenos">474</span></a>
</span><span id="MazeDatasetConfig.success_fraction_compensate-475"><a href="#MazeDatasetConfig.success_fraction_compensate-475"><span class="linenos">475</span></a><span class="sd">		# Raises:</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-476"><a href="#MazeDatasetConfig.success_fraction_compensate-476"><span class="linenos">476</span></a><span class="sd">		- `SuccessChanceTooSmallError` : if the computed success fraction is below `epsilon`</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-477"><a href="#MazeDatasetConfig.success_fraction_compensate-477"><span class="linenos">477</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-478"><a href="#MazeDatasetConfig.success_fraction_compensate-478"><span class="linenos">478</span></a>		<span class="c1"># compute and check the success fraction</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-479"><a href="#MazeDatasetConfig.success_fraction_compensate-479"><span class="linenos">479</span></a>		<span class="n">success_fraction</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">success_fraction_estimate</span><span class="p">(</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-480"><a href="#MazeDatasetConfig.success_fraction_compensate-480"><span class="linenos">480</span></a>			<span class="n">except_if_all_success_expected</span><span class="o">=</span><span class="n">except_if_all_success_expected</span><span class="p">,</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-481"><a href="#MazeDatasetConfig.success_fraction_compensate-481"><span class="linenos">481</span></a>		<span class="p">)</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-482"><a href="#MazeDatasetConfig.success_fraction_compensate-482"><span class="linenos">482</span></a>		<span class="k">if</span> <span class="n">success_fraction</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">:</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-483"><a href="#MazeDatasetConfig.success_fraction_compensate-483"><span class="linenos">483</span></a>			<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-484"><a href="#MazeDatasetConfig.success_fraction_compensate-484"><span class="linenos">484</span></a>				<span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">success_fraction</span><span class="w"> </span><span class="si">= }</span><span class="s2"> is below the threshold of </span><span class="si">{</span><span class="n">epsilon</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-485"><a href="#MazeDatasetConfig.success_fraction_compensate-485"><span class="linenos">485</span></a>			<span class="p">)</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-486"><a href="#MazeDatasetConfig.success_fraction_compensate-486"><span class="linenos">486</span></a>			<span class="k">raise</span> <span class="n">SuccessChanceTooSmallError</span><span class="p">(</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-487"><a href="#MazeDatasetConfig.success_fraction_compensate-487"><span class="linenos">487</span></a>				<span class="n">err_msg</span><span class="p">,</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-488"><a href="#MazeDatasetConfig.success_fraction_compensate-488"><span class="linenos">488</span></a>			<span class="p">)</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-489"><a href="#MazeDatasetConfig.success_fraction_compensate-489"><span class="linenos">489</span></a>
</span><span id="MazeDatasetConfig.success_fraction_compensate-490"><a href="#MazeDatasetConfig.success_fraction_compensate-490"><span class="linenos">490</span></a>		<span class="c1"># compute the new number of mazes</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-491"><a href="#MazeDatasetConfig.success_fraction_compensate-491"><span class="linenos">491</span></a>		<span class="n">n_mazes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_mazes</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-492"><a href="#MazeDatasetConfig.success_fraction_compensate-492"><span class="linenos">492</span></a>		<span class="n">new_n_mazes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">n_mazes</span> <span class="o">*</span> <span class="n">safety_margin</span><span class="p">)</span> <span class="o">/</span> <span class="n">success_fraction</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-493"><a href="#MazeDatasetConfig.success_fraction_compensate-493"><span class="linenos">493</span></a>
</span><span id="MazeDatasetConfig.success_fraction_compensate-494"><a href="#MazeDatasetConfig.success_fraction_compensate-494"><span class="linenos">494</span></a>		<span class="c1"># put it in a new config and return</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-495"><a href="#MazeDatasetConfig.success_fraction_compensate-495"><span class="linenos">495</span></a>		<span class="n">cfg_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-496"><a href="#MazeDatasetConfig.success_fraction_compensate-496"><span class="linenos">496</span></a>		<span class="n">cfg_dict</span><span class="p">[</span><span class="s2">&quot;n_mazes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_n_mazes</span>
</span><span id="MazeDatasetConfig.success_fraction_compensate-497"><a href="#MazeDatasetConfig.success_fraction_compensate-497"><span class="linenos">497</span></a>		<span class="k">return</span> <span class="n">MazeDatasetConfig</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">cfg_dict</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>return a new <code><a href="#MazeDatasetConfig">MazeDatasetConfig</a></code> like this one with <code><a href="#MazeDatasetConfig.n_mazes">n_mazes</a></code> adjusted to compensate for the success fraction</p>

<p>calls <code><a href="#MazeDatasetConfig.success_fraction_estimate">MazeDatasetConfig.success_fraction_estimate()</a></code> to get the success fraction, and then
computes the new number of mazes as <code>n_mazes = n_mazes * safety_margin / success_fraction + 1</code></p>

<p>more information on where this comes from can be found in</p>

<ul>
<li><code>cfg_success_predict_fn()</code> from <code><a href="dataset/success_predict_math.html">maze_dataset.dataset.success_predict_math</a></code></li>
<li><code>estimate_dataset_fractions.ipynb</code></li>
<li><code>maze_dataset.benchmarks.sweep_fit</code></li>
</ul>

<h1 id="parameters">Parameters:</h1>

<ul>
<li><code>safety_margin : float</code>
safety margin to apply to the success fraction estimate
(defaults to <code>1.2</code>, or 20% more mazes than estimated)</li>
<li><code>except_if_all_success_expected : bool</code>
if <code>True</code>, don't raise an error if the success fraction is below the threshold.
this is passed to <code><a href="#MazeDatasetConfig.success_fraction_estimate">MazeDatasetConfig.success_fraction_estimate</a></code>.
if your config isn't expected to fail, passing this might mean you generate more mazes than needed
since <code>safety_margin</code> is still applied.
(defaults to <code>False</code>)</li>
<li><code>epsilon : float</code>
raise <code>SuccessChanceTooSmallError</code> if the success fraction is below this threshold
(defaults to <code>1e-2</code>)</li>
</ul>

<h1 id="returns">Returns:</h1>

<ul>
<li><code><a href="#MazeDatasetConfig">MazeDatasetConfig</a></code>
new config with adjusted <code><a href="#MazeDatasetConfig.n_mazes">n_mazes</a></code></li>
</ul>

<h1 id="raises">Raises:</h1>

<ul>
<li><code>SuccessChanceTooSmallError</code> : if the computed success fraction is below <code>epsilon</code></li>
</ul>
</div>


                            </div>
                            <div id="MazeDatasetConfig.load" class="classattr">
                                        <input id="MazeDatasetConfig.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDatasetConfig.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L776-L862" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDatasetConfig.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDatasetConfig.load-777"><a href="#MazeDatasetConfig.load-777"><span class="linenos">777</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="MazeDatasetConfig.load-778"><a href="#MazeDatasetConfig.load-778"><span class="linenos">778</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="MazeDatasetConfig.load-779"><a href="#MazeDatasetConfig.load-779"><span class="linenos">779</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="MazeDatasetConfig.load-780"><a href="#MazeDatasetConfig.load-780"><span class="linenos">780</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="MazeDatasetConfig.load-781"><a href="#MazeDatasetConfig.load-781"><span class="linenos">781</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="MazeDatasetConfig.load-782"><a href="#MazeDatasetConfig.load-782"><span class="linenos">782</span></a>
</span><span id="MazeDatasetConfig.load-783"><a href="#MazeDatasetConfig.load-783"><span class="linenos">783</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="MazeDatasetConfig.load-784"><a href="#MazeDatasetConfig.load-784"><span class="linenos">784</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="MazeDatasetConfig.load-785"><a href="#MazeDatasetConfig.load-785"><span class="linenos">785</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="MazeDatasetConfig.load-786"><a href="#MazeDatasetConfig.load-786"><span class="linenos">786</span></a>
</span><span id="MazeDatasetConfig.load-787"><a href="#MazeDatasetConfig.load-787"><span class="linenos">787</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="MazeDatasetConfig.load-788"><a href="#MazeDatasetConfig.load-788"><span class="linenos">788</span></a>
</span><span id="MazeDatasetConfig.load-789"><a href="#MazeDatasetConfig.load-789"><span class="linenos">789</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="MazeDatasetConfig.load-790"><a href="#MazeDatasetConfig.load-790"><span class="linenos">790</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="MazeDatasetConfig.load-791"><a href="#MazeDatasetConfig.load-791"><span class="linenos">791</span></a>
</span><span id="MazeDatasetConfig.load-792"><a href="#MazeDatasetConfig.load-792"><span class="linenos">792</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="MazeDatasetConfig.load-793"><a href="#MazeDatasetConfig.load-793"><span class="linenos">793</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="MazeDatasetConfig.load-794"><a href="#MazeDatasetConfig.load-794"><span class="linenos">794</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="MazeDatasetConfig.load-795"><a href="#MazeDatasetConfig.load-795"><span class="linenos">795</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="MazeDatasetConfig.load-796"><a href="#MazeDatasetConfig.load-796"><span class="linenos">796</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="MazeDatasetConfig.load-797"><a href="#MazeDatasetConfig.load-797"><span class="linenos">797</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="MazeDatasetConfig.load-798"><a href="#MazeDatasetConfig.load-798"><span class="linenos">798</span></a>
</span><span id="MazeDatasetConfig.load-799"><a href="#MazeDatasetConfig.load-799"><span class="linenos">799</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="MazeDatasetConfig.load-800"><a href="#MazeDatasetConfig.load-800"><span class="linenos">800</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="MazeDatasetConfig.load-801"><a href="#MazeDatasetConfig.load-801"><span class="linenos">801</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="MazeDatasetConfig.load-802"><a href="#MazeDatasetConfig.load-802"><span class="linenos">802</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="MazeDatasetConfig.load-803"><a href="#MazeDatasetConfig.load-803"><span class="linenos">803</span></a>
</span><span id="MazeDatasetConfig.load-804"><a href="#MazeDatasetConfig.load-804"><span class="linenos">804</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="MazeDatasetConfig.load-805"><a href="#MazeDatasetConfig.load-805"><span class="linenos">805</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="MazeDatasetConfig.load-806"><a href="#MazeDatasetConfig.load-806"><span class="linenos">806</span></a>
</span><span id="MazeDatasetConfig.load-807"><a href="#MazeDatasetConfig.load-807"><span class="linenos">807</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="MazeDatasetConfig.load-808"><a href="#MazeDatasetConfig.load-808"><span class="linenos">808</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="MazeDatasetConfig.load-809"><a href="#MazeDatasetConfig.load-809"><span class="linenos">809</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="MazeDatasetConfig.load-810"><a href="#MazeDatasetConfig.load-810"><span class="linenos">810</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="MazeDatasetConfig.load-811"><a href="#MazeDatasetConfig.load-811"><span class="linenos">811</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="MazeDatasetConfig.load-812"><a href="#MazeDatasetConfig.load-812"><span class="linenos">812</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="MazeDatasetConfig.load-813"><a href="#MazeDatasetConfig.load-813"><span class="linenos">813</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="MazeDatasetConfig.load-814"><a href="#MazeDatasetConfig.load-814"><span class="linenos">814</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="MazeDatasetConfig.load-815"><a href="#MazeDatasetConfig.load-815"><span class="linenos">815</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="MazeDatasetConfig.load-816"><a href="#MazeDatasetConfig.load-816"><span class="linenos">816</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="MazeDatasetConfig.load-817"><a href="#MazeDatasetConfig.load-817"><span class="linenos">817</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="MazeDatasetConfig.load-818"><a href="#MazeDatasetConfig.load-818"><span class="linenos">818</span></a>                    <span class="p">):</span>
</span><span id="MazeDatasetConfig.load-819"><a href="#MazeDatasetConfig.load-819"><span class="linenos">819</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="MazeDatasetConfig.load-820"><a href="#MazeDatasetConfig.load-820"><span class="linenos">820</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="MazeDatasetConfig.load-821"><a href="#MazeDatasetConfig.load-821"><span class="linenos">821</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="MazeDatasetConfig.load-822"><a href="#MazeDatasetConfig.load-822"><span class="linenos">822</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="MazeDatasetConfig.load-823"><a href="#MazeDatasetConfig.load-823"><span class="linenos">823</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="MazeDatasetConfig.load-824"><a href="#MazeDatasetConfig.load-824"><span class="linenos">824</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="MazeDatasetConfig.load-825"><a href="#MazeDatasetConfig.load-825"><span class="linenos">825</span></a>                            <span class="p">)</span>
</span><span id="MazeDatasetConfig.load-826"><a href="#MazeDatasetConfig.load-826"><span class="linenos">826</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="MazeDatasetConfig.load-827"><a href="#MazeDatasetConfig.load-827"><span class="linenos">827</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="MazeDatasetConfig.load-828"><a href="#MazeDatasetConfig.load-828"><span class="linenos">828</span></a>                        <span class="k">pass</span>
</span><span id="MazeDatasetConfig.load-829"><a href="#MazeDatasetConfig.load-829"><span class="linenos">829</span></a>
</span><span id="MazeDatasetConfig.load-830"><a href="#MazeDatasetConfig.load-830"><span class="linenos">830</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="MazeDatasetConfig.load-831"><a href="#MazeDatasetConfig.load-831"><span class="linenos">831</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="MazeDatasetConfig.load-832"><a href="#MazeDatasetConfig.load-832"><span class="linenos">832</span></a>
</span><span id="MazeDatasetConfig.load-833"><a href="#MazeDatasetConfig.load-833"><span class="linenos">833</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="MazeDatasetConfig.load-834"><a href="#MazeDatasetConfig.load-834"><span class="linenos">834</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="MazeDatasetConfig.load-835"><a href="#MazeDatasetConfig.load-835"><span class="linenos">835</span></a>
</span><span id="MazeDatasetConfig.load-836"><a href="#MazeDatasetConfig.load-836"><span class="linenos">836</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="MazeDatasetConfig.load-837"><a href="#MazeDatasetConfig.load-837"><span class="linenos">837</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="MazeDatasetConfig.load-838"><a href="#MazeDatasetConfig.load-838"><span class="linenos">838</span></a>                <span class="n">fields_valid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="MazeDatasetConfig.load-839"><a href="#MazeDatasetConfig.load-839"><span class="linenos">839</span></a>                    <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="MazeDatasetConfig.load-840"><a href="#MazeDatasetConfig.load-840"><span class="linenos">840</span></a>                        <span class="n">output</span><span class="p">,</span>
</span><span id="MazeDatasetConfig.load-841"><a href="#MazeDatasetConfig.load-841"><span class="linenos">841</span></a>                        <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">,</span>
</span><span id="MazeDatasetConfig.load-842"><a href="#MazeDatasetConfig.load-842"><span class="linenos">842</span></a>                    <span class="p">)</span>
</span><span id="MazeDatasetConfig.load-843"><a href="#MazeDatasetConfig.load-843"><span class="linenos">843</span></a>                <span class="p">)</span>
</span><span id="MazeDatasetConfig.load-844"><a href="#MazeDatasetConfig.load-844"><span class="linenos">844</span></a>
</span><span id="MazeDatasetConfig.load-845"><a href="#MazeDatasetConfig.load-845"><span class="linenos">845</span></a>                <span class="c1"># if there are any fields that are not valid, raise an error</span>
</span><span id="MazeDatasetConfig.load-846"><a href="#MazeDatasetConfig.load-846"><span class="linenos">846</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">fields_valid</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="MazeDatasetConfig.load-847"><a href="#MazeDatasetConfig.load-847"><span class="linenos">847</span></a>                    <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="MazeDatasetConfig.load-848"><a href="#MazeDatasetConfig.load-848"><span class="linenos">848</span></a>                        <span class="sa">f</span><span class="s2">&quot;Type mismatch in fields of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="MazeDatasetConfig.load-849"><a href="#MazeDatasetConfig.load-849"><span class="linenos">849</span></a>                        <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="MazeDatasetConfig.load-850"><a href="#MazeDatasetConfig.load-850"><span class="linenos">850</span></a>                            <span class="p">[</span>
</span><span id="MazeDatasetConfig.load-851"><a href="#MazeDatasetConfig.load-851"><span class="linenos">851</span></a>                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">:</span><span class="se">\t</span><span class="s2">expected </span><span class="si">{</span><span class="n">cls_type_hints</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="si">= }</span><span class="s2">, but got value </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="MazeDatasetConfig.load-852"><a href="#MazeDatasetConfig.load-852"><span class="linenos">852</span></a>                                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">fields_valid</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="MazeDatasetConfig.load-853"><a href="#MazeDatasetConfig.load-853"><span class="linenos">853</span></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span>
</span><span id="MazeDatasetConfig.load-854"><a href="#MazeDatasetConfig.load-854"><span class="linenos">854</span></a>                            <span class="p">]</span>
</span><span id="MazeDatasetConfig.load-855"><a href="#MazeDatasetConfig.load-855"><span class="linenos">855</span></a>                        <span class="p">)</span>
</span><span id="MazeDatasetConfig.load-856"><a href="#MazeDatasetConfig.load-856"><span class="linenos">856</span></a>                    <span class="p">)</span>
</span><span id="MazeDatasetConfig.load-857"><a href="#MazeDatasetConfig.load-857"><span class="linenos">857</span></a>
</span><span id="MazeDatasetConfig.load-858"><a href="#MazeDatasetConfig.load-858"><span class="linenos">858</span></a>                    <span class="n">on_typecheck_mismatch</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
</span><span id="MazeDatasetConfig.load-859"><a href="#MazeDatasetConfig.load-859"><span class="linenos">859</span></a>                        <span class="n">msg</span><span class="p">,</span> <span class="n">except_cls</span><span class="o">=</span><span class="n">FieldTypeMismatchError</span>
</span><span id="MazeDatasetConfig.load-860"><a href="#MazeDatasetConfig.load-860"><span class="linenos">860</span></a>                    <span class="p">)</span>
</span><span id="MazeDatasetConfig.load-861"><a href="#MazeDatasetConfig.load-861"><span class="linenos">861</span></a>
</span><span id="MazeDatasetConfig.load-862"><a href="#MazeDatasetConfig.load-862"><span class="linenos">862</span></a>            <span class="c1"># return the new instance</span>
</span><span id="MazeDatasetConfig.load-863"><a href="#MazeDatasetConfig.load-863"><span class="linenos">863</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="MazeDatasetConfig.validate_fields_types" class="classattr">
                                        <input id="MazeDatasetConfig.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDatasetConfig.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L282-L291" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDatasetConfig.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDatasetConfig.validate_fields_types-283"><a href="#MazeDatasetConfig.validate_fields_types-283"><span class="linenos">283</span></a><span class="k">def</span><span class="w"> </span><span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="MazeDatasetConfig.validate_fields_types-284"><a href="#MazeDatasetConfig.validate_fields_types-284"><span class="linenos">284</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="MazeDatasetConfig.validate_fields_types-285"><a href="#MazeDatasetConfig.validate_fields_types-285"><span class="linenos">285</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="MazeDatasetConfig.validate_fields_types-286"><a href="#MazeDatasetConfig.validate_fields_types-286"><span class="linenos">286</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="MazeDatasetConfig.validate_fields_types-287"><a href="#MazeDatasetConfig.validate_fields_types-287"><span class="linenos">287</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="MazeDatasetConfig.validate_fields_types-288"><a href="#MazeDatasetConfig.validate_fields_types-288"><span class="linenos">288</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="MazeDatasetConfig.validate_fields_types-289"><a href="#MazeDatasetConfig.validate_fields_types-289"><span class="linenos">289</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="MazeDatasetConfig.validate_fields_types-290"><a href="#MazeDatasetConfig.validate_fields_types-290"><span class="linenos">290</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="MazeDatasetConfig.validate_fields_types-291"><a href="#MazeDatasetConfig.validate_fields_types-291"><span class="linenos">291</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="MazeDatasetConfig.validate_fields_types-292"><a href="#MazeDatasetConfig.validate_fields_types-292"><span class="linenos">292</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="dataset/maze_dataset_config.html#MazeDatasetConfig_base">maze_dataset.dataset.maze_dataset_config.MazeDatasetConfig_base</a></dt>
                                <dd id="MazeDatasetConfig.grid_n" class="variable"><a href="dataset/maze_dataset_config.html#MazeDatasetConfig_base.grid_n">grid_n</a></dd>
                <dd id="MazeDatasetConfig.n_mazes" class="variable"><a href="dataset/maze_dataset_config.html#MazeDatasetConfig_base.n_mazes">n_mazes</a></dd>
                <dd id="MazeDatasetConfig.maze_ctor" class="function"><a href="dataset/maze_dataset_config.html#MazeDatasetConfig_base.maze_ctor">maze_ctor</a></dd>
                <dd id="MazeDatasetConfig.maze_ctor_kwargs" class="variable"><a href="dataset/maze_dataset_config.html#MazeDatasetConfig_base.maze_ctor_kwargs">maze_ctor_kwargs</a></dd>
                <dd id="MazeDatasetConfig.endpoint_kwargs" class="variable"><a href="dataset/maze_dataset_config.html#MazeDatasetConfig_base.endpoint_kwargs">endpoint_kwargs</a></dd>
                <dd id="MazeDatasetConfig.grid_shape" class="variable"><a href="dataset/maze_dataset_config.html#MazeDatasetConfig_base.grid_shape">grid_shape</a></dd>
                <dd id="MazeDatasetConfig.grid_shape_np" class="variable"><a href="dataset/maze_dataset_config.html#MazeDatasetConfig_base.grid_shape_np">grid_shape_np</a></dd>
                <dd id="MazeDatasetConfig.max_grid_n" class="variable"><a href="dataset/maze_dataset_config.html#MazeDatasetConfig_base.max_grid_n">max_grid_n</a></dd>
                <dd id="MazeDatasetConfig.stable_hash_cfg" class="function"><a href="dataset/maze_dataset_config.html#MazeDatasetConfig_base.stable_hash_cfg">stable_hash_cfg</a></dd>
                <dd id="MazeDatasetConfig.to_fname" class="function"><a href="dataset/maze_dataset_config.html#MazeDatasetConfig_base.to_fname">to_fname</a></dd>

            </div>
            <div><dt><a href="dataset/dataset.html#GPTDatasetConfig">maze_dataset.dataset.dataset.GPTDatasetConfig</a></dt>
                                <dd id="MazeDatasetConfig.name" class="variable"><a href="dataset/dataset.html#GPTDatasetConfig.name">name</a></dd>
                <dd id="MazeDatasetConfig.seq_len_min" class="variable"><a href="dataset/dataset.html#GPTDatasetConfig.seq_len_min">seq_len_min</a></dd>
                <dd id="MazeDatasetConfig.seq_len_max" class="variable"><a href="dataset/dataset.html#GPTDatasetConfig.seq_len_max">seq_len_max</a></dd>
                <dd id="MazeDatasetConfig.seed" class="variable"><a href="dataset/dataset.html#GPTDatasetConfig.seed">seed</a></dd>
                <dd id="MazeDatasetConfig.applied_filters" class="variable"><a href="dataset/dataset.html#GPTDatasetConfig.applied_filters">applied_filters</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="MazeDatasetConfig.validate_field_type" class="function">validate_field_type</dd>
                <dd id="MazeDatasetConfig.diff" class="function">diff</dd>
                <dd id="MazeDatasetConfig.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="MazeDatasetCollection">
                            <input id="MazeDatasetCollection-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">MazeDatasetCollection</span><wbr>(<span class="base">typing.Generic[~T_DatasetConfig]</span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDatasetCollection-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L83-L224" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDatasetCollection"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDatasetCollection-84"><a href="#MazeDatasetCollection-84"><span class="linenos"> 84</span></a><span class="k">class</span><span class="w"> </span><span class="nc">MazeDatasetCollection</span><span class="p">(</span><span class="n">GPTDataset</span><span class="p">):</span>
</span><span id="MazeDatasetCollection-85"><a href="#MazeDatasetCollection-85"><span class="linenos"> 85</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;a collection of maze datasets&quot;&quot;&quot;</span>
</span><span id="MazeDatasetCollection-86"><a href="#MazeDatasetCollection-86"><span class="linenos"> 86</span></a>
</span><span id="MazeDatasetCollection-87"><a href="#MazeDatasetCollection-87"><span class="linenos"> 87</span></a>	<span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="MazeDatasetCollection-88"><a href="#MazeDatasetCollection-88"><span class="linenos"> 88</span></a>		<span class="bp">self</span><span class="p">,</span>
</span><span id="MazeDatasetCollection-89"><a href="#MazeDatasetCollection-89"><span class="linenos"> 89</span></a>		<span class="n">cfg</span><span class="p">:</span> <span class="n">MazeDatasetCollectionConfig</span><span class="p">,</span>
</span><span id="MazeDatasetCollection-90"><a href="#MazeDatasetCollection-90"><span class="linenos"> 90</span></a>		<span class="n">maze_datasets</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">MazeDataset</span><span class="p">],</span>
</span><span id="MazeDatasetCollection-91"><a href="#MazeDatasetCollection-91"><span class="linenos"> 91</span></a>		<span class="n">generation_metadata_collected</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="MazeDatasetCollection-92"><a href="#MazeDatasetCollection-92"><span class="linenos"> 92</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeDatasetCollection-93"><a href="#MazeDatasetCollection-93"><span class="linenos"> 93</span></a>		<span class="s2">&quot;initialize the dataset collection from a `MazeDatasetCollectionConfig` and a list of `MazeDataset`s&quot;</span>
</span><span id="MazeDatasetCollection-94"><a href="#MazeDatasetCollection-94"><span class="linenos"> 94</span></a>		<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="MazeDatasetCollection-95"><a href="#MazeDatasetCollection-95"><span class="linenos"> 95</span></a>		<span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">:</span> <span class="n">MazeDatasetCollectionConfig</span> <span class="o">=</span> <span class="n">cfg</span>
</span><span id="MazeDatasetCollection-96"><a href="#MazeDatasetCollection-96"><span class="linenos"> 96</span></a>		<span class="bp">self</span><span class="o">.</span><span class="n">maze_datasets</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">MazeDataset</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">maze_datasets</span><span class="p">)</span>
</span><span id="MazeDatasetCollection-97"><a href="#MazeDatasetCollection-97"><span class="linenos"> 97</span></a>		<span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">ds</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
</span><span id="MazeDatasetCollection-98"><a href="#MazeDatasetCollection-98"><span class="linenos"> 98</span></a>			<span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">maze_dataset_configs</span><span class="p">,</span>
</span><span id="MazeDatasetCollection-99"><a href="#MazeDatasetCollection-99"><span class="linenos"> 99</span></a>			<span class="bp">self</span><span class="o">.</span><span class="n">maze_datasets</span><span class="p">,</span>
</span><span id="MazeDatasetCollection-100"><a href="#MazeDatasetCollection-100"><span class="linenos">100</span></a>			<span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="MazeDatasetCollection-101"><a href="#MazeDatasetCollection-101"><span class="linenos">101</span></a>		<span class="p">):</span>
</span><span id="MazeDatasetCollection-102"><a href="#MazeDatasetCollection-102"><span class="linenos">102</span></a>			<span class="k">assert</span> <span class="n">c</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">ds</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">name</span>
</span><span id="MazeDatasetCollection-103"><a href="#MazeDatasetCollection-103"><span class="linenos">103</span></a>			<span class="k">assert</span> <span class="n">c</span> <span class="o">==</span> <span class="n">ds</span><span class="o">.</span><span class="n">cfg</span>
</span><span id="MazeDatasetCollection-104"><a href="#MazeDatasetCollection-104"><span class="linenos">104</span></a>
</span><span id="MazeDatasetCollection-105"><a href="#MazeDatasetCollection-105"><span class="linenos">105</span></a>		<span class="bp">self</span><span class="o">.</span><span class="n">generation_metadata_collected</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">generation_metadata_collected</span>
</span><span id="MazeDatasetCollection-106"><a href="#MazeDatasetCollection-106"><span class="linenos">106</span></a>
</span><span id="MazeDatasetCollection-107"><a href="#MazeDatasetCollection-107"><span class="linenos">107</span></a>	<span class="nd">@property</span>
</span><span id="MazeDatasetCollection-108"><a href="#MazeDatasetCollection-108"><span class="linenos">108</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">dataset_lengths</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="MazeDatasetCollection-109"><a href="#MazeDatasetCollection-109"><span class="linenos">109</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;return the lengths of each dataset in the collection&quot;&quot;&quot;</span>
</span><span id="MazeDatasetCollection-110"><a href="#MazeDatasetCollection-110"><span class="linenos">110</span></a>		<span class="k">return</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span> <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">maze_datasets</span><span class="p">]</span>
</span><span id="MazeDatasetCollection-111"><a href="#MazeDatasetCollection-111"><span class="linenos">111</span></a>
</span><span id="MazeDatasetCollection-112"><a href="#MazeDatasetCollection-112"><span class="linenos">112</span></a>	<span class="nd">@property</span>
</span><span id="MazeDatasetCollection-113"><a href="#MazeDatasetCollection-113"><span class="linenos">113</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">dataset_cum_lengths</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Int</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot; indices&quot;</span><span class="p">]:</span>
</span><span id="MazeDatasetCollection-114"><a href="#MazeDatasetCollection-114"><span class="linenos">114</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;return the cumulative lengths of each dataset in the collection&quot;&quot;&quot;</span>
</span><span id="MazeDatasetCollection-115"><a href="#MazeDatasetCollection-115"><span class="linenos">115</span></a>		<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_lengths</span><span class="p">)))</span>
</span><span id="MazeDatasetCollection-116"><a href="#MazeDatasetCollection-116"><span class="linenos">116</span></a>
</span><span id="MazeDatasetCollection-117"><a href="#MazeDatasetCollection-117"><span class="linenos">117</span></a>	<span class="nd">@cached_property</span>
</span><span id="MazeDatasetCollection-118"><a href="#MazeDatasetCollection-118"><span class="linenos">118</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">mazes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">LatticeMaze</span><span class="p">]:</span>
</span><span id="MazeDatasetCollection-119"><a href="#MazeDatasetCollection-119"><span class="linenos">119</span></a>		<span class="s2">&quot;single list of all mazes in the collection&quot;</span>
</span><span id="MazeDatasetCollection-120"><a href="#MazeDatasetCollection-120"><span class="linenos">120</span></a>		<span class="k">return</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="MazeDatasetCollection-121"><a href="#MazeDatasetCollection-121"><span class="linenos">121</span></a>			<span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
</span><span id="MazeDatasetCollection-122"><a href="#MazeDatasetCollection-122"><span class="linenos">122</span></a>				<span class="n">dataset</span><span class="o">.</span><span class="n">mazes</span> <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">maze_datasets</span>
</span><span id="MazeDatasetCollection-123"><a href="#MazeDatasetCollection-123"><span class="linenos">123</span></a>			<span class="p">),</span>
</span><span id="MazeDatasetCollection-124"><a href="#MazeDatasetCollection-124"><span class="linenos">124</span></a>		<span class="p">)</span>
</span><span id="MazeDatasetCollection-125"><a href="#MazeDatasetCollection-125"><span class="linenos">125</span></a>
</span><span id="MazeDatasetCollection-126"><a href="#MazeDatasetCollection-126"><span class="linenos">126</span></a>	<span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="MazeDatasetCollection-127"><a href="#MazeDatasetCollection-127"><span class="linenos">127</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;return the total number of mazes in the collection&quot;&quot;&quot;</span>
</span><span id="MazeDatasetCollection-128"><a href="#MazeDatasetCollection-128"><span class="linenos">128</span></a>		<span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span> <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">maze_datasets</span><span class="p">)</span>
</span><span id="MazeDatasetCollection-129"><a href="#MazeDatasetCollection-129"><span class="linenos">129</span></a>
</span><span id="MazeDatasetCollection-130"><a href="#MazeDatasetCollection-130"><span class="linenos">130</span></a>	<span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LatticeMaze</span><span class="p">:</span>
</span><span id="MazeDatasetCollection-131"><a href="#MazeDatasetCollection-131"><span class="linenos">131</span></a>		<span class="s2">&quot;get a maze by index&quot;</span>
</span><span id="MazeDatasetCollection-132"><a href="#MazeDatasetCollection-132"><span class="linenos">132</span></a>		<span class="c1"># find which dataset the index belongs to</span>
</span><span id="MazeDatasetCollection-133"><a href="#MazeDatasetCollection-133"><span class="linenos">133</span></a>		<span class="c1"># we add 1, since np.searchsorted returns the</span>
</span><span id="MazeDatasetCollection-134"><a href="#MazeDatasetCollection-134"><span class="linenos">134</span></a>		<span class="c1"># index of the last element that is strictly less than the target</span>
</span><span id="MazeDatasetCollection-135"><a href="#MazeDatasetCollection-135"><span class="linenos">135</span></a>		<span class="c1"># while we want the index of the last element less than or equal to the target</span>
</span><span id="MazeDatasetCollection-136"><a href="#MazeDatasetCollection-136"><span class="linenos">136</span></a>		<span class="n">dataset_idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_cum_lengths</span><span class="p">,</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="MazeDatasetCollection-137"><a href="#MazeDatasetCollection-137"><span class="linenos">137</span></a>		<span class="n">index_adjusted</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">index</span>
</span><span id="MazeDatasetCollection-138"><a href="#MazeDatasetCollection-138"><span class="linenos">138</span></a>		<span class="k">if</span> <span class="n">dataset_idx</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="MazeDatasetCollection-139"><a href="#MazeDatasetCollection-139"><span class="linenos">139</span></a>			<span class="c1"># if the index is 0, `dataset_idx - 1` will be -1.</span>
</span><span id="MazeDatasetCollection-140"><a href="#MazeDatasetCollection-140"><span class="linenos">140</span></a>			<span class="c1"># We just want to use the base index</span>
</span><span id="MazeDatasetCollection-141"><a href="#MazeDatasetCollection-141"><span class="linenos">141</span></a>			<span class="n">index_adjusted</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_cum_lengths</span><span class="p">[</span><span class="n">dataset_idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="MazeDatasetCollection-142"><a href="#MazeDatasetCollection-142"><span class="linenos">142</span></a>		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">maze_datasets</span><span class="p">[</span><span class="n">dataset_idx</span><span class="p">][</span><span class="n">index_adjusted</span><span class="p">]</span>
</span><span id="MazeDatasetCollection-143"><a href="#MazeDatasetCollection-143"><span class="linenos">143</span></a>
</span><span id="MazeDatasetCollection-144"><a href="#MazeDatasetCollection-144"><span class="linenos">144</span></a>	<span class="nd">@classmethod</span>
</span><span id="MazeDatasetCollection-145"><a href="#MazeDatasetCollection-145"><span class="linenos">145</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">generate</span><span class="p">(</span>
</span><span id="MazeDatasetCollection-146"><a href="#MazeDatasetCollection-146"><span class="linenos">146</span></a>		<span class="bp">cls</span><span class="p">,</span>
</span><span id="MazeDatasetCollection-147"><a href="#MazeDatasetCollection-147"><span class="linenos">147</span></a>		<span class="n">cfg</span><span class="p">:</span> <span class="n">MazeDatasetCollectionConfig</span><span class="p">,</span>
</span><span id="MazeDatasetCollection-148"><a href="#MazeDatasetCollection-148"><span class="linenos">148</span></a>		<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="MazeDatasetCollection-149"><a href="#MazeDatasetCollection-149"><span class="linenos">149</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MazeDatasetCollection&quot;</span><span class="p">:</span>
</span><span id="MazeDatasetCollection-150"><a href="#MazeDatasetCollection-150"><span class="linenos">150</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;generate a dataset collection from a config&quot;&quot;&quot;</span>
</span><span id="MazeDatasetCollection-151"><a href="#MazeDatasetCollection-151"><span class="linenos">151</span></a>		<span class="n">datasets</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="MazeDatasetCollection-152"><a href="#MazeDatasetCollection-152"><span class="linenos">152</span></a>			<span class="n">MazeDataset</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="MazeDatasetCollection-153"><a href="#MazeDatasetCollection-153"><span class="linenos">153</span></a>			<span class="k">for</span> <span class="n">config</span> <span class="ow">in</span> <span class="n">cfg</span><span class="o">.</span><span class="n">maze_dataset_configs</span>
</span><span id="MazeDatasetCollection-154"><a href="#MazeDatasetCollection-154"><span class="linenos">154</span></a>		<span class="p">]</span>
</span><span id="MazeDatasetCollection-155"><a href="#MazeDatasetCollection-155"><span class="linenos">155</span></a>		<span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">datasets</span><span class="p">)</span>
</span><span id="MazeDatasetCollection-156"><a href="#MazeDatasetCollection-156"><span class="linenos">156</span></a>
</span><span id="MazeDatasetCollection-157"><a href="#MazeDatasetCollection-157"><span class="linenos">157</span></a>	<span class="nd">@classmethod</span>
</span><span id="MazeDatasetCollection-158"><a href="#MazeDatasetCollection-158"><span class="linenos">158</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">download</span><span class="p">(</span>
</span><span id="MazeDatasetCollection-159"><a href="#MazeDatasetCollection-159"><span class="linenos">159</span></a>		<span class="bp">cls</span><span class="p">,</span>
</span><span id="MazeDatasetCollection-160"><a href="#MazeDatasetCollection-160"><span class="linenos">160</span></a>		<span class="n">cfg</span><span class="p">:</span> <span class="n">MazeDatasetCollectionConfig</span><span class="p">,</span>
</span><span id="MazeDatasetCollection-161"><a href="#MazeDatasetCollection-161"><span class="linenos">161</span></a>		<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="MazeDatasetCollection-162"><a href="#MazeDatasetCollection-162"><span class="linenos">162</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MazeDatasetCollection&quot;</span><span class="p">:</span>
</span><span id="MazeDatasetCollection-163"><a href="#MazeDatasetCollection-163"><span class="linenos">163</span></a>		<span class="s2">&quot;(not implemented!) download a dataset collection from a config&quot;</span>
</span><span id="MazeDatasetCollection-164"><a href="#MazeDatasetCollection-164"><span class="linenos">164</span></a>		<span class="n">datasets</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="MazeDatasetCollection-165"><a href="#MazeDatasetCollection-165"><span class="linenos">165</span></a>			<span class="n">MazeDataset</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="MazeDatasetCollection-166"><a href="#MazeDatasetCollection-166"><span class="linenos">166</span></a>			<span class="k">for</span> <span class="n">config</span> <span class="ow">in</span> <span class="n">cfg</span><span class="o">.</span><span class="n">maze_dataset_configs</span>
</span><span id="MazeDatasetCollection-167"><a href="#MazeDatasetCollection-167"><span class="linenos">167</span></a>		<span class="p">]</span>
</span><span id="MazeDatasetCollection-168"><a href="#MazeDatasetCollection-168"><span class="linenos">168</span></a>		<span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">datasets</span><span class="p">)</span>
</span><span id="MazeDatasetCollection-169"><a href="#MazeDatasetCollection-169"><span class="linenos">169</span></a>
</span><span id="MazeDatasetCollection-170"><a href="#MazeDatasetCollection-170"><span class="linenos">170</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JSONdict</span><span class="p">:</span>
</span><span id="MazeDatasetCollection-171"><a href="#MazeDatasetCollection-171"><span class="linenos">171</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;serialize the dataset collection&quot;&quot;&quot;</span>
</span><span id="MazeDatasetCollection-172"><a href="#MazeDatasetCollection-172"><span class="linenos">172</span></a>		<span class="k">return</span> <span class="p">{</span>
</span><span id="MazeDatasetCollection-173"><a href="#MazeDatasetCollection-173"><span class="linenos">173</span></a>			<span class="n">_FORMAT_KEY</span><span class="p">:</span> <span class="s2">&quot;MazeDatasetCollection&quot;</span><span class="p">,</span>
</span><span id="MazeDatasetCollection-174"><a href="#MazeDatasetCollection-174"><span class="linenos">174</span></a>			<span class="s2">&quot;cfg&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">serialize</span><span class="p">(),</span>
</span><span id="MazeDatasetCollection-175"><a href="#MazeDatasetCollection-175"><span class="linenos">175</span></a>			<span class="s2">&quot;maze_datasets&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">dataset</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span> <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">maze_datasets</span><span class="p">],</span>
</span><span id="MazeDatasetCollection-176"><a href="#MazeDatasetCollection-176"><span class="linenos">176</span></a>			<span class="s2">&quot;generation_metadata_collected&quot;</span><span class="p">:</span> <span class="n">json_serialize</span><span class="p">(</span>
</span><span id="MazeDatasetCollection-177"><a href="#MazeDatasetCollection-177"><span class="linenos">177</span></a>				<span class="bp">self</span><span class="o">.</span><span class="n">generation_metadata_collected</span><span class="p">,</span>
</span><span id="MazeDatasetCollection-178"><a href="#MazeDatasetCollection-178"><span class="linenos">178</span></a>			<span class="p">),</span>
</span><span id="MazeDatasetCollection-179"><a href="#MazeDatasetCollection-179"><span class="linenos">179</span></a>		<span class="p">}</span>
</span><span id="MazeDatasetCollection-180"><a href="#MazeDatasetCollection-180"><span class="linenos">180</span></a>
</span><span id="MazeDatasetCollection-181"><a href="#MazeDatasetCollection-181"><span class="linenos">181</span></a>	<span class="nd">@classmethod</span>
</span><span id="MazeDatasetCollection-182"><a href="#MazeDatasetCollection-182"><span class="linenos">182</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">JSONdict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MazeDatasetCollection&quot;</span><span class="p">:</span>
</span><span id="MazeDatasetCollection-183"><a href="#MazeDatasetCollection-183"><span class="linenos">183</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;load the dataset collection from the representation created by `serialize`&quot;&quot;&quot;</span>
</span><span id="MazeDatasetCollection-184"><a href="#MazeDatasetCollection-184"><span class="linenos">184</span></a>		<span class="k">assert</span> <span class="n">data</span><span class="p">[</span><span class="n">_FORMAT_KEY</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;MazeDatasetCollection&quot;</span>
</span><span id="MazeDatasetCollection-185"><a href="#MazeDatasetCollection-185"><span class="linenos">185</span></a>		<span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="MazeDatasetCollection-186"><a href="#MazeDatasetCollection-186"><span class="linenos">186</span></a>			<span class="o">**</span><span class="p">{</span>
</span><span id="MazeDatasetCollection-187"><a href="#MazeDatasetCollection-187"><span class="linenos">187</span></a>				<span class="n">key</span><span class="p">:</span> <span class="n">load_item_recursive</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">())</span>
</span><span id="MazeDatasetCollection-188"><a href="#MazeDatasetCollection-188"><span class="linenos">188</span></a>				<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;cfg&quot;</span><span class="p">,</span> <span class="s2">&quot;maze_datasets&quot;</span><span class="p">,</span> <span class="s2">&quot;generation_metadata_collected&quot;</span><span class="p">]</span>
</span><span id="MazeDatasetCollection-189"><a href="#MazeDatasetCollection-189"><span class="linenos">189</span></a>			<span class="p">},</span>
</span><span id="MazeDatasetCollection-190"><a href="#MazeDatasetCollection-190"><span class="linenos">190</span></a>		<span class="p">)</span>
</span><span id="MazeDatasetCollection-191"><a href="#MazeDatasetCollection-191"><span class="linenos">191</span></a>
</span><span id="MazeDatasetCollection-192"><a href="#MazeDatasetCollection-192"><span class="linenos">192</span></a>	<span class="c1"># TODO: remove duplication with MazeDatasetConfig().as_tokens() somehow?</span>
</span><span id="MazeDatasetCollection-193"><a href="#MazeDatasetCollection-193"><span class="linenos">193</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">as_tokens</span><span class="p">(</span>
</span><span id="MazeDatasetCollection-194"><a href="#MazeDatasetCollection-194"><span class="linenos">194</span></a>		<span class="bp">self</span><span class="p">,</span>
</span><span id="MazeDatasetCollection-195"><a href="#MazeDatasetCollection-195"><span class="linenos">195</span></a>		<span class="c1"># TODO: MazeTokenizer</span>
</span><span id="MazeDatasetCollection-196"><a href="#MazeDatasetCollection-196"><span class="linenos">196</span></a>		<span class="n">maze_tokenizer</span><span class="p">,</span>  <span class="c1"># noqa: ANN001</span>
</span><span id="MazeDatasetCollection-197"><a href="#MazeDatasetCollection-197"><span class="linenos">197</span></a>		<span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="MazeDatasetCollection-198"><a href="#MazeDatasetCollection-198"><span class="linenos">198</span></a>		<span class="n">join_tokens_individual_maze</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="MazeDatasetCollection-199"><a href="#MazeDatasetCollection-199"><span class="linenos">199</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="MazeDatasetCollection-200"><a href="#MazeDatasetCollection-200"><span class="linenos">200</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;return the dataset as tokens</span>
</span><span id="MazeDatasetCollection-201"><a href="#MazeDatasetCollection-201"><span class="linenos">201</span></a>
</span><span id="MazeDatasetCollection-202"><a href="#MazeDatasetCollection-202"><span class="linenos">202</span></a><span class="sd">		if join_tokens_individual_maze is True, then the tokens of each maze are</span>
</span><span id="MazeDatasetCollection-203"><a href="#MazeDatasetCollection-203"><span class="linenos">203</span></a><span class="sd">		joined with a space, and the result is a list of strings.</span>
</span><span id="MazeDatasetCollection-204"><a href="#MazeDatasetCollection-204"><span class="linenos">204</span></a><span class="sd">		i.e.:</span>
</span><span id="MazeDatasetCollection-205"><a href="#MazeDatasetCollection-205"><span class="linenos">205</span></a><span class="sd">		&gt;&gt;&gt; dataset.as_tokens(join_tokens_individual_maze=False)</span>
</span><span id="MazeDatasetCollection-206"><a href="#MazeDatasetCollection-206"><span class="linenos">206</span></a><span class="sd">		[[&quot;a&quot;, &quot;b&quot;, &quot;c&quot;], [&quot;d&quot;, &quot;e&quot;, &quot;f&quot;]]</span>
</span><span id="MazeDatasetCollection-207"><a href="#MazeDatasetCollection-207"><span class="linenos">207</span></a><span class="sd">		&gt;&gt;&gt; dataset.as_tokens(join_tokens_individual_maze=True)</span>
</span><span id="MazeDatasetCollection-208"><a href="#MazeDatasetCollection-208"><span class="linenos">208</span></a><span class="sd">		[&quot;a b c&quot;, &quot;d e f&quot;]</span>
</span><span id="MazeDatasetCollection-209"><a href="#MazeDatasetCollection-209"><span class="linenos">209</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="MazeDatasetCollection-210"><a href="#MazeDatasetCollection-210"><span class="linenos">210</span></a>		<span class="n">output</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="MazeDatasetCollection-211"><a href="#MazeDatasetCollection-211"><span class="linenos">211</span></a>			<span class="n">maze</span><span class="o">.</span><span class="n">as_tokens</span><span class="p">(</span><span class="n">maze_tokenizer</span><span class="p">)</span> <span class="k">for</span> <span class="n">maze</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mazes</span><span class="p">[:</span><span class="n">limit</span><span class="p">]</span>
</span><span id="MazeDatasetCollection-212"><a href="#MazeDatasetCollection-212"><span class="linenos">212</span></a>		<span class="p">]</span>
</span><span id="MazeDatasetCollection-213"><a href="#MazeDatasetCollection-213"><span class="linenos">213</span></a>		<span class="k">if</span> <span class="n">join_tokens_individual_maze</span><span class="p">:</span>
</span><span id="MazeDatasetCollection-214"><a href="#MazeDatasetCollection-214"><span class="linenos">214</span></a>			<span class="k">return</span> <span class="p">[</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span> <span class="k">for</span> <span class="n">tokens</span> <span class="ow">in</span> <span class="n">output</span><span class="p">]</span>
</span><span id="MazeDatasetCollection-215"><a href="#MazeDatasetCollection-215"><span class="linenos">215</span></a>		<span class="k">else</span><span class="p">:</span>
</span><span id="MazeDatasetCollection-216"><a href="#MazeDatasetCollection-216"><span class="linenos">216</span></a>			<span class="k">return</span> <span class="n">output</span>
</span><span id="MazeDatasetCollection-217"><a href="#MazeDatasetCollection-217"><span class="linenos">217</span></a>
</span><span id="MazeDatasetCollection-218"><a href="#MazeDatasetCollection-218"><span class="linenos">218</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">update_self_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeDatasetCollection-219"><a href="#MazeDatasetCollection-219"><span class="linenos">219</span></a>		<span class="s2">&quot;update the config to match the number of mazes, and update the underlying configs of each dataset&quot;</span>
</span><span id="MazeDatasetCollection-220"><a href="#MazeDatasetCollection-220"><span class="linenos">220</span></a>		<span class="c1"># TODO: why cant we set this directly? its not frozen, and it seems to work in a regular MazeDataset</span>
</span><span id="MazeDatasetCollection-221"><a href="#MazeDatasetCollection-221"><span class="linenos">221</span></a>		<span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s2">&quot;n_mazes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="MazeDatasetCollection-222"><a href="#MazeDatasetCollection-222"><span class="linenos">222</span></a>		<span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">maze_datasets</span><span class="p">:</span>
</span><span id="MazeDatasetCollection-223"><a href="#MazeDatasetCollection-223"><span class="linenos">223</span></a>			<span class="n">dataset</span><span class="o">.</span><span class="n">update_self_config</span><span class="p">()</span>
</span><span id="MazeDatasetCollection-224"><a href="#MazeDatasetCollection-224"><span class="linenos">224</span></a>
</span><span id="MazeDatasetCollection-225"><a href="#MazeDatasetCollection-225"><span class="linenos">225</span></a>		<span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">maze_dataset_configs</span> <span class="o">=</span> <span class="p">[</span><span class="n">dataset</span><span class="o">.</span><span class="n">cfg</span> <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">maze_datasets</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>a collection of maze datasets</p>
</div>


                            <div id="MazeDatasetCollection.__init__" class="classattr">
                                        <input id="MazeDatasetCollection.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">MazeDatasetCollection</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">cfg</span><span class="p">:</span> <span class="n"><a href="#MazeDatasetCollectionConfig">MazeDatasetCollectionConfig</a></span>,</span><span class="param">	<span class="n">maze_datasets</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="#MazeDataset">MazeDataset</a></span><span class="p">]</span>,</span><span class="param">	<span class="n">generation_metadata_collected</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDatasetCollection.__init__-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L86-L104" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDatasetCollection.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDatasetCollection.__init__-87"><a href="#MazeDatasetCollection.__init__-87"><span class="linenos"> 87</span></a>	<span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="MazeDatasetCollection.__init__-88"><a href="#MazeDatasetCollection.__init__-88"><span class="linenos"> 88</span></a>		<span class="bp">self</span><span class="p">,</span>
</span><span id="MazeDatasetCollection.__init__-89"><a href="#MazeDatasetCollection.__init__-89"><span class="linenos"> 89</span></a>		<span class="n">cfg</span><span class="p">:</span> <span class="n">MazeDatasetCollectionConfig</span><span class="p">,</span>
</span><span id="MazeDatasetCollection.__init__-90"><a href="#MazeDatasetCollection.__init__-90"><span class="linenos"> 90</span></a>		<span class="n">maze_datasets</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">MazeDataset</span><span class="p">],</span>
</span><span id="MazeDatasetCollection.__init__-91"><a href="#MazeDatasetCollection.__init__-91"><span class="linenos"> 91</span></a>		<span class="n">generation_metadata_collected</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="MazeDatasetCollection.__init__-92"><a href="#MazeDatasetCollection.__init__-92"><span class="linenos"> 92</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeDatasetCollection.__init__-93"><a href="#MazeDatasetCollection.__init__-93"><span class="linenos"> 93</span></a>		<span class="s2">&quot;initialize the dataset collection from a `MazeDatasetCollectionConfig` and a list of `MazeDataset`s&quot;</span>
</span><span id="MazeDatasetCollection.__init__-94"><a href="#MazeDatasetCollection.__init__-94"><span class="linenos"> 94</span></a>		<span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="MazeDatasetCollection.__init__-95"><a href="#MazeDatasetCollection.__init__-95"><span class="linenos"> 95</span></a>		<span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">:</span> <span class="n">MazeDatasetCollectionConfig</span> <span class="o">=</span> <span class="n">cfg</span>
</span><span id="MazeDatasetCollection.__init__-96"><a href="#MazeDatasetCollection.__init__-96"><span class="linenos"> 96</span></a>		<span class="bp">self</span><span class="o">.</span><span class="n">maze_datasets</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">MazeDataset</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">maze_datasets</span><span class="p">)</span>
</span><span id="MazeDatasetCollection.__init__-97"><a href="#MazeDatasetCollection.__init__-97"><span class="linenos"> 97</span></a>		<span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">ds</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
</span><span id="MazeDatasetCollection.__init__-98"><a href="#MazeDatasetCollection.__init__-98"><span class="linenos"> 98</span></a>			<span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">maze_dataset_configs</span><span class="p">,</span>
</span><span id="MazeDatasetCollection.__init__-99"><a href="#MazeDatasetCollection.__init__-99"><span class="linenos"> 99</span></a>			<span class="bp">self</span><span class="o">.</span><span class="n">maze_datasets</span><span class="p">,</span>
</span><span id="MazeDatasetCollection.__init__-100"><a href="#MazeDatasetCollection.__init__-100"><span class="linenos">100</span></a>			<span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="MazeDatasetCollection.__init__-101"><a href="#MazeDatasetCollection.__init__-101"><span class="linenos">101</span></a>		<span class="p">):</span>
</span><span id="MazeDatasetCollection.__init__-102"><a href="#MazeDatasetCollection.__init__-102"><span class="linenos">102</span></a>			<span class="k">assert</span> <span class="n">c</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">ds</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">name</span>
</span><span id="MazeDatasetCollection.__init__-103"><a href="#MazeDatasetCollection.__init__-103"><span class="linenos">103</span></a>			<span class="k">assert</span> <span class="n">c</span> <span class="o">==</span> <span class="n">ds</span><span class="o">.</span><span class="n">cfg</span>
</span><span id="MazeDatasetCollection.__init__-104"><a href="#MazeDatasetCollection.__init__-104"><span class="linenos">104</span></a>
</span><span id="MazeDatasetCollection.__init__-105"><a href="#MazeDatasetCollection.__init__-105"><span class="linenos">105</span></a>		<span class="bp">self</span><span class="o">.</span><span class="n">generation_metadata_collected</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">generation_metadata_collected</span>
</span></pre></div>


            <div class="docstring"><p>initialize the dataset collection from a <code><a href="#MazeDatasetCollectionConfig">MazeDatasetCollectionConfig</a></code> and a list of <code><a href="#MazeDataset">MazeDataset</a></code>s</p>
</div>


                            </div>
                            <div id="MazeDatasetCollection.cfg" class="classattr">
                                <div class="attr variable">
            <span class="name">cfg</span><span class="annotation">: <a href="#MazeDatasetCollectionConfig">MazeDatasetCollectionConfig</a></span>

        
    </div>
    <a class="headerlink" href="#MazeDatasetCollection.cfg"></a>
    
    

                            </div>
                            <div id="MazeDatasetCollection.maze_datasets" class="classattr">
                                <div class="attr variable">
            <span class="name">maze_datasets</span><span class="annotation">: list[<a href="#MazeDataset">MazeDataset</a>]</span>

        
    </div>
    <a class="headerlink" href="#MazeDatasetCollection.maze_datasets"></a>
    
    

                            </div>
                            <div id="MazeDatasetCollection.generation_metadata_collected" class="classattr">
                                <div class="attr variable">
            <span class="name">generation_metadata_collected</span><span class="annotation">: dict | None</span>

        
    </div>
    <a class="headerlink" href="#MazeDatasetCollection.generation_metadata_collected"></a>
    
    

                            </div>
                            <div id="MazeDatasetCollection.dataset_lengths" class="classattr">
                                        <input id="MazeDatasetCollection.dataset_lengths-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">dataset_lengths</span><span class="annotation">: list[int]</span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDatasetCollection.dataset_lengths-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L106-L109" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDatasetCollection.dataset_lengths"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDatasetCollection.dataset_lengths-107"><a href="#MazeDatasetCollection.dataset_lengths-107"><span class="linenos">107</span></a>	<span class="nd">@property</span>
</span><span id="MazeDatasetCollection.dataset_lengths-108"><a href="#MazeDatasetCollection.dataset_lengths-108"><span class="linenos">108</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">dataset_lengths</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="MazeDatasetCollection.dataset_lengths-109"><a href="#MazeDatasetCollection.dataset_lengths-109"><span class="linenos">109</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;return the lengths of each dataset in the collection&quot;&quot;&quot;</span>
</span><span id="MazeDatasetCollection.dataset_lengths-110"><a href="#MazeDatasetCollection.dataset_lengths-110"><span class="linenos">110</span></a>		<span class="k">return</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span> <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">maze_datasets</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>return the lengths of each dataset in the collection</p>
</div>


                            </div>
                            <div id="MazeDatasetCollection.dataset_cum_lengths" class="classattr">
                                        <input id="MazeDatasetCollection.dataset_cum_lengths-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">dataset_cum_lengths</span><span class="annotation">: jaxtyping.Int[ndarray, &#39;indices&#39;]</span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDatasetCollection.dataset_cum_lengths-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L111-L114" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDatasetCollection.dataset_cum_lengths"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDatasetCollection.dataset_cum_lengths-112"><a href="#MazeDatasetCollection.dataset_cum_lengths-112"><span class="linenos">112</span></a>	<span class="nd">@property</span>
</span><span id="MazeDatasetCollection.dataset_cum_lengths-113"><a href="#MazeDatasetCollection.dataset_cum_lengths-113"><span class="linenos">113</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">dataset_cum_lengths</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Int</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot; indices&quot;</span><span class="p">]:</span>
</span><span id="MazeDatasetCollection.dataset_cum_lengths-114"><a href="#MazeDatasetCollection.dataset_cum_lengths-114"><span class="linenos">114</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;return the cumulative lengths of each dataset in the collection&quot;&quot;&quot;</span>
</span><span id="MazeDatasetCollection.dataset_cum_lengths-115"><a href="#MazeDatasetCollection.dataset_cum_lengths-115"><span class="linenos">115</span></a>		<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_lengths</span><span class="p">)))</span>
</span></pre></div>


            <div class="docstring"><p>return the cumulative lengths of each dataset in the collection</p>
</div>


                            </div>
                            <div id="MazeDatasetCollection.mazes" class="classattr">
                                        <input id="MazeDatasetCollection.mazes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">mazes</span><span class="annotation">: list[<a href="../maze_dataset.html#LatticeMaze">maze_dataset.LatticeMaze</a>]</span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDatasetCollection.mazes-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L116-L123" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDatasetCollection.mazes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDatasetCollection.mazes-117"><a href="#MazeDatasetCollection.mazes-117"><span class="linenos">117</span></a>	<span class="nd">@cached_property</span>
</span><span id="MazeDatasetCollection.mazes-118"><a href="#MazeDatasetCollection.mazes-118"><span class="linenos">118</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">mazes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">LatticeMaze</span><span class="p">]:</span>
</span><span id="MazeDatasetCollection.mazes-119"><a href="#MazeDatasetCollection.mazes-119"><span class="linenos">119</span></a>		<span class="s2">&quot;single list of all mazes in the collection&quot;</span>
</span><span id="MazeDatasetCollection.mazes-120"><a href="#MazeDatasetCollection.mazes-120"><span class="linenos">120</span></a>		<span class="k">return</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="MazeDatasetCollection.mazes-121"><a href="#MazeDatasetCollection.mazes-121"><span class="linenos">121</span></a>			<span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
</span><span id="MazeDatasetCollection.mazes-122"><a href="#MazeDatasetCollection.mazes-122"><span class="linenos">122</span></a>				<span class="n">dataset</span><span class="o">.</span><span class="n">mazes</span> <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">maze_datasets</span>
</span><span id="MazeDatasetCollection.mazes-123"><a href="#MazeDatasetCollection.mazes-123"><span class="linenos">123</span></a>			<span class="p">),</span>
</span><span id="MazeDatasetCollection.mazes-124"><a href="#MazeDatasetCollection.mazes-124"><span class="linenos">124</span></a>		<span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>single list of all mazes in the collection</p>
</div>


                            </div>
                            <div id="MazeDatasetCollection.generate" class="classattr">
                                        <input id="MazeDatasetCollection.generate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">generate</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">cls</span>,</span><span class="param">	<span class="n">cfg</span><span class="p">:</span> <span class="n"><a href="#MazeDatasetCollectionConfig">MazeDatasetCollectionConfig</a></span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="n"><a href="#MazeDatasetCollection">MazeDatasetCollection</a></span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDatasetCollection.generate-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L143-L154" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDatasetCollection.generate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDatasetCollection.generate-144"><a href="#MazeDatasetCollection.generate-144"><span class="linenos">144</span></a>	<span class="nd">@classmethod</span>
</span><span id="MazeDatasetCollection.generate-145"><a href="#MazeDatasetCollection.generate-145"><span class="linenos">145</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">generate</span><span class="p">(</span>
</span><span id="MazeDatasetCollection.generate-146"><a href="#MazeDatasetCollection.generate-146"><span class="linenos">146</span></a>		<span class="bp">cls</span><span class="p">,</span>
</span><span id="MazeDatasetCollection.generate-147"><a href="#MazeDatasetCollection.generate-147"><span class="linenos">147</span></a>		<span class="n">cfg</span><span class="p">:</span> <span class="n">MazeDatasetCollectionConfig</span><span class="p">,</span>
</span><span id="MazeDatasetCollection.generate-148"><a href="#MazeDatasetCollection.generate-148"><span class="linenos">148</span></a>		<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="MazeDatasetCollection.generate-149"><a href="#MazeDatasetCollection.generate-149"><span class="linenos">149</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MazeDatasetCollection&quot;</span><span class="p">:</span>
</span><span id="MazeDatasetCollection.generate-150"><a href="#MazeDatasetCollection.generate-150"><span class="linenos">150</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;generate a dataset collection from a config&quot;&quot;&quot;</span>
</span><span id="MazeDatasetCollection.generate-151"><a href="#MazeDatasetCollection.generate-151"><span class="linenos">151</span></a>		<span class="n">datasets</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="MazeDatasetCollection.generate-152"><a href="#MazeDatasetCollection.generate-152"><span class="linenos">152</span></a>			<span class="n">MazeDataset</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="MazeDatasetCollection.generate-153"><a href="#MazeDatasetCollection.generate-153"><span class="linenos">153</span></a>			<span class="k">for</span> <span class="n">config</span> <span class="ow">in</span> <span class="n">cfg</span><span class="o">.</span><span class="n">maze_dataset_configs</span>
</span><span id="MazeDatasetCollection.generate-154"><a href="#MazeDatasetCollection.generate-154"><span class="linenos">154</span></a>		<span class="p">]</span>
</span><span id="MazeDatasetCollection.generate-155"><a href="#MazeDatasetCollection.generate-155"><span class="linenos">155</span></a>		<span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">datasets</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>generate a dataset collection from a config</p>
</div>


                            </div>
                            <div id="MazeDatasetCollection.download" class="classattr">
                                        <input id="MazeDatasetCollection.download-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">download</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">cls</span>,</span><span class="param">	<span class="n">cfg</span><span class="p">:</span> <span class="n"><a href="#MazeDatasetCollectionConfig">MazeDatasetCollectionConfig</a></span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="n"><a href="#MazeDatasetCollection">MazeDatasetCollection</a></span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDatasetCollection.download-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L156-L167" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDatasetCollection.download"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDatasetCollection.download-157"><a href="#MazeDatasetCollection.download-157"><span class="linenos">157</span></a>	<span class="nd">@classmethod</span>
</span><span id="MazeDatasetCollection.download-158"><a href="#MazeDatasetCollection.download-158"><span class="linenos">158</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">download</span><span class="p">(</span>
</span><span id="MazeDatasetCollection.download-159"><a href="#MazeDatasetCollection.download-159"><span class="linenos">159</span></a>		<span class="bp">cls</span><span class="p">,</span>
</span><span id="MazeDatasetCollection.download-160"><a href="#MazeDatasetCollection.download-160"><span class="linenos">160</span></a>		<span class="n">cfg</span><span class="p">:</span> <span class="n">MazeDatasetCollectionConfig</span><span class="p">,</span>
</span><span id="MazeDatasetCollection.download-161"><a href="#MazeDatasetCollection.download-161"><span class="linenos">161</span></a>		<span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="MazeDatasetCollection.download-162"><a href="#MazeDatasetCollection.download-162"><span class="linenos">162</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MazeDatasetCollection&quot;</span><span class="p">:</span>
</span><span id="MazeDatasetCollection.download-163"><a href="#MazeDatasetCollection.download-163"><span class="linenos">163</span></a>		<span class="s2">&quot;(not implemented!) download a dataset collection from a config&quot;</span>
</span><span id="MazeDatasetCollection.download-164"><a href="#MazeDatasetCollection.download-164"><span class="linenos">164</span></a>		<span class="n">datasets</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="MazeDatasetCollection.download-165"><a href="#MazeDatasetCollection.download-165"><span class="linenos">165</span></a>			<span class="n">MazeDataset</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="MazeDatasetCollection.download-166"><a href="#MazeDatasetCollection.download-166"><span class="linenos">166</span></a>			<span class="k">for</span> <span class="n">config</span> <span class="ow">in</span> <span class="n">cfg</span><span class="o">.</span><span class="n">maze_dataset_configs</span>
</span><span id="MazeDatasetCollection.download-167"><a href="#MazeDatasetCollection.download-167"><span class="linenos">167</span></a>		<span class="p">]</span>
</span><span id="MazeDatasetCollection.download-168"><a href="#MazeDatasetCollection.download-168"><span class="linenos">168</span></a>		<span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">datasets</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>(not implemented!) download a dataset collection from a config</p>
</div>


                            </div>
                            <div id="MazeDatasetCollection.serialize" class="classattr">
                                        <input id="MazeDatasetCollection.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]]]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDatasetCollection.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L169-L178" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDatasetCollection.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDatasetCollection.serialize-170"><a href="#MazeDatasetCollection.serialize-170"><span class="linenos">170</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JSONdict</span><span class="p">:</span>
</span><span id="MazeDatasetCollection.serialize-171"><a href="#MazeDatasetCollection.serialize-171"><span class="linenos">171</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;serialize the dataset collection&quot;&quot;&quot;</span>
</span><span id="MazeDatasetCollection.serialize-172"><a href="#MazeDatasetCollection.serialize-172"><span class="linenos">172</span></a>		<span class="k">return</span> <span class="p">{</span>
</span><span id="MazeDatasetCollection.serialize-173"><a href="#MazeDatasetCollection.serialize-173"><span class="linenos">173</span></a>			<span class="n">_FORMAT_KEY</span><span class="p">:</span> <span class="s2">&quot;MazeDatasetCollection&quot;</span><span class="p">,</span>
</span><span id="MazeDatasetCollection.serialize-174"><a href="#MazeDatasetCollection.serialize-174"><span class="linenos">174</span></a>			<span class="s2">&quot;cfg&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">serialize</span><span class="p">(),</span>
</span><span id="MazeDatasetCollection.serialize-175"><a href="#MazeDatasetCollection.serialize-175"><span class="linenos">175</span></a>			<span class="s2">&quot;maze_datasets&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">dataset</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span> <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">maze_datasets</span><span class="p">],</span>
</span><span id="MazeDatasetCollection.serialize-176"><a href="#MazeDatasetCollection.serialize-176"><span class="linenos">176</span></a>			<span class="s2">&quot;generation_metadata_collected&quot;</span><span class="p">:</span> <span class="n">json_serialize</span><span class="p">(</span>
</span><span id="MazeDatasetCollection.serialize-177"><a href="#MazeDatasetCollection.serialize-177"><span class="linenos">177</span></a>				<span class="bp">self</span><span class="o">.</span><span class="n">generation_metadata_collected</span><span class="p">,</span>
</span><span id="MazeDatasetCollection.serialize-178"><a href="#MazeDatasetCollection.serialize-178"><span class="linenos">178</span></a>			<span class="p">),</span>
</span><span id="MazeDatasetCollection.serialize-179"><a href="#MazeDatasetCollection.serialize-179"><span class="linenos">179</span></a>		<span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>serialize the dataset collection</p>
</div>


                            </div>
                            <div id="MazeDatasetCollection.load" class="classattr">
                                        <input id="MazeDatasetCollection.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">cls</span>,</span><span class="param">	<span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]]]</span></span><span class="return-annotation">) -> <span class="n"><a href="#MazeDatasetCollection">MazeDatasetCollection</a></span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDatasetCollection.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L180-L189" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDatasetCollection.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDatasetCollection.load-181"><a href="#MazeDatasetCollection.load-181"><span class="linenos">181</span></a>	<span class="nd">@classmethod</span>
</span><span id="MazeDatasetCollection.load-182"><a href="#MazeDatasetCollection.load-182"><span class="linenos">182</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">JSONdict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MazeDatasetCollection&quot;</span><span class="p">:</span>
</span><span id="MazeDatasetCollection.load-183"><a href="#MazeDatasetCollection.load-183"><span class="linenos">183</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;load the dataset collection from the representation created by `serialize`&quot;&quot;&quot;</span>
</span><span id="MazeDatasetCollection.load-184"><a href="#MazeDatasetCollection.load-184"><span class="linenos">184</span></a>		<span class="k">assert</span> <span class="n">data</span><span class="p">[</span><span class="n">_FORMAT_KEY</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;MazeDatasetCollection&quot;</span>
</span><span id="MazeDatasetCollection.load-185"><a href="#MazeDatasetCollection.load-185"><span class="linenos">185</span></a>		<span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="MazeDatasetCollection.load-186"><a href="#MazeDatasetCollection.load-186"><span class="linenos">186</span></a>			<span class="o">**</span><span class="p">{</span>
</span><span id="MazeDatasetCollection.load-187"><a href="#MazeDatasetCollection.load-187"><span class="linenos">187</span></a>				<span class="n">key</span><span class="p">:</span> <span class="n">load_item_recursive</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">())</span>
</span><span id="MazeDatasetCollection.load-188"><a href="#MazeDatasetCollection.load-188"><span class="linenos">188</span></a>				<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;cfg&quot;</span><span class="p">,</span> <span class="s2">&quot;maze_datasets&quot;</span><span class="p">,</span> <span class="s2">&quot;generation_metadata_collected&quot;</span><span class="p">]</span>
</span><span id="MazeDatasetCollection.load-189"><a href="#MazeDatasetCollection.load-189"><span class="linenos">189</span></a>			<span class="p">},</span>
</span><span id="MazeDatasetCollection.load-190"><a href="#MazeDatasetCollection.load-190"><span class="linenos">190</span></a>		<span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>load the dataset collection from the representation created by <code><a href="#MazeDatasetCollection.serialize">serialize</a></code></p>
</div>


                            </div>
                            <div id="MazeDatasetCollection.as_tokens" class="classattr">
                                        <input id="MazeDatasetCollection.as_tokens-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">as_tokens</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">maze_tokenizer</span>,</span><span class="param">	<span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">join_tokens_individual_maze</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDatasetCollection.as_tokens-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L192-L215" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDatasetCollection.as_tokens"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDatasetCollection.as_tokens-193"><a href="#MazeDatasetCollection.as_tokens-193"><span class="linenos">193</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">as_tokens</span><span class="p">(</span>
</span><span id="MazeDatasetCollection.as_tokens-194"><a href="#MazeDatasetCollection.as_tokens-194"><span class="linenos">194</span></a>		<span class="bp">self</span><span class="p">,</span>
</span><span id="MazeDatasetCollection.as_tokens-195"><a href="#MazeDatasetCollection.as_tokens-195"><span class="linenos">195</span></a>		<span class="c1"># TODO: MazeTokenizer</span>
</span><span id="MazeDatasetCollection.as_tokens-196"><a href="#MazeDatasetCollection.as_tokens-196"><span class="linenos">196</span></a>		<span class="n">maze_tokenizer</span><span class="p">,</span>  <span class="c1"># noqa: ANN001</span>
</span><span id="MazeDatasetCollection.as_tokens-197"><a href="#MazeDatasetCollection.as_tokens-197"><span class="linenos">197</span></a>		<span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="MazeDatasetCollection.as_tokens-198"><a href="#MazeDatasetCollection.as_tokens-198"><span class="linenos">198</span></a>		<span class="n">join_tokens_individual_maze</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="MazeDatasetCollection.as_tokens-199"><a href="#MazeDatasetCollection.as_tokens-199"><span class="linenos">199</span></a>	<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="MazeDatasetCollection.as_tokens-200"><a href="#MazeDatasetCollection.as_tokens-200"><span class="linenos">200</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;return the dataset as tokens</span>
</span><span id="MazeDatasetCollection.as_tokens-201"><a href="#MazeDatasetCollection.as_tokens-201"><span class="linenos">201</span></a>
</span><span id="MazeDatasetCollection.as_tokens-202"><a href="#MazeDatasetCollection.as_tokens-202"><span class="linenos">202</span></a><span class="sd">		if join_tokens_individual_maze is True, then the tokens of each maze are</span>
</span><span id="MazeDatasetCollection.as_tokens-203"><a href="#MazeDatasetCollection.as_tokens-203"><span class="linenos">203</span></a><span class="sd">		joined with a space, and the result is a list of strings.</span>
</span><span id="MazeDatasetCollection.as_tokens-204"><a href="#MazeDatasetCollection.as_tokens-204"><span class="linenos">204</span></a><span class="sd">		i.e.:</span>
</span><span id="MazeDatasetCollection.as_tokens-205"><a href="#MazeDatasetCollection.as_tokens-205"><span class="linenos">205</span></a><span class="sd">		&gt;&gt;&gt; dataset.as_tokens(join_tokens_individual_maze=False)</span>
</span><span id="MazeDatasetCollection.as_tokens-206"><a href="#MazeDatasetCollection.as_tokens-206"><span class="linenos">206</span></a><span class="sd">		[[&quot;a&quot;, &quot;b&quot;, &quot;c&quot;], [&quot;d&quot;, &quot;e&quot;, &quot;f&quot;]]</span>
</span><span id="MazeDatasetCollection.as_tokens-207"><a href="#MazeDatasetCollection.as_tokens-207"><span class="linenos">207</span></a><span class="sd">		&gt;&gt;&gt; dataset.as_tokens(join_tokens_individual_maze=True)</span>
</span><span id="MazeDatasetCollection.as_tokens-208"><a href="#MazeDatasetCollection.as_tokens-208"><span class="linenos">208</span></a><span class="sd">		[&quot;a b c&quot;, &quot;d e f&quot;]</span>
</span><span id="MazeDatasetCollection.as_tokens-209"><a href="#MazeDatasetCollection.as_tokens-209"><span class="linenos">209</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="MazeDatasetCollection.as_tokens-210"><a href="#MazeDatasetCollection.as_tokens-210"><span class="linenos">210</span></a>		<span class="n">output</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="MazeDatasetCollection.as_tokens-211"><a href="#MazeDatasetCollection.as_tokens-211"><span class="linenos">211</span></a>			<span class="n">maze</span><span class="o">.</span><span class="n">as_tokens</span><span class="p">(</span><span class="n">maze_tokenizer</span><span class="p">)</span> <span class="k">for</span> <span class="n">maze</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mazes</span><span class="p">[:</span><span class="n">limit</span><span class="p">]</span>
</span><span id="MazeDatasetCollection.as_tokens-212"><a href="#MazeDatasetCollection.as_tokens-212"><span class="linenos">212</span></a>		<span class="p">]</span>
</span><span id="MazeDatasetCollection.as_tokens-213"><a href="#MazeDatasetCollection.as_tokens-213"><span class="linenos">213</span></a>		<span class="k">if</span> <span class="n">join_tokens_individual_maze</span><span class="p">:</span>
</span><span id="MazeDatasetCollection.as_tokens-214"><a href="#MazeDatasetCollection.as_tokens-214"><span class="linenos">214</span></a>			<span class="k">return</span> <span class="p">[</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span> <span class="k">for</span> <span class="n">tokens</span> <span class="ow">in</span> <span class="n">output</span><span class="p">]</span>
</span><span id="MazeDatasetCollection.as_tokens-215"><a href="#MazeDatasetCollection.as_tokens-215"><span class="linenos">215</span></a>		<span class="k">else</span><span class="p">:</span>
</span><span id="MazeDatasetCollection.as_tokens-216"><a href="#MazeDatasetCollection.as_tokens-216"><span class="linenos">216</span></a>			<span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>return the dataset as tokens</p>

<p>if join_tokens_individual_maze is True, then the tokens of each maze are
joined with a space, and the result is a list of strings.
i.e.:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="o">.</span><span class="n">as_tokens</span><span class="p">(</span><span class="n">join_tokens_individual_maze</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[[&quot;a&quot;, &quot;b&quot;, &quot;c&quot;], [&quot;d&quot;, &quot;e&quot;, &quot;f&quot;]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="o">.</span><span class="n">as_tokens</span><span class="p">(</span><span class="n">join_tokens_individual_maze</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[&quot;a b c&quot;, &quot;d e f&quot;]</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="MazeDatasetCollection.update_self_config" class="classattr">
                                        <input id="MazeDatasetCollection.update_self_config-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_self_config</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDatasetCollection.update_self_config-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L217-L224" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDatasetCollection.update_self_config"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDatasetCollection.update_self_config-218"><a href="#MazeDatasetCollection.update_self_config-218"><span class="linenos">218</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">update_self_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeDatasetCollection.update_self_config-219"><a href="#MazeDatasetCollection.update_self_config-219"><span class="linenos">219</span></a>		<span class="s2">&quot;update the config to match the number of mazes, and update the underlying configs of each dataset&quot;</span>
</span><span id="MazeDatasetCollection.update_self_config-220"><a href="#MazeDatasetCollection.update_self_config-220"><span class="linenos">220</span></a>		<span class="c1"># TODO: why cant we set this directly? its not frozen, and it seems to work in a regular MazeDataset</span>
</span><span id="MazeDatasetCollection.update_self_config-221"><a href="#MazeDatasetCollection.update_self_config-221"><span class="linenos">221</span></a>		<span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s2">&quot;n_mazes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="MazeDatasetCollection.update_self_config-222"><a href="#MazeDatasetCollection.update_self_config-222"><span class="linenos">222</span></a>		<span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">maze_datasets</span><span class="p">:</span>
</span><span id="MazeDatasetCollection.update_self_config-223"><a href="#MazeDatasetCollection.update_self_config-223"><span class="linenos">223</span></a>			<span class="n">dataset</span><span class="o">.</span><span class="n">update_self_config</span><span class="p">()</span>
</span><span id="MazeDatasetCollection.update_self_config-224"><a href="#MazeDatasetCollection.update_self_config-224"><span class="linenos">224</span></a>
</span><span id="MazeDatasetCollection.update_self_config-225"><a href="#MazeDatasetCollection.update_self_config-225"><span class="linenos">225</span></a>		<span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">maze_dataset_configs</span> <span class="o">=</span> <span class="p">[</span><span class="n">dataset</span><span class="o">.</span><span class="n">cfg</span> <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">maze_datasets</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>update the config to match the number of mazes, and update the underlying configs of each dataset</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="dataset/dataset.html#GPTDataset">maze_dataset.dataset.dataset.GPTDataset</a></dt>
                                <dd id="MazeDatasetCollection.from_config" class="function"><a href="dataset/dataset.html#GPTDataset.from_config">from_config</a></dd>
                <dd id="MazeDatasetCollection.save" class="function"><a href="dataset/dataset.html#GPTDataset.save">save</a></dd>
                <dd id="MazeDatasetCollection.read" class="function"><a href="dataset/dataset.html#GPTDataset.read">read</a></dd>
                <dd id="MazeDatasetCollection.data_hash" class="function"><a href="dataset/dataset.html#GPTDataset.data_hash">data_hash</a></dd>
                <dd id="MazeDatasetCollection.FilterBy" class="class"><a href="dataset/dataset.html#GPTDataset.FilterBy">FilterBy</a></dd>
                <dd id="MazeDatasetCollection.filter_by" class="variable"><a href="dataset/dataset.html#GPTDataset.filter_by">filter_by</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="MazeDatasetCollectionConfig">
                            <input id="MazeDatasetCollectionConfig-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">MazeDatasetCollectionConfig</span><wbr>(<span class="base"><a href="dataset/dataset.html#GPTDatasetConfig">maze_dataset.dataset.dataset.GPTDatasetConfig</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDatasetCollectionConfig-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L30-L80" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDatasetCollectionConfig"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDatasetCollectionConfig-31"><a href="#MazeDatasetCollectionConfig-31"><span class="linenos">31</span></a><span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="MazeDatasetCollectionConfig-32"><a href="#MazeDatasetCollectionConfig-32"><span class="linenos">32</span></a><span class="k">class</span><span class="w"> </span><span class="nc">MazeDatasetCollectionConfig</span><span class="p">(</span><span class="n">GPTDatasetConfig</span><span class="p">):</span>
</span><span id="MazeDatasetCollectionConfig-33"><a href="#MazeDatasetCollectionConfig-33"><span class="linenos">33</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;maze dataset collection configuration, including tokenizers and shuffle&quot;&quot;&quot;</span>
</span><span id="MazeDatasetCollectionConfig-34"><a href="#MazeDatasetCollectionConfig-34"><span class="linenos">34</span></a>
</span><span id="MazeDatasetCollectionConfig-35"><a href="#MazeDatasetCollectionConfig-35"><span class="linenos">35</span></a>	<span class="c1"># Attributes without a default cannot follow attributes with one  [misc]</span>
</span><span id="MazeDatasetCollectionConfig-36"><a href="#MazeDatasetCollectionConfig-36"><span class="linenos">36</span></a>	<span class="n">maze_dataset_configs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">MazeDatasetConfig</span><span class="p">]</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="MazeDatasetCollectionConfig-37"><a href="#MazeDatasetCollectionConfig-37"><span class="linenos">37</span></a>		<span class="n">serialization_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">configs</span><span class="p">:</span> <span class="p">[</span><span class="n">config</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span> <span class="k">for</span> <span class="n">config</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">],</span>
</span><span id="MazeDatasetCollectionConfig-38"><a href="#MazeDatasetCollectionConfig-38"><span class="linenos">38</span></a>		<span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">data</span><span class="p">:</span> <span class="p">[</span>
</span><span id="MazeDatasetCollectionConfig-39"><a href="#MazeDatasetCollectionConfig-39"><span class="linenos">39</span></a>			<span class="n">MazeDatasetConfig</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">config</span><span class="p">)</span> <span class="k">for</span> <span class="n">config</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;maze_dataset_configs&quot;</span><span class="p">]</span>
</span><span id="MazeDatasetCollectionConfig-40"><a href="#MazeDatasetCollectionConfig-40"><span class="linenos">40</span></a>		<span class="p">],</span>
</span><span id="MazeDatasetCollectionConfig-41"><a href="#MazeDatasetCollectionConfig-41"><span class="linenos">41</span></a>	<span class="p">)</span>
</span><span id="MazeDatasetCollectionConfig-42"><a href="#MazeDatasetCollectionConfig-42"><span class="linenos">42</span></a>
</span><span id="MazeDatasetCollectionConfig-43"><a href="#MazeDatasetCollectionConfig-43"><span class="linenos">43</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="MazeDatasetCollectionConfig-44"><a href="#MazeDatasetCollectionConfig-44"><span class="linenos">44</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;return a summary of the config&quot;&quot;&quot;</span>
</span><span id="MazeDatasetCollectionConfig-45"><a href="#MazeDatasetCollectionConfig-45"><span class="linenos">45</span></a>		<span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
</span><span id="MazeDatasetCollectionConfig-46"><a href="#MazeDatasetCollectionConfig-46"><span class="linenos">46</span></a>			<span class="n">n_mazes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_mazes</span><span class="p">,</span>
</span><span id="MazeDatasetCollectionConfig-47"><a href="#MazeDatasetCollectionConfig-47"><span class="linenos">47</span></a>			<span class="n">max_grid_n</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_grid_n</span><span class="p">,</span>
</span><span id="MazeDatasetCollectionConfig-48"><a href="#MazeDatasetCollectionConfig-48"><span class="linenos">48</span></a>			<span class="n">max_grid_shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_grid_shape</span><span class="p">,</span>
</span><span id="MazeDatasetCollectionConfig-49"><a href="#MazeDatasetCollectionConfig-49"><span class="linenos">49</span></a>			<span class="n">fname</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">to_fname</span><span class="p">(),</span>
</span><span id="MazeDatasetCollectionConfig-50"><a href="#MazeDatasetCollectionConfig-50"><span class="linenos">50</span></a>			<span class="n">cfg_summaries</span><span class="o">=</span><span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">maze_dataset_configs</span><span class="p">],</span>
</span><span id="MazeDatasetCollectionConfig-51"><a href="#MazeDatasetCollectionConfig-51"><span class="linenos">51</span></a>		<span class="p">)</span>
</span><span id="MazeDatasetCollectionConfig-52"><a href="#MazeDatasetCollectionConfig-52"><span class="linenos">52</span></a>
</span><span id="MazeDatasetCollectionConfig-53"><a href="#MazeDatasetCollectionConfig-53"><span class="linenos">53</span></a>	<span class="nd">@property</span>
</span><span id="MazeDatasetCollectionConfig-54"><a href="#MazeDatasetCollectionConfig-54"><span class="linenos">54</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">n_mazes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="MazeDatasetCollectionConfig-55"><a href="#MazeDatasetCollectionConfig-55"><span class="linenos">55</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;return the total number of mazes in the collection across all dataset&quot;&quot;&quot;</span>
</span><span id="MazeDatasetCollectionConfig-56"><a href="#MazeDatasetCollectionConfig-56"><span class="linenos">56</span></a>		<span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">n_mazes</span> <span class="k">for</span> <span class="n">config</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">maze_dataset_configs</span><span class="p">)</span>
</span><span id="MazeDatasetCollectionConfig-57"><a href="#MazeDatasetCollectionConfig-57"><span class="linenos">57</span></a>
</span><span id="MazeDatasetCollectionConfig-58"><a href="#MazeDatasetCollectionConfig-58"><span class="linenos">58</span></a>	<span class="nd">@property</span>
</span><span id="MazeDatasetCollectionConfig-59"><a href="#MazeDatasetCollectionConfig-59"><span class="linenos">59</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">max_grid_n</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="MazeDatasetCollectionConfig-60"><a href="#MazeDatasetCollectionConfig-60"><span class="linenos">60</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;return the maximum grid size of the mazes in the collection&quot;&quot;&quot;</span>
</span><span id="MazeDatasetCollectionConfig-61"><a href="#MazeDatasetCollectionConfig-61"><span class="linenos">61</span></a>		<span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">grid_n</span> <span class="k">for</span> <span class="n">config</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">maze_dataset_configs</span><span class="p">)</span>
</span><span id="MazeDatasetCollectionConfig-62"><a href="#MazeDatasetCollectionConfig-62"><span class="linenos">62</span></a>
</span><span id="MazeDatasetCollectionConfig-63"><a href="#MazeDatasetCollectionConfig-63"><span class="linenos">63</span></a>	<span class="nd">@property</span>
</span><span id="MazeDatasetCollectionConfig-64"><a href="#MazeDatasetCollectionConfig-64"><span class="linenos">64</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">max_grid_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CoordTup</span><span class="p">:</span>
</span><span id="MazeDatasetCollectionConfig-65"><a href="#MazeDatasetCollectionConfig-65"><span class="linenos">65</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;return the maximum grid shape of the mazes in the collection&quot;&quot;&quot;</span>
</span><span id="MazeDatasetCollectionConfig-66"><a href="#MazeDatasetCollectionConfig-66"><span class="linenos">66</span></a>		<span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_grid_n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_grid_n</span><span class="p">)</span>
</span><span id="MazeDatasetCollectionConfig-67"><a href="#MazeDatasetCollectionConfig-67"><span class="linenos">67</span></a>
</span><span id="MazeDatasetCollectionConfig-68"><a href="#MazeDatasetCollectionConfig-68"><span class="linenos">68</span></a>	<span class="nd">@property</span>
</span><span id="MazeDatasetCollectionConfig-69"><a href="#MazeDatasetCollectionConfig-69"><span class="linenos">69</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">max_grid_shape_np</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Coord</span><span class="p">:</span>
</span><span id="MazeDatasetCollectionConfig-70"><a href="#MazeDatasetCollectionConfig-70"><span class="linenos">70</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;return the maximum grid shape of the mazes in the collection as a numpy array&quot;&quot;&quot;</span>
</span><span id="MazeDatasetCollectionConfig-71"><a href="#MazeDatasetCollectionConfig-71"><span class="linenos">71</span></a>		<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_grid_shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</span><span id="MazeDatasetCollectionConfig-72"><a href="#MazeDatasetCollectionConfig-72"><span class="linenos">72</span></a>
</span><span id="MazeDatasetCollectionConfig-73"><a href="#MazeDatasetCollectionConfig-73"><span class="linenos">73</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">stable_hash_cfg</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="MazeDatasetCollectionConfig-74"><a href="#MazeDatasetCollectionConfig-74"><span class="linenos">74</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;return a stable hash of the config&quot;&quot;&quot;</span>
</span><span id="MazeDatasetCollectionConfig-75"><a href="#MazeDatasetCollectionConfig-75"><span class="linenos">75</span></a>		<span class="k">return</span> <span class="n">stable_hash</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">()))</span>
</span><span id="MazeDatasetCollectionConfig-76"><a href="#MazeDatasetCollectionConfig-76"><span class="linenos">76</span></a>
</span><span id="MazeDatasetCollectionConfig-77"><a href="#MazeDatasetCollectionConfig-77"><span class="linenos">77</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">to_fname</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="MazeDatasetCollectionConfig-78"><a href="#MazeDatasetCollectionConfig-78"><span class="linenos">78</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;convert config to a filename&quot;&quot;&quot;</span>
</span><span id="MazeDatasetCollectionConfig-79"><a href="#MazeDatasetCollectionConfig-79"><span class="linenos">79</span></a>		<span class="k">return</span> <span class="n">sanitize_fname</span><span class="p">(</span>
</span><span id="MazeDatasetCollectionConfig-80"><a href="#MazeDatasetCollectionConfig-80"><span class="linenos">80</span></a>			<span class="sa">f</span><span class="s2">&quot;collected-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">-n</span><span class="si">{</span><span class="n">shorten_numerical_to_str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_mazes</span><span class="p">)</span><span class="si">}</span><span class="s2">-h</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">stable_hash_cfg</span><span class="p">()</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="MazeDatasetCollectionConfig-81"><a href="#MazeDatasetCollectionConfig-81"><span class="linenos">81</span></a>		<span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>maze dataset collection configuration, including tokenizers and shuffle</p>
</div>


                            <div id="MazeDatasetCollectionConfig.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">MazeDatasetCollectionConfig</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">seq_len_min</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">seq_len_max</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">512</span>,</span><span class="param">	<span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="mi">42</span>,</span><span class="param">	<span class="n">applied_filters</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">,</span> <span class="s1">&#39;kwargs&#39;</span><span class="p">],</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="nb">tuple</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">maze_dataset_configs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="#MazeDatasetConfig">MazeDatasetConfig</a></span><span class="p">]</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MazeDatasetCollectionConfig.__init__"></a>
    
    

                            </div>
                            <div id="MazeDatasetCollectionConfig.maze_dataset_configs" class="classattr">
                                <div class="attr variable">
            <span class="name">maze_dataset_configs</span><span class="annotation">: list[<a href="#MazeDatasetConfig">MazeDatasetConfig</a>]</span>

        
    </div>
    <a class="headerlink" href="#MazeDatasetCollectionConfig.maze_dataset_configs"></a>
    
    

                            </div>
                            <div id="MazeDatasetCollectionConfig.summary" class="classattr">
                                        <input id="MazeDatasetCollectionConfig.summary-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">summary</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDatasetCollectionConfig.summary-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L42-L50" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDatasetCollectionConfig.summary"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDatasetCollectionConfig.summary-43"><a href="#MazeDatasetCollectionConfig.summary-43"><span class="linenos">43</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="MazeDatasetCollectionConfig.summary-44"><a href="#MazeDatasetCollectionConfig.summary-44"><span class="linenos">44</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;return a summary of the config&quot;&quot;&quot;</span>
</span><span id="MazeDatasetCollectionConfig.summary-45"><a href="#MazeDatasetCollectionConfig.summary-45"><span class="linenos">45</span></a>		<span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
</span><span id="MazeDatasetCollectionConfig.summary-46"><a href="#MazeDatasetCollectionConfig.summary-46"><span class="linenos">46</span></a>			<span class="n">n_mazes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_mazes</span><span class="p">,</span>
</span><span id="MazeDatasetCollectionConfig.summary-47"><a href="#MazeDatasetCollectionConfig.summary-47"><span class="linenos">47</span></a>			<span class="n">max_grid_n</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_grid_n</span><span class="p">,</span>
</span><span id="MazeDatasetCollectionConfig.summary-48"><a href="#MazeDatasetCollectionConfig.summary-48"><span class="linenos">48</span></a>			<span class="n">max_grid_shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_grid_shape</span><span class="p">,</span>
</span><span id="MazeDatasetCollectionConfig.summary-49"><a href="#MazeDatasetCollectionConfig.summary-49"><span class="linenos">49</span></a>			<span class="n">fname</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">to_fname</span><span class="p">(),</span>
</span><span id="MazeDatasetCollectionConfig.summary-50"><a href="#MazeDatasetCollectionConfig.summary-50"><span class="linenos">50</span></a>			<span class="n">cfg_summaries</span><span class="o">=</span><span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">maze_dataset_configs</span><span class="p">],</span>
</span><span id="MazeDatasetCollectionConfig.summary-51"><a href="#MazeDatasetCollectionConfig.summary-51"><span class="linenos">51</span></a>		<span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>return a summary of the config</p>
</div>


                            </div>
                            <div id="MazeDatasetCollectionConfig.n_mazes" class="classattr">
                                        <input id="MazeDatasetCollectionConfig.n_mazes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">n_mazes</span><span class="annotation">: int</span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDatasetCollectionConfig.n_mazes-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L52-L55" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDatasetCollectionConfig.n_mazes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDatasetCollectionConfig.n_mazes-53"><a href="#MazeDatasetCollectionConfig.n_mazes-53"><span class="linenos">53</span></a>	<span class="nd">@property</span>
</span><span id="MazeDatasetCollectionConfig.n_mazes-54"><a href="#MazeDatasetCollectionConfig.n_mazes-54"><span class="linenos">54</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">n_mazes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="MazeDatasetCollectionConfig.n_mazes-55"><a href="#MazeDatasetCollectionConfig.n_mazes-55"><span class="linenos">55</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;return the total number of mazes in the collection across all dataset&quot;&quot;&quot;</span>
</span><span id="MazeDatasetCollectionConfig.n_mazes-56"><a href="#MazeDatasetCollectionConfig.n_mazes-56"><span class="linenos">56</span></a>		<span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">n_mazes</span> <span class="k">for</span> <span class="n">config</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">maze_dataset_configs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>return the total number of mazes in the collection across all dataset</p>
</div>


                            </div>
                            <div id="MazeDatasetCollectionConfig.max_grid_n" class="classattr">
                                        <input id="MazeDatasetCollectionConfig.max_grid_n-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">max_grid_n</span><span class="annotation">: int</span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDatasetCollectionConfig.max_grid_n-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L57-L60" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDatasetCollectionConfig.max_grid_n"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDatasetCollectionConfig.max_grid_n-58"><a href="#MazeDatasetCollectionConfig.max_grid_n-58"><span class="linenos">58</span></a>	<span class="nd">@property</span>
</span><span id="MazeDatasetCollectionConfig.max_grid_n-59"><a href="#MazeDatasetCollectionConfig.max_grid_n-59"><span class="linenos">59</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">max_grid_n</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="MazeDatasetCollectionConfig.max_grid_n-60"><a href="#MazeDatasetCollectionConfig.max_grid_n-60"><span class="linenos">60</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;return the maximum grid size of the mazes in the collection&quot;&quot;&quot;</span>
</span><span id="MazeDatasetCollectionConfig.max_grid_n-61"><a href="#MazeDatasetCollectionConfig.max_grid_n-61"><span class="linenos">61</span></a>		<span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">grid_n</span> <span class="k">for</span> <span class="n">config</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">maze_dataset_configs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>return the maximum grid size of the mazes in the collection</p>
</div>


                            </div>
                            <div id="MazeDatasetCollectionConfig.max_grid_shape" class="classattr">
                                        <input id="MazeDatasetCollectionConfig.max_grid_shape-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">max_grid_shape</span><span class="annotation">: tuple[int, int]</span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDatasetCollectionConfig.max_grid_shape-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L62-L65" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDatasetCollectionConfig.max_grid_shape"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDatasetCollectionConfig.max_grid_shape-63"><a href="#MazeDatasetCollectionConfig.max_grid_shape-63"><span class="linenos">63</span></a>	<span class="nd">@property</span>
</span><span id="MazeDatasetCollectionConfig.max_grid_shape-64"><a href="#MazeDatasetCollectionConfig.max_grid_shape-64"><span class="linenos">64</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">max_grid_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CoordTup</span><span class="p">:</span>
</span><span id="MazeDatasetCollectionConfig.max_grid_shape-65"><a href="#MazeDatasetCollectionConfig.max_grid_shape-65"><span class="linenos">65</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;return the maximum grid shape of the mazes in the collection&quot;&quot;&quot;</span>
</span><span id="MazeDatasetCollectionConfig.max_grid_shape-66"><a href="#MazeDatasetCollectionConfig.max_grid_shape-66"><span class="linenos">66</span></a>		<span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_grid_n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_grid_n</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>return the maximum grid shape of the mazes in the collection</p>
</div>


                            </div>
                            <div id="MazeDatasetCollectionConfig.max_grid_shape_np" class="classattr">
                                        <input id="MazeDatasetCollectionConfig.max_grid_shape_np-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">max_grid_shape_np</span><span class="annotation">: jaxtyping.Int8[ndarray, &#39;row_col=2&#39;]</span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDatasetCollectionConfig.max_grid_shape_np-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L67-L70" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDatasetCollectionConfig.max_grid_shape_np"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDatasetCollectionConfig.max_grid_shape_np-68"><a href="#MazeDatasetCollectionConfig.max_grid_shape_np-68"><span class="linenos">68</span></a>	<span class="nd">@property</span>
</span><span id="MazeDatasetCollectionConfig.max_grid_shape_np-69"><a href="#MazeDatasetCollectionConfig.max_grid_shape_np-69"><span class="linenos">69</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">max_grid_shape_np</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Coord</span><span class="p">:</span>
</span><span id="MazeDatasetCollectionConfig.max_grid_shape_np-70"><a href="#MazeDatasetCollectionConfig.max_grid_shape_np-70"><span class="linenos">70</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;return the maximum grid shape of the mazes in the collection as a numpy array&quot;&quot;&quot;</span>
</span><span id="MazeDatasetCollectionConfig.max_grid_shape_np-71"><a href="#MazeDatasetCollectionConfig.max_grid_shape_np-71"><span class="linenos">71</span></a>		<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_grid_shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>return the maximum grid shape of the mazes in the collection as a numpy array</p>
</div>


                            </div>
                            <div id="MazeDatasetCollectionConfig.stable_hash_cfg" class="classattr">
                                        <input id="MazeDatasetCollectionConfig.stable_hash_cfg-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">stable_hash_cfg</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">int</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDatasetCollectionConfig.stable_hash_cfg-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L72-L74" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDatasetCollectionConfig.stable_hash_cfg"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDatasetCollectionConfig.stable_hash_cfg-73"><a href="#MazeDatasetCollectionConfig.stable_hash_cfg-73"><span class="linenos">73</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">stable_hash_cfg</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="MazeDatasetCollectionConfig.stable_hash_cfg-74"><a href="#MazeDatasetCollectionConfig.stable_hash_cfg-74"><span class="linenos">74</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;return a stable hash of the config&quot;&quot;&quot;</span>
</span><span id="MazeDatasetCollectionConfig.stable_hash_cfg-75"><a href="#MazeDatasetCollectionConfig.stable_hash_cfg-75"><span class="linenos">75</span></a>		<span class="k">return</span> <span class="n">stable_hash</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">()))</span>
</span></pre></div>


            <div class="docstring"><p>return a stable hash of the config</p>
</div>


                            </div>
                            <div id="MazeDatasetCollectionConfig.to_fname" class="classattr">
                                        <input id="MazeDatasetCollectionConfig.to_fname-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_fname</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDatasetCollectionConfig.to_fname-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L76-L80" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDatasetCollectionConfig.to_fname"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDatasetCollectionConfig.to_fname-77"><a href="#MazeDatasetCollectionConfig.to_fname-77"><span class="linenos">77</span></a>	<span class="k">def</span><span class="w"> </span><span class="nf">to_fname</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="MazeDatasetCollectionConfig.to_fname-78"><a href="#MazeDatasetCollectionConfig.to_fname-78"><span class="linenos">78</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;convert config to a filename&quot;&quot;&quot;</span>
</span><span id="MazeDatasetCollectionConfig.to_fname-79"><a href="#MazeDatasetCollectionConfig.to_fname-79"><span class="linenos">79</span></a>		<span class="k">return</span> <span class="n">sanitize_fname</span><span class="p">(</span>
</span><span id="MazeDatasetCollectionConfig.to_fname-80"><a href="#MazeDatasetCollectionConfig.to_fname-80"><span class="linenos">80</span></a>			<span class="sa">f</span><span class="s2">&quot;collected-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">-n</span><span class="si">{</span><span class="n">shorten_numerical_to_str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_mazes</span><span class="p">)</span><span class="si">}</span><span class="s2">-h</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">stable_hash_cfg</span><span class="p">()</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="MazeDatasetCollectionConfig.to_fname-81"><a href="#MazeDatasetCollectionConfig.to_fname-81"><span class="linenos">81</span></a>		<span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>convert config to a filename</p>
</div>


                            </div>
                            <div id="MazeDatasetCollectionConfig.serialize" class="classattr">
                                        <input id="MazeDatasetCollectionConfig.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDatasetCollectionConfig.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L713-L769" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDatasetCollectionConfig.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDatasetCollectionConfig.serialize-714"><a href="#MazeDatasetCollectionConfig.serialize-714"><span class="linenos">714</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="MazeDatasetCollectionConfig.serialize-715"><a href="#MazeDatasetCollectionConfig.serialize-715"><span class="linenos">715</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="MazeDatasetCollectionConfig.serialize-716"><a href="#MazeDatasetCollectionConfig.serialize-716"><span class="linenos">716</span></a>                <span class="n">_FORMAT_KEY</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="MazeDatasetCollectionConfig.serialize-717"><a href="#MazeDatasetCollectionConfig.serialize-717"><span class="linenos">717</span></a>            <span class="p">}</span>
</span><span id="MazeDatasetCollectionConfig.serialize-718"><a href="#MazeDatasetCollectionConfig.serialize-718"><span class="linenos">718</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="MazeDatasetCollectionConfig.serialize-719"><a href="#MazeDatasetCollectionConfig.serialize-719"><span class="linenos">719</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="MazeDatasetCollectionConfig.serialize-720"><a href="#MazeDatasetCollectionConfig.serialize-720"><span class="linenos">720</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="MazeDatasetCollectionConfig.serialize-721"><a href="#MazeDatasetCollectionConfig.serialize-721"><span class="linenos">721</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="MazeDatasetCollectionConfig.serialize-722"><a href="#MazeDatasetCollectionConfig.serialize-722"><span class="linenos">722</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="MazeDatasetCollectionConfig.serialize-723"><a href="#MazeDatasetCollectionConfig.serialize-723"><span class="linenos">723</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="MazeDatasetCollectionConfig.serialize-724"><a href="#MazeDatasetCollectionConfig.serialize-724"><span class="linenos">724</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="MazeDatasetCollectionConfig.serialize-725"><a href="#MazeDatasetCollectionConfig.serialize-725"><span class="linenos">725</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="MazeDatasetCollectionConfig.serialize-726"><a href="#MazeDatasetCollectionConfig.serialize-726"><span class="linenos">726</span></a>                    <span class="p">)</span>
</span><span id="MazeDatasetCollectionConfig.serialize-727"><a href="#MazeDatasetCollectionConfig.serialize-727"><span class="linenos">727</span></a>
</span><span id="MazeDatasetCollectionConfig.serialize-728"><a href="#MazeDatasetCollectionConfig.serialize-728"><span class="linenos">728</span></a>                <span class="c1"># try to save it</span>
</span><span id="MazeDatasetCollectionConfig.serialize-729"><a href="#MazeDatasetCollectionConfig.serialize-729"><span class="linenos">729</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="MazeDatasetCollectionConfig.serialize-730"><a href="#MazeDatasetCollectionConfig.serialize-730"><span class="linenos">730</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="MazeDatasetCollectionConfig.serialize-731"><a href="#MazeDatasetCollectionConfig.serialize-731"><span class="linenos">731</span></a>                        <span class="c1"># get the val</span>
</span><span id="MazeDatasetCollectionConfig.serialize-732"><a href="#MazeDatasetCollectionConfig.serialize-732"><span class="linenos">732</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="MazeDatasetCollectionConfig.serialize-733"><a href="#MazeDatasetCollectionConfig.serialize-733"><span class="linenos">733</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="MazeDatasetCollectionConfig.serialize-734"><a href="#MazeDatasetCollectionConfig.serialize-734"><span class="linenos">734</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="MazeDatasetCollectionConfig.serialize-735"><a href="#MazeDatasetCollectionConfig.serialize-735"><span class="linenos">735</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="MazeDatasetCollectionConfig.serialize-736"><a href="#MazeDatasetCollectionConfig.serialize-736"><span class="linenos">736</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="MazeDatasetCollectionConfig.serialize-737"><a href="#MazeDatasetCollectionConfig.serialize-737"><span class="linenos">737</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="MazeDatasetCollectionConfig.serialize-738"><a href="#MazeDatasetCollectionConfig.serialize-738"><span class="linenos">738</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="MazeDatasetCollectionConfig.serialize-739"><a href="#MazeDatasetCollectionConfig.serialize-739"><span class="linenos">739</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="MazeDatasetCollectionConfig.serialize-740"><a href="#MazeDatasetCollectionConfig.serialize-740"><span class="linenos">740</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="MazeDatasetCollectionConfig.serialize-741"><a href="#MazeDatasetCollectionConfig.serialize-741"><span class="linenos">741</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="MazeDatasetCollectionConfig.serialize-742"><a href="#MazeDatasetCollectionConfig.serialize-742"><span class="linenos">742</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="MazeDatasetCollectionConfig.serialize-743"><a href="#MazeDatasetCollectionConfig.serialize-743"><span class="linenos">743</span></a>
</span><span id="MazeDatasetCollectionConfig.serialize-744"><a href="#MazeDatasetCollectionConfig.serialize-744"><span class="linenos">744</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="MazeDatasetCollectionConfig.serialize-745"><a href="#MazeDatasetCollectionConfig.serialize-745"><span class="linenos">745</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="MazeDatasetCollectionConfig.serialize-746"><a href="#MazeDatasetCollectionConfig.serialize-746"><span class="linenos">746</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="MazeDatasetCollectionConfig.serialize-747"><a href="#MazeDatasetCollectionConfig.serialize-747"><span class="linenos">747</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="MazeDatasetCollectionConfig.serialize-748"><a href="#MazeDatasetCollectionConfig.serialize-748"><span class="linenos">748</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="MazeDatasetCollectionConfig.serialize-749"><a href="#MazeDatasetCollectionConfig.serialize-749"><span class="linenos">749</span></a>                                <span class="p">[</span>
</span><span id="MazeDatasetCollectionConfig.serialize-750"><a href="#MazeDatasetCollectionConfig.serialize-750"><span class="linenos">750</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="MazeDatasetCollectionConfig.serialize-751"><a href="#MazeDatasetCollectionConfig.serialize-751"><span class="linenos">751</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="MazeDatasetCollectionConfig.serialize-752"><a href="#MazeDatasetCollectionConfig.serialize-752"><span class="linenos">752</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="MazeDatasetCollectionConfig.serialize-753"><a href="#MazeDatasetCollectionConfig.serialize-753"><span class="linenos">753</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="MazeDatasetCollectionConfig.serialize-754"><a href="#MazeDatasetCollectionConfig.serialize-754"><span class="linenos">754</span></a>                                <span class="p">]</span>
</span><span id="MazeDatasetCollectionConfig.serialize-755"><a href="#MazeDatasetCollectionConfig.serialize-755"><span class="linenos">755</span></a>                            <span class="p">)</span>
</span><span id="MazeDatasetCollectionConfig.serialize-756"><a href="#MazeDatasetCollectionConfig.serialize-756"><span class="linenos">756</span></a>                        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</span><span id="MazeDatasetCollectionConfig.serialize-757"><a href="#MazeDatasetCollectionConfig.serialize-757"><span class="linenos">757</span></a>
</span><span id="MazeDatasetCollectionConfig.serialize-758"><a href="#MazeDatasetCollectionConfig.serialize-758"><span class="linenos">758</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="MazeDatasetCollectionConfig.serialize-759"><a href="#MazeDatasetCollectionConfig.serialize-759"><span class="linenos">759</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="MazeDatasetCollectionConfig.serialize-760"><a href="#MazeDatasetCollectionConfig.serialize-760"><span class="linenos">760</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="MazeDatasetCollectionConfig.serialize-761"><a href="#MazeDatasetCollectionConfig.serialize-761"><span class="linenos">761</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="MazeDatasetCollectionConfig.serialize-762"><a href="#MazeDatasetCollectionConfig.serialize-762"><span class="linenos">762</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="MazeDatasetCollectionConfig.serialize-763"><a href="#MazeDatasetCollectionConfig.serialize-763"><span class="linenos">763</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="MazeDatasetCollectionConfig.serialize-764"><a href="#MazeDatasetCollectionConfig.serialize-764"><span class="linenos">764</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="MazeDatasetCollectionConfig.serialize-765"><a href="#MazeDatasetCollectionConfig.serialize-765"><span class="linenos">765</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="MazeDatasetCollectionConfig.serialize-766"><a href="#MazeDatasetCollectionConfig.serialize-766"><span class="linenos">766</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="MazeDatasetCollectionConfig.serialize-767"><a href="#MazeDatasetCollectionConfig.serialize-767"><span class="linenos">767</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="MazeDatasetCollectionConfig.serialize-768"><a href="#MazeDatasetCollectionConfig.serialize-768"><span class="linenos">768</span></a>                    <span class="p">)</span>
</span><span id="MazeDatasetCollectionConfig.serialize-769"><a href="#MazeDatasetCollectionConfig.serialize-769"><span class="linenos">769</span></a>
</span><span id="MazeDatasetCollectionConfig.serialize-770"><a href="#MazeDatasetCollectionConfig.serialize-770"><span class="linenos">770</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="MazeDatasetCollectionConfig.load" class="classattr">
                                        <input id="MazeDatasetCollectionConfig.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDatasetCollectionConfig.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L776-L862" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDatasetCollectionConfig.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDatasetCollectionConfig.load-777"><a href="#MazeDatasetCollectionConfig.load-777"><span class="linenos">777</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="MazeDatasetCollectionConfig.load-778"><a href="#MazeDatasetCollectionConfig.load-778"><span class="linenos">778</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="MazeDatasetCollectionConfig.load-779"><a href="#MazeDatasetCollectionConfig.load-779"><span class="linenos">779</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="MazeDatasetCollectionConfig.load-780"><a href="#MazeDatasetCollectionConfig.load-780"><span class="linenos">780</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="MazeDatasetCollectionConfig.load-781"><a href="#MazeDatasetCollectionConfig.load-781"><span class="linenos">781</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="MazeDatasetCollectionConfig.load-782"><a href="#MazeDatasetCollectionConfig.load-782"><span class="linenos">782</span></a>
</span><span id="MazeDatasetCollectionConfig.load-783"><a href="#MazeDatasetCollectionConfig.load-783"><span class="linenos">783</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="MazeDatasetCollectionConfig.load-784"><a href="#MazeDatasetCollectionConfig.load-784"><span class="linenos">784</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="MazeDatasetCollectionConfig.load-785"><a href="#MazeDatasetCollectionConfig.load-785"><span class="linenos">785</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="MazeDatasetCollectionConfig.load-786"><a href="#MazeDatasetCollectionConfig.load-786"><span class="linenos">786</span></a>
</span><span id="MazeDatasetCollectionConfig.load-787"><a href="#MazeDatasetCollectionConfig.load-787"><span class="linenos">787</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="MazeDatasetCollectionConfig.load-788"><a href="#MazeDatasetCollectionConfig.load-788"><span class="linenos">788</span></a>
</span><span id="MazeDatasetCollectionConfig.load-789"><a href="#MazeDatasetCollectionConfig.load-789"><span class="linenos">789</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="MazeDatasetCollectionConfig.load-790"><a href="#MazeDatasetCollectionConfig.load-790"><span class="linenos">790</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="MazeDatasetCollectionConfig.load-791"><a href="#MazeDatasetCollectionConfig.load-791"><span class="linenos">791</span></a>
</span><span id="MazeDatasetCollectionConfig.load-792"><a href="#MazeDatasetCollectionConfig.load-792"><span class="linenos">792</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="MazeDatasetCollectionConfig.load-793"><a href="#MazeDatasetCollectionConfig.load-793"><span class="linenos">793</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="MazeDatasetCollectionConfig.load-794"><a href="#MazeDatasetCollectionConfig.load-794"><span class="linenos">794</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="MazeDatasetCollectionConfig.load-795"><a href="#MazeDatasetCollectionConfig.load-795"><span class="linenos">795</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="MazeDatasetCollectionConfig.load-796"><a href="#MazeDatasetCollectionConfig.load-796"><span class="linenos">796</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="MazeDatasetCollectionConfig.load-797"><a href="#MazeDatasetCollectionConfig.load-797"><span class="linenos">797</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="MazeDatasetCollectionConfig.load-798"><a href="#MazeDatasetCollectionConfig.load-798"><span class="linenos">798</span></a>
</span><span id="MazeDatasetCollectionConfig.load-799"><a href="#MazeDatasetCollectionConfig.load-799"><span class="linenos">799</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="MazeDatasetCollectionConfig.load-800"><a href="#MazeDatasetCollectionConfig.load-800"><span class="linenos">800</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="MazeDatasetCollectionConfig.load-801"><a href="#MazeDatasetCollectionConfig.load-801"><span class="linenos">801</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="MazeDatasetCollectionConfig.load-802"><a href="#MazeDatasetCollectionConfig.load-802"><span class="linenos">802</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="MazeDatasetCollectionConfig.load-803"><a href="#MazeDatasetCollectionConfig.load-803"><span class="linenos">803</span></a>
</span><span id="MazeDatasetCollectionConfig.load-804"><a href="#MazeDatasetCollectionConfig.load-804"><span class="linenos">804</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="MazeDatasetCollectionConfig.load-805"><a href="#MazeDatasetCollectionConfig.load-805"><span class="linenos">805</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="MazeDatasetCollectionConfig.load-806"><a href="#MazeDatasetCollectionConfig.load-806"><span class="linenos">806</span></a>
</span><span id="MazeDatasetCollectionConfig.load-807"><a href="#MazeDatasetCollectionConfig.load-807"><span class="linenos">807</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="MazeDatasetCollectionConfig.load-808"><a href="#MazeDatasetCollectionConfig.load-808"><span class="linenos">808</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="MazeDatasetCollectionConfig.load-809"><a href="#MazeDatasetCollectionConfig.load-809"><span class="linenos">809</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="MazeDatasetCollectionConfig.load-810"><a href="#MazeDatasetCollectionConfig.load-810"><span class="linenos">810</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="MazeDatasetCollectionConfig.load-811"><a href="#MazeDatasetCollectionConfig.load-811"><span class="linenos">811</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="MazeDatasetCollectionConfig.load-812"><a href="#MazeDatasetCollectionConfig.load-812"><span class="linenos">812</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="MazeDatasetCollectionConfig.load-813"><a href="#MazeDatasetCollectionConfig.load-813"><span class="linenos">813</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="MazeDatasetCollectionConfig.load-814"><a href="#MazeDatasetCollectionConfig.load-814"><span class="linenos">814</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="MazeDatasetCollectionConfig.load-815"><a href="#MazeDatasetCollectionConfig.load-815"><span class="linenos">815</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="MazeDatasetCollectionConfig.load-816"><a href="#MazeDatasetCollectionConfig.load-816"><span class="linenos">816</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="MazeDatasetCollectionConfig.load-817"><a href="#MazeDatasetCollectionConfig.load-817"><span class="linenos">817</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="MazeDatasetCollectionConfig.load-818"><a href="#MazeDatasetCollectionConfig.load-818"><span class="linenos">818</span></a>                    <span class="p">):</span>
</span><span id="MazeDatasetCollectionConfig.load-819"><a href="#MazeDatasetCollectionConfig.load-819"><span class="linenos">819</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="MazeDatasetCollectionConfig.load-820"><a href="#MazeDatasetCollectionConfig.load-820"><span class="linenos">820</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="MazeDatasetCollectionConfig.load-821"><a href="#MazeDatasetCollectionConfig.load-821"><span class="linenos">821</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="MazeDatasetCollectionConfig.load-822"><a href="#MazeDatasetCollectionConfig.load-822"><span class="linenos">822</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="MazeDatasetCollectionConfig.load-823"><a href="#MazeDatasetCollectionConfig.load-823"><span class="linenos">823</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="MazeDatasetCollectionConfig.load-824"><a href="#MazeDatasetCollectionConfig.load-824"><span class="linenos">824</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="MazeDatasetCollectionConfig.load-825"><a href="#MazeDatasetCollectionConfig.load-825"><span class="linenos">825</span></a>                            <span class="p">)</span>
</span><span id="MazeDatasetCollectionConfig.load-826"><a href="#MazeDatasetCollectionConfig.load-826"><span class="linenos">826</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="MazeDatasetCollectionConfig.load-827"><a href="#MazeDatasetCollectionConfig.load-827"><span class="linenos">827</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="MazeDatasetCollectionConfig.load-828"><a href="#MazeDatasetCollectionConfig.load-828"><span class="linenos">828</span></a>                        <span class="k">pass</span>
</span><span id="MazeDatasetCollectionConfig.load-829"><a href="#MazeDatasetCollectionConfig.load-829"><span class="linenos">829</span></a>
</span><span id="MazeDatasetCollectionConfig.load-830"><a href="#MazeDatasetCollectionConfig.load-830"><span class="linenos">830</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="MazeDatasetCollectionConfig.load-831"><a href="#MazeDatasetCollectionConfig.load-831"><span class="linenos">831</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="MazeDatasetCollectionConfig.load-832"><a href="#MazeDatasetCollectionConfig.load-832"><span class="linenos">832</span></a>
</span><span id="MazeDatasetCollectionConfig.load-833"><a href="#MazeDatasetCollectionConfig.load-833"><span class="linenos">833</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="MazeDatasetCollectionConfig.load-834"><a href="#MazeDatasetCollectionConfig.load-834"><span class="linenos">834</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="MazeDatasetCollectionConfig.load-835"><a href="#MazeDatasetCollectionConfig.load-835"><span class="linenos">835</span></a>
</span><span id="MazeDatasetCollectionConfig.load-836"><a href="#MazeDatasetCollectionConfig.load-836"><span class="linenos">836</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="MazeDatasetCollectionConfig.load-837"><a href="#MazeDatasetCollectionConfig.load-837"><span class="linenos">837</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="MazeDatasetCollectionConfig.load-838"><a href="#MazeDatasetCollectionConfig.load-838"><span class="linenos">838</span></a>                <span class="n">fields_valid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="MazeDatasetCollectionConfig.load-839"><a href="#MazeDatasetCollectionConfig.load-839"><span class="linenos">839</span></a>                    <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="MazeDatasetCollectionConfig.load-840"><a href="#MazeDatasetCollectionConfig.load-840"><span class="linenos">840</span></a>                        <span class="n">output</span><span class="p">,</span>
</span><span id="MazeDatasetCollectionConfig.load-841"><a href="#MazeDatasetCollectionConfig.load-841"><span class="linenos">841</span></a>                        <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">,</span>
</span><span id="MazeDatasetCollectionConfig.load-842"><a href="#MazeDatasetCollectionConfig.load-842"><span class="linenos">842</span></a>                    <span class="p">)</span>
</span><span id="MazeDatasetCollectionConfig.load-843"><a href="#MazeDatasetCollectionConfig.load-843"><span class="linenos">843</span></a>                <span class="p">)</span>
</span><span id="MazeDatasetCollectionConfig.load-844"><a href="#MazeDatasetCollectionConfig.load-844"><span class="linenos">844</span></a>
</span><span id="MazeDatasetCollectionConfig.load-845"><a href="#MazeDatasetCollectionConfig.load-845"><span class="linenos">845</span></a>                <span class="c1"># if there are any fields that are not valid, raise an error</span>
</span><span id="MazeDatasetCollectionConfig.load-846"><a href="#MazeDatasetCollectionConfig.load-846"><span class="linenos">846</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">fields_valid</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="MazeDatasetCollectionConfig.load-847"><a href="#MazeDatasetCollectionConfig.load-847"><span class="linenos">847</span></a>                    <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="MazeDatasetCollectionConfig.load-848"><a href="#MazeDatasetCollectionConfig.load-848"><span class="linenos">848</span></a>                        <span class="sa">f</span><span class="s2">&quot;Type mismatch in fields of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="MazeDatasetCollectionConfig.load-849"><a href="#MazeDatasetCollectionConfig.load-849"><span class="linenos">849</span></a>                        <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="MazeDatasetCollectionConfig.load-850"><a href="#MazeDatasetCollectionConfig.load-850"><span class="linenos">850</span></a>                            <span class="p">[</span>
</span><span id="MazeDatasetCollectionConfig.load-851"><a href="#MazeDatasetCollectionConfig.load-851"><span class="linenos">851</span></a>                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">:</span><span class="se">\t</span><span class="s2">expected </span><span class="si">{</span><span class="n">cls_type_hints</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="si">= }</span><span class="s2">, but got value </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="MazeDatasetCollectionConfig.load-852"><a href="#MazeDatasetCollectionConfig.load-852"><span class="linenos">852</span></a>                                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">fields_valid</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="MazeDatasetCollectionConfig.load-853"><a href="#MazeDatasetCollectionConfig.load-853"><span class="linenos">853</span></a>                                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span>
</span><span id="MazeDatasetCollectionConfig.load-854"><a href="#MazeDatasetCollectionConfig.load-854"><span class="linenos">854</span></a>                            <span class="p">]</span>
</span><span id="MazeDatasetCollectionConfig.load-855"><a href="#MazeDatasetCollectionConfig.load-855"><span class="linenos">855</span></a>                        <span class="p">)</span>
</span><span id="MazeDatasetCollectionConfig.load-856"><a href="#MazeDatasetCollectionConfig.load-856"><span class="linenos">856</span></a>                    <span class="p">)</span>
</span><span id="MazeDatasetCollectionConfig.load-857"><a href="#MazeDatasetCollectionConfig.load-857"><span class="linenos">857</span></a>
</span><span id="MazeDatasetCollectionConfig.load-858"><a href="#MazeDatasetCollectionConfig.load-858"><span class="linenos">858</span></a>                    <span class="n">on_typecheck_mismatch</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
</span><span id="MazeDatasetCollectionConfig.load-859"><a href="#MazeDatasetCollectionConfig.load-859"><span class="linenos">859</span></a>                        <span class="n">msg</span><span class="p">,</span> <span class="n">except_cls</span><span class="o">=</span><span class="n">FieldTypeMismatchError</span>
</span><span id="MazeDatasetCollectionConfig.load-860"><a href="#MazeDatasetCollectionConfig.load-860"><span class="linenos">860</span></a>                    <span class="p">)</span>
</span><span id="MazeDatasetCollectionConfig.load-861"><a href="#MazeDatasetCollectionConfig.load-861"><span class="linenos">861</span></a>
</span><span id="MazeDatasetCollectionConfig.load-862"><a href="#MazeDatasetCollectionConfig.load-862"><span class="linenos">862</span></a>            <span class="c1"># return the new instance</span>
</span><span id="MazeDatasetCollectionConfig.load-863"><a href="#MazeDatasetCollectionConfig.load-863"><span class="linenos">863</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>The type of the None singleton.</p>
</div>


                            </div>
                            <div id="MazeDatasetCollectionConfig.validate_fields_types" class="classattr">
                                        <input id="MazeDatasetCollectionConfig.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeDatasetCollectionConfig.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/dataset.py#L282-L291" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeDatasetCollectionConfig.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeDatasetCollectionConfig.validate_fields_types-283"><a href="#MazeDatasetCollectionConfig.validate_fields_types-283"><span class="linenos">283</span></a><span class="k">def</span><span class="w"> </span><span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="MazeDatasetCollectionConfig.validate_fields_types-284"><a href="#MazeDatasetCollectionConfig.validate_fields_types-284"><span class="linenos">284</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="MazeDatasetCollectionConfig.validate_fields_types-285"><a href="#MazeDatasetCollectionConfig.validate_fields_types-285"><span class="linenos">285</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="MazeDatasetCollectionConfig.validate_fields_types-286"><a href="#MazeDatasetCollectionConfig.validate_fields_types-286"><span class="linenos">286</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="MazeDatasetCollectionConfig.validate_fields_types-287"><a href="#MazeDatasetCollectionConfig.validate_fields_types-287"><span class="linenos">287</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="MazeDatasetCollectionConfig.validate_fields_types-288"><a href="#MazeDatasetCollectionConfig.validate_fields_types-288"><span class="linenos">288</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="MazeDatasetCollectionConfig.validate_fields_types-289"><a href="#MazeDatasetCollectionConfig.validate_fields_types-289"><span class="linenos">289</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="MazeDatasetCollectionConfig.validate_fields_types-290"><a href="#MazeDatasetCollectionConfig.validate_fields_types-290"><span class="linenos">290</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="MazeDatasetCollectionConfig.validate_fields_types-291"><a href="#MazeDatasetCollectionConfig.validate_fields_types-291"><span class="linenos">291</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="MazeDatasetCollectionConfig.validate_fields_types-292"><a href="#MazeDatasetCollectionConfig.validate_fields_types-292"><span class="linenos">292</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="dataset/dataset.html#GPTDatasetConfig">maze_dataset.dataset.dataset.GPTDatasetConfig</a></dt>
                                <dd id="MazeDatasetCollectionConfig.name" class="variable"><a href="dataset/dataset.html#GPTDatasetConfig.name">name</a></dd>
                <dd id="MazeDatasetCollectionConfig.seq_len_min" class="variable"><a href="dataset/dataset.html#GPTDatasetConfig.seq_len_min">seq_len_min</a></dd>
                <dd id="MazeDatasetCollectionConfig.seq_len_max" class="variable"><a href="dataset/dataset.html#GPTDatasetConfig.seq_len_max">seq_len_max</a></dd>
                <dd id="MazeDatasetCollectionConfig.seed" class="variable"><a href="dataset/dataset.html#GPTDatasetConfig.seed">seed</a></dd>
                <dd id="MazeDatasetCollectionConfig.applied_filters" class="variable"><a href="dataset/dataset.html#GPTDatasetConfig.applied_filters">applied_filters</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="MazeDatasetCollectionConfig.validate_field_type" class="function">validate_field_type</dd>
                <dd id="MazeDatasetCollectionConfig.diff" class="function">diff</dd>
                <dd id="MazeDatasetCollectionConfig.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>