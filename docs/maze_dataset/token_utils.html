<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.4"/>
    <title>maze_dataset.token_utils API documentation</title>
    <link rel="icon" href="../resources/favicon.png"/>
<link rel="stylesheet" href="../resources/css/bootstrap-reboot.min.css"><link rel="stylesheet" href="../resources/css/syntax-highlighting.css"><link rel="stylesheet" href="../resources/css/theme.css"><link rel="stylesheet" href="../resources/css/layout.css"><link rel="stylesheet" href="../resources/css/content.css"><link rel="stylesheet" href="../resources/css/custom.css"><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
        overflow-y: hidden;
    }
</style><style>
    .pdoc .mermaid-pre {
        border: none;
        background: none;
    }
</style>
<script type="module" defer>
    import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs";

    /* Re-invoke Mermaid when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => mermaid.run()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script></head>
<body>
<div class="package-version">
    docs for <a href="https://github.com/understanding-search/maze-dataset">maze-dataset</a> v1.4.0<br>
</div>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button">
            <img src="../resources/svg/navtoggle.svg" alt="Toggle navigation"> 
        </label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../maze_dataset.html">
                <img src="../resources/svg/box-arrow-in-left.svg" alt="Back to parent module"/>
                &nbsp;maze_dataset</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="function" href="#remove_padding_from_token_str">remove_padding_from_token_str</a>
            </li>
            <li>
                    <a class="function" href="#tokens_between">tokens_between</a>
            </li>
            <li>
                    <a class="function" href="#get_adj_list_tokens">get_adj_list_tokens</a>
            </li>
            <li>
                    <a class="function" href="#get_path_tokens">get_path_tokens</a>
            </li>
            <li>
                    <a class="function" href="#get_context_tokens">get_context_tokens</a>
            </li>
            <li>
                    <a class="function" href="#get_origin_tokens">get_origin_tokens</a>
            </li>
            <li>
                    <a class="function" href="#get_target_tokens">get_target_tokens</a>
            </li>
            <li>
                    <a class="function" href="#get_cardinal_direction">get_cardinal_direction</a>
            </li>
            <li>
                    <a class="function" href="#get_relative_direction">get_relative_direction</a>
            </li>
            <li>
                    <a class="class" href="#TokenizerPendingDeprecationWarning">TokenizerPendingDeprecationWarning</a>
                            <ul class="memberlist">
                </ul>

            </li>
            <li>
                    <a class="function" href="#str_is_coord">str_is_coord</a>
            </li>
            <li>
                    <a class="class" href="#TokenizerDeprecationWarning">TokenizerDeprecationWarning</a>
                            <ul class="memberlist">
                </ul>

            </li>
            <li>
                    <a class="function" href="#coord_str_to_tuple">coord_str_to_tuple</a>
            </li>
            <li>
                    <a class="function" href="#coord_str_to_coord_np">coord_str_to_coord_np</a>
            </li>
            <li>
                    <a class="function" href="#coord_str_to_tuple_noneable">coord_str_to_tuple_noneable</a>
            </li>
            <li>
                    <a class="function" href="#coords_string_split_UT">coords_string_split_UT</a>
            </li>
            <li>
                    <a class="function" href="#strings_to_coords">strings_to_coords</a>
            </li>
            <li>
                    <a class="function" href="#coords_to_strings">coords_to_strings</a>
            </li>
            <li>
                    <a class="function" href="#get_token_regions">get_token_regions</a>
            </li>
            <li>
                    <a class="function" href="#equal_except_adj_list_sequence">equal_except_adj_list_sequence</a>
            </li>
            <li>
                    <a class="function" href="#connection_list_to_adj_list">connection_list_to_adj_list</a>
            </li>
            <li>
                    <a class="function" href="#is_connection">is_connection</a>
            </li>
    </ul>


    <hr/>
    
    <div>
        <a href="../coverage/html/index.html" class="pdoc-button" title="View test coverage report">
            Coverage
        </a>
        <a href="../other/todo-inline.html" class="pdoc-button" title="Table of TODOs scraped from source code, with links to create issues from them">
            TODOs
        </a>
        <a href="../other/lmcat.txt" class="pdoc-button" title="a view of the repo contents made for LLMs, using https://miv.name/lmcat">
            lmcat
        </a>
    </div>


        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span>
            <img src="../resources/svg/pdoc-logo.svg" alt="pdoc logo"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                        <a class="pdoc-button git-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/token_utils.py">View Source on GitHub</a>
                    <h1 class="modulename">
<a href="./../maze_dataset.html">maze_dataset</a><wbr>.token_utils    </h1>

                        <div class="docstring"><p>a whole bunch of utilities for tokenization</p>
</div>

                        <input id="mod-token_utils-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="mod-token_utils-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/token_utils.py#L0-L539" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

                <br/>
                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sd">&quot;&quot;&quot;a whole bunch of utilities for tokenization&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">typing</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Literal</span><span class="p">,</span> <span class="n">overload</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">jaxtyping</span><span class="w"> </span><span class="kn">import</span> <span class="n">Bool</span><span class="p">,</span> <span class="n">Float</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span> <span class="n">Int8</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">muutils.errormode</span><span class="w"> </span><span class="kn">import</span> <span class="n">ErrorMode</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">muutils.misc</span><span class="w"> </span><span class="kn">import</span> <span class="n">list_join</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">muutils.misc.sequence</span><span class="w"> </span><span class="kn">import</span> <span class="n">WhenMissing</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">maze_dataset.constants</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a>	<span class="n">CARDINAL_MAP</span><span class="p">,</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a>	<span class="n">SPECIAL_TOKENS</span><span class="p">,</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a>	<span class="n">VOCAB</span><span class="p">,</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a>	<span class="n">ConnectionArray</span><span class="p">,</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>	<span class="n">ConnectionList</span><span class="p">,</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a>	<span class="n">CoordTup</span><span class="p">,</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="p">)</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="c1"># filtering things from a prompt or generated text</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="c1"># ==================================================</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="k">def</span><span class="w"> </span><span class="nf">remove_padding_from_token_str</span><span class="p">(</span><span class="n">token_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;remove padding tokens from a joined token string&quot;&quot;&quot;</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a>	<span class="n">token_str</span> <span class="o">=</span> <span class="n">token_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">PADDING</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a>	<span class="n">token_str</span> <span class="o">=</span> <span class="n">token_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">PADDING</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a>	<span class="k">return</span> <span class="n">token_str</span>  <span class="c1"># noqa: RET504</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="k">def</span><span class="w"> </span><span class="nf">tokens_between</span><span class="p">(</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>	<span class="n">tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>	<span class="n">start_value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>	<span class="n">end_value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a>	<span class="n">include_start</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>	<span class="n">include_end</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>	<span class="n">except_when_tokens_not_unique</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;given a list `tokens`, get the tokens between `start_value` and `end_value`</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="sd">	_extended_summary_</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="sd">	# Parameters:</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="sd">	- `tokens : list[str]`</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="sd">	- `start_value : str`</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="sd">	- `end_value : str`</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="sd">	- `include_start : bool`</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a><span class="sd">		(defaults to `False`)</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="sd">	- `include_end : bool`</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="sd">		(defaults to `False`)</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a><span class="sd">	- `except_when_tokens_not_unique : bool`</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="sd">		when `True`, raise an error if `start_value` or `end_value` are not unique in the input tokens</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a><span class="sd">		(defaults to `False`)</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="sd">	# Returns:</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="sd">	- `list[str]`</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="sd">	# Raises:</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="sd">	- `ValueError` : if `start_value` and `end_value` are the same</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="sd">	- `ValueError` : if `except_when_tokens_not_unique` is `True` and `start_value` or `end_value` are not unique in the input tokens</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">	- `ValueError` : if `start_value` or `end_value` are not present in the input tokens</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>	<span class="k">if</span> <span class="n">start_value</span> <span class="o">==</span> <span class="n">end_value</span><span class="p">:</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>		<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;start_value and end_value cannot be the same: </span><span class="si">{</span><span class="n">start_value</span><span class="w"> </span><span class="si">= }</span><span class="s2"> </span><span class="si">{</span><span class="n">end_value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>			<span class="n">err_msg</span><span class="p">,</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>		<span class="p">)</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>	<span class="k">if</span> <span class="n">except_when_tokens_not_unique</span><span class="p">:</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>		<span class="k">if</span> <span class="p">(</span><span class="n">tokens</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">start_value</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">tokens</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">end_value</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>			<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>				<span class="s2">&quot;start_value or end_value is not unique in the input tokens:&quot;</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>				<span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">tokens</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">start_value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> </span><span class="si">{</span><span class="n">tokens</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">end_value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>				<span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">start_value</span><span class="w"> </span><span class="si">= }</span><span class="s2"> </span><span class="si">{</span><span class="n">end_value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>				<span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">tokens</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>			<span class="p">)</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>			<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>	<span class="k">else</span><span class="p">:</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>		<span class="k">if</span> <span class="p">(</span><span class="n">tokens</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">start_value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">tokens</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">end_value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>			<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>				<span class="s2">&quot;start_value or end_value is not present in the input tokens:&quot;</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>				<span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">tokens</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">start_value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> </span><span class="si">{</span><span class="n">tokens</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">end_value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>				<span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">start_value</span><span class="w"> </span><span class="si">= }</span><span class="s2"> </span><span class="si">{</span><span class="n">end_value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>				<span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">tokens</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>			<span class="p">)</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>			<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>	<span class="n">start_idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">tokens</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">start_value</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="ow">not</span> <span class="n">include_start</span><span class="p">)</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>	<span class="n">end_idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">tokens</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">end_value</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">include_end</span><span class="p">)</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>	<span class="k">assert</span> <span class="n">start_idx</span> <span class="o">&lt;</span> <span class="n">end_idx</span><span class="p">,</span> <span class="s2">&quot;Start must come before end&quot;</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>	<span class="k">return</span> <span class="n">tokens</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span><span class="n">end_idx</span><span class="p">]</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_adj_list_tokens</span><span class="p">(</span><span class="n">tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>	<span class="s2">&quot;get tokens between ADJLIST_START and ADJLIST_END, without the special tokens themselves&quot;</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>	<span class="k">return</span> <span class="n">tokens_between</span><span class="p">(</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>		<span class="n">tokens</span><span class="p">,</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>		<span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">ADJLIST_START</span><span class="p">,</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>		<span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">ADJLIST_END</span><span class="p">,</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>	<span class="p">)</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_path_tokens</span><span class="p">(</span><span class="n">tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">trim_end</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;The path is considered everything from the first path coord to the path_end token, if it exists.&quot;&quot;&quot;</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>	<span class="k">if</span> <span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">PATH_START</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">:</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>		<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Path start token </span><span class="si">{</span><span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">PATH_START</span><span class="si">}</span><span class="s2"> not found in tokens:</span><span class="se">\n</span><span class="si">{</span><span class="n">tokens</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>			<span class="n">err_msg</span><span class="p">,</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>		<span class="p">)</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>	<span class="n">start_idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">tokens</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">PATH_START</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">trim_end</span><span class="p">)</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>	<span class="n">end_idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>	<span class="k">if</span> <span class="n">trim_end</span> <span class="ow">and</span> <span class="p">(</span><span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">PATH_END</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">):</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>		<span class="n">end_idx</span> <span class="o">=</span> <span class="n">tokens</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">PATH_END</span><span class="p">)</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>	<span class="k">return</span> <span class="n">tokens</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span><span class="n">end_idx</span><span class="p">]</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_context_tokens</span><span class="p">(</span><span class="n">tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>	<span class="s2">&quot;get tokens between ADJLIST_START and PATH_START&quot;</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>	<span class="k">return</span> <span class="n">tokens_between</span><span class="p">(</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>		<span class="n">tokens</span><span class="p">,</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>		<span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">ADJLIST_START</span><span class="p">,</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>		<span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">PATH_START</span><span class="p">,</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>		<span class="n">include_start</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>		<span class="n">include_end</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>	<span class="p">)</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_origin_tokens</span><span class="p">(</span><span class="n">tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>	<span class="s2">&quot;get tokens_between ORIGIN_START and ORIGIN_END&quot;</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>	<span class="k">return</span> <span class="n">tokens_between</span><span class="p">(</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>		<span class="n">tokens</span><span class="p">,</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>		<span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">ORIGIN_START</span><span class="p">,</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>		<span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">ORIGIN_END</span><span class="p">,</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>		<span class="n">include_start</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>		<span class="n">include_end</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>	<span class="p">)</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_target_tokens</span><span class="p">(</span><span class="n">tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>	<span class="s2">&quot;get tokens_between TARGET_START and TARGET_END&quot;</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>	<span class="k">return</span> <span class="n">tokens_between</span><span class="p">(</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>		<span class="n">tokens</span><span class="p">,</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>		<span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">TARGET_START</span><span class="p">,</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>		<span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">TARGET_END</span><span class="p">,</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>		<span class="n">include_start</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>		<span class="n">include_end</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>	<span class="p">)</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_cardinal_direction</span><span class="p">(</span><span class="n">coords</span><span class="p">:</span> <span class="n">Int</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;start_end=2 row_col=2&quot;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Returns the cardinal direction token corresponding to traveling from `coords[0]` to `coords[1]`.&quot;&quot;&quot;</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>	<span class="k">return</span> <span class="n">CARDINAL_MAP</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_relative_direction</span><span class="p">(</span><span class="n">coords</span><span class="p">:</span> <span class="n">Int</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;prev_cur_next=3 row_col=2&quot;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Returns the relative first-person direction token corresponding to traveling from `coords[1]` to `coords[2]`.</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a><span class="sd">	# Parameters</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a><span class="sd">	- `coords`: Contains 3 Coords, each of which must neighbor the previous Coord.</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a><span class="sd">		- `coords[0]`: The previous location, used to determine the current absolute direction that the &quot;agent&quot; is facing.</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a><span class="sd">		- `coords[1]`: The current location</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a><span class="sd">		- `coords[2]`: The next location. May be equal to the current location.</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>	<span class="k">if</span> <span class="n">coords</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>		<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;`coords` must have shape (3,2). Got </span><span class="si">{</span><span class="n">coords</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> instead.&quot;</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>	<span class="n">directions</span> <span class="o">=</span> <span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">coords</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>	<span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">directions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">])):</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>		<span class="c1"># Use floats as constant since `np.linalg.norm` returns float array</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>		<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Adjacent `coords` must be neighboring or equivalent. Got </span><span class="si">{</span><span class="n">coords</span><span class="si">}</span><span class="s2"> instead.&quot;</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>			<span class="n">err_msg</span><span class="p">,</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>		<span class="p">)</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>	<span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>		<span class="k">return</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_STAY</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>	<span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>		<span class="k">return</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_BACKWARD</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>	<span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>		<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Previous first-person direction indeterminate from </span><span class="si">{</span><span class="n">coords</span><span class="si">=}</span><span class="s2">.&quot;</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>			<span class="n">err_msg</span><span class="p">,</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>		<span class="p">)</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>	<span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">directions</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">directions</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>		<span class="k">return</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_FORWARD</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>	<span class="n">directions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>		<span class="n">directions</span><span class="p">,</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>		<span class="p">[[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>		<span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>	<span class="p">)</span>  <span class="c1"># Augment to represent unit basis vectors in 3D</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>	<span class="k">match</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">directions</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">directions</span><span class="p">[</span><span class="mi">1</span><span class="p">])[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>		<span class="k">case</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>			<span class="k">return</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_LEFT</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>		<span class="k">case</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>			<span class="k">return</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_RIGHT</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a><span class="k">class</span><span class="w"> </span><span class="nc">TokenizerPendingDeprecationWarning</span><span class="p">(</span><span class="ne">PendingDeprecationWarning</span><span class="p">):</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Pending deprecation warnings related to the `MazeTokenizerModular` upgrade.&quot;&quot;&quot;</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>	<span class="k">pass</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a><span class="k">def</span><span class="w"> </span><span class="nf">str_is_coord</span><span class="p">(</span><span class="n">coord_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">allow_whitespace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;return True if the string represents a coordinate, False otherwise&quot;&quot;&quot;</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>	<span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>		<span class="s2">&quot;`util.str_is_coord` only supports legacy UT strings. Function will be replaced with a generalized version in a future release.&quot;</span><span class="p">,</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>		<span class="n">TokenizerPendingDeprecationWarning</span><span class="p">,</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>	<span class="p">)</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>	<span class="n">strip_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="n">allow_whitespace</span> <span class="k">else</span> <span class="n">x</span>  <span class="c1"># noqa: E731</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>	<span class="n">coord_str</span> <span class="o">=</span> <span class="n">strip_func</span><span class="p">(</span><span class="n">coord_str</span><span class="p">)</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>	<span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>		<span class="p">[</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>			<span class="n">coord_str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">),</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>			<span class="n">coord_str</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">),</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>			<span class="s2">&quot;,&quot;</span> <span class="ow">in</span> <span class="n">coord_str</span><span class="p">,</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>			<span class="nb">all</span><span class="p">(</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>				<span class="n">strip_func</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>				<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">strip_func</span><span class="p">(</span><span class="n">coord_str</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>			<span class="p">),</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>		<span class="p">],</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>	<span class="p">)</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a><span class="k">class</span><span class="w"> </span><span class="nc">TokenizerDeprecationWarning</span><span class="p">(</span><span class="ne">DeprecationWarning</span><span class="p">):</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Deprecation warnings related to the `MazeTokenizerModular` upgrade.&quot;&quot;&quot;</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>	<span class="k">pass</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a><span class="c1"># coordinate to strings</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a><span class="c1"># ==================================================</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a><span class="k">def</span><span class="w"> </span><span class="nf">_coord_to_strings_UT</span><span class="p">(</span><span class="n">coord</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;convert a coordinate to a string: `(i,j)`-&gt;&quot;(i,j)&quot;</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a><span class="sd">	always returns a list of length 1</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>	<span class="k">return</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">coord</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">]</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a><span class="k">def</span><span class="w"> </span><span class="nf">_coord_to_strings_indexed</span><span class="p">(</span><span class="n">coord</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;convert a coordinate to a list of indexed strings: `(i,j)`-&gt;&quot;(&quot;, &quot;i&quot;, &quot;,&quot;, &quot;j&quot;, &quot;)&quot;</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a><span class="sd">	always returns a list of length 5</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>	<span class="k">return</span> <span class="p">[</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>		<span class="s2">&quot;(&quot;</span><span class="p">,</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>		<span class="o">*</span><span class="n">list_join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">coord</span><span class="p">],</span> <span class="k">lambda</span><span class="p">:</span> <span class="s2">&quot;,&quot;</span><span class="p">),</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>		<span class="s2">&quot;)&quot;</span><span class="p">,</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>	<span class="p">]</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a><span class="k">def</span><span class="w"> </span><span class="nf">coord_str_to_tuple</span><span class="p">(</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>	<span class="n">coord_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>	<span class="n">allow_whitespace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;convert a coordinate string to a tuple&quot;&quot;&quot;</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>	<span class="n">strip_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="n">allow_whitespace</span> <span class="k">else</span> <span class="n">x</span>  <span class="c1"># noqa: E731</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>	<span class="n">coord_str</span> <span class="o">=</span> <span class="n">strip_func</span><span class="p">(</span><span class="n">coord_str</span><span class="p">)</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>	<span class="n">stripped</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">strip_func</span><span class="p">(</span><span class="n">coord_str</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">))</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>	<span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">strip_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">stripped</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">))</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a><span class="k">def</span><span class="w"> </span><span class="nf">coord_str_to_coord_np</span><span class="p">(</span><span class="n">coord_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">allow_whitespace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;convert a coordinate string to a numpy array&quot;&quot;&quot;</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>	<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_str_to_tuple</span><span class="p">(</span><span class="n">coord_str</span><span class="p">,</span> <span class="n">allow_whitespace</span><span class="o">=</span><span class="n">allow_whitespace</span><span class="p">))</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a><span class="k">def</span><span class="w"> </span><span class="nf">coord_str_to_tuple_noneable</span><span class="p">(</span><span class="n">coord_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CoordTup</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;convert a coordinate string to a tuple, or None if the string is not a coordinate string&quot;&quot;&quot;</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>	<span class="k">if</span> <span class="ow">not</span> <span class="n">str_is_coord</span><span class="p">(</span><span class="n">coord_str</span><span class="p">):</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>		<span class="k">return</span> <span class="kc">None</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>	<span class="k">return</span> <span class="n">coord_str_to_tuple</span><span class="p">(</span><span class="n">coord_str</span><span class="p">)</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a><span class="k">def</span><span class="w"> </span><span class="nf">coords_string_split_UT</span><span class="p">(</span><span class="n">coords</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Splits a string of tokens into a list containing the UT tokens for each coordinate.</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a><span class="sd">	Not capable of producing indexed tokens (&quot;(&quot;, &quot;1&quot;, &quot;,&quot;, &quot;2&quot;, &quot;)&quot;), only unique tokens (&quot;(1,2)&quot;).</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a><span class="sd">	Non-whitespace portions of the input string not matched are preserved in the same list:</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a><span class="sd">	&quot;(1,2) &lt;SPECIAL_TOKEN&gt; (5,6)&quot; -&gt; [&quot;(1,2)&quot;, &quot;&lt;SPECIAL_TOKEN&gt;&quot;, &quot;(5,6)&quot;]</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>	<span class="c1"># ty gpt4</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>	<span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\([^)]*\)|\S+&quot;</span><span class="p">,</span> <span class="n">coords</span><span class="p">)</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a><span class="c1"># back and forth in wrapped form</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a><span class="c1"># ==================================================</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a><span class="nd">@overload</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a><span class="k">def</span><span class="w"> </span><span class="nf">strings_to_coords</span><span class="p">(</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>	<span class="n">text</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>	<span class="n">when_noncoord</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;skip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;skip&quot;</span><span class="p">,</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">CoordTup</span><span class="p">]:</span> <span class="o">...</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a><span class="nd">@overload</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a><span class="k">def</span><span class="w"> </span><span class="nf">strings_to_coords</span><span class="p">(</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>	<span class="n">text</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>	<span class="n">when_noncoord</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">CoordTup</span><span class="p">]:</span> <span class="o">...</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a><span class="nd">@overload</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a><span class="k">def</span><span class="w"> </span><span class="nf">strings_to_coords</span><span class="p">(</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>	<span class="n">text</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>	<span class="n">when_noncoord</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;include&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;include&quot;</span><span class="p">,</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">]:</span> <span class="o">...</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a><span class="k">def</span><span class="w"> </span><span class="nf">strings_to_coords</span><span class="p">(</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>	<span class="n">text</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>	<span class="n">when_noncoord</span><span class="p">:</span> <span class="n">WhenMissing</span> <span class="o">=</span> <span class="s2">&quot;skip&quot;</span><span class="p">,</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">]:</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;converts a list of tokens to a list of coordinates</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a><span class="sd">	returns list[CoordTup] if `when_noncoord` is &quot;skip&quot; or &quot;error&quot;</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a><span class="sd">	returns list[str | CoordTup] if `when_noncoord` is &quot;include&quot;</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>	<span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>		<span class="s2">&quot;`util.strings_to_coords` only supports legacy UT strings. Function will be replaced with a generalized version in a future release.&quot;</span><span class="p">,</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>		<span class="n">TokenizerPendingDeprecationWarning</span><span class="p">,</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>	<span class="p">)</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>	<span class="n">tokens_joined</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">text</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>	<span class="n">tokens_processed</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">coords_string_split_UT</span><span class="p">(</span><span class="n">tokens_joined</span><span class="p">)</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>	<span class="n">result</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>	<span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">tokens_processed</span><span class="p">:</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>		<span class="n">coord</span><span class="p">:</span> <span class="n">CoordTup</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">coord_str_to_tuple_noneable</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>		<span class="k">if</span> <span class="n">coord</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>			<span class="k">if</span> <span class="n">when_noncoord</span> <span class="o">==</span> <span class="s2">&quot;skip&quot;</span><span class="p">:</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>				<span class="k">continue</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>			<span class="k">if</span> <span class="n">when_noncoord</span> <span class="o">==</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>				<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>					<span class="sa">f</span><span class="s2">&quot;Invalid non-coordinate token &#39;</span><span class="si">{</span><span class="n">token</span><span class="si">}</span><span class="s2">&#39; in text: &#39;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>				<span class="p">)</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>				<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>					<span class="n">err_msg</span><span class="p">,</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>				<span class="p">)</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>			<span class="k">if</span> <span class="n">when_noncoord</span> <span class="o">==</span> <span class="s2">&quot;include&quot;</span><span class="p">:</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>				<span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>			<span class="k">else</span><span class="p">:</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>				<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Invalid when_noncoord value &#39;</span><span class="si">{</span><span class="n">when_noncoord</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>				<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>		<span class="k">else</span><span class="p">:</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>			<span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>	<span class="k">return</span> <span class="n">result</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a><span class="nd">@overload</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a><span class="k">def</span><span class="w"> </span><span class="nf">coords_to_strings</span><span class="p">(</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>	<span class="n">coords</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">],</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>	<span class="n">coord_to_strings_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">CoordTup</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>	<span class="n">when_noncoord</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;include&quot;</span><span class="p">,</span> <span class="s2">&quot;skip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;skip&quot;</span><span class="p">,</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span> <span class="o">...</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a><span class="nd">@overload</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a><span class="k">def</span><span class="w"> </span><span class="nf">coords_to_strings</span><span class="p">(</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>	<span class="n">coords</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">CoordTup</span><span class="p">],</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>	<span class="n">coord_to_strings_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">CoordTup</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>	<span class="n">when_noncoord</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span> <span class="o">...</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a><span class="k">def</span><span class="w"> </span><span class="nf">coords_to_strings</span><span class="p">(</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>	<span class="n">coords</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">],</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>	<span class="n">coord_to_strings_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">CoordTup</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>	<span class="n">when_noncoord</span><span class="p">:</span> <span class="n">WhenMissing</span> <span class="o">=</span> <span class="s2">&quot;skip&quot;</span><span class="p">,</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;converts a list of coordinates to a list of strings (tokens)</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a><span class="sd">	expects list[CoordTup] if `when_noncoord` is &quot;error&quot;</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a><span class="sd">	expects list[str | CoordTup] if `when_noncoord` is &quot;include&quot; or &quot;skip&quot;</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a>	<span class="n">result</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>	<span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">:</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a>		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>			<span class="k">if</span> <span class="n">when_noncoord</span> <span class="o">==</span> <span class="s2">&quot;skip&quot;</span><span class="p">:</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a>				<span class="k">continue</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>			<span class="k">if</span> <span class="n">when_noncoord</span> <span class="o">==</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>				<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>					<span class="sa">f</span><span class="s2">&quot;Invalid non-coordinate &#39;</span><span class="si">{</span><span class="n">coord</span><span class="si">}</span><span class="s2">&#39; in list of coords: &#39;</span><span class="si">{</span><span class="n">coords</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a>				<span class="p">)</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a>				<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a>					<span class="n">err_msg</span><span class="p">,</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a>				<span class="p">)</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a>			<span class="k">if</span> <span class="n">when_noncoord</span> <span class="o">==</span> <span class="s2">&quot;include&quot;</span><span class="p">:</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a>				<span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a>			<span class="k">else</span><span class="p">:</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a>				<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Invalid when_noncoord value &#39;</span><span class="si">{</span><span class="n">when_noncoord</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a>				<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a>		<span class="k">else</span><span class="p">:</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a>			<span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">coord_to_strings_func</span><span class="p">(</span><span class="n">coord</span><span class="p">))</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a>	<span class="k">return</span> <span class="n">result</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_token_regions</span><span class="p">(</span><span class="n">toks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Splits a list of tokens into adjacency list tokens and non-adjacency list tokens.&quot;&quot;&quot;</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a>	<span class="n">adj_list_start</span><span class="p">,</span> <span class="n">adj_list_end</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a>		<span class="n">toks</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;&lt;ADJLIST_START&gt;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a>		<span class="n">toks</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;&lt;ADJLIST_END&gt;&quot;</span><span class="p">),</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>	<span class="p">)</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a>	<span class="n">adj_list</span> <span class="o">=</span> <span class="n">toks</span><span class="p">[</span><span class="n">adj_list_start</span><span class="p">:</span><span class="n">adj_list_end</span><span class="p">]</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>	<span class="n">non_adj_list</span> <span class="o">=</span> <span class="n">toks</span><span class="p">[:</span><span class="n">adj_list_start</span><span class="p">]</span> <span class="o">+</span> <span class="n">toks</span><span class="p">[</span><span class="n">adj_list_end</span><span class="p">:]</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>	<span class="k">return</span> <span class="n">adj_list</span><span class="p">,</span> <span class="n">non_adj_list</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a><span class="k">def</span><span class="w"> </span><span class="nf">equal_except_adj_list_sequence</span><span class="p">(</span>  <span class="c1"># noqa: C901</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a>	<span class="n">rollout1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a>	<span class="n">rollout2</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a>	<span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a>	<span class="n">when_counter_mismatch</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">EXCEPT</span><span class="p">,</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a>	<span class="n">when_len_mismatch</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">EXCEPT</span><span class="p">,</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Returns if the rollout strings are equal, allowing for differently sequenced adjacency lists.</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a><span class="sd">	&lt;ADJLIST_START&gt; and &lt;ADJLIST_END&gt; tokens must be in the rollouts.</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a><span class="sd">	Intended ONLY for determining if two tokenization schemes are the same for rollouts generated from the same maze.</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a><span class="sd">	This function should NOT be used to determine if two rollouts encode the same `LatticeMaze` object.</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a><span class="sd">	# Warning: CTT False Positives</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a><span class="sd">	This function is not robustly correct for some corner cases using `CoordTokenizers.CTT`.</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a><span class="sd">	If rollouts are passed for identical tokenizers processing two slightly different mazes, a false positive is possible.</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a><span class="sd">	More specifically, some cases of zero-sum adding and removing of connections in a maze within square regions along the diagonal will produce a false positive.</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>	<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rollout1</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rollout2</span><span class="p">):</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>		<span class="k">if</span> <span class="n">do_except</span><span class="p">:</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>			<span class="n">when_len_mismatch</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>				<span class="sa">f</span><span class="s2">&quot;Rollouts are not the same length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">rollout1</span><span class="p">)</span><span class="si">}</span><span class="s2"> != </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">rollout2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>			<span class="p">)</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>		<span class="k">return</span> <span class="kc">False</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>	<span class="k">if</span> <span class="p">(</span><span class="s2">&quot;&lt;ADJLIST_START&gt;&quot;</span> <span class="ow">in</span> <span class="n">rollout1</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="s2">&quot;&lt;ADJLIST_START&gt;&quot;</span> <span class="ow">in</span> <span class="n">rollout2</span><span class="p">):</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>		<span class="k">if</span> <span class="n">do_except</span><span class="p">:</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>			<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Rollouts do not have the same &lt;ADJLIST_START&gt; token: `</span><span class="si">{</span><span class="s1">&#39;&lt;ADJLIST_START&gt;&#39;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">rollout1</span><span class="w"> </span><span class="si">= }</span><span class="s2">` != `</span><span class="si">{</span><span class="s1">&#39;&lt;ADJLIST_START&gt;&#39;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">rollout2</span><span class="w"> </span><span class="si">= }</span><span class="s2">`&quot;</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>			<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>				<span class="n">err_msg</span><span class="p">,</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a>			<span class="p">)</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a>		<span class="k">return</span> <span class="kc">False</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>	<span class="k">if</span> <span class="p">(</span><span class="s2">&quot;&lt;ADJLIST_END&gt;&quot;</span> <span class="ow">in</span> <span class="n">rollout1</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="s2">&quot;&lt;ADJLIST_END&gt;&quot;</span> <span class="ow">in</span> <span class="n">rollout2</span><span class="p">):</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a>		<span class="k">if</span> <span class="n">do_except</span><span class="p">:</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a>			<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Rollouts do not have the same &lt;ADJLIST_END&gt; token: `</span><span class="si">{</span><span class="s1">&#39;&lt;ADJLIST_END&gt;&#39;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">rollout1</span><span class="w"> </span><span class="si">= }</span><span class="s2">` != `</span><span class="si">{</span><span class="s1">&#39;&lt;ADJLIST_END&gt;&#39;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">rollout2</span><span class="w"> </span><span class="si">= }</span><span class="s2">`&quot;</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>			<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a>				<span class="n">err_msg</span><span class="p">,</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>			<span class="p">)</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>		<span class="k">return</span> <span class="kc">False</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a>	<span class="n">adj_list1</span><span class="p">,</span> <span class="n">non_adj_list1</span> <span class="o">=</span> <span class="n">get_token_regions</span><span class="p">(</span><span class="n">rollout1</span><span class="p">)</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a>	<span class="n">adj_list2</span><span class="p">,</span> <span class="n">non_adj_list2</span> <span class="o">=</span> <span class="n">get_token_regions</span><span class="p">(</span><span class="n">rollout2</span><span class="p">)</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a>	<span class="k">if</span> <span class="n">non_adj_list1</span> <span class="o">!=</span> <span class="n">non_adj_list2</span><span class="p">:</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a>		<span class="k">if</span> <span class="n">do_except</span><span class="p">:</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a>			<span class="n">when_len_mismatch</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a>				<span class="sa">f</span><span class="s2">&quot;Non-adjacency list tokens are not the same:</span><span class="se">\n</span><span class="si">{</span><span class="n">non_adj_list1</span><span class="si">}</span><span class="se">\n</span><span class="s2">!=</span><span class="se">\n</span><span class="si">{</span><span class="n">non_adj_list2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a>			<span class="p">)</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a>			<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Non-adjacency list tokens are not the same:</span><span class="se">\n</span><span class="si">{</span><span class="n">non_adj_list1</span><span class="si">}</span><span class="se">\n</span><span class="s2">!=</span><span class="se">\n</span><span class="si">{</span><span class="n">non_adj_list2</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a>			<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a>				<span class="n">err_msg</span><span class="p">,</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>			<span class="p">)</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a>		<span class="k">return</span> <span class="kc">False</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a>	<span class="n">counter1</span><span class="p">:</span> <span class="n">Counter</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">adj_list1</span><span class="p">)</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a>	<span class="n">counter2</span><span class="p">:</span> <span class="n">Counter</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">adj_list2</span><span class="p">)</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a>	<span class="n">counters_eq</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">counter1</span> <span class="o">==</span> <span class="n">counter2</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a>	<span class="k">if</span> <span class="ow">not</span> <span class="n">counters_eq</span><span class="p">:</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a>		<span class="k">if</span> <span class="n">do_except</span><span class="p">:</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a>			<span class="n">when_counter_mismatch</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a>				<span class="sa">f</span><span class="s2">&quot;Adjacency list counters are not the same:</span><span class="se">\n</span><span class="si">{</span><span class="n">counter1</span><span class="si">}</span><span class="se">\n</span><span class="s2">!=</span><span class="se">\n</span><span class="si">{</span><span class="n">counter2</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">counter1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">counter2</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a>			<span class="p">)</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a>		<span class="k">return</span> <span class="kc">False</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a>	<span class="k">return</span> <span class="kc">True</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a><span class="k">def</span><span class="w"> </span><span class="nf">connection_list_to_adj_list</span><span class="p">(</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a>	<span class="n">conn_list</span><span class="p">:</span> <span class="n">ConnectionList</span><span class="p">,</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a>	<span class="n">shuffle_d0</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a>	<span class="n">shuffle_d1</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Int8</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;conn start_end=2 coord=2&quot;</span><span class="p">]:</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;converts a `ConnectionList` (special lattice format) to a shuffled adjacency list</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a><span class="sd">	# Parameters:</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a><span class="sd">	- `conn_list: ConnectionList`</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a><span class="sd">		special internal format for graphs which are subgraphs of a lattice</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a><span class="sd">	- `shuffle_d0: bool`</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a><span class="sd">		shuffle the adjacency list along the 0th axis (order of pairs)</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a><span class="sd">	- `shuffle_d1: bool`</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a><span class="sd">		shuffle the adjacency list along the 1st axis (order of coordinates in each pair).</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a><span class="sd">		If `False`, all pairs have the smaller coord first.</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a><span class="sd">	# Returns:</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a><span class="sd">	- `Int8[np.ndarray, &quot;conn start_end=2 coord=2&quot;]`</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a><span class="sd">		adjacency list in the shape `(n_connections, 2, 2)`</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a>	<span class="n">n_connections</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">conn_list</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a>	<span class="n">adj_list</span><span class="p">:</span> <span class="n">Int8</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;conn start_end=2 coord=2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a>		<span class="p">(</span><span class="n">n_connections</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a>		<span class="o">-</span><span class="mi">1</span><span class="p">,</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a>		<span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">,</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a>	<span class="p">)</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a>	<span class="k">if</span> <span class="n">shuffle_d1</span><span class="p">:</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a>		<span class="n">flip_d1</span><span class="p">:</span> <span class="n">Float</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot; conn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n_connections</span><span class="p">)</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a>	<span class="c1"># loop over all nonzero elements of the connection list</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a>	<span class="n">i</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a>	<span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndindex</span><span class="p">(</span><span class="n">conn_list</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a>		<span class="k">if</span> <span class="n">conn_list</span><span class="p">[</span><span class="n">d</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]:</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a>			<span class="n">c_start</span><span class="p">:</span> <span class="n">CoordTup</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a>			<span class="n">c_end</span><span class="p">:</span> <span class="n">CoordTup</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a>				<span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">),</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a>				<span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span><span class="p">),</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a>			<span class="p">)</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a>			<span class="n">adj_list</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">c_start</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a>			<span class="n">adj_list</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">c_end</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a>			<span class="c1"># flip if shuffling</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a>			<span class="c1"># magic value is fine here</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a>			<span class="k">if</span> <span class="n">shuffle_d1</span> <span class="ow">and</span> <span class="p">(</span><span class="n">flip_d1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">):</span>  <span class="c1"># noqa: PLR2004</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a>				<span class="n">c_s</span><span class="p">,</span> <span class="n">c_e</span> <span class="o">=</span> <span class="n">adj_list</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">adj_list</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a>				<span class="n">adj_list</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_e</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a>				<span class="n">adj_list</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_s</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a>			<span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a>	<span class="k">if</span> <span class="n">shuffle_d0</span><span class="p">:</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a>		<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">adj_list</span><span class="p">)</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a>	<span class="k">return</span> <span class="n">adj_list</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a><span class="k">def</span><span class="w"> </span><span class="nf">is_connection</span><span class="p">(</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a>	<span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">,</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a>	<span class="n">connection_list</span><span class="p">:</span> <span class="n">ConnectionList</span><span class="p">,</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Bool</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;is_connection=edges&quot;</span><span class="p">]:</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Returns if each edge in `edges` is a connection (`True`) or wall (`False`) in `connection_list`.&quot;&quot;&quot;</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a>	<span class="n">sorted_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a>	<span class="n">edge_direction</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a>		<span class="p">(</span><span class="n">sorted_edges</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">sorted_edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:])[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a>	<span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a>	<span class="k">return</span> <span class="n">connection_list</span><span class="p">[</span><span class="n">edge_direction</span><span class="p">,</span> <span class="n">sorted_edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">sorted_edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a><span class="c1"># string to coordinate representation</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a><span class="c1"># ==================================================</span>
</span></pre></div>


                <br/>
            </section>
                <section id="remove_padding_from_token_str">
                            <input id="remove_padding_from_token_str-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">remove_padding_from_token_str</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">token_str</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="remove_padding_from_token_str-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/token_utils.py#L28-L32" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#remove_padding_from_token_str"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="remove_padding_from_token_str-29"><a href="#remove_padding_from_token_str-29"><span class="linenos">29</span></a><span class="k">def</span><span class="w"> </span><span class="nf">remove_padding_from_token_str</span><span class="p">(</span><span class="n">token_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="remove_padding_from_token_str-30"><a href="#remove_padding_from_token_str-30"><span class="linenos">30</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;remove padding tokens from a joined token string&quot;&quot;&quot;</span>
</span><span id="remove_padding_from_token_str-31"><a href="#remove_padding_from_token_str-31"><span class="linenos">31</span></a>	<span class="n">token_str</span> <span class="o">=</span> <span class="n">token_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">PADDING</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="remove_padding_from_token_str-32"><a href="#remove_padding_from_token_str-32"><span class="linenos">32</span></a>	<span class="n">token_str</span> <span class="o">=</span> <span class="n">token_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">PADDING</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="remove_padding_from_token_str-33"><a href="#remove_padding_from_token_str-33"><span class="linenos">33</span></a>	<span class="k">return</span> <span class="n">token_str</span>  <span class="c1"># noqa: RET504</span>
</span></pre></div>


            <div class="docstring"><p>remove padding tokens from a joined token string</p>
</div>


                </section>
                <section id="tokens_between">
                            <input id="tokens_between-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">tokens_between</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>,</span><span class="param">	<span class="n">start_value</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">end_value</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">include_start</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">include_end</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">except_when_tokens_not_unique</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="tokens_between-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/token_utils.py#L35-L96" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#tokens_between"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="tokens_between-36"><a href="#tokens_between-36"><span class="linenos">36</span></a><span class="k">def</span><span class="w"> </span><span class="nf">tokens_between</span><span class="p">(</span>
</span><span id="tokens_between-37"><a href="#tokens_between-37"><span class="linenos">37</span></a>	<span class="n">tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="tokens_between-38"><a href="#tokens_between-38"><span class="linenos">38</span></a>	<span class="n">start_value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="tokens_between-39"><a href="#tokens_between-39"><span class="linenos">39</span></a>	<span class="n">end_value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="tokens_between-40"><a href="#tokens_between-40"><span class="linenos">40</span></a>	<span class="n">include_start</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="tokens_between-41"><a href="#tokens_between-41"><span class="linenos">41</span></a>	<span class="n">include_end</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="tokens_between-42"><a href="#tokens_between-42"><span class="linenos">42</span></a>	<span class="n">except_when_tokens_not_unique</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="tokens_between-43"><a href="#tokens_between-43"><span class="linenos">43</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="tokens_between-44"><a href="#tokens_between-44"><span class="linenos">44</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;given a list `tokens`, get the tokens between `start_value` and `end_value`</span>
</span><span id="tokens_between-45"><a href="#tokens_between-45"><span class="linenos">45</span></a>
</span><span id="tokens_between-46"><a href="#tokens_between-46"><span class="linenos">46</span></a><span class="sd">	_extended_summary_</span>
</span><span id="tokens_between-47"><a href="#tokens_between-47"><span class="linenos">47</span></a>
</span><span id="tokens_between-48"><a href="#tokens_between-48"><span class="linenos">48</span></a><span class="sd">	# Parameters:</span>
</span><span id="tokens_between-49"><a href="#tokens_between-49"><span class="linenos">49</span></a><span class="sd">	- `tokens : list[str]`</span>
</span><span id="tokens_between-50"><a href="#tokens_between-50"><span class="linenos">50</span></a><span class="sd">	- `start_value : str`</span>
</span><span id="tokens_between-51"><a href="#tokens_between-51"><span class="linenos">51</span></a><span class="sd">	- `end_value : str`</span>
</span><span id="tokens_between-52"><a href="#tokens_between-52"><span class="linenos">52</span></a><span class="sd">	- `include_start : bool`</span>
</span><span id="tokens_between-53"><a href="#tokens_between-53"><span class="linenos">53</span></a><span class="sd">		(defaults to `False`)</span>
</span><span id="tokens_between-54"><a href="#tokens_between-54"><span class="linenos">54</span></a><span class="sd">	- `include_end : bool`</span>
</span><span id="tokens_between-55"><a href="#tokens_between-55"><span class="linenos">55</span></a><span class="sd">		(defaults to `False`)</span>
</span><span id="tokens_between-56"><a href="#tokens_between-56"><span class="linenos">56</span></a><span class="sd">	- `except_when_tokens_not_unique : bool`</span>
</span><span id="tokens_between-57"><a href="#tokens_between-57"><span class="linenos">57</span></a><span class="sd">		when `True`, raise an error if `start_value` or `end_value` are not unique in the input tokens</span>
</span><span id="tokens_between-58"><a href="#tokens_between-58"><span class="linenos">58</span></a><span class="sd">		(defaults to `False`)</span>
</span><span id="tokens_between-59"><a href="#tokens_between-59"><span class="linenos">59</span></a>
</span><span id="tokens_between-60"><a href="#tokens_between-60"><span class="linenos">60</span></a><span class="sd">	# Returns:</span>
</span><span id="tokens_between-61"><a href="#tokens_between-61"><span class="linenos">61</span></a><span class="sd">	- `list[str]`</span>
</span><span id="tokens_between-62"><a href="#tokens_between-62"><span class="linenos">62</span></a>
</span><span id="tokens_between-63"><a href="#tokens_between-63"><span class="linenos">63</span></a><span class="sd">	# Raises:</span>
</span><span id="tokens_between-64"><a href="#tokens_between-64"><span class="linenos">64</span></a><span class="sd">	- `ValueError` : if `start_value` and `end_value` are the same</span>
</span><span id="tokens_between-65"><a href="#tokens_between-65"><span class="linenos">65</span></a><span class="sd">	- `ValueError` : if `except_when_tokens_not_unique` is `True` and `start_value` or `end_value` are not unique in the input tokens</span>
</span><span id="tokens_between-66"><a href="#tokens_between-66"><span class="linenos">66</span></a><span class="sd">	- `ValueError` : if `start_value` or `end_value` are not present in the input tokens</span>
</span><span id="tokens_between-67"><a href="#tokens_between-67"><span class="linenos">67</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="tokens_between-68"><a href="#tokens_between-68"><span class="linenos">68</span></a>	<span class="k">if</span> <span class="n">start_value</span> <span class="o">==</span> <span class="n">end_value</span><span class="p">:</span>
</span><span id="tokens_between-69"><a href="#tokens_between-69"><span class="linenos">69</span></a>		<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;start_value and end_value cannot be the same: </span><span class="si">{</span><span class="n">start_value</span><span class="w"> </span><span class="si">= }</span><span class="s2"> </span><span class="si">{</span><span class="n">end_value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="tokens_between-70"><a href="#tokens_between-70"><span class="linenos">70</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="tokens_between-71"><a href="#tokens_between-71"><span class="linenos">71</span></a>			<span class="n">err_msg</span><span class="p">,</span>
</span><span id="tokens_between-72"><a href="#tokens_between-72"><span class="linenos">72</span></a>		<span class="p">)</span>
</span><span id="tokens_between-73"><a href="#tokens_between-73"><span class="linenos">73</span></a>	<span class="k">if</span> <span class="n">except_when_tokens_not_unique</span><span class="p">:</span>
</span><span id="tokens_between-74"><a href="#tokens_between-74"><span class="linenos">74</span></a>		<span class="k">if</span> <span class="p">(</span><span class="n">tokens</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">start_value</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">tokens</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">end_value</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="tokens_between-75"><a href="#tokens_between-75"><span class="linenos">75</span></a>			<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="tokens_between-76"><a href="#tokens_between-76"><span class="linenos">76</span></a>				<span class="s2">&quot;start_value or end_value is not unique in the input tokens:&quot;</span>
</span><span id="tokens_between-77"><a href="#tokens_between-77"><span class="linenos">77</span></a>				<span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">tokens</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">start_value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> </span><span class="si">{</span><span class="n">tokens</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">end_value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="tokens_between-78"><a href="#tokens_between-78"><span class="linenos">78</span></a>				<span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">start_value</span><span class="w"> </span><span class="si">= }</span><span class="s2"> </span><span class="si">{</span><span class="n">end_value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="tokens_between-79"><a href="#tokens_between-79"><span class="linenos">79</span></a>				<span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">tokens</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="tokens_between-80"><a href="#tokens_between-80"><span class="linenos">80</span></a>			<span class="p">)</span>
</span><span id="tokens_between-81"><a href="#tokens_between-81"><span class="linenos">81</span></a>			<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
</span><span id="tokens_between-82"><a href="#tokens_between-82"><span class="linenos">82</span></a>	<span class="k">else</span><span class="p">:</span>
</span><span id="tokens_between-83"><a href="#tokens_between-83"><span class="linenos">83</span></a>		<span class="k">if</span> <span class="p">(</span><span class="n">tokens</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">start_value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">tokens</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">end_value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="tokens_between-84"><a href="#tokens_between-84"><span class="linenos">84</span></a>			<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="tokens_between-85"><a href="#tokens_between-85"><span class="linenos">85</span></a>				<span class="s2">&quot;start_value or end_value is not present in the input tokens:&quot;</span>
</span><span id="tokens_between-86"><a href="#tokens_between-86"><span class="linenos">86</span></a>				<span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">tokens</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">start_value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> </span><span class="si">{</span><span class="n">tokens</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">end_value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="tokens_between-87"><a href="#tokens_between-87"><span class="linenos">87</span></a>				<span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">start_value</span><span class="w"> </span><span class="si">= }</span><span class="s2"> </span><span class="si">{</span><span class="n">end_value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="tokens_between-88"><a href="#tokens_between-88"><span class="linenos">88</span></a>				<span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">tokens</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="tokens_between-89"><a href="#tokens_between-89"><span class="linenos">89</span></a>			<span class="p">)</span>
</span><span id="tokens_between-90"><a href="#tokens_between-90"><span class="linenos">90</span></a>			<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
</span><span id="tokens_between-91"><a href="#tokens_between-91"><span class="linenos">91</span></a>
</span><span id="tokens_between-92"><a href="#tokens_between-92"><span class="linenos">92</span></a>	<span class="n">start_idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">tokens</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">start_value</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="ow">not</span> <span class="n">include_start</span><span class="p">)</span>
</span><span id="tokens_between-93"><a href="#tokens_between-93"><span class="linenos">93</span></a>	<span class="n">end_idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">tokens</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">end_value</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">include_end</span><span class="p">)</span>
</span><span id="tokens_between-94"><a href="#tokens_between-94"><span class="linenos">94</span></a>
</span><span id="tokens_between-95"><a href="#tokens_between-95"><span class="linenos">95</span></a>	<span class="k">assert</span> <span class="n">start_idx</span> <span class="o">&lt;</span> <span class="n">end_idx</span><span class="p">,</span> <span class="s2">&quot;Start must come before end&quot;</span>
</span><span id="tokens_between-96"><a href="#tokens_between-96"><span class="linenos">96</span></a>
</span><span id="tokens_between-97"><a href="#tokens_between-97"><span class="linenos">97</span></a>	<span class="k">return</span> <span class="n">tokens</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span><span class="n">end_idx</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>given a list <code>tokens</code>, get the tokens between <code>start_value</code> and <code>end_value</code></p>

<p>_extended_summary_</p>

<h1 id="parameters">Parameters:</h1>

<ul>
<li><code>tokens : list[str]</code></li>
<li><code>start_value : str</code></li>
<li><code>end_value : str</code></li>
<li><code>include_start : bool</code>
(defaults to <code>False</code>)</li>
<li><code>include_end : bool</code>
(defaults to <code>False</code>)</li>
<li><code>except_when_tokens_not_unique : bool</code>
when <code>True</code>, raise an error if <code>start_value</code> or <code>end_value</code> are not unique in the input tokens
(defaults to <code>False</code>)</li>
</ul>

<h1 id="returns">Returns:</h1>

<ul>
<li><code>list[str]</code></li>
</ul>

<h1 id="raises">Raises:</h1>

<ul>
<li><code>ValueError</code> : if <code>start_value</code> and <code>end_value</code> are the same</li>
<li><code>ValueError</code> : if <code>except_when_tokens_not_unique</code> is <code>True</code> and <code>start_value</code> or <code>end_value</code> are not unique in the input tokens</li>
<li><code>ValueError</code> : if <code>start_value</code> or <code>end_value</code> are not present in the input tokens</li>
</ul>
</div>


                </section>
                <section id="get_adj_list_tokens">
                            <input id="get_adj_list_tokens-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_adj_list_tokens</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="get_adj_list_tokens-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/token_utils.py#L99-L105" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#get_adj_list_tokens"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_adj_list_tokens-100"><a href="#get_adj_list_tokens-100"><span class="linenos">100</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_adj_list_tokens</span><span class="p">(</span><span class="n">tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="get_adj_list_tokens-101"><a href="#get_adj_list_tokens-101"><span class="linenos">101</span></a>	<span class="s2">&quot;get tokens between ADJLIST_START and ADJLIST_END, without the special tokens themselves&quot;</span>
</span><span id="get_adj_list_tokens-102"><a href="#get_adj_list_tokens-102"><span class="linenos">102</span></a>	<span class="k">return</span> <span class="n">tokens_between</span><span class="p">(</span>
</span><span id="get_adj_list_tokens-103"><a href="#get_adj_list_tokens-103"><span class="linenos">103</span></a>		<span class="n">tokens</span><span class="p">,</span>
</span><span id="get_adj_list_tokens-104"><a href="#get_adj_list_tokens-104"><span class="linenos">104</span></a>		<span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">ADJLIST_START</span><span class="p">,</span>
</span><span id="get_adj_list_tokens-105"><a href="#get_adj_list_tokens-105"><span class="linenos">105</span></a>		<span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">ADJLIST_END</span><span class="p">,</span>
</span><span id="get_adj_list_tokens-106"><a href="#get_adj_list_tokens-106"><span class="linenos">106</span></a>	<span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>get tokens between ADJLIST_START and ADJLIST_END, without the special tokens themselves</p>
</div>


                </section>
                <section id="get_path_tokens">
                            <input id="get_path_tokens-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_path_tokens</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>, </span><span class="param"><span class="n">trim_end</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="get_path_tokens-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/token_utils.py#L108-L119" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#get_path_tokens"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_path_tokens-109"><a href="#get_path_tokens-109"><span class="linenos">109</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_path_tokens</span><span class="p">(</span><span class="n">tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">trim_end</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="get_path_tokens-110"><a href="#get_path_tokens-110"><span class="linenos">110</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;The path is considered everything from the first path coord to the path_end token, if it exists.&quot;&quot;&quot;</span>
</span><span id="get_path_tokens-111"><a href="#get_path_tokens-111"><span class="linenos">111</span></a>	<span class="k">if</span> <span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">PATH_START</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">:</span>
</span><span id="get_path_tokens-112"><a href="#get_path_tokens-112"><span class="linenos">112</span></a>		<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Path start token </span><span class="si">{</span><span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">PATH_START</span><span class="si">}</span><span class="s2"> not found in tokens:</span><span class="se">\n</span><span class="si">{</span><span class="n">tokens</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="get_path_tokens-113"><a href="#get_path_tokens-113"><span class="linenos">113</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="get_path_tokens-114"><a href="#get_path_tokens-114"><span class="linenos">114</span></a>			<span class="n">err_msg</span><span class="p">,</span>
</span><span id="get_path_tokens-115"><a href="#get_path_tokens-115"><span class="linenos">115</span></a>		<span class="p">)</span>
</span><span id="get_path_tokens-116"><a href="#get_path_tokens-116"><span class="linenos">116</span></a>	<span class="n">start_idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">tokens</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">PATH_START</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">trim_end</span><span class="p">)</span>
</span><span id="get_path_tokens-117"><a href="#get_path_tokens-117"><span class="linenos">117</span></a>	<span class="n">end_idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="get_path_tokens-118"><a href="#get_path_tokens-118"><span class="linenos">118</span></a>	<span class="k">if</span> <span class="n">trim_end</span> <span class="ow">and</span> <span class="p">(</span><span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">PATH_END</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">):</span>
</span><span id="get_path_tokens-119"><a href="#get_path_tokens-119"><span class="linenos">119</span></a>		<span class="n">end_idx</span> <span class="o">=</span> <span class="n">tokens</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">PATH_END</span><span class="p">)</span>
</span><span id="get_path_tokens-120"><a href="#get_path_tokens-120"><span class="linenos">120</span></a>	<span class="k">return</span> <span class="n">tokens</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span><span class="n">end_idx</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>The path is considered everything from the first path coord to the path_end token, if it exists.</p>
</div>


                </section>
                <section id="get_context_tokens">
                            <input id="get_context_tokens-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_context_tokens</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="get_context_tokens-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/token_utils.py#L122-L130" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#get_context_tokens"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_context_tokens-123"><a href="#get_context_tokens-123"><span class="linenos">123</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_context_tokens</span><span class="p">(</span><span class="n">tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="get_context_tokens-124"><a href="#get_context_tokens-124"><span class="linenos">124</span></a>	<span class="s2">&quot;get tokens between ADJLIST_START and PATH_START&quot;</span>
</span><span id="get_context_tokens-125"><a href="#get_context_tokens-125"><span class="linenos">125</span></a>	<span class="k">return</span> <span class="n">tokens_between</span><span class="p">(</span>
</span><span id="get_context_tokens-126"><a href="#get_context_tokens-126"><span class="linenos">126</span></a>		<span class="n">tokens</span><span class="p">,</span>
</span><span id="get_context_tokens-127"><a href="#get_context_tokens-127"><span class="linenos">127</span></a>		<span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">ADJLIST_START</span><span class="p">,</span>
</span><span id="get_context_tokens-128"><a href="#get_context_tokens-128"><span class="linenos">128</span></a>		<span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">PATH_START</span><span class="p">,</span>
</span><span id="get_context_tokens-129"><a href="#get_context_tokens-129"><span class="linenos">129</span></a>		<span class="n">include_start</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="get_context_tokens-130"><a href="#get_context_tokens-130"><span class="linenos">130</span></a>		<span class="n">include_end</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="get_context_tokens-131"><a href="#get_context_tokens-131"><span class="linenos">131</span></a>	<span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>get tokens between ADJLIST_START and PATH_START</p>
</div>


                </section>
                <section id="get_origin_tokens">
                            <input id="get_origin_tokens-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_origin_tokens</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="get_origin_tokens-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/token_utils.py#L133-L141" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#get_origin_tokens"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_origin_tokens-134"><a href="#get_origin_tokens-134"><span class="linenos">134</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_origin_tokens</span><span class="p">(</span><span class="n">tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="get_origin_tokens-135"><a href="#get_origin_tokens-135"><span class="linenos">135</span></a>	<span class="s2">&quot;get tokens_between ORIGIN_START and ORIGIN_END&quot;</span>
</span><span id="get_origin_tokens-136"><a href="#get_origin_tokens-136"><span class="linenos">136</span></a>	<span class="k">return</span> <span class="n">tokens_between</span><span class="p">(</span>
</span><span id="get_origin_tokens-137"><a href="#get_origin_tokens-137"><span class="linenos">137</span></a>		<span class="n">tokens</span><span class="p">,</span>
</span><span id="get_origin_tokens-138"><a href="#get_origin_tokens-138"><span class="linenos">138</span></a>		<span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">ORIGIN_START</span><span class="p">,</span>
</span><span id="get_origin_tokens-139"><a href="#get_origin_tokens-139"><span class="linenos">139</span></a>		<span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">ORIGIN_END</span><span class="p">,</span>
</span><span id="get_origin_tokens-140"><a href="#get_origin_tokens-140"><span class="linenos">140</span></a>		<span class="n">include_start</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="get_origin_tokens-141"><a href="#get_origin_tokens-141"><span class="linenos">141</span></a>		<span class="n">include_end</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="get_origin_tokens-142"><a href="#get_origin_tokens-142"><span class="linenos">142</span></a>	<span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>get tokens_between ORIGIN_START and ORIGIN_END</p>
</div>


                </section>
                <section id="get_target_tokens">
                            <input id="get_target_tokens-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_target_tokens</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="get_target_tokens-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/token_utils.py#L144-L152" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#get_target_tokens"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_target_tokens-145"><a href="#get_target_tokens-145"><span class="linenos">145</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_target_tokens</span><span class="p">(</span><span class="n">tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="get_target_tokens-146"><a href="#get_target_tokens-146"><span class="linenos">146</span></a>	<span class="s2">&quot;get tokens_between TARGET_START and TARGET_END&quot;</span>
</span><span id="get_target_tokens-147"><a href="#get_target_tokens-147"><span class="linenos">147</span></a>	<span class="k">return</span> <span class="n">tokens_between</span><span class="p">(</span>
</span><span id="get_target_tokens-148"><a href="#get_target_tokens-148"><span class="linenos">148</span></a>		<span class="n">tokens</span><span class="p">,</span>
</span><span id="get_target_tokens-149"><a href="#get_target_tokens-149"><span class="linenos">149</span></a>		<span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">TARGET_START</span><span class="p">,</span>
</span><span id="get_target_tokens-150"><a href="#get_target_tokens-150"><span class="linenos">150</span></a>		<span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">TARGET_END</span><span class="p">,</span>
</span><span id="get_target_tokens-151"><a href="#get_target_tokens-151"><span class="linenos">151</span></a>		<span class="n">include_start</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="get_target_tokens-152"><a href="#get_target_tokens-152"><span class="linenos">152</span></a>		<span class="n">include_end</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="get_target_tokens-153"><a href="#get_target_tokens-153"><span class="linenos">153</span></a>	<span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>get tokens_between TARGET_START and TARGET_END</p>
</div>


                </section>
                <section id="get_cardinal_direction">
                            <input id="get_cardinal_direction-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_cardinal_direction</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">coords</span><span class="p">:</span> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">Int</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="s1">&#39;start_end=2 row_col=2&#39;</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="get_cardinal_direction-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/token_utils.py#L155-L157" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#get_cardinal_direction"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_cardinal_direction-156"><a href="#get_cardinal_direction-156"><span class="linenos">156</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_cardinal_direction</span><span class="p">(</span><span class="n">coords</span><span class="p">:</span> <span class="n">Int</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;start_end=2 row_col=2&quot;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="get_cardinal_direction-157"><a href="#get_cardinal_direction-157"><span class="linenos">157</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Returns the cardinal direction token corresponding to traveling from `coords[0]` to `coords[1]`.&quot;&quot;&quot;</span>
</span><span id="get_cardinal_direction-158"><a href="#get_cardinal_direction-158"><span class="linenos">158</span></a>	<span class="k">return</span> <span class="n">CARDINAL_MAP</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
</span></pre></div>


            <div class="docstring"><p>Returns the cardinal direction token corresponding to traveling from <code>coords[0]</code> to <code>coords[1]</code>.</p>
</div>


                </section>
                <section id="get_relative_direction">
                            <input id="get_relative_direction-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_relative_direction</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">coords</span><span class="p">:</span> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">Int</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="s1">&#39;prev_cur_next=3 row_col=2&#39;</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="get_relative_direction-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/token_utils.py#L160-L199" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#get_relative_direction"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_relative_direction-161"><a href="#get_relative_direction-161"><span class="linenos">161</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_relative_direction</span><span class="p">(</span><span class="n">coords</span><span class="p">:</span> <span class="n">Int</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;prev_cur_next=3 row_col=2&quot;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="get_relative_direction-162"><a href="#get_relative_direction-162"><span class="linenos">162</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Returns the relative first-person direction token corresponding to traveling from `coords[1]` to `coords[2]`.</span>
</span><span id="get_relative_direction-163"><a href="#get_relative_direction-163"><span class="linenos">163</span></a>
</span><span id="get_relative_direction-164"><a href="#get_relative_direction-164"><span class="linenos">164</span></a><span class="sd">	# Parameters</span>
</span><span id="get_relative_direction-165"><a href="#get_relative_direction-165"><span class="linenos">165</span></a><span class="sd">	- `coords`: Contains 3 Coords, each of which must neighbor the previous Coord.</span>
</span><span id="get_relative_direction-166"><a href="#get_relative_direction-166"><span class="linenos">166</span></a><span class="sd">		- `coords[0]`: The previous location, used to determine the current absolute direction that the &quot;agent&quot; is facing.</span>
</span><span id="get_relative_direction-167"><a href="#get_relative_direction-167"><span class="linenos">167</span></a><span class="sd">		- `coords[1]`: The current location</span>
</span><span id="get_relative_direction-168"><a href="#get_relative_direction-168"><span class="linenos">168</span></a><span class="sd">		- `coords[2]`: The next location. May be equal to the current location.</span>
</span><span id="get_relative_direction-169"><a href="#get_relative_direction-169"><span class="linenos">169</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="get_relative_direction-170"><a href="#get_relative_direction-170"><span class="linenos">170</span></a>	<span class="k">if</span> <span class="n">coords</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
</span><span id="get_relative_direction-171"><a href="#get_relative_direction-171"><span class="linenos">171</span></a>		<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;`coords` must have shape (3,2). Got </span><span class="si">{</span><span class="n">coords</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> instead.&quot;</span>
</span><span id="get_relative_direction-172"><a href="#get_relative_direction-172"><span class="linenos">172</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
</span><span id="get_relative_direction-173"><a href="#get_relative_direction-173"><span class="linenos">173</span></a>	<span class="n">directions</span> <span class="o">=</span> <span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">coords</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="get_relative_direction-174"><a href="#get_relative_direction-174"><span class="linenos">174</span></a>	<span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">directions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">])):</span>
</span><span id="get_relative_direction-175"><a href="#get_relative_direction-175"><span class="linenos">175</span></a>		<span class="c1"># Use floats as constant since `np.linalg.norm` returns float array</span>
</span><span id="get_relative_direction-176"><a href="#get_relative_direction-176"><span class="linenos">176</span></a>		<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Adjacent `coords` must be neighboring or equivalent. Got </span><span class="si">{</span><span class="n">coords</span><span class="si">}</span><span class="s2"> instead.&quot;</span>
</span><span id="get_relative_direction-177"><a href="#get_relative_direction-177"><span class="linenos">177</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="get_relative_direction-178"><a href="#get_relative_direction-178"><span class="linenos">178</span></a>			<span class="n">err_msg</span><span class="p">,</span>
</span><span id="get_relative_direction-179"><a href="#get_relative_direction-179"><span class="linenos">179</span></a>		<span class="p">)</span>
</span><span id="get_relative_direction-180"><a href="#get_relative_direction-180"><span class="linenos">180</span></a>	<span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
</span><span id="get_relative_direction-181"><a href="#get_relative_direction-181"><span class="linenos">181</span></a>		<span class="k">return</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_STAY</span>
</span><span id="get_relative_direction-182"><a href="#get_relative_direction-182"><span class="linenos">182</span></a>	<span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
</span><span id="get_relative_direction-183"><a href="#get_relative_direction-183"><span class="linenos">183</span></a>		<span class="k">return</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_BACKWARD</span>
</span><span id="get_relative_direction-184"><a href="#get_relative_direction-184"><span class="linenos">184</span></a>	<span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="get_relative_direction-185"><a href="#get_relative_direction-185"><span class="linenos">185</span></a>		<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Previous first-person direction indeterminate from </span><span class="si">{</span><span class="n">coords</span><span class="si">=}</span><span class="s2">.&quot;</span>
</span><span id="get_relative_direction-186"><a href="#get_relative_direction-186"><span class="linenos">186</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="get_relative_direction-187"><a href="#get_relative_direction-187"><span class="linenos">187</span></a>			<span class="n">err_msg</span><span class="p">,</span>
</span><span id="get_relative_direction-188"><a href="#get_relative_direction-188"><span class="linenos">188</span></a>		<span class="p">)</span>
</span><span id="get_relative_direction-189"><a href="#get_relative_direction-189"><span class="linenos">189</span></a>	<span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">directions</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">directions</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="get_relative_direction-190"><a href="#get_relative_direction-190"><span class="linenos">190</span></a>		<span class="k">return</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_FORWARD</span>
</span><span id="get_relative_direction-191"><a href="#get_relative_direction-191"><span class="linenos">191</span></a>	<span class="n">directions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="get_relative_direction-192"><a href="#get_relative_direction-192"><span class="linenos">192</span></a>		<span class="n">directions</span><span class="p">,</span>
</span><span id="get_relative_direction-193"><a href="#get_relative_direction-193"><span class="linenos">193</span></a>		<span class="p">[[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
</span><span id="get_relative_direction-194"><a href="#get_relative_direction-194"><span class="linenos">194</span></a>		<span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="get_relative_direction-195"><a href="#get_relative_direction-195"><span class="linenos">195</span></a>	<span class="p">)</span>  <span class="c1"># Augment to represent unit basis vectors in 3D</span>
</span><span id="get_relative_direction-196"><a href="#get_relative_direction-196"><span class="linenos">196</span></a>	<span class="k">match</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">directions</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">directions</span><span class="p">[</span><span class="mi">1</span><span class="p">])[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="get_relative_direction-197"><a href="#get_relative_direction-197"><span class="linenos">197</span></a>		<span class="k">case</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="get_relative_direction-198"><a href="#get_relative_direction-198"><span class="linenos">198</span></a>			<span class="k">return</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_LEFT</span>
</span><span id="get_relative_direction-199"><a href="#get_relative_direction-199"><span class="linenos">199</span></a>		<span class="k">case</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="get_relative_direction-200"><a href="#get_relative_direction-200"><span class="linenos">200</span></a>			<span class="k">return</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_RIGHT</span>
</span></pre></div>


            <div class="docstring"><p>Returns the relative first-person direction token corresponding to traveling from <code>coords[1]</code> to <code>coords[2]</code>.</p>

<h1 id="parameters">Parameters</h1>

<ul>
<li><code>coords</code>: Contains 3 Coords, each of which must neighbor the previous Coord.
<ul>
<li><code>coords[0]</code>: The previous location, used to determine the current absolute direction that the "agent" is facing.</li>
<li><code>coords[1]</code>: The current location</li>
<li><code>coords[2]</code>: The next location. May be equal to the current location.</li>
</ul></li>
</ul>
</div>


                </section>
                <section id="TokenizerPendingDeprecationWarning">
                            <input id="TokenizerPendingDeprecationWarning-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">TokenizerPendingDeprecationWarning</span><wbr>(<span class="base">builtins.PendingDeprecationWarning</span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="TokenizerPendingDeprecationWarning-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/token_utils.py#L202-L205" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#TokenizerPendingDeprecationWarning"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TokenizerPendingDeprecationWarning-203"><a href="#TokenizerPendingDeprecationWarning-203"><span class="linenos">203</span></a><span class="k">class</span><span class="w"> </span><span class="nc">TokenizerPendingDeprecationWarning</span><span class="p">(</span><span class="ne">PendingDeprecationWarning</span><span class="p">):</span>
</span><span id="TokenizerPendingDeprecationWarning-204"><a href="#TokenizerPendingDeprecationWarning-204"><span class="linenos">204</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Pending deprecation warnings related to the `MazeTokenizerModular` upgrade.&quot;&quot;&quot;</span>
</span><span id="TokenizerPendingDeprecationWarning-205"><a href="#TokenizerPendingDeprecationWarning-205"><span class="linenos">205</span></a>
</span><span id="TokenizerPendingDeprecationWarning-206"><a href="#TokenizerPendingDeprecationWarning-206"><span class="linenos">206</span></a>	<span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Pending deprecation warnings related to the <code>MazeTokenizerModular</code> upgrade.</p>
</div>


                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>builtins.PendingDeprecationWarning</dt>
                                <dd id="TokenizerPendingDeprecationWarning.__init__" class="function">PendingDeprecationWarning</dd>

            </div>
            <div><dt>builtins.BaseException</dt>
                                <dd id="TokenizerPendingDeprecationWarning.with_traceback" class="function">with_traceback</dd>
                <dd id="TokenizerPendingDeprecationWarning.add_note" class="function">add_note</dd>
                <dd id="TokenizerPendingDeprecationWarning.args" class="variable">args</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="str_is_coord">
                            <input id="str_is_coord-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">str_is_coord</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">coord_str</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">allow_whitespace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="str_is_coord-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/token_utils.py#L208-L228" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#str_is_coord"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="str_is_coord-209"><a href="#str_is_coord-209"><span class="linenos">209</span></a><span class="k">def</span><span class="w"> </span><span class="nf">str_is_coord</span><span class="p">(</span><span class="n">coord_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">allow_whitespace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="str_is_coord-210"><a href="#str_is_coord-210"><span class="linenos">210</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;return True if the string represents a coordinate, False otherwise&quot;&quot;&quot;</span>
</span><span id="str_is_coord-211"><a href="#str_is_coord-211"><span class="linenos">211</span></a>	<span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="str_is_coord-212"><a href="#str_is_coord-212"><span class="linenos">212</span></a>		<span class="s2">&quot;`util.str_is_coord` only supports legacy UT strings. Function will be replaced with a generalized version in a future release.&quot;</span><span class="p">,</span>
</span><span id="str_is_coord-213"><a href="#str_is_coord-213"><span class="linenos">213</span></a>		<span class="n">TokenizerPendingDeprecationWarning</span><span class="p">,</span>
</span><span id="str_is_coord-214"><a href="#str_is_coord-214"><span class="linenos">214</span></a>	<span class="p">)</span>
</span><span id="str_is_coord-215"><a href="#str_is_coord-215"><span class="linenos">215</span></a>	<span class="n">strip_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="n">allow_whitespace</span> <span class="k">else</span> <span class="n">x</span>  <span class="c1"># noqa: E731</span>
</span><span id="str_is_coord-216"><a href="#str_is_coord-216"><span class="linenos">216</span></a>
</span><span id="str_is_coord-217"><a href="#str_is_coord-217"><span class="linenos">217</span></a>	<span class="n">coord_str</span> <span class="o">=</span> <span class="n">strip_func</span><span class="p">(</span><span class="n">coord_str</span><span class="p">)</span>
</span><span id="str_is_coord-218"><a href="#str_is_coord-218"><span class="linenos">218</span></a>
</span><span id="str_is_coord-219"><a href="#str_is_coord-219"><span class="linenos">219</span></a>	<span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="str_is_coord-220"><a href="#str_is_coord-220"><span class="linenos">220</span></a>		<span class="p">[</span>
</span><span id="str_is_coord-221"><a href="#str_is_coord-221"><span class="linenos">221</span></a>			<span class="n">coord_str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">),</span>
</span><span id="str_is_coord-222"><a href="#str_is_coord-222"><span class="linenos">222</span></a>			<span class="n">coord_str</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">),</span>
</span><span id="str_is_coord-223"><a href="#str_is_coord-223"><span class="linenos">223</span></a>			<span class="s2">&quot;,&quot;</span> <span class="ow">in</span> <span class="n">coord_str</span><span class="p">,</span>
</span><span id="str_is_coord-224"><a href="#str_is_coord-224"><span class="linenos">224</span></a>			<span class="nb">all</span><span class="p">(</span>
</span><span id="str_is_coord-225"><a href="#str_is_coord-225"><span class="linenos">225</span></a>				<span class="n">strip_func</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span>
</span><span id="str_is_coord-226"><a href="#str_is_coord-226"><span class="linenos">226</span></a>				<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">strip_func</span><span class="p">(</span><span class="n">coord_str</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
</span><span id="str_is_coord-227"><a href="#str_is_coord-227"><span class="linenos">227</span></a>			<span class="p">),</span>
</span><span id="str_is_coord-228"><a href="#str_is_coord-228"><span class="linenos">228</span></a>		<span class="p">],</span>
</span><span id="str_is_coord-229"><a href="#str_is_coord-229"><span class="linenos">229</span></a>	<span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>return True if the string represents a coordinate, False otherwise</p>
</div>


                </section>
                <section id="TokenizerDeprecationWarning">
                            <input id="TokenizerDeprecationWarning-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">TokenizerDeprecationWarning</span><wbr>(<span class="base">builtins.DeprecationWarning</span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="TokenizerDeprecationWarning-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/token_utils.py#L231-L234" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#TokenizerDeprecationWarning"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TokenizerDeprecationWarning-232"><a href="#TokenizerDeprecationWarning-232"><span class="linenos">232</span></a><span class="k">class</span><span class="w"> </span><span class="nc">TokenizerDeprecationWarning</span><span class="p">(</span><span class="ne">DeprecationWarning</span><span class="p">):</span>
</span><span id="TokenizerDeprecationWarning-233"><a href="#TokenizerDeprecationWarning-233"><span class="linenos">233</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Deprecation warnings related to the `MazeTokenizerModular` upgrade.&quot;&quot;&quot;</span>
</span><span id="TokenizerDeprecationWarning-234"><a href="#TokenizerDeprecationWarning-234"><span class="linenos">234</span></a>
</span><span id="TokenizerDeprecationWarning-235"><a href="#TokenizerDeprecationWarning-235"><span class="linenos">235</span></a>	<span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Deprecation warnings related to the <code>MazeTokenizerModular</code> upgrade.</p>
</div>


                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>builtins.DeprecationWarning</dt>
                                <dd id="TokenizerDeprecationWarning.__init__" class="function">DeprecationWarning</dd>

            </div>
            <div><dt>builtins.BaseException</dt>
                                <dd id="TokenizerDeprecationWarning.with_traceback" class="function">with_traceback</dd>
                <dd id="TokenizerDeprecationWarning.add_note" class="function">add_note</dd>
                <dd id="TokenizerDeprecationWarning.args" class="variable">args</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="coord_str_to_tuple">
                            <input id="coord_str_to_tuple-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">coord_str_to_tuple</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">coord_str</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">allow_whitespace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="coord_str_to_tuple-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/token_utils.py#L261-L269" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#coord_str_to_tuple"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="coord_str_to_tuple-262"><a href="#coord_str_to_tuple-262"><span class="linenos">262</span></a><span class="k">def</span><span class="w"> </span><span class="nf">coord_str_to_tuple</span><span class="p">(</span>
</span><span id="coord_str_to_tuple-263"><a href="#coord_str_to_tuple-263"><span class="linenos">263</span></a>	<span class="n">coord_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="coord_str_to_tuple-264"><a href="#coord_str_to_tuple-264"><span class="linenos">264</span></a>	<span class="n">allow_whitespace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="coord_str_to_tuple-265"><a href="#coord_str_to_tuple-265"><span class="linenos">265</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
</span><span id="coord_str_to_tuple-266"><a href="#coord_str_to_tuple-266"><span class="linenos">266</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;convert a coordinate string to a tuple&quot;&quot;&quot;</span>
</span><span id="coord_str_to_tuple-267"><a href="#coord_str_to_tuple-267"><span class="linenos">267</span></a>	<span class="n">strip_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="n">allow_whitespace</span> <span class="k">else</span> <span class="n">x</span>  <span class="c1"># noqa: E731</span>
</span><span id="coord_str_to_tuple-268"><a href="#coord_str_to_tuple-268"><span class="linenos">268</span></a>	<span class="n">coord_str</span> <span class="o">=</span> <span class="n">strip_func</span><span class="p">(</span><span class="n">coord_str</span><span class="p">)</span>
</span><span id="coord_str_to_tuple-269"><a href="#coord_str_to_tuple-269"><span class="linenos">269</span></a>	<span class="n">stripped</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">strip_func</span><span class="p">(</span><span class="n">coord_str</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">))</span>
</span><span id="coord_str_to_tuple-270"><a href="#coord_str_to_tuple-270"><span class="linenos">270</span></a>	<span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">strip_func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">stripped</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>convert a coordinate string to a tuple</p>
</div>


                </section>
                <section id="coord_str_to_coord_np">
                            <input id="coord_str_to_coord_np-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">coord_str_to_coord_np</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">coord_str</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">allow_whitespace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="coord_str_to_coord_np-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/token_utils.py#L272-L274" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#coord_str_to_coord_np"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="coord_str_to_coord_np-273"><a href="#coord_str_to_coord_np-273"><span class="linenos">273</span></a><span class="k">def</span><span class="w"> </span><span class="nf">coord_str_to_coord_np</span><span class="p">(</span><span class="n">coord_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">allow_whitespace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="coord_str_to_coord_np-274"><a href="#coord_str_to_coord_np-274"><span class="linenos">274</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;convert a coordinate string to a numpy array&quot;&quot;&quot;</span>
</span><span id="coord_str_to_coord_np-275"><a href="#coord_str_to_coord_np-275"><span class="linenos">275</span></a>	<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_str_to_tuple</span><span class="p">(</span><span class="n">coord_str</span><span class="p">,</span> <span class="n">allow_whitespace</span><span class="o">=</span><span class="n">allow_whitespace</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>convert a coordinate string to a numpy array</p>
</div>


                </section>
                <section id="coord_str_to_tuple_noneable">
                            <input id="coord_str_to_tuple_noneable-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">coord_str_to_tuple_noneable</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">coord_str</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="coord_str_to_tuple_noneable-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/token_utils.py#L277-L281" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#coord_str_to_tuple_noneable"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="coord_str_to_tuple_noneable-278"><a href="#coord_str_to_tuple_noneable-278"><span class="linenos">278</span></a><span class="k">def</span><span class="w"> </span><span class="nf">coord_str_to_tuple_noneable</span><span class="p">(</span><span class="n">coord_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CoordTup</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="coord_str_to_tuple_noneable-279"><a href="#coord_str_to_tuple_noneable-279"><span class="linenos">279</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;convert a coordinate string to a tuple, or None if the string is not a coordinate string&quot;&quot;&quot;</span>
</span><span id="coord_str_to_tuple_noneable-280"><a href="#coord_str_to_tuple_noneable-280"><span class="linenos">280</span></a>	<span class="k">if</span> <span class="ow">not</span> <span class="n">str_is_coord</span><span class="p">(</span><span class="n">coord_str</span><span class="p">):</span>
</span><span id="coord_str_to_tuple_noneable-281"><a href="#coord_str_to_tuple_noneable-281"><span class="linenos">281</span></a>		<span class="k">return</span> <span class="kc">None</span>
</span><span id="coord_str_to_tuple_noneable-282"><a href="#coord_str_to_tuple_noneable-282"><span class="linenos">282</span></a>	<span class="k">return</span> <span class="n">coord_str_to_tuple</span><span class="p">(</span><span class="n">coord_str</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>convert a coordinate string to a tuple, or None if the string is not a coordinate string</p>
</div>


                </section>
                <section id="coords_string_split_UT">
                            <input id="coords_string_split_UT-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">coords_string_split_UT</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">coords</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="coords_string_split_UT-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/token_utils.py#L284-L292" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#coords_string_split_UT"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="coords_string_split_UT-285"><a href="#coords_string_split_UT-285"><span class="linenos">285</span></a><span class="k">def</span><span class="w"> </span><span class="nf">coords_string_split_UT</span><span class="p">(</span><span class="n">coords</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="coords_string_split_UT-286"><a href="#coords_string_split_UT-286"><span class="linenos">286</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Splits a string of tokens into a list containing the UT tokens for each coordinate.</span>
</span><span id="coords_string_split_UT-287"><a href="#coords_string_split_UT-287"><span class="linenos">287</span></a>
</span><span id="coords_string_split_UT-288"><a href="#coords_string_split_UT-288"><span class="linenos">288</span></a><span class="sd">	Not capable of producing indexed tokens (&quot;(&quot;, &quot;1&quot;, &quot;,&quot;, &quot;2&quot;, &quot;)&quot;), only unique tokens (&quot;(1,2)&quot;).</span>
</span><span id="coords_string_split_UT-289"><a href="#coords_string_split_UT-289"><span class="linenos">289</span></a><span class="sd">	Non-whitespace portions of the input string not matched are preserved in the same list:</span>
</span><span id="coords_string_split_UT-290"><a href="#coords_string_split_UT-290"><span class="linenos">290</span></a><span class="sd">	&quot;(1,2) &lt;SPECIAL_TOKEN&gt; (5,6)&quot; -&gt; [&quot;(1,2)&quot;, &quot;&lt;SPECIAL_TOKEN&gt;&quot;, &quot;(5,6)&quot;]</span>
</span><span id="coords_string_split_UT-291"><a href="#coords_string_split_UT-291"><span class="linenos">291</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="coords_string_split_UT-292"><a href="#coords_string_split_UT-292"><span class="linenos">292</span></a>	<span class="c1"># ty gpt4</span>
</span><span id="coords_string_split_UT-293"><a href="#coords_string_split_UT-293"><span class="linenos">293</span></a>	<span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\([^)]*\)|\S+&quot;</span><span class="p">,</span> <span class="n">coords</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Splits a string of tokens into a list containing the UT tokens for each coordinate.</p>

<p>Not capable of producing indexed tokens ("(", "1", ",", "2", ")"), only unique tokens ("(1,2)").
Non-whitespace portions of the input string not matched are preserved in the same list:
"(1,2) <SPECIAL_TOKEN> (5,6)" -> ["(1,2)", "<SPECIAL_TOKEN>", "(5,6)"]</p>
</div>


                </section>
                <section id="strings_to_coords">
                            <input id="strings_to_coords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">strings_to_coords</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">text</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>,</span><span class="param">	<span class="n">when_noncoord</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;except&#39;</span><span class="p">,</span> <span class="s1">&#39;skip&#39;</span><span class="p">,</span> <span class="s1">&#39;include&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;skip&#39;</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="strings_to_coords-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/token_utils.py#L312-L347" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#strings_to_coords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="strings_to_coords-313"><a href="#strings_to_coords-313"><span class="linenos">313</span></a><span class="k">def</span><span class="w"> </span><span class="nf">strings_to_coords</span><span class="p">(</span>
</span><span id="strings_to_coords-314"><a href="#strings_to_coords-314"><span class="linenos">314</span></a>	<span class="n">text</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="strings_to_coords-315"><a href="#strings_to_coords-315"><span class="linenos">315</span></a>	<span class="n">when_noncoord</span><span class="p">:</span> <span class="n">WhenMissing</span> <span class="o">=</span> <span class="s2">&quot;skip&quot;</span><span class="p">,</span>
</span><span id="strings_to_coords-316"><a href="#strings_to_coords-316"><span class="linenos">316</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">]:</span>
</span><span id="strings_to_coords-317"><a href="#strings_to_coords-317"><span class="linenos">317</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;converts a list of tokens to a list of coordinates</span>
</span><span id="strings_to_coords-318"><a href="#strings_to_coords-318"><span class="linenos">318</span></a>
</span><span id="strings_to_coords-319"><a href="#strings_to_coords-319"><span class="linenos">319</span></a><span class="sd">	returns list[CoordTup] if `when_noncoord` is &quot;skip&quot; or &quot;error&quot;</span>
</span><span id="strings_to_coords-320"><a href="#strings_to_coords-320"><span class="linenos">320</span></a><span class="sd">	returns list[str | CoordTup] if `when_noncoord` is &quot;include&quot;</span>
</span><span id="strings_to_coords-321"><a href="#strings_to_coords-321"><span class="linenos">321</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="strings_to_coords-322"><a href="#strings_to_coords-322"><span class="linenos">322</span></a>	<span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="strings_to_coords-323"><a href="#strings_to_coords-323"><span class="linenos">323</span></a>		<span class="s2">&quot;`util.strings_to_coords` only supports legacy UT strings. Function will be replaced with a generalized version in a future release.&quot;</span><span class="p">,</span>
</span><span id="strings_to_coords-324"><a href="#strings_to_coords-324"><span class="linenos">324</span></a>		<span class="n">TokenizerPendingDeprecationWarning</span><span class="p">,</span>
</span><span id="strings_to_coords-325"><a href="#strings_to_coords-325"><span class="linenos">325</span></a>	<span class="p">)</span>
</span><span id="strings_to_coords-326"><a href="#strings_to_coords-326"><span class="linenos">326</span></a>	<span class="n">tokens_joined</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">text</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</span><span id="strings_to_coords-327"><a href="#strings_to_coords-327"><span class="linenos">327</span></a>	<span class="n">tokens_processed</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">coords_string_split_UT</span><span class="p">(</span><span class="n">tokens_joined</span><span class="p">)</span>
</span><span id="strings_to_coords-328"><a href="#strings_to_coords-328"><span class="linenos">328</span></a>	<span class="n">result</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="strings_to_coords-329"><a href="#strings_to_coords-329"><span class="linenos">329</span></a>	<span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">tokens_processed</span><span class="p">:</span>
</span><span id="strings_to_coords-330"><a href="#strings_to_coords-330"><span class="linenos">330</span></a>		<span class="n">coord</span><span class="p">:</span> <span class="n">CoordTup</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">coord_str_to_tuple_noneable</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
</span><span id="strings_to_coords-331"><a href="#strings_to_coords-331"><span class="linenos">331</span></a>		<span class="k">if</span> <span class="n">coord</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="strings_to_coords-332"><a href="#strings_to_coords-332"><span class="linenos">332</span></a>			<span class="k">if</span> <span class="n">when_noncoord</span> <span class="o">==</span> <span class="s2">&quot;skip&quot;</span><span class="p">:</span>
</span><span id="strings_to_coords-333"><a href="#strings_to_coords-333"><span class="linenos">333</span></a>				<span class="k">continue</span>
</span><span id="strings_to_coords-334"><a href="#strings_to_coords-334"><span class="linenos">334</span></a>			<span class="k">if</span> <span class="n">when_noncoord</span> <span class="o">==</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span>
</span><span id="strings_to_coords-335"><a href="#strings_to_coords-335"><span class="linenos">335</span></a>				<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="strings_to_coords-336"><a href="#strings_to_coords-336"><span class="linenos">336</span></a>					<span class="sa">f</span><span class="s2">&quot;Invalid non-coordinate token &#39;</span><span class="si">{</span><span class="n">token</span><span class="si">}</span><span class="s2">&#39; in text: &#39;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="strings_to_coords-337"><a href="#strings_to_coords-337"><span class="linenos">337</span></a>				<span class="p">)</span>
</span><span id="strings_to_coords-338"><a href="#strings_to_coords-338"><span class="linenos">338</span></a>				<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="strings_to_coords-339"><a href="#strings_to_coords-339"><span class="linenos">339</span></a>					<span class="n">err_msg</span><span class="p">,</span>
</span><span id="strings_to_coords-340"><a href="#strings_to_coords-340"><span class="linenos">340</span></a>				<span class="p">)</span>
</span><span id="strings_to_coords-341"><a href="#strings_to_coords-341"><span class="linenos">341</span></a>			<span class="k">if</span> <span class="n">when_noncoord</span> <span class="o">==</span> <span class="s2">&quot;include&quot;</span><span class="p">:</span>
</span><span id="strings_to_coords-342"><a href="#strings_to_coords-342"><span class="linenos">342</span></a>				<span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
</span><span id="strings_to_coords-343"><a href="#strings_to_coords-343"><span class="linenos">343</span></a>			<span class="k">else</span><span class="p">:</span>
</span><span id="strings_to_coords-344"><a href="#strings_to_coords-344"><span class="linenos">344</span></a>				<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Invalid when_noncoord value &#39;</span><span class="si">{</span><span class="n">when_noncoord</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="strings_to_coords-345"><a href="#strings_to_coords-345"><span class="linenos">345</span></a>				<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
</span><span id="strings_to_coords-346"><a href="#strings_to_coords-346"><span class="linenos">346</span></a>		<span class="k">else</span><span class="p">:</span>
</span><span id="strings_to_coords-347"><a href="#strings_to_coords-347"><span class="linenos">347</span></a>			<span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
</span><span id="strings_to_coords-348"><a href="#strings_to_coords-348"><span class="linenos">348</span></a>	<span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>converts a list of tokens to a list of coordinates</p>

<p>returns list[CoordTup] if <code>when_noncoord</code> is "skip" or "error"
returns list[str | CoordTup] if <code>when_noncoord</code> is "include"</p>
</div>


                </section>
                <section id="coords_to_strings">
                            <input id="coords_to_strings-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">coords_to_strings</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">coords</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>,</span><span class="param">	<span class="n">coord_to_strings_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>,</span><span class="param">	<span class="n">when_noncoord</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;except&#39;</span><span class="p">,</span> <span class="s1">&#39;skip&#39;</span><span class="p">,</span> <span class="s1">&#39;include&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;skip&#39;</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="coords_to_strings-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/token_utils.py#L362-L391" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#coords_to_strings"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="coords_to_strings-363"><a href="#coords_to_strings-363"><span class="linenos">363</span></a><span class="k">def</span><span class="w"> </span><span class="nf">coords_to_strings</span><span class="p">(</span>
</span><span id="coords_to_strings-364"><a href="#coords_to_strings-364"><span class="linenos">364</span></a>	<span class="n">coords</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">],</span>
</span><span id="coords_to_strings-365"><a href="#coords_to_strings-365"><span class="linenos">365</span></a>	<span class="n">coord_to_strings_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">CoordTup</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="coords_to_strings-366"><a href="#coords_to_strings-366"><span class="linenos">366</span></a>	<span class="n">when_noncoord</span><span class="p">:</span> <span class="n">WhenMissing</span> <span class="o">=</span> <span class="s2">&quot;skip&quot;</span><span class="p">,</span>
</span><span id="coords_to_strings-367"><a href="#coords_to_strings-367"><span class="linenos">367</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="coords_to_strings-368"><a href="#coords_to_strings-368"><span class="linenos">368</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;converts a list of coordinates to a list of strings (tokens)</span>
</span><span id="coords_to_strings-369"><a href="#coords_to_strings-369"><span class="linenos">369</span></a>
</span><span id="coords_to_strings-370"><a href="#coords_to_strings-370"><span class="linenos">370</span></a><span class="sd">	expects list[CoordTup] if `when_noncoord` is &quot;error&quot;</span>
</span><span id="coords_to_strings-371"><a href="#coords_to_strings-371"><span class="linenos">371</span></a><span class="sd">	expects list[str | CoordTup] if `when_noncoord` is &quot;include&quot; or &quot;skip&quot;</span>
</span><span id="coords_to_strings-372"><a href="#coords_to_strings-372"><span class="linenos">372</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="coords_to_strings-373"><a href="#coords_to_strings-373"><span class="linenos">373</span></a>	<span class="n">result</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="coords_to_strings-374"><a href="#coords_to_strings-374"><span class="linenos">374</span></a>	<span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">:</span>
</span><span id="coords_to_strings-375"><a href="#coords_to_strings-375"><span class="linenos">375</span></a>		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="coords_to_strings-376"><a href="#coords_to_strings-376"><span class="linenos">376</span></a>			<span class="k">if</span> <span class="n">when_noncoord</span> <span class="o">==</span> <span class="s2">&quot;skip&quot;</span><span class="p">:</span>
</span><span id="coords_to_strings-377"><a href="#coords_to_strings-377"><span class="linenos">377</span></a>				<span class="k">continue</span>
</span><span id="coords_to_strings-378"><a href="#coords_to_strings-378"><span class="linenos">378</span></a>			<span class="k">if</span> <span class="n">when_noncoord</span> <span class="o">==</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span>
</span><span id="coords_to_strings-379"><a href="#coords_to_strings-379"><span class="linenos">379</span></a>				<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="coords_to_strings-380"><a href="#coords_to_strings-380"><span class="linenos">380</span></a>					<span class="sa">f</span><span class="s2">&quot;Invalid non-coordinate &#39;</span><span class="si">{</span><span class="n">coord</span><span class="si">}</span><span class="s2">&#39; in list of coords: &#39;</span><span class="si">{</span><span class="n">coords</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="coords_to_strings-381"><a href="#coords_to_strings-381"><span class="linenos">381</span></a>				<span class="p">)</span>
</span><span id="coords_to_strings-382"><a href="#coords_to_strings-382"><span class="linenos">382</span></a>				<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="coords_to_strings-383"><a href="#coords_to_strings-383"><span class="linenos">383</span></a>					<span class="n">err_msg</span><span class="p">,</span>
</span><span id="coords_to_strings-384"><a href="#coords_to_strings-384"><span class="linenos">384</span></a>				<span class="p">)</span>
</span><span id="coords_to_strings-385"><a href="#coords_to_strings-385"><span class="linenos">385</span></a>			<span class="k">if</span> <span class="n">when_noncoord</span> <span class="o">==</span> <span class="s2">&quot;include&quot;</span><span class="p">:</span>
</span><span id="coords_to_strings-386"><a href="#coords_to_strings-386"><span class="linenos">386</span></a>				<span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
</span><span id="coords_to_strings-387"><a href="#coords_to_strings-387"><span class="linenos">387</span></a>			<span class="k">else</span><span class="p">:</span>
</span><span id="coords_to_strings-388"><a href="#coords_to_strings-388"><span class="linenos">388</span></a>				<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Invalid when_noncoord value &#39;</span><span class="si">{</span><span class="n">when_noncoord</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="coords_to_strings-389"><a href="#coords_to_strings-389"><span class="linenos">389</span></a>				<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
</span><span id="coords_to_strings-390"><a href="#coords_to_strings-390"><span class="linenos">390</span></a>		<span class="k">else</span><span class="p">:</span>
</span><span id="coords_to_strings-391"><a href="#coords_to_strings-391"><span class="linenos">391</span></a>			<span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">coord_to_strings_func</span><span class="p">(</span><span class="n">coord</span><span class="p">))</span>
</span><span id="coords_to_strings-392"><a href="#coords_to_strings-392"><span class="linenos">392</span></a>	<span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>converts a list of coordinates to a list of strings (tokens)</p>

<p>expects list[CoordTup] if <code>when_noncoord</code> is "error"
expects list[str | CoordTup] if <code>when_noncoord</code> is "include" or "skip"</p>
</div>


                </section>
                <section id="get_token_regions">
                            <input id="get_token_regions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_token_regions</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">toks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="get_token_regions-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/token_utils.py#L394-L402" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#get_token_regions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_token_regions-395"><a href="#get_token_regions-395"><span class="linenos">395</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_token_regions</span><span class="p">(</span><span class="n">toks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="get_token_regions-396"><a href="#get_token_regions-396"><span class="linenos">396</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Splits a list of tokens into adjacency list tokens and non-adjacency list tokens.&quot;&quot;&quot;</span>
</span><span id="get_token_regions-397"><a href="#get_token_regions-397"><span class="linenos">397</span></a>	<span class="n">adj_list_start</span><span class="p">,</span> <span class="n">adj_list_end</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="get_token_regions-398"><a href="#get_token_regions-398"><span class="linenos">398</span></a>		<span class="n">toks</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;&lt;ADJLIST_START&gt;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="get_token_regions-399"><a href="#get_token_regions-399"><span class="linenos">399</span></a>		<span class="n">toks</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;&lt;ADJLIST_END&gt;&quot;</span><span class="p">),</span>
</span><span id="get_token_regions-400"><a href="#get_token_regions-400"><span class="linenos">400</span></a>	<span class="p">)</span>
</span><span id="get_token_regions-401"><a href="#get_token_regions-401"><span class="linenos">401</span></a>	<span class="n">adj_list</span> <span class="o">=</span> <span class="n">toks</span><span class="p">[</span><span class="n">adj_list_start</span><span class="p">:</span><span class="n">adj_list_end</span><span class="p">]</span>
</span><span id="get_token_regions-402"><a href="#get_token_regions-402"><span class="linenos">402</span></a>	<span class="n">non_adj_list</span> <span class="o">=</span> <span class="n">toks</span><span class="p">[:</span><span class="n">adj_list_start</span><span class="p">]</span> <span class="o">+</span> <span class="n">toks</span><span class="p">[</span><span class="n">adj_list_end</span><span class="p">:]</span>
</span><span id="get_token_regions-403"><a href="#get_token_regions-403"><span class="linenos">403</span></a>	<span class="k">return</span> <span class="n">adj_list</span><span class="p">,</span> <span class="n">non_adj_list</span>
</span></pre></div>


            <div class="docstring"><p>Splits a list of tokens into adjacency list tokens and non-adjacency list tokens.</p>
</div>


                </section>
                <section id="equal_except_adj_list_sequence">
                            <input id="equal_except_adj_list_sequence-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">equal_except_adj_list_sequence</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">rollout1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>,</span><span class="param">	<span class="n">rollout2</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>,</span><span class="param">	<span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">when_counter_mismatch</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span>,</span><span class="param">	<span class="n">when_len_mismatch</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="equal_except_adj_list_sequence-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/token_utils.py#L405-L466" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#equal_except_adj_list_sequence"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="equal_except_adj_list_sequence-406"><a href="#equal_except_adj_list_sequence-406"><span class="linenos">406</span></a><span class="k">def</span><span class="w"> </span><span class="nf">equal_except_adj_list_sequence</span><span class="p">(</span>  <span class="c1"># noqa: C901</span>
</span><span id="equal_except_adj_list_sequence-407"><a href="#equal_except_adj_list_sequence-407"><span class="linenos">407</span></a>	<span class="n">rollout1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="equal_except_adj_list_sequence-408"><a href="#equal_except_adj_list_sequence-408"><span class="linenos">408</span></a>	<span class="n">rollout2</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="equal_except_adj_list_sequence-409"><a href="#equal_except_adj_list_sequence-409"><span class="linenos">409</span></a>	<span class="n">do_except</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="equal_except_adj_list_sequence-410"><a href="#equal_except_adj_list_sequence-410"><span class="linenos">410</span></a>	<span class="n">when_counter_mismatch</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">EXCEPT</span><span class="p">,</span>
</span><span id="equal_except_adj_list_sequence-411"><a href="#equal_except_adj_list_sequence-411"><span class="linenos">411</span></a>	<span class="n">when_len_mismatch</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">EXCEPT</span><span class="p">,</span>
</span><span id="equal_except_adj_list_sequence-412"><a href="#equal_except_adj_list_sequence-412"><span class="linenos">412</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="equal_except_adj_list_sequence-413"><a href="#equal_except_adj_list_sequence-413"><span class="linenos">413</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Returns if the rollout strings are equal, allowing for differently sequenced adjacency lists.</span>
</span><span id="equal_except_adj_list_sequence-414"><a href="#equal_except_adj_list_sequence-414"><span class="linenos">414</span></a>
</span><span id="equal_except_adj_list_sequence-415"><a href="#equal_except_adj_list_sequence-415"><span class="linenos">415</span></a><span class="sd">	&lt;ADJLIST_START&gt; and &lt;ADJLIST_END&gt; tokens must be in the rollouts.</span>
</span><span id="equal_except_adj_list_sequence-416"><a href="#equal_except_adj_list_sequence-416"><span class="linenos">416</span></a><span class="sd">	Intended ONLY for determining if two tokenization schemes are the same for rollouts generated from the same maze.</span>
</span><span id="equal_except_adj_list_sequence-417"><a href="#equal_except_adj_list_sequence-417"><span class="linenos">417</span></a><span class="sd">	This function should NOT be used to determine if two rollouts encode the same `LatticeMaze` object.</span>
</span><span id="equal_except_adj_list_sequence-418"><a href="#equal_except_adj_list_sequence-418"><span class="linenos">418</span></a>
</span><span id="equal_except_adj_list_sequence-419"><a href="#equal_except_adj_list_sequence-419"><span class="linenos">419</span></a><span class="sd">	# Warning: CTT False Positives</span>
</span><span id="equal_except_adj_list_sequence-420"><a href="#equal_except_adj_list_sequence-420"><span class="linenos">420</span></a><span class="sd">	This function is not robustly correct for some corner cases using `CoordTokenizers.CTT`.</span>
</span><span id="equal_except_adj_list_sequence-421"><a href="#equal_except_adj_list_sequence-421"><span class="linenos">421</span></a><span class="sd">	If rollouts are passed for identical tokenizers processing two slightly different mazes, a false positive is possible.</span>
</span><span id="equal_except_adj_list_sequence-422"><a href="#equal_except_adj_list_sequence-422"><span class="linenos">422</span></a><span class="sd">	More specifically, some cases of zero-sum adding and removing of connections in a maze within square regions along the diagonal will produce a false positive.</span>
</span><span id="equal_except_adj_list_sequence-423"><a href="#equal_except_adj_list_sequence-423"><span class="linenos">423</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="equal_except_adj_list_sequence-424"><a href="#equal_except_adj_list_sequence-424"><span class="linenos">424</span></a>	<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rollout1</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rollout2</span><span class="p">):</span>
</span><span id="equal_except_adj_list_sequence-425"><a href="#equal_except_adj_list_sequence-425"><span class="linenos">425</span></a>		<span class="k">if</span> <span class="n">do_except</span><span class="p">:</span>
</span><span id="equal_except_adj_list_sequence-426"><a href="#equal_except_adj_list_sequence-426"><span class="linenos">426</span></a>			<span class="n">when_len_mismatch</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
</span><span id="equal_except_adj_list_sequence-427"><a href="#equal_except_adj_list_sequence-427"><span class="linenos">427</span></a>				<span class="sa">f</span><span class="s2">&quot;Rollouts are not the same length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">rollout1</span><span class="p">)</span><span class="si">}</span><span class="s2"> != </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">rollout2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="equal_except_adj_list_sequence-428"><a href="#equal_except_adj_list_sequence-428"><span class="linenos">428</span></a>			<span class="p">)</span>
</span><span id="equal_except_adj_list_sequence-429"><a href="#equal_except_adj_list_sequence-429"><span class="linenos">429</span></a>		<span class="k">return</span> <span class="kc">False</span>
</span><span id="equal_except_adj_list_sequence-430"><a href="#equal_except_adj_list_sequence-430"><span class="linenos">430</span></a>	<span class="k">if</span> <span class="p">(</span><span class="s2">&quot;&lt;ADJLIST_START&gt;&quot;</span> <span class="ow">in</span> <span class="n">rollout1</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="s2">&quot;&lt;ADJLIST_START&gt;&quot;</span> <span class="ow">in</span> <span class="n">rollout2</span><span class="p">):</span>
</span><span id="equal_except_adj_list_sequence-431"><a href="#equal_except_adj_list_sequence-431"><span class="linenos">431</span></a>		<span class="k">if</span> <span class="n">do_except</span><span class="p">:</span>
</span><span id="equal_except_adj_list_sequence-432"><a href="#equal_except_adj_list_sequence-432"><span class="linenos">432</span></a>			<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Rollouts do not have the same &lt;ADJLIST_START&gt; token: `</span><span class="si">{</span><span class="s1">&#39;&lt;ADJLIST_START&gt;&#39;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">rollout1</span><span class="w"> </span><span class="si">= }</span><span class="s2">` != `</span><span class="si">{</span><span class="s1">&#39;&lt;ADJLIST_START&gt;&#39;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">rollout2</span><span class="w"> </span><span class="si">= }</span><span class="s2">`&quot;</span>
</span><span id="equal_except_adj_list_sequence-433"><a href="#equal_except_adj_list_sequence-433"><span class="linenos">433</span></a>			<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="equal_except_adj_list_sequence-434"><a href="#equal_except_adj_list_sequence-434"><span class="linenos">434</span></a>				<span class="n">err_msg</span><span class="p">,</span>
</span><span id="equal_except_adj_list_sequence-435"><a href="#equal_except_adj_list_sequence-435"><span class="linenos">435</span></a>			<span class="p">)</span>
</span><span id="equal_except_adj_list_sequence-436"><a href="#equal_except_adj_list_sequence-436"><span class="linenos">436</span></a>		<span class="k">return</span> <span class="kc">False</span>
</span><span id="equal_except_adj_list_sequence-437"><a href="#equal_except_adj_list_sequence-437"><span class="linenos">437</span></a>	<span class="k">if</span> <span class="p">(</span><span class="s2">&quot;&lt;ADJLIST_END&gt;&quot;</span> <span class="ow">in</span> <span class="n">rollout1</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="s2">&quot;&lt;ADJLIST_END&gt;&quot;</span> <span class="ow">in</span> <span class="n">rollout2</span><span class="p">):</span>
</span><span id="equal_except_adj_list_sequence-438"><a href="#equal_except_adj_list_sequence-438"><span class="linenos">438</span></a>		<span class="k">if</span> <span class="n">do_except</span><span class="p">:</span>
</span><span id="equal_except_adj_list_sequence-439"><a href="#equal_except_adj_list_sequence-439"><span class="linenos">439</span></a>			<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Rollouts do not have the same &lt;ADJLIST_END&gt; token: `</span><span class="si">{</span><span class="s1">&#39;&lt;ADJLIST_END&gt;&#39;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">rollout1</span><span class="w"> </span><span class="si">= }</span><span class="s2">` != `</span><span class="si">{</span><span class="s1">&#39;&lt;ADJLIST_END&gt;&#39;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">rollout2</span><span class="w"> </span><span class="si">= }</span><span class="s2">`&quot;</span>
</span><span id="equal_except_adj_list_sequence-440"><a href="#equal_except_adj_list_sequence-440"><span class="linenos">440</span></a>			<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="equal_except_adj_list_sequence-441"><a href="#equal_except_adj_list_sequence-441"><span class="linenos">441</span></a>				<span class="n">err_msg</span><span class="p">,</span>
</span><span id="equal_except_adj_list_sequence-442"><a href="#equal_except_adj_list_sequence-442"><span class="linenos">442</span></a>			<span class="p">)</span>
</span><span id="equal_except_adj_list_sequence-443"><a href="#equal_except_adj_list_sequence-443"><span class="linenos">443</span></a>		<span class="k">return</span> <span class="kc">False</span>
</span><span id="equal_except_adj_list_sequence-444"><a href="#equal_except_adj_list_sequence-444"><span class="linenos">444</span></a>
</span><span id="equal_except_adj_list_sequence-445"><a href="#equal_except_adj_list_sequence-445"><span class="linenos">445</span></a>	<span class="n">adj_list1</span><span class="p">,</span> <span class="n">non_adj_list1</span> <span class="o">=</span> <span class="n">get_token_regions</span><span class="p">(</span><span class="n">rollout1</span><span class="p">)</span>
</span><span id="equal_except_adj_list_sequence-446"><a href="#equal_except_adj_list_sequence-446"><span class="linenos">446</span></a>	<span class="n">adj_list2</span><span class="p">,</span> <span class="n">non_adj_list2</span> <span class="o">=</span> <span class="n">get_token_regions</span><span class="p">(</span><span class="n">rollout2</span><span class="p">)</span>
</span><span id="equal_except_adj_list_sequence-447"><a href="#equal_except_adj_list_sequence-447"><span class="linenos">447</span></a>	<span class="k">if</span> <span class="n">non_adj_list1</span> <span class="o">!=</span> <span class="n">non_adj_list2</span><span class="p">:</span>
</span><span id="equal_except_adj_list_sequence-448"><a href="#equal_except_adj_list_sequence-448"><span class="linenos">448</span></a>		<span class="k">if</span> <span class="n">do_except</span><span class="p">:</span>
</span><span id="equal_except_adj_list_sequence-449"><a href="#equal_except_adj_list_sequence-449"><span class="linenos">449</span></a>			<span class="n">when_len_mismatch</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
</span><span id="equal_except_adj_list_sequence-450"><a href="#equal_except_adj_list_sequence-450"><span class="linenos">450</span></a>				<span class="sa">f</span><span class="s2">&quot;Non-adjacency list tokens are not the same:</span><span class="se">\n</span><span class="si">{</span><span class="n">non_adj_list1</span><span class="si">}</span><span class="se">\n</span><span class="s2">!=</span><span class="se">\n</span><span class="si">{</span><span class="n">non_adj_list2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="equal_except_adj_list_sequence-451"><a href="#equal_except_adj_list_sequence-451"><span class="linenos">451</span></a>			<span class="p">)</span>
</span><span id="equal_except_adj_list_sequence-452"><a href="#equal_except_adj_list_sequence-452"><span class="linenos">452</span></a>			<span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Non-adjacency list tokens are not the same:</span><span class="se">\n</span><span class="si">{</span><span class="n">non_adj_list1</span><span class="si">}</span><span class="se">\n</span><span class="s2">!=</span><span class="se">\n</span><span class="si">{</span><span class="n">non_adj_list2</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="equal_except_adj_list_sequence-453"><a href="#equal_except_adj_list_sequence-453"><span class="linenos">453</span></a>			<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="equal_except_adj_list_sequence-454"><a href="#equal_except_adj_list_sequence-454"><span class="linenos">454</span></a>				<span class="n">err_msg</span><span class="p">,</span>
</span><span id="equal_except_adj_list_sequence-455"><a href="#equal_except_adj_list_sequence-455"><span class="linenos">455</span></a>			<span class="p">)</span>
</span><span id="equal_except_adj_list_sequence-456"><a href="#equal_except_adj_list_sequence-456"><span class="linenos">456</span></a>		<span class="k">return</span> <span class="kc">False</span>
</span><span id="equal_except_adj_list_sequence-457"><a href="#equal_except_adj_list_sequence-457"><span class="linenos">457</span></a>	<span class="n">counter1</span><span class="p">:</span> <span class="n">Counter</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">adj_list1</span><span class="p">)</span>
</span><span id="equal_except_adj_list_sequence-458"><a href="#equal_except_adj_list_sequence-458"><span class="linenos">458</span></a>	<span class="n">counter2</span><span class="p">:</span> <span class="n">Counter</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">adj_list2</span><span class="p">)</span>
</span><span id="equal_except_adj_list_sequence-459"><a href="#equal_except_adj_list_sequence-459"><span class="linenos">459</span></a>	<span class="n">counters_eq</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">counter1</span> <span class="o">==</span> <span class="n">counter2</span>
</span><span id="equal_except_adj_list_sequence-460"><a href="#equal_except_adj_list_sequence-460"><span class="linenos">460</span></a>	<span class="k">if</span> <span class="ow">not</span> <span class="n">counters_eq</span><span class="p">:</span>
</span><span id="equal_except_adj_list_sequence-461"><a href="#equal_except_adj_list_sequence-461"><span class="linenos">461</span></a>		<span class="k">if</span> <span class="n">do_except</span><span class="p">:</span>
</span><span id="equal_except_adj_list_sequence-462"><a href="#equal_except_adj_list_sequence-462"><span class="linenos">462</span></a>			<span class="n">when_counter_mismatch</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
</span><span id="equal_except_adj_list_sequence-463"><a href="#equal_except_adj_list_sequence-463"><span class="linenos">463</span></a>				<span class="sa">f</span><span class="s2">&quot;Adjacency list counters are not the same:</span><span class="se">\n</span><span class="si">{</span><span class="n">counter1</span><span class="si">}</span><span class="se">\n</span><span class="s2">!=</span><span class="se">\n</span><span class="si">{</span><span class="n">counter2</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">counter1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">counter2</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="equal_except_adj_list_sequence-464"><a href="#equal_except_adj_list_sequence-464"><span class="linenos">464</span></a>			<span class="p">)</span>
</span><span id="equal_except_adj_list_sequence-465"><a href="#equal_except_adj_list_sequence-465"><span class="linenos">465</span></a>		<span class="k">return</span> <span class="kc">False</span>
</span><span id="equal_except_adj_list_sequence-466"><a href="#equal_except_adj_list_sequence-466"><span class="linenos">466</span></a>
</span><span id="equal_except_adj_list_sequence-467"><a href="#equal_except_adj_list_sequence-467"><span class="linenos">467</span></a>	<span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Returns if the rollout strings are equal, allowing for differently sequenced adjacency lists.</p>

<p><ADJLIST_START> and <ADJLIST_END> tokens must be in the rollouts.
Intended ONLY for determining if two tokenization schemes are the same for rollouts generated from the same maze.
This function should NOT be used to determine if two rollouts encode the same <code>LatticeMaze</code> object.</p>

<h1 id="warning-ctt-false-positives">Warning: CTT False Positives</h1>

<p>This function is not robustly correct for some corner cases using <code>CoordTokenizers.CTT</code>.
If rollouts are passed for identical tokenizers processing two slightly different mazes, a false positive is possible.
More specifically, some cases of zero-sum adding and removing of connections in a maze within square regions along the diagonal will produce a false positive.</p>
</div>


                </section>
                <section id="connection_list_to_adj_list">
                            <input id="connection_list_to_adj_list-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">connection_list_to_adj_list</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">conn_list</span><span class="p">:</span> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">Bool</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="s1">&#39;lattice_dim=2 row col&#39;</span><span class="p">]</span>,</span><span class="param">	<span class="n">shuffle_d0</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">shuffle_d1</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">Int8</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="s1">&#39;conn start_end=2 coord=2&#39;</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="connection_list_to_adj_list-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/token_utils.py#L469-L524" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#connection_list_to_adj_list"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="connection_list_to_adj_list-470"><a href="#connection_list_to_adj_list-470"><span class="linenos">470</span></a><span class="k">def</span><span class="w"> </span><span class="nf">connection_list_to_adj_list</span><span class="p">(</span>
</span><span id="connection_list_to_adj_list-471"><a href="#connection_list_to_adj_list-471"><span class="linenos">471</span></a>	<span class="n">conn_list</span><span class="p">:</span> <span class="n">ConnectionList</span><span class="p">,</span>
</span><span id="connection_list_to_adj_list-472"><a href="#connection_list_to_adj_list-472"><span class="linenos">472</span></a>	<span class="n">shuffle_d0</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="connection_list_to_adj_list-473"><a href="#connection_list_to_adj_list-473"><span class="linenos">473</span></a>	<span class="n">shuffle_d1</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="connection_list_to_adj_list-474"><a href="#connection_list_to_adj_list-474"><span class="linenos">474</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Int8</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;conn start_end=2 coord=2&quot;</span><span class="p">]:</span>
</span><span id="connection_list_to_adj_list-475"><a href="#connection_list_to_adj_list-475"><span class="linenos">475</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;converts a `ConnectionList` (special lattice format) to a shuffled adjacency list</span>
</span><span id="connection_list_to_adj_list-476"><a href="#connection_list_to_adj_list-476"><span class="linenos">476</span></a>
</span><span id="connection_list_to_adj_list-477"><a href="#connection_list_to_adj_list-477"><span class="linenos">477</span></a><span class="sd">	# Parameters:</span>
</span><span id="connection_list_to_adj_list-478"><a href="#connection_list_to_adj_list-478"><span class="linenos">478</span></a><span class="sd">	- `conn_list: ConnectionList`</span>
</span><span id="connection_list_to_adj_list-479"><a href="#connection_list_to_adj_list-479"><span class="linenos">479</span></a><span class="sd">		special internal format for graphs which are subgraphs of a lattice</span>
</span><span id="connection_list_to_adj_list-480"><a href="#connection_list_to_adj_list-480"><span class="linenos">480</span></a><span class="sd">	- `shuffle_d0: bool`</span>
</span><span id="connection_list_to_adj_list-481"><a href="#connection_list_to_adj_list-481"><span class="linenos">481</span></a><span class="sd">		shuffle the adjacency list along the 0th axis (order of pairs)</span>
</span><span id="connection_list_to_adj_list-482"><a href="#connection_list_to_adj_list-482"><span class="linenos">482</span></a><span class="sd">	- `shuffle_d1: bool`</span>
</span><span id="connection_list_to_adj_list-483"><a href="#connection_list_to_adj_list-483"><span class="linenos">483</span></a><span class="sd">		shuffle the adjacency list along the 1st axis (order of coordinates in each pair).</span>
</span><span id="connection_list_to_adj_list-484"><a href="#connection_list_to_adj_list-484"><span class="linenos">484</span></a><span class="sd">		If `False`, all pairs have the smaller coord first.</span>
</span><span id="connection_list_to_adj_list-485"><a href="#connection_list_to_adj_list-485"><span class="linenos">485</span></a>
</span><span id="connection_list_to_adj_list-486"><a href="#connection_list_to_adj_list-486"><span class="linenos">486</span></a>
</span><span id="connection_list_to_adj_list-487"><a href="#connection_list_to_adj_list-487"><span class="linenos">487</span></a><span class="sd">	# Returns:</span>
</span><span id="connection_list_to_adj_list-488"><a href="#connection_list_to_adj_list-488"><span class="linenos">488</span></a><span class="sd">	- `Int8[np.ndarray, &quot;conn start_end=2 coord=2&quot;]`</span>
</span><span id="connection_list_to_adj_list-489"><a href="#connection_list_to_adj_list-489"><span class="linenos">489</span></a><span class="sd">		adjacency list in the shape `(n_connections, 2, 2)`</span>
</span><span id="connection_list_to_adj_list-490"><a href="#connection_list_to_adj_list-490"><span class="linenos">490</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="connection_list_to_adj_list-491"><a href="#connection_list_to_adj_list-491"><span class="linenos">491</span></a>	<span class="n">n_connections</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">conn_list</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="connection_list_to_adj_list-492"><a href="#connection_list_to_adj_list-492"><span class="linenos">492</span></a>	<span class="n">adj_list</span><span class="p">:</span> <span class="n">Int8</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;conn start_end=2 coord=2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span>
</span><span id="connection_list_to_adj_list-493"><a href="#connection_list_to_adj_list-493"><span class="linenos">493</span></a>		<span class="p">(</span><span class="n">n_connections</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
</span><span id="connection_list_to_adj_list-494"><a href="#connection_list_to_adj_list-494"><span class="linenos">494</span></a>		<span class="o">-</span><span class="mi">1</span><span class="p">,</span>
</span><span id="connection_list_to_adj_list-495"><a href="#connection_list_to_adj_list-495"><span class="linenos">495</span></a>		<span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">,</span>
</span><span id="connection_list_to_adj_list-496"><a href="#connection_list_to_adj_list-496"><span class="linenos">496</span></a>	<span class="p">)</span>
</span><span id="connection_list_to_adj_list-497"><a href="#connection_list_to_adj_list-497"><span class="linenos">497</span></a>
</span><span id="connection_list_to_adj_list-498"><a href="#connection_list_to_adj_list-498"><span class="linenos">498</span></a>	<span class="k">if</span> <span class="n">shuffle_d1</span><span class="p">:</span>
</span><span id="connection_list_to_adj_list-499"><a href="#connection_list_to_adj_list-499"><span class="linenos">499</span></a>		<span class="n">flip_d1</span><span class="p">:</span> <span class="n">Float</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot; conn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n_connections</span><span class="p">)</span>
</span><span id="connection_list_to_adj_list-500"><a href="#connection_list_to_adj_list-500"><span class="linenos">500</span></a>
</span><span id="connection_list_to_adj_list-501"><a href="#connection_list_to_adj_list-501"><span class="linenos">501</span></a>	<span class="c1"># loop over all nonzero elements of the connection list</span>
</span><span id="connection_list_to_adj_list-502"><a href="#connection_list_to_adj_list-502"><span class="linenos">502</span></a>	<span class="n">i</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="connection_list_to_adj_list-503"><a href="#connection_list_to_adj_list-503"><span class="linenos">503</span></a>	<span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndindex</span><span class="p">(</span><span class="n">conn_list</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
</span><span id="connection_list_to_adj_list-504"><a href="#connection_list_to_adj_list-504"><span class="linenos">504</span></a>		<span class="k">if</span> <span class="n">conn_list</span><span class="p">[</span><span class="n">d</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]:</span>
</span><span id="connection_list_to_adj_list-505"><a href="#connection_list_to_adj_list-505"><span class="linenos">505</span></a>			<span class="n">c_start</span><span class="p">:</span> <span class="n">CoordTup</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="connection_list_to_adj_list-506"><a href="#connection_list_to_adj_list-506"><span class="linenos">506</span></a>			<span class="n">c_end</span><span class="p">:</span> <span class="n">CoordTup</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="connection_list_to_adj_list-507"><a href="#connection_list_to_adj_list-507"><span class="linenos">507</span></a>				<span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">),</span>
</span><span id="connection_list_to_adj_list-508"><a href="#connection_list_to_adj_list-508"><span class="linenos">508</span></a>				<span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span><span class="p">),</span>
</span><span id="connection_list_to_adj_list-509"><a href="#connection_list_to_adj_list-509"><span class="linenos">509</span></a>			<span class="p">)</span>
</span><span id="connection_list_to_adj_list-510"><a href="#connection_list_to_adj_list-510"><span class="linenos">510</span></a>			<span class="n">adj_list</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">c_start</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>
</span><span id="connection_list_to_adj_list-511"><a href="#connection_list_to_adj_list-511"><span class="linenos">511</span></a>			<span class="n">adj_list</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">c_end</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>
</span><span id="connection_list_to_adj_list-512"><a href="#connection_list_to_adj_list-512"><span class="linenos">512</span></a>
</span><span id="connection_list_to_adj_list-513"><a href="#connection_list_to_adj_list-513"><span class="linenos">513</span></a>			<span class="c1"># flip if shuffling</span>
</span><span id="connection_list_to_adj_list-514"><a href="#connection_list_to_adj_list-514"><span class="linenos">514</span></a>			<span class="c1"># magic value is fine here</span>
</span><span id="connection_list_to_adj_list-515"><a href="#connection_list_to_adj_list-515"><span class="linenos">515</span></a>			<span class="k">if</span> <span class="n">shuffle_d1</span> <span class="ow">and</span> <span class="p">(</span><span class="n">flip_d1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">):</span>  <span class="c1"># noqa: PLR2004</span>
</span><span id="connection_list_to_adj_list-516"><a href="#connection_list_to_adj_list-516"><span class="linenos">516</span></a>				<span class="n">c_s</span><span class="p">,</span> <span class="n">c_e</span> <span class="o">=</span> <span class="n">adj_list</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">adj_list</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="connection_list_to_adj_list-517"><a href="#connection_list_to_adj_list-517"><span class="linenos">517</span></a>				<span class="n">adj_list</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_e</span>
</span><span id="connection_list_to_adj_list-518"><a href="#connection_list_to_adj_list-518"><span class="linenos">518</span></a>				<span class="n">adj_list</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_s</span>
</span><span id="connection_list_to_adj_list-519"><a href="#connection_list_to_adj_list-519"><span class="linenos">519</span></a>
</span><span id="connection_list_to_adj_list-520"><a href="#connection_list_to_adj_list-520"><span class="linenos">520</span></a>			<span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="connection_list_to_adj_list-521"><a href="#connection_list_to_adj_list-521"><span class="linenos">521</span></a>
</span><span id="connection_list_to_adj_list-522"><a href="#connection_list_to_adj_list-522"><span class="linenos">522</span></a>	<span class="k">if</span> <span class="n">shuffle_d0</span><span class="p">:</span>
</span><span id="connection_list_to_adj_list-523"><a href="#connection_list_to_adj_list-523"><span class="linenos">523</span></a>		<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">adj_list</span><span class="p">)</span>
</span><span id="connection_list_to_adj_list-524"><a href="#connection_list_to_adj_list-524"><span class="linenos">524</span></a>
</span><span id="connection_list_to_adj_list-525"><a href="#connection_list_to_adj_list-525"><span class="linenos">525</span></a>	<span class="k">return</span> <span class="n">adj_list</span>
</span></pre></div>


            <div class="docstring"><p>converts a <code>ConnectionList</code> (special lattice format) to a shuffled adjacency list</p>

<h1 id="parameters">Parameters:</h1>

<ul>
<li><code>conn_list: ConnectionList</code>
special internal format for graphs which are subgraphs of a lattice</li>
<li><code>shuffle_d0: bool</code>
shuffle the adjacency list along the 0th axis (order of pairs)</li>
<li><code>shuffle_d1: bool</code>
shuffle the adjacency list along the 1st axis (order of coordinates in each pair).
If <code>False</code>, all pairs have the smaller coord first.</li>
</ul>

<h1 id="returns">Returns:</h1>

<ul>
<li><code>Int8[np.ndarray, "conn start_end=2 coord=2"]</code>
adjacency list in the shape <code>(n_connections, 2, 2)</code></li>
</ul>
</div>


                </section>
                <section id="is_connection">
                            <input id="is_connection-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_connection</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">edges</span><span class="p">:</span> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">Int8</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="s1">&#39;edges leading_trailing_coord=2 row_col=2&#39;</span><span class="p">]</span>,</span><span class="param">	<span class="n">connection_list</span><span class="p">:</span> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">Bool</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="s1">&#39;lattice_dim=2 row col&#39;</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">Bool</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="s1">&#39;is_connection=edges&#39;</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="is_connection-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/1.4.0maze_dataset/token_utils.py#L527-L536" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#is_connection"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="is_connection-528"><a href="#is_connection-528"><span class="linenos">528</span></a><span class="k">def</span><span class="w"> </span><span class="nf">is_connection</span><span class="p">(</span>
</span><span id="is_connection-529"><a href="#is_connection-529"><span class="linenos">529</span></a>	<span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">,</span>
</span><span id="is_connection-530"><a href="#is_connection-530"><span class="linenos">530</span></a>	<span class="n">connection_list</span><span class="p">:</span> <span class="n">ConnectionList</span><span class="p">,</span>
</span><span id="is_connection-531"><a href="#is_connection-531"><span class="linenos">531</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Bool</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;is_connection=edges&quot;</span><span class="p">]:</span>
</span><span id="is_connection-532"><a href="#is_connection-532"><span class="linenos">532</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot;Returns if each edge in `edges` is a connection (`True`) or wall (`False`) in `connection_list`.&quot;&quot;&quot;</span>
</span><span id="is_connection-533"><a href="#is_connection-533"><span class="linenos">533</span></a>	<span class="n">sorted_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="is_connection-534"><a href="#is_connection-534"><span class="linenos">534</span></a>	<span class="n">edge_direction</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="is_connection-535"><a href="#is_connection-535"><span class="linenos">535</span></a>		<span class="p">(</span><span class="n">sorted_edges</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">sorted_edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:])[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span>
</span><span id="is_connection-536"><a href="#is_connection-536"><span class="linenos">536</span></a>	<span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>
</span><span id="is_connection-537"><a href="#is_connection-537"><span class="linenos">537</span></a>	<span class="k">return</span> <span class="n">connection_list</span><span class="p">[</span><span class="n">edge_direction</span><span class="p">,</span> <span class="n">sorted_edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">sorted_edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
</span></pre></div>


            <div class="docstring"><p>Returns if each edge in <code>edges</code> is a connection (<code>True</code>) or wall (<code>False</code>) in <code>connection_list</code>.</p>
</div>


                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>